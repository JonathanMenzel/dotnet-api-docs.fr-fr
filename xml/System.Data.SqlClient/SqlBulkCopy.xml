<Type Name="SqlBulkCopy" FullName="System.Data.SqlClient.SqlBulkCopy">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="a5fe1fba4a5f51260a44036cdf38a7da69fb2fb7" />
    <Meta Name="ms.sourcegitcommit" Value="5a49536d99d2d0b54e4cb7280870903e043272df" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="07/03/2018" />
    <Meta Name="ms.locfileid" Value="37673298" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class SqlBulkCopy : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlBulkCopy extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Data.SqlClient.SqlBulkCopy" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlBulkCopy&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlBulkCopy sealed : IDisposable" />
  <TypeSignature Language="F#" Value="type SqlBulkCopy = class&#xA;    interface IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Data.SqlClient</AssemblyName>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary>
      <span data-ttu-id="38ad8-101">Permet de charger en masse une table SQL Server avec des données d’une autre source.</span>
      <span class="sxs-lookup">
        <span data-stu-id="38ad8-101">Lets you efficiently bulk load a SQL Server table with data from another source.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-102">Microsoft SQL Server inclut un utilitaire de ligne de commande connu nommé **bcp** de déplacement des données à partir d’une table vers une autre, que ce soit sur un serveur unique ou entre des serveurs.</span><span class="sxs-lookup"><span data-stu-id="38ad8-102">Microsoft SQL Server includes a popular command-prompt utility named **bcp** for moving data from one table to another, whether on a single server or between servers.</span></span> <span data-ttu-id="38ad8-103">Le <xref:System.Data.SqlClient.SqlBulkCopy> classe vous permet d’écrire des solutions de code managé qui fournissent des fonctionnalités similaires.</span><span class="sxs-lookup"><span data-stu-id="38ad8-103">The <xref:System.Data.SqlClient.SqlBulkCopy> class lets you write managed code solutions that provide similar functionality.</span></span> <span data-ttu-id="38ad8-104">Il existe d’autres façons de charger des données dans une table SQL Server (au moyen d’instructions INSERT, par exemple), mais <xref:System.Data.SqlClient.SqlBulkCopy> offre un avantage significative des performances.</span><span class="sxs-lookup"><span data-stu-id="38ad8-104">There are other ways to load data into a SQL Server table (INSERT statements, for example), but <xref:System.Data.SqlClient.SqlBulkCopy> offers a significant performance advantage over them.</span></span>  
  
 <span data-ttu-id="38ad8-105">La classe <xref:System.Data.SqlClient.SqlBulkCopy> permet d'écrire des données uniquement dans des tables SQL Server.</span><span class="sxs-lookup"><span data-stu-id="38ad8-105">The <xref:System.Data.SqlClient.SqlBulkCopy> class can be used to write data only to SQL Server tables.</span></span> <span data-ttu-id="38ad8-106">Toutefois, la source de données n’est pas limitée à SQL Server ; n’importe quelle source de données peut être utilisé tant que les données puissent être chargées dans un <xref:System.Data.DataTable> instance ou lues avec une <xref:System.Data.IDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-106">However, the data source is not limited to SQL Server; any data source can be used, as long as the data can be loaded to a <xref:System.Data.DataTable> instance or read with a <xref:System.Data.IDataReader> instance.</span></span>  
  
 <span data-ttu-id="38ad8-107"><xref:System.Data.SqlClient.SqlBulkCopy> échoue lorsque le chargement en masse un <xref:System.Data.DataTable> colonne de type <xref:System.Data.SqlTypes.SqlDateTime> dans un serveur SQL Server dont le type est un des types date/heure de colonne ajoutée dans SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="38ad8-107"><xref:System.Data.SqlClient.SqlBulkCopy> will fail when bulk loading a <xref:System.Data.DataTable> column of type <xref:System.Data.SqlTypes.SqlDateTime> into a SQL Server column whose type is one of the date/time types added in SQL Server 2008.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-108">L'application console suivante montre comment charger des données à l'aide de la classe <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-108">The following console application demonstrates how to load data using the <xref:System.Data.SqlClient.SqlBulkCopy> class.</span></span> <span data-ttu-id="38ad8-109">Dans cet exemple, un <xref:System.Data.SqlClient.SqlDataReader> est utilisé pour copier des données à partir de la **Production.Product** table dans SQL Server **AdventureWorks** base de données vers une table semblable dans la même base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-109">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-110">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-110">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-111">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-111">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-112">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-112">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-113">Initialise une nouvelle instance de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-113">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connection" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="38ad8-114">Instance déjà ouverte de <see cref="T:System.Data.SqlClient.SqlConnection" /> qui sera utilisée pour effectuer l'opération de copie en bloc.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-114">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy operation.</span>
          </span>
          <span data-ttu-id="38ad8-115">Si votre chaîne de connexion n'utilise pas <see langword="Integrated Security = true" />, vous pouvez utiliser les <see cref="T:System.Data.SqlClient.SqlCredential" /> pour obtenir l'ID d'utilisateur et le mot de passe de façon plus sécurisée qu'en spécifiant l'ID d'utilisateur et le mot de passe sous forme de texte dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-115">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-116">Initialise une nouvelle instance de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> à l'aide de l'instance ouverte de <see cref="T:System.Data.SqlClient.SqlConnection" /> spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-116">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the specified open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-117">Étant donné que la connexion est déjà ouverte lorsque le <xref:System.Data.SqlClient.SqlBulkCopy> instance est initialisée, la connexion reste ouverte après le <xref:System.Data.SqlClient.SqlBulkCopy> instance est fermée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-117">Because the connection is already open when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is initialized, the connection remains open after the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="38ad8-118">Si le `connection` argument est null, un <xref:System.ArgumentNullException> est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-118">If the `connection` argument is null, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-119">L’application console suivante montre comment en bloc des données de charge à l’aide d’une connexion qui est déjà ouverte.</span><span class="sxs-lookup"><span data-stu-id="38ad8-119">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="38ad8-120">Dans cet exemple, un <xref:System.Data.SqlClient.SqlDataReader> est utilisé pour copier des données à partir de la **Production.Product** table dans SQL Server **AdventureWorks** base de données vers une table semblable dans la même base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-120">In this example, a <xref:System.Data.SqlClient.SqlDataReader> is used to copy data from the **Production.Product** table in the SQL Server **AdventureWorks** database to a similar table in the same database.</span></span> <span data-ttu-id="38ad8-121">L’exemple est uniquement fourni à des fins de démonstration.</span><span class="sxs-lookup"><span data-stu-id="38ad8-121">This example is for demonstration purposes only.</span></span> <span data-ttu-id="38ad8-122">Vous ne devez pas utiliser `SqlBulkCopy` pour déplacer des données d’une table à l’autre dans la même base de données dans une application de production.</span><span class="sxs-lookup"><span data-stu-id="38ad8-122">You would not use `SqlBulkCopy` to move data from one table to another in the same database in a production application.</span></span> <span data-ttu-id="38ad8-123">Notez que la source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-123">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-124">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-124">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-125">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-125">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-126">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-126">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks BulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks BulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks BulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy connectionString" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="connectionString">
          <span data-ttu-id="38ad8-127">Chaîne définissant la connexion qui sera ouverte afin d'être utilisée par l'instance de <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-127">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
          <span data-ttu-id="38ad8-128">Si votre chaîne de connexion n'utilise pas <see langword="Integrated Security = true" />, vous pouvez utiliser la <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> ou la <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> et les <see cref="T:System.Data.SqlClient.SqlCredential" /> pour obtenir l'ID d'utilisateur et le mot de passe de façon plus sécurisée qu'en spécifiant l'ID d'utilisateur et le mot de passe sous forme de texte dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-128">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-129">Initialise et ouvre une nouvelle instance de <see cref="T:System.Data.SqlClient.SqlConnection" /> basée sur le <paramref name="connectionString" /> fourni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-129">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span>
          </span>
          <span data-ttu-id="38ad8-130">Ce constructeur utilise <see cref="T:System.Data.SqlClient.SqlConnection" /> pour initialiser une nouvelle instance de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-130">The constructor uses the <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-131">La connexion est fermée automatiquement à la fin de l’opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="38ad8-131">The connection is automatically closed at the end of the bulk copy operation.</span></span>  
  
 <span data-ttu-id="38ad8-132">Si `connectionString` a la valeur null, un <xref:System.ArgumentNullException> est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-132">If `connectionString` is null, an <xref:System.ArgumentNullException> is thrown.</span></span> <span data-ttu-id="38ad8-133">Si `connectionString` est une chaîne vide, un <xref:System.ArgumentException> est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-133">If `connectionString` is an empty string, an <xref:System.ArgumentException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-134">L’application console suivante montre comment en bloc des données de charge à l’aide d’une connexion spécifiée en tant que chaîne.</span><span class="sxs-lookup"><span data-stu-id="38ad8-134">The following console application demonstrates how to bulk load data by using a connection specified as a string.</span></span> <span data-ttu-id="38ad8-135">La connexion est fermée automatiquement lorsque le <xref:System.Data.SqlClient.SqlBulkCopy> instance est fermée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-135">The connection is automatically closed when the <xref:System.Data.SqlClient.SqlBulkCopy> instance is closed.</span></span>  
  
 <span data-ttu-id="38ad8-136">Dans cet exemple, la source de données est tout d’abord en lecture à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-136">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-137">La source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-137">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-138">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-138">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-139">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-139">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-140">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-140">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (string connectionString, System.Data.SqlClient.SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string connectionString, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.String,System.Data.SqlClient.SqlBulkCopyOptions)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connectionString As String, copyOptions As SqlBulkCopyOptions)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::String ^ connectionString, System::Data::SqlClient::SqlBulkCopyOptions copyOptions);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : string * System.Data.SqlClient.SqlBulkCopyOptions -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connectionString, copyOptions)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connectionString" Type="System.String" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
      </Parameters>
      <Docs>
        <param name="connectionString">
          <span data-ttu-id="38ad8-141">Chaîne définissant la connexion qui sera ouverte afin d'être utilisée par l'instance de <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-141">The string defining the connection that will be opened for use by the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
          <span data-ttu-id="38ad8-142">Si votre chaîne de connexion n'utilise pas <see langword="Integrated Security = true" />, vous pouvez utiliser la <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> ou la <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> et les <see cref="T:System.Data.SqlClient.SqlCredential" /> pour obtenir l'ID d'utilisateur et le mot de passe de façon plus sécurisée qu'en spécifiant l'ID d'utilisateur et le mot de passe sous forme de texte dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-142">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection)" /> or <see cref="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" /> and <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <param name="copyOptions">
          <span data-ttu-id="38ad8-143">Combinaison de valeurs de l'énumération <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> qui détermine les lignes de la source de données qui sont copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-143">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-144">Initialise et ouvre une nouvelle instance de <see cref="T:System.Data.SqlClient.SqlConnection" /> basée sur le <paramref name="connectionString" /> fourni.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-144">Initializes and opens a new instance of <see cref="T:System.Data.SqlClient.SqlConnection" /> based on the supplied <paramref name="connectionString" />.</span>
          </span>
          <span data-ttu-id="38ad8-145">Ce constructeur utilise ce <see cref="T:System.Data.SqlClient.SqlConnection" /> pour initialiser une nouvelle instance de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-145">The constructor uses that <see cref="T:System.Data.SqlClient.SqlConnection" /> to initialize a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
          <span data-ttu-id="38ad8-146">L'instance de <see cref="T:System.Data.SqlClient.SqlConnection" /> se comporte conformément aux options fournies dans le paramètre <paramref name="copyOptions" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-146">The <see cref="T:System.Data.SqlClient.SqlConnection" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-147">Vous pouvez obtenir des informations détaillées sur toutes les options de copie en bloc dans le <xref:System.Data.SqlClient.SqlBulkCopyOptions> rubrique.</span><span class="sxs-lookup"><span data-stu-id="38ad8-147">You can obtain detailed information about all the bulk copy options in the <xref:System.Data.SqlClient.SqlBulkCopyOptions> topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-148">L’application console suivante montre comment effectuer un chargement en masse à l’aide d’une connexion spécifiée en tant que chaîne.</span><span class="sxs-lookup"><span data-stu-id="38ad8-148">The following console application demonstrates how to perform a bulk load by using a connection specified as a string.</span></span> <span data-ttu-id="38ad8-149">Une option est définie pour utiliser la valeur dans la colonne d’identité de la table source lorsque vous chargez la table de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-149">An option is set to use the value in the identity column of the source table when you load the destination table.</span></span> <span data-ttu-id="38ad8-150">Dans cet exemple, la source de données est tout d’abord en lecture à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-150">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-151">La table source et table de destination incluent une colonne d’identité.</span><span class="sxs-lookup"><span data-stu-id="38ad8-151">The source table and destination table each include an Identity column.</span></span> <span data-ttu-id="38ad8-152">Par défaut, une nouvelle valeur pour le **identité** colonne est générée dans la table de destination pour chaque ligne ajoutée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-152">By default, a new value for the **Identity** column is generated in the destination table for each row added.</span></span> <span data-ttu-id="38ad8-153">Dans cet exemple, une option est définie lorsque la connexion est ouverte qui oblige le processus de chargement en bloc à utiliser le **identité** valeurs à partir de la table source à la place.</span><span class="sxs-lookup"><span data-stu-id="38ad8-153">In this example, an option is set when the connection is opened that forces the bulk load process to use the **Identity** values from the source table instead.</span></span> <span data-ttu-id="38ad8-154">Pour voir comment l’option change le fonctionnement du chargement en bloc, exécutez l’exemple avec la **dbo. BulkCopyDemoMatchingColumns** table vide.</span><span class="sxs-lookup"><span data-stu-id="38ad8-154">To see how the option changes the way the bulk load works, run the sample with the **dbo.BulkCopyDemoMatchingColumns** table empty.</span></span> <span data-ttu-id="38ad8-155">Chargement de toutes les lignes de la source.</span><span class="sxs-lookup"><span data-stu-id="38ad8-155">All rows load from the source.</span></span> <span data-ttu-id="38ad8-156">Réexécutez ensuite l’exemple sans vider la table.</span><span class="sxs-lookup"><span data-stu-id="38ad8-156">Then run the sample again without emptying the table.</span></span> <span data-ttu-id="38ad8-157">Une exception est levée et le code écrit un message dans la console vous notifiant que les lignes n’ont pas été ajoutées en raison de violations de contrainte de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="38ad8-157">An exception is thrown and the code writes a message to the console notifying you that rows weren't added because of primary key constraint violations.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-158">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-158">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-159">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-159">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-160">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-160">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.KeepIdentity#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.KeepIdentity/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlBulkCopy (System.Data.SqlClient.SqlConnection connection, System.Data.SqlClient.SqlBulkCopyOptions copyOptions, System.Data.SqlClient.SqlTransaction externalTransaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Data.SqlClient.SqlConnection connection, valuetype System.Data.SqlClient.SqlBulkCopyOptions copyOptions, class System.Data.SqlClient.SqlTransaction externalTransaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.#ctor(System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlBulkCopyOptions,System.Data.SqlClient.SqlTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (connection As SqlConnection, copyOptions As SqlBulkCopyOptions, externalTransaction As SqlTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlBulkCopy(System::Data::SqlClient::SqlConnection ^ connection, System::Data::SqlClient::SqlBulkCopyOptions copyOptions, System::Data::SqlClient::SqlTransaction ^ externalTransaction);" />
      <MemberSignature Language="F#" Value="new System.Data.SqlClient.SqlBulkCopy : System.Data.SqlClient.SqlConnection * System.Data.SqlClient.SqlBulkCopyOptions * System.Data.SqlClient.SqlTransaction -&gt; System.Data.SqlClient.SqlBulkCopy" Usage="new System.Data.SqlClient.SqlBulkCopy (connection, copyOptions, externalTransaction)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="connection" Type="System.Data.SqlClient.SqlConnection" />
        <Parameter Name="copyOptions" Type="System.Data.SqlClient.SqlBulkCopyOptions" />
        <Parameter Name="externalTransaction" Type="System.Data.SqlClient.SqlTransaction" />
      </Parameters>
      <Docs>
        <param name="connection">
          <span data-ttu-id="38ad8-161">Instance déjà ouverte de <see cref="T:System.Data.SqlClient.SqlConnection" /> qui sera utilisée pour effectuer l'opération de copie en bloc.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-161">The already open <see cref="T:System.Data.SqlClient.SqlConnection" /> instance that will be used to perform the bulk copy.</span>
          </span>
          <span data-ttu-id="38ad8-162">Si votre chaîne de connexion n'utilise pas <see langword="Integrated Security = true" />, vous pouvez utiliser les <see cref="T:System.Data.SqlClient.SqlCredential" /> pour obtenir l'ID d'utilisateur et le mot de passe de façon plus sécurisée qu'en spécifiant l'ID d'utilisateur et le mot de passe sous forme de texte dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-162">If your connection string does not use <see langword="Integrated Security = true" />, you can use <see cref="T:System.Data.SqlClient.SqlCredential" /> to pass the user ID and password more securely than by specifying the user ID and password as text in the connection string.</span>
          </span>
        </param>
        <param name="copyOptions">
          <span data-ttu-id="38ad8-163">Combinaison de valeurs de l'énumération <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> qui détermine les lignes de la source de données qui sont copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-163">A combination of values from the <see cref="T:System.Data.SqlClient.SqlBulkCopyOptions" /> enumeration that determines which data source rows are copied to the destination table.</span>
          </span>
        </param>
        <param name="externalTransaction">
          <span data-ttu-id="38ad8-164">Instance de <see cref="T:System.Data.SqlClient.SqlTransaction" /> existante sous laquelle la copie en bloc aura lieu.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-164">An existing <see cref="T:System.Data.SqlClient.SqlTransaction" /> instance under which the bulk copy will occur.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-165">Initialise une nouvelle instance de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> à l'aide de l'instance ouverte existante de <see cref="T:System.Data.SqlClient.SqlConnection" /> fournie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-165">Initializes a new instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class using the supplied existing open instance of <see cref="T:System.Data.SqlClient.SqlConnection" />.</span>
          </span>
          <span data-ttu-id="38ad8-166">L'instance de <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> se comporte conformément aux options fournies dans le paramètre <paramref name="copyOptions" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-166">The <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance behaves according to options supplied in the <paramref name="copyOptions" /> parameter.</span>
          </span>
          <span data-ttu-id="38ad8-167">Si un <see cref="T:System.Data.SqlClient.SqlTransaction" /> non null est fourni, les opérations de copie seront effectuées dans cette transaction.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-167">If a non-null <see cref="T:System.Data.SqlClient.SqlTransaction" /> is supplied, the copy operations will be performed within that transaction.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-168">Si les options incluent `UseInternalTransaction` et `externalTransaction` argument n’est pas null, une **InvalidArgumentException** est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-168">If options include `UseInternalTransaction` and the `externalTransaction` argument is not null, an **InvalidArgumentException** is thrown.</span></span>  
  
 <span data-ttu-id="38ad8-169">Pour obtenir des exemples montrant comment utiliser `SqlBulkCopy` dans une transaction, consultez [Transaction et opérations de copie en bloc](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-169">For examples demonstrating how to use `SqlBulkCopy` in a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="BatchSize">
      <MemberSignature Language="C#" Value="public int BatchSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BatchSize" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberSignature Language="VB.NET" Value="Public Property BatchSize As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BatchSize { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BatchSize : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BatchSize" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-170">Nombre de lignes dans chaque lot.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-170">Number of rows in each batch.</span>
          </span>
          <span data-ttu-id="38ad8-171">À la fin de chaque lot, les lignes dans le lot sont envoyées au serveur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-171">At the end of each batch, the rows in the batch are sent to the server.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-172">Valeur entière de la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> ou zéro si aucune valeur n’a été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-172">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BatchSize" /> property, or zero if no value has been set.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-173">Un lot est terminé lorsque <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> lignes ont été traitées ou il n’existe plus aucune ligne à envoyer à la source de données de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-173">A batch is complete when <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows have been processed or there are no more rows to send to the destination data source.</span></span>  
  
 <span data-ttu-id="38ad8-174">Zéro (valeur par défaut) indique que chaque <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> opération est un lot unique.</span><span class="sxs-lookup"><span data-stu-id="38ad8-174">Zero (the default) indicates that each <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is a single batch.</span></span>  
  
 <span data-ttu-id="38ad8-175">Si le <xref:System.Data.SqlClient.SqlBulkCopy> instance a été déclarée sans le <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> option en vigueur, les lignes sont envoyées au serveur <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> provient des lignes à une heure, mais aucune action relative à la transaction.</span><span class="sxs-lookup"><span data-stu-id="38ad8-175">If the <xref:System.Data.SqlClient.SqlBulkCopy> instance has been declared without the <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> option in effect, rows are sent to the server <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> rows at a time, but no transaction-related action is taken.</span></span> <span data-ttu-id="38ad8-176">Si <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> est en effet, chaque lot de lignes est inséré comme une transaction distincte.</span><span class="sxs-lookup"><span data-stu-id="38ad8-176">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is in effect, each batch of rows is inserted as a separate transaction.</span></span>  
  
 <span data-ttu-id="38ad8-177">Le <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> propriété peut être définie à tout moment.</span><span class="sxs-lookup"><span data-stu-id="38ad8-177">The <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> property can be set at any time.</span></span> <span data-ttu-id="38ad8-178">Si une copie en bloc est déjà en cours d’exécution, le lot actuel est dimensionné en fonction de la taille du lot précédent.</span><span class="sxs-lookup"><span data-stu-id="38ad8-178">If a bulk copy is already in progress, the current batch is sized according to the previous batch size.</span></span> <span data-ttu-id="38ad8-179">Les lots suivants utilisent la nouvelle taille.</span><span class="sxs-lookup"><span data-stu-id="38ad8-179">Subsequent batches use the new size.</span></span> <span data-ttu-id="38ad8-180">Si le <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> est initialement égale à zéro et les modifications apportées lors une <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> opération est déjà en cours, cette opération charge les données comme un lot unique.</span><span class="sxs-lookup"><span data-stu-id="38ad8-180">If the <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> is initially zero and changed while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is already in progress, that operation loads the data as a single batch.</span></span> <span data-ttu-id="38ad8-181">Toutes les <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> opérations sur le même <xref:System.Data.SqlClient.SqlBulkCopy> instance utiliser la nouvelle <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-181">Any subsequent <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operations on the same <xref:System.Data.SqlClient.SqlBulkCopy> instance use the new <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-182">L’application console suivante montre comment en bloc des données de chargement par lots de 50 lignes.</span><span class="sxs-lookup"><span data-stu-id="38ad8-182">The following console application demonstrates how to bulk load data in batches of 50 rows.</span></span> <span data-ttu-id="38ad8-183">Pour un exemple illustrant comment <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> fonctionne avec une transaction, consultez [Transaction et opérations de copie en bloc](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-183">For an example illustrating how <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> works with a transaction, see [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md).</span></span>  
  
 <span data-ttu-id="38ad8-184">Dans cet exemple, la source de données est tout d’abord en lecture à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-184">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-185">La source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-185">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-186">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-186">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-187">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-187">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-188">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-188">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.BatchSize#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.BatchSize/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="BulkCopyTimeout">
      <MemberSignature Language="C#" Value="public int BulkCopyTimeout { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 BulkCopyTimeout" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Property BulkCopyTimeout As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int BulkCopyTimeout { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.BulkCopyTimeout : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-189">Nombre de secondes pour l’achèvement de l’opération avant qu’elle n’expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-189">Number of seconds for the operation to complete before it times out.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-190">Valeur entière de la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-190">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.BulkCopyTimeout" /> property.</span>
          </span>
          <span data-ttu-id="38ad8-191">La valeur par défaut est 30 secondes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-191">The default is 30 seconds.</span>
          </span>
          <span data-ttu-id="38ad8-192">La valeur 0 indique une absence de limite ; la copie en bloc attend indéfiniment.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-192">A value of 0 indicates no limit; the bulk copy will wait indefinitely.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-193">Si l’opération n’expire, la transaction n’est pas validée et toutes les lignes copiées sont supprimés de la table de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-193">If the operation does time out, the transaction is not committed and all copied rows are removed from the destination table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-194">L’application console suivante montre comment modifier le délai d’attente de 60 secondes lorsque les données de chargement en bloc.</span><span class="sxs-lookup"><span data-stu-id="38ad8-194">The following console application demonstrates how to modify the time-out to 60 seconds when bulk loading data.</span></span>  
  
 <span data-ttu-id="38ad8-195">Dans cet exemple, la source de données est tout d’abord en lecture à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-195">In this example, the source data is first read from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-196">La source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-196">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-197">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-197">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-198">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-198">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-199">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser un [!INCLUDE[tsql](~/includes/tsql-md.md)] `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-199">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a [!INCLUDE[tsql](~/includes/tsql-md.md)]`INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Timeout#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Timeout/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="sqlBulkCopy.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-200">Ferme l’instance <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-200">Closes the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> instance.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-201">Une fois que vous appelez un <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> sur la <xref:System.Data.SqlClient.SqlBulkCopy> de l’objet, aucune autre opération ne réussira.</span><span class="sxs-lookup"><span data-stu-id="38ad8-201">After you call a <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> on the <xref:System.Data.SqlClient.SqlBulkCopy> object, no other operation will succeed.</span></span> <span data-ttu-id="38ad8-202">Les appels à la <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> méthode lèvera une <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-202">Calls to the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="38ad8-203">Appelant le <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> méthode à partir de la <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> événement entraîne un <xref:System.InvalidOperationException> levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-203">Calling the <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method from the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event causes an <xref:System.InvalidOperationException> to be thrown.</span></span>  
  
 <span data-ttu-id="38ad8-204">Notez qui s’ouvrent <xref:System.Data.SqlClient.SqlBulkCopy> instances sont fermées implicitement à la fin d’un `using` bloc.</span><span class="sxs-lookup"><span data-stu-id="38ad8-204">Note that open <xref:System.Data.SqlClient.SqlBulkCopy> instances are closed implicitly at the end of a `using` block.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-205">L’exemple suivant utilise le même <xref:System.Data.SqlClient.SqlBulkCopy> instance à ajouter des commandes client et les détails associés à deux tables de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-205">The following example uses the same <xref:System.Data.SqlClient.SqlBulkCopy> instance to add sales orders and their associated details to two destination tables.</span></span> <span data-ttu-id="38ad8-206">Étant donné que le **AdventureWorks** commande vente tables sont volumineuses, l’exemple lit uniquement les commandes passées par un certain nombre de compte et copie en bloc ces commandes et les détails associés aux tables de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-206">Because the **AdventureWorks** sales order tables are large, the sample reads only orders placed by a certain account number and bulk copies those orders and details to the destination tables.</span></span> <span data-ttu-id="38ad8-207">Le <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> méthode est utilisée uniquement après que les deux opérations de copie en bloc sont terminées.</span><span class="sxs-lookup"><span data-stu-id="38ad8-207">The <xref:System.Data.SqlClient.SqlBulkCopy.Close%2A> method is used only after both bulk copy operations are complete.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-208">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-208">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-209">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-209">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-210">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-210">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.OrdersDetails#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.OrdersDetails/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ColumnMappings">
      <MemberSignature Language="C#" Value="public System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Data.SqlClient.SqlBulkCopyColumnMappingCollection ColumnMappings" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ColumnMappings As SqlBulkCopyColumnMappingCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ ColumnMappings { System::Data::SqlClient::SqlBulkCopyColumnMappingCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ColumnMappings : System.Data.SqlClient.SqlBulkCopyColumnMappingCollection" Usage="System.Data.SqlClient.SqlBulkCopy.ColumnMappings" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlBulkCopyColumnMappingCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-211">Retourne une collection d’éléments <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-211">Returns a collection of <see cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" /> items.</span>
          </span>
          <span data-ttu-id="38ad8-212">Les mappages de colonnes définissent les relations entre les colonnes de la source de données et les colonnes de la destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-212">Column mappings define the relationships between columns in the data source and columns in the destination.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-213">Collection de mappages de colonnes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-213">A collection of column mappings.</span>
          </span>
          <span data-ttu-id="38ad8-214">Par défaut, cette collection est vide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-214">By default, it is an empty collection.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-215">Si la source de données et de la table de destination ont le même nombre de colonnes, et la position ordinale de chaque colonne source dans la source de données correspond à la position ordinale de la colonne de destination correspondante, le <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="38ad8-215">If the data source and the destination table have the same number of columns, and the ordinal position of each source column within the data source matches the ordinal position of the corresponding destination column, the <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection is unnecessary.</span></span> <span data-ttu-id="38ad8-216">Toutefois, si le nombre de colonnes diffère, ou les positions ordinales ne sont pas cohérentes, vous devez utiliser <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> pour vous assurer que les données sont copiées dans les colonnes appropriées.</span><span class="sxs-lookup"><span data-stu-id="38ad8-216">However, if the column counts differ, or the ordinal positions are not consistent, you must use <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> to make sure that data is copied into the correct columns.</span></span>  
  
 <span data-ttu-id="38ad8-217">Pendant l’exécution d’une opération de copie en bloc, cette collection est accessible, mais il ne peut pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="38ad8-217">During the execution of a bulk copy operation, this collection can be accessed, but it cannot be changed.</span></span> <span data-ttu-id="38ad8-218">Toute tentative de modification lèvera une <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-218">Any attempt to change it will throw an <xref:System.InvalidOperationException>.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.SqlClient.SqlBulkCopyColumnMapping" />
      </Docs>
    </Member>
    <Member MemberName="DestinationTableName">
      <MemberSignature Language="C#" Value="public string DestinationTableName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DestinationTableName" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberSignature Language="VB.NET" Value="Public Property DestinationTableName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DestinationTableName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DestinationTableName : string with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-219">Nom de la table de destination sur le serveur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-219">Name of the destination table on the server.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-220">Valeur de chaîne de la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" />, ou null si aucune valeur n’a été fournie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-220">The string value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property, or null if none as been supplied.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-221">Si <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> n’a été défini lorsque <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> est appelée, un <xref:System.ArgumentNullException> est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-221">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> has not been set when <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> is called, an <xref:System.ArgumentNullException> is thrown.</span></span>  
  
 <span data-ttu-id="38ad8-222">Si <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> est modifié pendant un <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> opération est en cours d’exécution, la modification n’affecte pas l’opération en cours.</span><span class="sxs-lookup"><span data-stu-id="38ad8-222">If <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is modified while a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is running, the change does not affect the current operation.</span></span> <span data-ttu-id="38ad8-223">La nouvelle <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> valeur est utilisée la prochaine fois un <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-223">The new <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> value is used the next time a <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called.</span></span>  
  
 <span data-ttu-id="38ad8-224"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> est un nom en trois parties (`<database>.<owningschema>.<name>`).</span><span class="sxs-lookup"><span data-stu-id="38ad8-224"><xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> is a three-part name (`<database>.<owningschema>.<name>`).</span></span> <span data-ttu-id="38ad8-225">Vous pouvez qualifier le nom de table avec sa base de données et son schéma propriétaire si vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="38ad8-225">You can qualify the table name with its database and owning schema if you choose.</span></span> <span data-ttu-id="38ad8-226">Toutefois, si le nom de table utilise un trait de soulignement (« _ ») ou d’autres caractères spéciaux, vous devez échapper le nom à l’aide de la placer entre crochets comme dans (`[<database>.<owningschema>.<name_01>]`).</span><span class="sxs-lookup"><span data-stu-id="38ad8-226">However, if the table name uses an underscore ("_") or any other special characters, you must escape the name using surrounding brackets as in (`[<database>.<owningschema>.<name_01>]`).</span></span> <span data-ttu-id="38ad8-227">Pour plus d’informations, consultez « Identificateurs » dans la documentation en ligne de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="38ad8-227">For more information, see "Identifiers" in SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="38ad8-228">Vous pouvez les données de copie en bloc dans une table temporaire en utilisant une valeur telle que `tempdb..#table` ou `tempdb.<owner>.#table` pour le <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="38ad8-228">You can bulk-copy data to a temporary table by using a value such as `tempdb..#table` or `tempdb.<owner>.#table` for the <xref:System.Data.SqlClient.SqlBulkCopy.DestinationTableName%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-229">L’application console suivante montre comment en bloc des données de charge à l’aide d’une connexion qui est déjà ouverte.</span><span class="sxs-lookup"><span data-stu-id="38ad8-229">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="38ad8-230">La table de destination est une table dans le **AdventureWorks** base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-230">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="38ad8-231">Dans cet exemple, la connexion est tout d’abord utilisée pour lire les données à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-231">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-232">La source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-232">The source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-233">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-233">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-234">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-234">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-235">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-235">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.Single#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.Single/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="EnableStreaming">
      <MemberSignature Language="C#" Value="public bool EnableStreaming { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableStreaming" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableStreaming As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableStreaming { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableStreaming : bool with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.EnableStreaming" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-236">Active ou désactive un objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> pour diffuser des données en continu à partir d’un objet <see cref="T:System.Data.IDataReader" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-236">Enables or disables a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object to stream data from an <see cref="T:System.Data.IDataReader" /> object</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-237">
            <see langword="true" /> si un objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> peut diffuser des données en continu à partir d’un objet <see cref="T:System.Data.IDataReader" /> ; sinon, false.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-237">
              <see langword="true" /> if a <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object can stream data from an <see cref="T:System.Data.IDataReader" /> object; otherwise, false.</span>
          </span>
          <span data-ttu-id="38ad8-238">La valeur par défaut est <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-238">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-239">Lorsque <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> est `true`, <xref:System.Data.SqlClient.SqlBulkCopy> lit à partir d’un <xref:System.Data.IDataReader> à l’aide de l’objet <xref:System.Data.CommandBehavior.SequentialAccess>, optimisation de l’utilisation de mémoire à l’aide de la <xref:System.Data.IDataReader> fonctionnalités de diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="38ad8-239">When <xref:System.Data.SqlClient.SqlBulkCopy.EnableStreaming%2A> is `true`, <xref:System.Data.SqlClient.SqlBulkCopy> reads from an <xref:System.Data.IDataReader> object using <xref:System.Data.CommandBehavior.SequentialAccess>, optimizing memory usage by using the <xref:System.Data.IDataReader> streaming capabilities.</span></span> <span data-ttu-id="38ad8-240">Lorsqu’il est défini sur false, le <xref:System.Data.SqlClient.SqlBulkCopy> classe charge toutes les données retournées par la <xref:System.Data.IDataReader> objet en mémoire avant de les envoyer à SQL Server ou SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="38ad8-240">When it’s set to false, the <xref:System.Data.SqlClient.SqlBulkCopy> class loads all the data returned by the <xref:System.Data.IDataReader> object into memory before sending it to SQL Server or SQL Azure.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NotifyAfter">
      <MemberSignature Language="C#" Value="public int NotifyAfter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 NotifyAfter" />
      <MemberSignature Language="DocId" Value="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberSignature Language="VB.NET" Value="Public Property NotifyAfter As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int NotifyAfter { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.NotifyAfter : int with get, set" Usage="System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-241">Définit le nombre de lignes à traiter avant de générer un événement de notification.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-241">Defines the number of rows to be processed before generating a notification event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="38ad8-242">Valeur entière de la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" />, ou zéro si la propriété n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-242">The integer value of the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property, or zero if the property has not been set.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-243">Cette propriété est conçue pour les composants d’interface utilisateur qui illustrent la progression d’une opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="38ad8-243">This property is designed for user interface components that illustrate the progress of a bulk copy operation.</span></span> <span data-ttu-id="38ad8-244">Cette propriété indique le nombre de lignes à traiter avant de générer un événement de notification.</span><span class="sxs-lookup"><span data-stu-id="38ad8-244">It indicates the number of rows to be processed before generating a notification event.</span></span> <span data-ttu-id="38ad8-245">Le <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> propriété peut être définie à tout moment, même lorsqu’une opération de copie en bloc est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="38ad8-245">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property can be set at any time, even while a bulk copy operation is underway.</span></span> <span data-ttu-id="38ad8-246">Modifications apportées pendant une opération de copie en bloc prennent effet après la notification suivante.</span><span class="sxs-lookup"><span data-stu-id="38ad8-246">Changes made during a bulk copy operation take effect after the next notification.</span></span> <span data-ttu-id="38ad8-247">Le nouveau paramètre s’applique à toutes les opérations suivantes sur la même instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-247">The new setting applies to all subsequent operations on the same instance.</span></span>  
  
 <span data-ttu-id="38ad8-248">Si <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> est définie sur un nombre inférieur à zéro, un <xref:System.ArgumentOutOfRangeException> est levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-248">If <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> is set to a number less than zero, an <xref:System.ArgumentOutOfRangeException> is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-249">L’application console suivante montre comment en bloc des données de charge à l’aide d’une connexion qui est déjà ouverte.</span><span class="sxs-lookup"><span data-stu-id="38ad8-249">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="38ad8-250">Le <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> propriété est définie afin que le Gestionnaire d’événements est appelé une fois que toutes les 50 lignes copiées dans la table.</span><span class="sxs-lookup"><span data-stu-id="38ad8-250">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="38ad8-251">Dans cet exemple, la connexion est tout d’abord utilisée pour lire les données à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-251">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-252">Puis une deuxième connexion est ouverte pour copier les données en bloc.</span><span class="sxs-lookup"><span data-stu-id="38ad8-252">Then a second connection is opened to bulk copy the data.</span></span> <span data-ttu-id="38ad8-253">Notez que la source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-253">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-254">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-254">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-255">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-255">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-256">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-256">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="SqlRowsCopied">
      <MemberSignature Language="C#" Value="public event System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Data.SqlClient.SqlRowsCopiedEventHandler SqlRowsCopied" />
      <MemberSignature Language="DocId" Value="E:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event SqlRowsCopied As SqlRowsCopiedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Data::SqlClient::SqlRowsCopiedEventHandler ^ SqlRowsCopied;" />
      <MemberSignature Language="F#" Value="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " Usage="member this.SqlRowsCopied : System.Data.SqlClient.SqlRowsCopiedEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.SqlClient.SqlRowsCopiedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-257">Se produit chaque fois que le nombre de lignes spécifié par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> a été traité.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-257">Occurs every time that the number of rows specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.NotifyAfter" /> property have been processed.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-258">Notez que les paramètres de <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> et <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> sont indépendants.</span><span class="sxs-lookup"><span data-stu-id="38ad8-258">Note that the settings of <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> and <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> are independent.</span></span> <span data-ttu-id="38ad8-259">Réception d’un <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> événement n’implique pas que toutes les lignes ont été envoyées au serveur ou validées.</span><span class="sxs-lookup"><span data-stu-id="38ad8-259">Receipt of a <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event does not imply that any rows have been sent to the server or committed.</span></span>  
  
 <span data-ttu-id="38ad8-260">Vous ne pouvez pas appeler SqlBulkCopy.Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) ou SqlConnection.Close (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) à partir de cet événement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-260">You cannot call SqlBulkCopy.Close (<xref:System.Data.SqlClient.SqlBulkCopy.Close%2A>) or SqlConnection.Close (<xref:System.Data.SqlClient.SqlConnection.Close%2A>) from this event.</span></span> <span data-ttu-id="38ad8-261">Ainsi, un <xref:System.InvalidOperationException> levée et le <xref:System.Data.SqlClient.SqlBulkCopy> état de l’objet ne change pas.</span><span class="sxs-lookup"><span data-stu-id="38ad8-261">Doing this will cause an <xref:System.InvalidOperationException> being thrown, and the <xref:System.Data.SqlClient.SqlBulkCopy> object state will not change.</span></span> <span data-ttu-id="38ad8-262">Si l’utilisateur souhaite annuler l’opération à partir de l’événement, le <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> propriété de la <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="38ad8-262">If the user wants to cancel the operation from the event, the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property of the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs> can be used.</span></span> <span data-ttu-id="38ad8-263">(Consultez [Transaction et opérations de copie en bloc](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) pour obtenir des exemples qui utilisent la <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> propriété.)</span><span class="sxs-lookup"><span data-stu-id="38ad8-263">(See [Transaction and Bulk Copy Operations](~/docs/framework/data/adonet/sql/transaction-and-bulk-copy-operations.md) for examples that use the <xref:System.Data.SqlClient.SqlRowsCopiedEventArgs.Abort%2A> property.)</span></span>  
  
 <span data-ttu-id="38ad8-264">Aucune action, telles que l’activité de transaction, n’est pris en charge dans la connexion pendant l’exécution de l’opération de copie en bloc, et il est recommandé que vous N'utilisez pas la même connexion que celui utilisée lors de la <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> événement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-264">No action, such as transaction activity, is supported in the connection during the execution of the bulk copy operation, and it is recommended that you not use the same connection used during the <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> event.</span></span> <span data-ttu-id="38ad8-265">Toutefois, vous pouvez ouvrir une autre connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-265">However, you can open a different connection.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-266">L’application console suivante montre comment en bloc des données de charge à l’aide d’une connexion qui est déjà ouverte.</span><span class="sxs-lookup"><span data-stu-id="38ad8-266">The following console application demonstrates how to bulk load data using a connection that is already open.</span></span> <span data-ttu-id="38ad8-267">Le <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> propriété est définie afin que le Gestionnaire d’événements est appelé une fois que toutes les 50 lignes copiées dans la table.</span><span class="sxs-lookup"><span data-stu-id="38ad8-267">The <xref:System.Data.SqlClient.SqlBulkCopy.NotifyAfter%2A> property is set so that the event handler is called after every 50 rows copied to the table.</span></span>  
  
 <span data-ttu-id="38ad8-268">Dans cet exemple, la connexion est tout d’abord utilisée pour lire les données à partir d’une table SQL Server à un <xref:System.Data.SqlClient.SqlDataReader> instance.</span><span class="sxs-lookup"><span data-stu-id="38ad8-268">In this example, the connection is first used to read data from a SQL Server table to a <xref:System.Data.SqlClient.SqlDataReader> instance.</span></span> <span data-ttu-id="38ad8-269">Notez que la source de données ne devra pas se trouver sur SQL Server ; Vous pouvez utiliser n’importe quelle source de données qui peut être lues pour un <xref:System.Data.IDataReader> ou chargé dans un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-269">Note that the source data does not have to be located on SQL Server; you can use any data source that can be read to an <xref:System.Data.IDataReader> or loaded to a <xref:System.Data.DataTable>.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-270">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-270">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-271">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-271">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-272">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-272">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.NotifyAfter#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.NotifyAfter/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.System#IDisposable#Dispose" />
      <MemberSignature Language="VB.NET" Value="Sub Dispose () Implements IDisposable.Dispose" />
      <MemberSignature Language="C++ CLI" Value=" virtual void System.IDisposable.Dispose() = IDisposable::Dispose;" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-273">Libère toutes les ressources utilisées par l'instance actuelle de la classe <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-273">Releases all resources used by the current instance of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-274">Appelez la méthode `Dispose` une fois que vous avez terminé d'utiliser <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-274">Call `Dispose` when you are finished using the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="38ad8-275">La méthode `Dispose` rend le <xref:System.Data.SqlClient.SqlBulkCopy> inutilisable.</span><span class="sxs-lookup"><span data-stu-id="38ad8-275">The `Dispose` method leaves the <xref:System.Data.SqlClient.SqlBulkCopy> in an unusable state.</span></span> <span data-ttu-id="38ad8-276">Après avoir appelé `Dispose`, vous devez libérer toutes les références à la <xref:System.Data.SqlClient.SqlBulkCopy> pour que le garbage collector puisse récupérer la mémoire qui le <xref:System.Data.SqlClient.SqlBulkCopy> occupée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-276">After calling `Dispose`, you must release all references to the <xref:System.Data.SqlClient.SqlBulkCopy> so the garbage collector can reclaim the memory that the <xref:System.Data.SqlClient.SqlBulkCopy> was occupying.</span></span>  
  
 <span data-ttu-id="38ad8-277">Pour plus d’informations, consultez [de nettoyage des ressources non managées](~/docs/standard/garbage-collection/unmanaged.md) et [implémentation d’une méthode Dispose](~/docs/standard/garbage-collection/implementing-dispose.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-277">For more information, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md) and [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="38ad8-278">Appelez toujours `Dispose` avant de libérer votre dernière référence à <xref:System.Data.SqlClient.SqlBulkCopy>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-278">Always call `Dispose` before you release your last reference to the <xref:System.Data.SqlClient.SqlBulkCopy>.</span></span> <span data-ttu-id="38ad8-279">Sinon, les ressources utilisées ne seront pas libérées tant que le garbage collector n'aura pas appelé la méthode <xref:System.Data.SqlClient.SqlBulkCopy> de l'objet `Finalize`.</span><span class="sxs-lookup"><span data-stu-id="38ad8-279">Otherwise, the resources it is using will not be freed until the garbage collector calls the <xref:System.Data.SqlClient.SqlBulkCopy> object's `Finalize` method.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServer">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-280">Copie toutes les lignes d'une source de données dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-280">Copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-281">Si plusieurs active ensembles de résultats (MARS) est désactivé, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> établit la connexion occupée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-281">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="38ad8-282">Si MARS est activé, vous pouvez entrelacer les appels à <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> avec d’autres commandes dans la même connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-282">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As DbDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.Common.DbDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-283">
            <see cref="T:System.Data.Common.DbDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-283">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-284">Copie toutes les lignes du tableau <see cref="T:System.Data.Common.DbDataReader" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-284">Copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (rows As DataRow())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataRow[] -&gt; unit" Usage="sqlBulkCopy.WriteToServer rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="38ad8-285">Tableau d'objets <see cref="T:System.Data.DataRow" /> qui seront copiés dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-285">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-286">Copie toutes les lignes du tableau <see cref="T:System.Data.DataRow" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-286">Copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-287">Lorsque l’opération de copie en bloc est en cours, la destination associée <xref:System.Data.SqlClient.SqlConnection> est occupé à cette tâche, et aucune autre opération ne peut être effectuée sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-287">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="38ad8-288">Le <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection de mappages à partir du <xref:System.Data.DataRow> colonnes à la table de base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-288">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataRow> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-289">L’application console suivante montre comment en bloc des données de charge à partir d’un <xref:System.Data.DataRow> tableau.</span><span class="sxs-lookup"><span data-stu-id="38ad8-289">The following console application demonstrates how to bulk load data from a <xref:System.Data.DataRow> array.</span></span> <span data-ttu-id="38ad8-290">La table de destination est une table dans le **AdventureWorks** base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-290">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="38ad8-291">Dans cet exemple, un <xref:System.Data.DataTable> est créé au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="38ad8-291">In this example, a <xref:System.Data.DataTable> is created at run time.</span></span> <span data-ttu-id="38ad8-292">Une seule ligne est sélectionnée dans le <xref:System.Data.DataTable> pour copier vers la table de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-292">A single row is selected from the <xref:System.Data.DataTable> to copy to the destination table.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-293">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-293">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-294">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-294">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-295">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-295">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.RowArray#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.RowArray/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable -&gt; unit" Usage="sqlBulkCopy.WriteToServer table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-296">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-296">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-297">Copie toutes les lignes du <see cref="T:System.Data.DataTable" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-297">Copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-298">Toutes les lignes dans le <xref:System.Data.DataTable> sont copiés dans la table de destination à l’exception de ceux qui ont été supprimés.</span><span class="sxs-lookup"><span data-stu-id="38ad8-298">All rows in the <xref:System.Data.DataTable> are copied to the destination table except those that have been deleted.</span></span>  
  
 <span data-ttu-id="38ad8-299">Lorsque l’opération de copie en bloc est en cours, la destination associée <xref:System.Data.SqlClient.SqlConnection> est occupé à cette tâche, et aucune autre opération ne peut être effectuée sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-299">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="38ad8-300">Le <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection de mappages à partir du <xref:System.Data.DataTable> colonnes à la table de base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-300">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-301">L’application Console suivante montre comment en bloc des données de charge à partir d’un <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-301">The following Console application demonstrates how to bulk load data from a <xref:System.Data.DataTable>.</span></span> <span data-ttu-id="38ad8-302">La table de destination est une table dans le **AdventureWorks** base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-302">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="38ad8-303">Dans cet exemple, un <xref:System.Data.DataTable> est créé au moment de l’exécution et est la source de la `SqlBulkCopy` opération.</span><span class="sxs-lookup"><span data-stu-id="38ad8-303">In this example, a <xref:System.Data.DataTable> is created at run time and is the source of the `SqlBulkCopy` operation.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-304">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-304">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-305">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-305">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-306">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-306">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataTable#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataTable/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (reader As IDataReader)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.IDataReader -&gt; unit" Usage="sqlBulkCopy.WriteToServer reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-307">
            <see cref="T:System.Data.IDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-307">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-308">Copie toutes les lignes du <see cref="T:System.Data.IDataReader" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-308">Copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-309">L’opération de copie démarre à la ligne suivante dans le lecteur.</span><span class="sxs-lookup"><span data-stu-id="38ad8-309">The copy operation starts at the next available row in the reader.</span></span> <span data-ttu-id="38ad8-310">La plupart du temps, le lecteur vient d’être retourné par <xref:System.Data.IDbCommand.ExecuteReader%2A> ou un appel semblable, donc la ligne suivante est la première ligne.</span><span class="sxs-lookup"><span data-stu-id="38ad8-310">Most of the time, the reader was just returned by <xref:System.Data.IDbCommand.ExecuteReader%2A> or a similar call, so the next available row is the first row.</span></span> <span data-ttu-id="38ad8-311">Pour traiter plusieurs résultats, appelez <xref:System.Data.IDataReader.NextResult%2A> sur le lecteur de données et l’appel <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> à nouveau.</span><span class="sxs-lookup"><span data-stu-id="38ad8-311">To process multiple results, call <xref:System.Data.IDataReader.NextResult%2A> on the data reader and call <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> again.</span></span>  
  
 <span data-ttu-id="38ad8-312">Notez que l’utilisation <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> modifie l’état du lecteur.</span><span class="sxs-lookup"><span data-stu-id="38ad8-312">Note that using <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> modifies the state of the reader.</span></span> <span data-ttu-id="38ad8-313">Appelle la méthode <xref:System.Data.IDataReader.Read%2A> jusqu'à ce qu’elle retourne false, l’opération est abandonnée, ou une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="38ad8-313">The method will call <xref:System.Data.IDataReader.Read%2A> until it returns false, the operation is aborted, or an error occurs.</span></span> <span data-ttu-id="38ad8-314">Cela signifie que le lecteur de données sera placé dans un état différent, probablement à la fin du jeu de résultats, lorsque le <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> l’opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-314">This means that the data reader will be in a different state, probably at the end of the result set, when the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> operation is complete.</span></span>  
  
 <span data-ttu-id="38ad8-315">Lorsque l’opération de copie en bloc est en cours, la destination associée <xref:System.Data.SqlClient.SqlConnection> est occupé à cette tâche, et aucune autre opération ne peut être effectuée sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-315">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="38ad8-316">Le <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection mappe les colonnes de lecteur à partir des données à la table de base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-316">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the data reader columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-317">L’application console suivante montre comment en bloc des données de charge à partir d’un <xref:System.Data.SqlClient.SqlDataReader>.</span><span class="sxs-lookup"><span data-stu-id="38ad8-317">The following console application demonstrates how to bulk load data from a <xref:System.Data.SqlClient.SqlDataReader>.</span></span> <span data-ttu-id="38ad8-318">La table de destination est une table dans le **AdventureWorks** base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-318">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-319">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-319">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-320">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-320">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-321">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-321">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.ConnectionString#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.ConnectionString/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServer">
      <MemberSignature Language="C#" Value="public void WriteToServer (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteToServer(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteToServer (table As DataTable, rowState As DataRowState)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteToServer(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServer : System.Data.DataTable * System.Data.DataRowState -&gt; unit" Usage="sqlBulkCopy.WriteToServer (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-322">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-322">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="38ad8-323">Valeur de l'énumération <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-323">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="38ad8-324">Seules les lignes correspondant à l’état de ligne sont copiées vers la destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-324">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-325">Copie uniquement les lignes qui correspondent à l'état de ligne fourni dans le <see cref="T:System.Data.DataTable" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-325">Copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-326">Seules les lignes de la <xref:System.Data.DataTable> qui se trouvent dans les états indiqués dans le `rowState` argument et n’ont pas été supprimés sont copiés dans la table de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-326">Only rows in the <xref:System.Data.DataTable> that are in the states indicated in the `rowState` argument and have not been deleted are copied to the destination table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="38ad8-327">Si <xref:System.Data.DataRowState.Deleted> est spécifié, n’importe quel <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, et <xref:System.Data.DataRowState.Modified> lignes seront également être copiés vers le serveur.</span><span class="sxs-lookup"><span data-stu-id="38ad8-327">If <xref:System.Data.DataRowState.Deleted> is specified, any <xref:System.Data.DataRowState.Unchanged>, <xref:System.Data.DataRowState.Added>, and <xref:System.Data.DataRowState.Modified> rows will also be copied to the server.</span></span> <span data-ttu-id="38ad8-328">Aucune exception ne sera levée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-328">No exception will be raised.</span></span>  
  
 <span data-ttu-id="38ad8-329">Lorsque l’opération de copie en bloc est en cours, la destination associée <xref:System.Data.SqlClient.SqlConnection> est occupé à cette tâche, et aucune autre opération ne peut être effectuée sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-329">While the bulk copy operation is in progress, the associated destination <xref:System.Data.SqlClient.SqlConnection> is busy serving it, and no other operations can be performed on the connection.</span></span>  
  
 <span data-ttu-id="38ad8-330">Le <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection de mappages à partir du <xref:System.Data.DataTable> colonnes à la table de base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-330">The <xref:System.Data.SqlClient.SqlBulkCopy.ColumnMappings%2A> collection maps from the <xref:System.Data.DataTable> columns to the destination database table.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="38ad8-331">L’application Console suivante montre comment en bloc charger uniquement les lignes dans un <xref:System.Data.DataTable> qui correspond à un état spécifié.</span><span class="sxs-lookup"><span data-stu-id="38ad8-331">The following Console application demonstrates how to bulk load only the rows in a <xref:System.Data.DataTable> that match a specified state.</span></span> <span data-ttu-id="38ad8-332">Dans ce cas, seules les lignes inchangées sont ajoutés.</span><span class="sxs-lookup"><span data-stu-id="38ad8-332">In this case, only unchanged rows are added.</span></span> <span data-ttu-id="38ad8-333">La table de destination est une table dans le **AdventureWorks** base de données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-333">The destination table is a table in the **AdventureWorks** database.</span></span>  
  
 <span data-ttu-id="38ad8-334">Dans cet exemple, un <xref:System.Data.DataTable> est créé au moment de l’exécution et trois lignes sont ajoutées à celle-ci.</span><span class="sxs-lookup"><span data-stu-id="38ad8-334">In this example, a <xref:System.Data.DataTable> is created at run time and three rows are added to it.</span></span> <span data-ttu-id="38ad8-335">Avant du <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> méthode est exécutée, une des lignes est modifiée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-335">Before the <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is executed, one of the rows is edited.</span></span> <span data-ttu-id="38ad8-336">Le <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> méthode est appelée avec un `DataRowState.Unchanged` `rowState` argument, afin que seuls les deux lignes inchangées sont copiées en bloc vers la destination.</span><span class="sxs-lookup"><span data-stu-id="38ad8-336">The <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> method is called with a `DataRowState.Unchanged` `rowState` argument, so only the two unchanged rows are bulk copied to the destination.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38ad8-337">Cet exemple ne s’exécutera pas, sauf si vous avez créé les tables de travail comme décrit dans [exemple de configuration de copie en bloc](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-337">This sample will not run unless you have created the work tables as described in [Bulk Copy Example Setup](~/docs/framework/data/adonet/sql/bulk-copy-example-setup.md).</span></span> <span data-ttu-id="38ad8-338">Ce code est fourni pour illustrer la syntaxe pour l’utilisation de **SqlBulkCopy** uniquement.</span><span class="sxs-lookup"><span data-stu-id="38ad8-338">This code is provided to demonstrate the syntax for using **SqlBulkCopy** only.</span></span> <span data-ttu-id="38ad8-339">Si les tables source et de destination sont dans la même instance de SQL Server, il est plus facile et plus rapide d’utiliser Transact-SQL `INSERT … SELECT` instruction pour copier les données.</span><span class="sxs-lookup"><span data-stu-id="38ad8-339">If the source and destination tables are in the same SQL Server instance, it is easier and faster to use a Transact-SQL `INSERT … SELECT` statement to copy the data.</span></span>  
  
 [!code-csharp[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/CS/source.cs#1)]
 [!code-vb[DataWorks SqlBulkCopy.DataRowState#1](~/samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlBulkCopy.DataRowState/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Data.DataRowState" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteToServerAsync">
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="38ad8-340">Version asynchrone de <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, qui copie toutes les lignes d'une source de données vers une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-340">An asynchronous version of <see cref="Overload:System.Data.SqlClient.SqlBulkCopy.WriteToServer" />, which copies all rows from a data source to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-341">Si plusieurs active ensembles de résultats (MARS) est désactivé, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> établit la connexion occupée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-341">If multiple active result sets (MARS) is disabled, <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> makes the connection busy.</span></span> <span data-ttu-id="38ad8-342">Si MARS est activé, vous pouvez entrelacer les appels à <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> avec d’autres commandes dans la même connexion.</span><span class="sxs-lookup"><span data-stu-id="38ad8-342">If MARS is enabled, you can interleave calls to <xref:System.Data.SqlClient.SqlBulkCopy.WriteToServer%2A> with other commands in the same connection.</span></span>  
  
 <span data-ttu-id="38ad8-343">Le nombre de lignes qui sont annulées lors de l’échec de l’un dépend de plusieurs choses :</span><span class="sxs-lookup"><span data-stu-id="38ad8-343">The number of rows that are rolled back when one fails depends on several things:</span></span>  
  
-   <span data-ttu-id="38ad8-344">Si <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> est spécifié.</span><span class="sxs-lookup"><span data-stu-id="38ad8-344">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is specified.</span></span>  
  
-   <span data-ttu-id="38ad8-345">Si vous avez votre propre transaction.</span><span class="sxs-lookup"><span data-stu-id="38ad8-345">If you have your own transaction.</span></span>  
  
-   <span data-ttu-id="38ad8-346">la valeur de la propriété <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A> ;</span><span class="sxs-lookup"><span data-stu-id="38ad8-346">The value of <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>.</span></span>  
  
 <span data-ttu-id="38ad8-347">Lorsqu’il existe une erreur lors de l’envoi des données au serveur, le lot actuel (tel que spécifié par <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) sera restaurée.</span><span class="sxs-lookup"><span data-stu-id="38ad8-347">When there is an error while sending data to the server, the current batch (as specified by <xref:System.Data.SqlClient.SqlBulkCopy.BatchSize%2A>) will be rolled back.</span></span> <span data-ttu-id="38ad8-348">Si <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> n’est pas spécifié et que vous avez votre propre transaction, l’intégralité de la transaction sera restaurée (qui inclut tous les lots précédentes).</span><span class="sxs-lookup"><span data-stu-id="38ad8-348">If <xref:System.Data.SqlClient.SqlBulkCopyOptions.UseInternalTransaction> is not specified and you have your own transaction, the entire transaction will be rolled back (which includes all previous batches as well).</span></span>  
  
 <span data-ttu-id="38ad8-349">Utilisez <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> savoir combien de lignes ont été copiés sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="38ad8-349">Use <xref:System.Data.SqlClient.SqlBulkCopy.SqlRowsCopied> to know how many rows were copied to the server.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As DbDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-350">
            <see cref="T:System.Data.Common.DbDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-350">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-351">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, qui copie toutes les lignes du tableau <see cref="T:System.Data.Common.DbDataReader" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-351">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-352">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-352">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (rows As DataRow()) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync rows" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="38ad8-353">Tableau d'objets <see cref="T:System.Data.DataRow" /> qui seront copiés dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-353">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-354">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, qui copie toutes les lignes du tableau <see cref="T:System.Data.DataRow" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-354">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-355">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-355">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-356">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-356">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-357">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-357">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-358">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-358">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-359">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-359">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-360">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-360">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-361">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-361">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-362">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-362">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-363">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-363">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-364">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-364">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync table" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-365">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-365">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-366">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, qui copie toutes les lignes dans le tableau <see cref="T:System.Data.DataTable" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-366">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-367">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-367">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-368">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-368">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-369">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-369">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-370">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-370">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-371">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-371">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-372">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-372">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-373">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-373">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-374">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-374">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-375">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-375">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-376">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-376">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (reader As IDataReader) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync reader" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-377">
            <see cref="T:System.Data.IDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-377">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-378">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, qui copie toutes les lignes dans le tableau <see cref="T:System.Data.IDataReader" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-378">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-379">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-379">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-380">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-380">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-381">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-381">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-382">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-382">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-383">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-383">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-384">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-384">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-385">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-385">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-386">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-386">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-387">
            <see cref="T:System.Data.IDataReader" /> a été fermé avant le retour du <see cref="T:System.Threading.Tasks.Task" /> terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-387">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="38ad8-388">La connexion associée à <see cref="T:System.Data.IDataReader" /> a été fermée avant le retour du <see cref="T:System.Threading.Tasks.Task" /> terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-388">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="38ad8-389">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-389">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-390">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-390">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.Common.DbDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.Common.DbDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::Common::DbDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.Common.DbDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.Common.DbDataReader" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-391">
            <see cref="T:System.Data.Common.DbDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-391">A <see cref="T:System.Data.Common.DbDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="38ad8-392">Instruction d'annulation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-392">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="38ad8-393">Une valeur <see cref="P:System.Threading.CancellationToken.None" /> dans ce paramètre rend cette méthode équivalente à <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-393">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.Common.DbDataReader)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-394">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, qui copie toutes les lignes du tableau <see cref="T:System.Data.Common.DbDataReader" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-394">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.Common.DbDataReader)" />, which copies all rows from the supplied <see cref="T:System.Data.Common.DbDataReader" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-395">Retourne <see cref="T:System.Threading.Tasks.Task" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-395">Returns <see cref="T:System.Threading.Tasks.Task" />.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataRow[] rows, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataRow[] rows, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[],System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(cli::array &lt;System::Data::DataRow ^&gt; ^ rows, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataRow[] * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (rows, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="rows" Type="System.Data.DataRow[]" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="rows">
          <span data-ttu-id="38ad8-396">Tableau d'objets <see cref="T:System.Data.DataRow" /> qui seront copiés dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-396">An array of <see cref="T:System.Data.DataRow" /> objects that will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="38ad8-397">Instruction d'annulation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-397">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="38ad8-398">Une valeur <see cref="P:System.Threading.CancellationToken.None" /> dans ce paramètre rend cette méthode équivalente à <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-398">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-399">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, qui copie toutes les lignes du tableau <see cref="T:System.Data.DataRow" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-399">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" />, which copies all rows from the supplied <see cref="T:System.Data.DataRow" /> array to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="38ad8-400">Le jeton d'annulation peut être utilisé pour demander que l'opération soit abandonnée avant que le délai d'attente de commande s'écoule.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-400">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="38ad8-401">Les exceptions seront signalées via l’objet Task retourné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-401">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-402">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-402">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-403">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-403">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-404">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-404">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-405">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-405">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataRow[])" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-406">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-406">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataRow[])" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-407">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-407">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-408">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-408">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-409">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-409">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-410">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-410">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-411">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-411">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" />
      <MemberSignature Language="VB.NET" Value="Public Function WriteToServerAsync (table As DataTable, rowState As DataRowState) As Task" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-412">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-412">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="38ad8-413">Valeur de l'énumération <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-413">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="38ad8-414">Seules les lignes correspondant à l’état de ligne sont copiées vers la destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-414">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-415">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, qui copie uniquement les lignes qui correspondent à l'état de ligne fourni dans le <see cref="T:System.Data.DataTable" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-415">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-416">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-416">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-417">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-417">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-418">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-418">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-419">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-419">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-420">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-420">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-421">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-421">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-422">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-422">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-423">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-423">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-424">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-424">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-425">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-425">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-426">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-426">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="38ad8-427">Instruction d'annulation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-427">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="38ad8-428">Une valeur <see cref="P:System.Threading.CancellationToken.None" /> dans ce paramètre rend cette méthode équivalente à <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-428">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-429">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, qui copie toutes les lignes dans le tableau <see cref="T:System.Data.DataTable" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-429">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" />, which copies all rows in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="38ad8-430">Le jeton d'annulation peut être utilisé pour demander que l'opération soit abandonnée avant que le délai d'attente de commande s'écoule.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-430">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="38ad8-431">Les exceptions seront signalées via l’objet Task retourné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-431">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-432">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-432">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-433">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-433">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-434">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-434">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-435">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-435">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-436">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-436">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-437">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-437">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-438">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-438">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-439">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-439">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-440">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-440">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-441">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-441">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.IDataReader reader, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.IDataReader reader, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::IDataReader ^ reader, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.IDataReader * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (reader, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="reader" Type="System.Data.IDataReader" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="reader">
          <span data-ttu-id="38ad8-442">
            <see cref="T:System.Data.IDataReader" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-442">A <see cref="T:System.Data.IDataReader" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="38ad8-443">Instruction d'annulation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-443">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="38ad8-444">Une valeur <see cref="P:System.Threading.CancellationToken.None" /> dans ce paramètre rend cette méthode équivalente à <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-444">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-445">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, qui copie toutes les lignes dans le tableau <see cref="T:System.Data.IDataReader" /> dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-445">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" />, which copies all rows in the supplied <see cref="T:System.Data.IDataReader" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="38ad8-446">Le jeton d'annulation peut être utilisé pour demander que l'opération soit abandonnée avant que le délai d'attente de commande s'écoule.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-446">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="38ad8-447">Les exceptions seront signalées via l’objet Task retourné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-447">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-448">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-448">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-449">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-449">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-450">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-450">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-451">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-451">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.IDataReader)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-452">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-452">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.IDataReader)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-453">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-453">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-454">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-454">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-455">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-455">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-456">
            <see cref="T:System.Data.IDataReader" /> a été fermé avant le retour du <see cref="T:System.Threading.Tasks.Task" /> terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-456">The <see cref="T:System.Data.IDataReader" /> was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="38ad8-457">La connexion associée à <see cref="T:System.Data.IDataReader" /> a été fermée avant le retour du <see cref="T:System.Threading.Tasks.Task" /> terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-457">The <see cref="T:System.Data.IDataReader" />'s associated connection was closed before the completed <see cref="T:System.Threading.Tasks.Task" /> returned.</span>
          </span>
          <span data-ttu-id="38ad8-458">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-458">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-459">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-459">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="WriteToServerAsync">
      <MemberSignature Language="C#" Value="public System.Threading.Tasks.Task WriteToServerAsync (System.Data.DataTable table, System.Data.DataRowState rowState, System.Threading.CancellationToken cancellationToken);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Threading.Tasks.Task WriteToServerAsync(class System.Data.DataTable table, valuetype System.Data.DataRowState rowState, valuetype System.Threading.CancellationToken cancellationToken) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState,System.Threading.CancellationToken)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Threading::Tasks::Task ^ WriteToServerAsync(System::Data::DataTable ^ table, System::Data::DataRowState rowState, System::Threading::CancellationToken cancellationToken);" />
      <MemberSignature Language="F#" Value="member this.WriteToServerAsync : System.Data.DataTable * System.Data.DataRowState * System.Threading.CancellationToken -&gt; System.Threading.Tasks.Task" Usage="sqlBulkCopy.WriteToServerAsync (table, rowState, cancellationToken)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Data.SqlClient</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Threading.Tasks.Task</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="table" Type="System.Data.DataTable" />
        <Parameter Name="rowState" Type="System.Data.DataRowState" />
        <Parameter Name="cancellationToken" Type="System.Threading.CancellationToken" />
      </Parameters>
      <Docs>
        <param name="table">
          <span data-ttu-id="38ad8-460">
            <see cref="T:System.Data.DataTable" /> dont les lignes seront copiées dans la table de destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-460">A <see cref="T:System.Data.DataTable" /> whose rows will be copied to the destination table.</span>
          </span>
        </param>
        <param name="rowState">
          <span data-ttu-id="38ad8-461">Valeur de l'énumération <see cref="T:System.Data.DataRowState" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-461">A value from the <see cref="T:System.Data.DataRowState" /> enumeration.</span>
          </span>
          <span data-ttu-id="38ad8-462">Seules les lignes correspondant à l’état de ligne sont copiées vers la destination.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-462">Only rows matching the row state are copied to the destination.</span>
          </span>
        </param>
        <param name="cancellationToken">
          <span data-ttu-id="38ad8-463">Instruction d'annulation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-463">The cancellation instruction.</span>
          </span>
          <span data-ttu-id="38ad8-464">Une valeur <see cref="P:System.Threading.CancellationToken.None" /> dans ce paramètre rend cette méthode équivalente à <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-464">A <see cref="P:System.Threading.CancellationToken.None" /> value in this parameter makes this method equivalent to <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable)" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="38ad8-465">Version asynchrone de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, qui copie uniquement les lignes qui correspondent à l'état de ligne fourni dans le <see cref="T:System.Data.DataTable" /> fourni dans une table de destination spécifiée par la propriété <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> de l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-465">The asynchronous version of <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" />, which copies only rows that match the supplied row state in the supplied <see cref="T:System.Data.DataTable" /> to a destination table specified by the <see cref="P:System.Data.SqlClient.SqlBulkCopy.DestinationTableName" /> property of the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object.</span>
          </span>
          <span data-ttu-id="38ad8-466">Le jeton d'annulation peut être utilisé pour demander que l'opération soit abandonnée avant que le délai d'attente de commande s'écoule.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-466">The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.</span>
          </span>
          <span data-ttu-id="38ad8-467">Les exceptions seront signalées via l’objet Task retourné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-467">Exceptions will be reported via the returned Task object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="38ad8-468">Tâche représentant l’opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-468">A task representing the asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="38ad8-469">Pour plus d’informations sur la programmation asynchrone dans le fournisseur de données .NET Framework pour SQL Server, consultez [programmation asynchrone](~/docs/framework/data/adonet/asynchronous-programming.md).</span><span class="sxs-lookup"><span data-stu-id="38ad8-469">For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see [Asynchronous Programming](~/docs/framework/data/adonet/asynchronous-programming.md).</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="38ad8-470">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> plusieurs fois pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-470">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> multiple times for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-471">Appel de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> et <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> pour la même instance avant l'achèvement de la tâche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-471">Calling <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> and <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServer(System.Data.DataTable,System.Data.DataRowState)" /> for the same instance before task completion.</span>
          </span>
          <span data-ttu-id="38ad8-472">La connexion est perdue ou fermée pendant l'exécution de <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> .</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-472">The connection drops or is closed during <see cref="M:System.Data.SqlClient.SqlBulkCopy.WriteToServerAsync(System.Data.DataTable,System.Data.DataRowState)" /> execution.</span>
          </span>
          <span data-ttu-id="38ad8-473">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> a été fermé au cours de l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-473">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlBulkCopy" /> object was closed during the method execution.</span>
          </span>
          <span data-ttu-id="38ad8-474">Retourné dans l’objet de tâche en raison d’un délai d’attente du pool de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-474">Returned in the task object, there was a connection pool timeout.</span>
          </span>
          <span data-ttu-id="38ad8-475">Retourné dans l'objet de tâche, l'objet <see cref="T:System.Data.SqlClient.SqlConnection" /> est fermé avant l'exécution de méthode.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-475">Returned in the task object, the <see cref="T:System.Data.SqlClient.SqlConnection" /> object is closed before method execution.</span>
          </span>
          <span data-ttu-id="38ad8-476">
            <see langword="Context Connection=true" /> est spécifié dans la chaîne de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-476">
              <see langword="Context Connection=true" /> is specified in the connection string.</span>
          </span>
        </exception>
        <exception cref="T:System.Data.SqlClient.SqlException">
          <span data-ttu-id="38ad8-477">Retourné dans l’objet de tâche, toute erreur retournée par SQL Server qui s’est produite à l’ouverture de la connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="38ad8-477">Returned in the task object, any error returned by SQL Server that occurred while opening the connection.</span>
          </span>
        </exception>
      </Docs>
    </Member>
  </Members>
</Type>