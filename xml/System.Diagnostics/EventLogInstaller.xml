<Type Name="EventLogInstaller" FullName="System.Diagnostics.EventLogInstaller">
  <TypeSignature Language="C#" Value="public class EventLogInstaller : System.Configuration.Install.ComponentInstaller" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLogInstaller extends System.Configuration.Install.ComponentInstaller" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLogInstaller" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLogInstaller&#xA;Inherits ComponentInstaller" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLogInstaller : System::Configuration::Install::ComponentInstaller" />
  <AssemblyInfo>
    <AssemblyName>System.Configuration.Install</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Configuration.Install.ComponentInstaller</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="f7d81-101">Vous permet d'installer et de configurer un journal des événements que votre application lit et dans lequel elle écrit pendant l'exécution.</span><span class="sxs-lookup"><span data-stu-id="f7d81-101">Allows you to install and configure an event log that your application reads from or writes to when running.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-102">Le <xref:System.Diagnostics.EventLogInstaller> est utilisé par le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md) lors de l’installation d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-102">The <xref:System.Diagnostics.EventLogInstaller> is used by the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md) when installing an event log.</span></span> <span data-ttu-id="f7d81-103">La <xref:System.Diagnostics.EventLogInstaller> classe peut installer des journaux des événements uniquement sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="f7d81-103">The <xref:System.Diagnostics.EventLogInstaller> class can install event logs only on the local computer.</span></span>  
  
 <span data-ttu-id="f7d81-104">Utilisez la <xref:System.Diagnostics.EventLogInstaller> classe lorsque votre application écrit dans un journal des événements ; elle n’est pas nécessaire d’utiliser un programme d’installation du journal des événements pour votre application à lire à partir d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-104">Use the <xref:System.Diagnostics.EventLogInstaller> class when your application writes to an event log; it is not necessary to use an event log installer for your application to read from an event log.</span></span> <span data-ttu-id="f7d81-105">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-105">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="f7d81-106">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="f7d81-106">Device drivers should write to the System log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f7d81-107">Le journal de sécurité est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="f7d81-107">The Security log is read-only.</span></span>  
  
 <span data-ttu-id="f7d81-108">Le programme d’installation crée la source d’événements que vous spécifiez dans le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété et pour le journal des événements spécifié dans des registres <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-108">The installer creates the event source that you specify in the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property and registers it for the event log specified in <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span> <span data-ttu-id="f7d81-109">Ce comportement est similaire à l’appel <xref:System.Diagnostics.EventLog.CreateEventSource%2A> sur le <xref:System.Diagnostics.EventLog> composant.</span><span class="sxs-lookup"><span data-stu-id="f7d81-109">This behavior is similar to calling <xref:System.Diagnostics.EventLog.CreateEventSource%2A> on the <xref:System.Diagnostics.EventLog> component.</span></span>  
  
 <span data-ttu-id="f7d81-110">Utilisez le <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthodes pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-110">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="f7d81-111">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-111">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="f7d81-112">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="f7d81-112">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="f7d81-113">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrits et leurs configurations.</span><span class="sxs-lookup"><span data-stu-id="f7d81-113">This allows time for the operating system to refresh its list of registered event sources and their configurations.</span></span> <span data-ttu-id="f7d81-114">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="f7d81-114">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="f7d81-115">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="f7d81-115">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="f7d81-116">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-116">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="f7d81-117">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-117">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="f7d81-118">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-118">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="f7d81-119">Pour installer un journal des événements, créez une classe de programme d’installation de projet qui hérite de <xref:System.Configuration.Install.Installer>et définissez la <xref:System.ComponentModel.RunInstallerAttribute> pour la classe `true`.</span><span class="sxs-lookup"><span data-stu-id="f7d81-119">To install an event log, create a project installer class that inherits from <xref:System.Configuration.Install.Installer>, and set the <xref:System.ComponentModel.RunInstallerAttribute> for the class to `true`.</span></span> <span data-ttu-id="f7d81-120">Dans votre projet, créez un <xref:System.Diagnostics.EventLogInstaller> pour chaque journal des événements que votre application écrire et ajoutez l’instance à la classe de programme d’installation de votre projet.</span><span class="sxs-lookup"><span data-stu-id="f7d81-120">Within your project, create an <xref:System.Diagnostics.EventLogInstaller> for each event log that your application will write to and add the instance to your project installer class.</span></span>  
  
 <span data-ttu-id="f7d81-121">Lorsque le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md) est appelée, elle examine le <xref:System.ComponentModel.RunInstallerAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-121">When the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md) is called, it looks at the <xref:System.ComponentModel.RunInstallerAttribute>.</span></span> <span data-ttu-id="f7d81-122">S’il s’agit `true`, l’outil installe tous les éléments dans le <xref:System.Configuration.Install.Installer.Installers%2A> collection qui sont associés à votre programme d’installation du projet.</span><span class="sxs-lookup"><span data-stu-id="f7d81-122">If it is `true`, the tool installs all the items in the <xref:System.Configuration.Install.Installer.Installers%2A> collection that are associated with your project installer.</span></span> <span data-ttu-id="f7d81-123">Si <xref:System.ComponentModel.RunInstallerAttribute> est `false`, l’outil ignore le programme d’installation du projet.</span><span class="sxs-lookup"><span data-stu-id="f7d81-123">If <xref:System.ComponentModel.RunInstallerAttribute> is `false`, the tool ignores the project installer.</span></span>  
  
 <span data-ttu-id="f7d81-124">Vous modifiez d’autres propriétés d’un <xref:System.Diagnostics.EventLogInstaller> avant ou après l’ajout de l’instance de la <xref:System.Configuration.Install.Installer.Installers%2A> collection de votre programme d’installation de projet, mais avant l’exécution de l’outil installer.</span><span class="sxs-lookup"><span data-stu-id="f7d81-124">You modify other properties of an <xref:System.Diagnostics.EventLogInstaller> either before or after adding the instance to the <xref:System.Configuration.Install.Installer.Installers%2A> collection of your project installer, but before the installer tool runs.</span></span> <span data-ttu-id="f7d81-125">Vous devez définir le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété si votre application doit écrire dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-125">You must set the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property if your application will be writing to the event log.</span></span>  
  
 <span data-ttu-id="f7d81-126">Utilisez <xref:System.Diagnostics.EventLogInstaller> pour inscrire une nouvelle source pour un journal des événements nouveau ou existant ; n’utilisez pas <xref:System.Diagnostics.EventLogInstaller> pour modifier une source existante.</span><span class="sxs-lookup"><span data-stu-id="f7d81-126">Use <xref:System.Diagnostics.EventLogInstaller> to register a new source for a new or existing event log; do not use <xref:System.Diagnostics.EventLogInstaller> to change an existing source.</span></span> <span data-ttu-id="f7d81-127">La <xref:System.Diagnostics.EventLogInstaller> classe ne modifie pas les propriétés de configuration d’une source existante pour faire correspondre les propriétés d’installation spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-127">The <xref:System.Diagnostics.EventLogInstaller> class does not modify the configuration properties of an existing source to match the specified installation properties.</span></span> <span data-ttu-id="f7d81-128">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode lève une exception si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est enregistré pour un autre journal des événements sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-128">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method throws an exception if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is registered for a different event log on the computer.</span></span> <span data-ttu-id="f7d81-129">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode n’enregistre pas la source si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est déjà inscrite pour le même journal des événements spécifié dans le <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-129">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method does not register the source if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is already registered for the same event log specified in the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-130">Vous pouvez inscrire la source d’événements avec les fichiers de ressources localisés pour vos chaînes de catégorie et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-130">You can register the event source with localized resource files for your event category and message strings.</span></span> <span data-ttu-id="f7d81-131">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources, au lieu de spécifier la chaîne réelle.</span><span class="sxs-lookup"><span data-stu-id="f7d81-131">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="f7d81-132">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource localisée selon les paramètres de langue actuels.</span><span class="sxs-lookup"><span data-stu-id="f7d81-132">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="f7d81-133">Vous pouvez enregistrer un fichier distinct pour les catégories d’événements, les messages et les chaînes d’insertion de paramètre, ou vous pouvez inscrire le même fichier de ressources pour les trois types de chaînes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-133">You can register a separate file for event categories, messages, and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="f7d81-134">Utilisez le <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A>, <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A>, et <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> propriétés pour configurer la source pour écrire des entrées localisées dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-134">Use the <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A>, <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="f7d81-135">Si votre application écrit les valeurs des chaînes directement dans le journal des événements, il est inutile de définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-135">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="f7d81-136">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-136">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="f7d81-137">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-137">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="f7d81-138">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-138">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="f7d81-139">Créez une autre source, sans fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-139">Create a different source without resource files and then use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="f7d81-140">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> classe dans votre code ; elles sont généralement appelées par Installutil.exe uniquement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-140">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> class from within your code; they are generally called only by Installutil.exe.</span></span> <span data-ttu-id="f7d81-141">L’outil appelle automatiquement la <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode pendant le processus d’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-141">The tool automatically calls the <xref:System.Diagnostics.EventLogInstaller.Install%2A> method during the installation process.</span></span> <span data-ttu-id="f7d81-142">Si nécessaire, il annule les erreurs, en appelant le <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> méthode pour l’objet qui a généré l’exception.</span><span class="sxs-lookup"><span data-stu-id="f7d81-142">It backs out failures, if necessary, by calling the <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> method for the object that generated the exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f7d81-143">L’exemple de code suivant définit les propriétés d’installation pour une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-143">The following code example sets the installation properties for a new event source.</span></span> <span data-ttu-id="f7d81-144">L’exemple de code définit le nom de la source et le nom du journal des événements et ajoute les <xref:System.Diagnostics.EventLogInstaller> à la <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span><span class="sxs-lookup"><span data-stu-id="f7d81-144">The code example sets the source name and the event log name, and adds the <xref:System.Diagnostics.EventLogInstaller> to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span>  
  
 [!code-cpp[EventLogInstaller#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogInstaller/CPP/eventloginstaller.cpp#1)]
 [!code-csharp[EventLogInstaller#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogInstaller/CS/eventloginstaller.cs#1)]
 [!code-vb[EventLogInstaller#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogInstaller/VB/eventloginstaller.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLog" />
    <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLogInstaller ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLogInstaller();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="f7d81-145">Initialise une nouvelle instance de la classe <see cref="T:System.Diagnostics.EventLogInstaller" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-145">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLogInstaller" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CategoryCount">
      <MemberSignature Language="C#" Value="public int CategoryCount { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CategoryCount" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.CategoryCount" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryCount As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int CategoryCount { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-146">Obtient ou définit le numéro de catégorie dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="f7d81-146">Gets or sets the number of categories in the category resource file.</span></span></summary>
        <value><span data-ttu-id="f7d81-147">Numéro de catégories dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="f7d81-147">The number of categories in the category resource file.</span></span> <span data-ttu-id="f7d81-148">La valeur par défaut est 0.</span><span class="sxs-lookup"><span data-stu-id="f7d81-148">The default value is zero.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-149">Utilisez le <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> et <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> propriétés pour écrire les événements avec localisées des chaînes de catégorie.</span><span class="sxs-lookup"><span data-stu-id="f7d81-149">Use the <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> and <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="f7d81-150">L’Observateur d’événements affiche la catégorie pour une entrée d’événement, si vous fournissez une catégorie lorsque vous écrivez l’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-150">The Event Viewer displays the category for an event entry, if you supply a category when you write the event.</span></span> <span data-ttu-id="f7d81-151">Catégories du journal des événements sont des chaînes définies par l’application qui aident à filtrer des événements ou fournissent des informations sur un événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-151">Event log categories are application-defined strings that help filter events, or provide information on an event.</span></span> <span data-ttu-id="f7d81-152">Par exemple, votre application peut définir des catégories séparées pour des composants différents ou des opérations différentes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-152">For example, your application can define separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="f7d81-153">Catégories d’événements sont facultatifs ; Si votre application n’utilise pas de catégories, ne définissez pas le <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> et <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-153">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> and <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="f7d81-154">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="f7d81-154">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f7d81-155">L’exemple de code suivant définit les propriétés d’installation pour une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-155">The following code example sets the installation properties for a new event source.</span></span> <span data-ttu-id="f7d81-156">L’exemple de code définit le nom de source d’événement, nom du journal des événements et fichier de ressources pour le texte de l’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-156">The code example sets the event source name, event log name, and resource file for localized event text.</span></span>  
  
 [!code-cpp[EventLogInstaller_Resources#1](~/samples/snippets/cpp/VS_Snippets_CLR/eventlogInstaller_Resources/CPP/source.cpp#1)]
 [!code-csharp[EventLogInstaller_Resources#1](~/samples/snippets/csharp/VS_Snippets_CLR/eventlogInstaller_Resources/CS/source.cs#1)]
 [!code-vb[EventLogInstaller_Resources#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlogInstaller_Resources/VB/source.vb#1)]  
  
 <span data-ttu-id="f7d81-157">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="f7d81-157">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="f7d81-158">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-158">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="f7d81-159">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f7d81-159">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryResourceFile" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryCount" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
      </Docs>
    </Member>
    <Member MemberName="CategoryResourceFile">
      <MemberSignature Language="C#" Value="public string CategoryResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CategoryResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.CategoryResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ CategoryResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Windows.Forms.Design.FileNameEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-160">Obtient ou définit le chemin d'accès du fichier de ressources contenant des chaînes de catégorie pour la source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-160">Gets or sets the path of the resource file that contains category strings for the source.</span></span></summary>
        <value><span data-ttu-id="f7d81-161">Chemin d'accès au fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="f7d81-161">The path of the category resource file.</span></span> <span data-ttu-id="f7d81-162">La valeur par défaut est une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="f7d81-162">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-163">Utilisez le <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> et <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> propriétés pour écrire les événements avec localisées des chaînes de catégorie.</span><span class="sxs-lookup"><span data-stu-id="f7d81-163">Use the <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> and <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="f7d81-164">L’Observateur d’événements affiche la catégorie pour une entrée d’événement si vous fournissez une catégorie lorsque vous écrivez l’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-164">The Event Viewer displays the category for an event entry if you supply a category when you write the event.</span></span> <span data-ttu-id="f7d81-165">Catégories du journal des événements sont des chaînes définies par l’application qui aident à filtrer des événements ou fournissent des informations sur un événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-165">Event log categories are application-defined strings that help filter events, or provide information about an event.</span></span> <span data-ttu-id="f7d81-166">Par exemple, votre application peut avoir des catégories distinctes pour les différents composants ou des opérations différentes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-166">For example, your application might have separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="f7d81-167">Catégories d’événements sont facultatifs ; Si votre application n’utilise pas de catégories, ne définissez pas le <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> et <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-167">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventLogInstaller.CategoryCount%2A> and <xref:System.Diagnostics.EventLogInstaller.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="f7d81-168">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="f7d81-168">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f7d81-169">L’exemple de code suivant définit les propriétés d’installation pour une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-169">The following code example sets the installation properties for a new event source.</span></span> <span data-ttu-id="f7d81-170">L’exemple de code définit le nom de source d’événement, nom du journal des événements et fichier de ressources pour le texte de l’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-170">The code example sets the event source name, event log name, and resource file for localized event text.</span></span>  
  
 [!code-cpp[EventLogInstaller_Resources#1](~/samples/snippets/cpp/VS_Snippets_CLR/eventlogInstaller_Resources/CPP/source.cpp#1)]
 [!code-csharp[EventLogInstaller_Resources#1](~/samples/snippets/csharp/VS_Snippets_CLR/eventlogInstaller_Resources/CS/source.cs#1)]
 [!code-vb[EventLogInstaller_Resources#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlogInstaller_Resources/VB/source.vb#1)]  
  
 <span data-ttu-id="f7d81-171">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="f7d81-171">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="f7d81-172">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-172">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="f7d81-173">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f7d81-173">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryCount" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryResourceFile" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
      </Docs>
    </Member>
    <Member MemberName="CopyFromComponent">
      <MemberSignature Language="C#" Value="public override void CopyFromComponent (System.ComponentModel.IComponent component);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void CopyFromComponent(class System.ComponentModel.IComponent component) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.CopyFromComponent(System.ComponentModel.IComponent)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub CopyFromComponent (component As IComponent)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void CopyFromComponent(System::ComponentModel::IComponent ^ component);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="component" Type="System.ComponentModel.IComponent" />
      </Parameters>
      <Docs>
        <param name="component"><span data-ttu-id="f7d81-174"><see cref="T:System.ComponentModel.IComponent" /> à utiliser comme modèle pour <see cref="T:System.Diagnostics.EventLogInstaller" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-174">An <see cref="T:System.ComponentModel.IComponent" /> to use as a template for the <see cref="T:System.Diagnostics.EventLogInstaller" />.</span></span></param>
        <summary><span data-ttu-id="f7d81-175">Copie les valeurs des propriétés d'un composant <see cref="T:System.Diagnostics.EventLog" /> requises lors de l'installation d'un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-175">Copies the property values of an <see cref="T:System.Diagnostics.EventLog" /> component that are required at installation time for an event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-176">Le composant spécifié par le `component` le paramètre doit être un <xref:System.Diagnostics.EventLog>; sinon, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-176">The component specified by the `component` parameter must be an <xref:System.Diagnostics.EventLog>; otherwise, an exception is thrown.</span></span>  
  
 <span data-ttu-id="f7d81-177">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> à partir de votre code ; elles sont généralement appelées uniquement par le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span><span class="sxs-lookup"><span data-stu-id="f7d81-177">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> from within your code; they are generally called only by the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span></span> <span data-ttu-id="f7d81-178"><xref:System.Diagnostics.EventLogInstaller.CopyFromComponent%2A> est utilisé par Installutil.exe pour définir les valeurs de propriété pour le <xref:System.Diagnostics.EventLogInstaller> les valeurs d’un objet <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-178"><xref:System.Diagnostics.EventLogInstaller.CopyFromComponent%2A> is used by Installutil.exe to set the property values for the <xref:System.Diagnostics.EventLogInstaller> to the values of an existing <xref:System.Diagnostics.EventLog>.</span></span>  
  
 <span data-ttu-id="f7d81-179">Si le <xref:System.Diagnostics.EventLog.Log%2A> de la <xref:System.Diagnostics.EventLog> qui est passé est une chaîne vide (« »), vous devez définir le <xref:System.Diagnostics.EventLog.Log%2A> propriété à une valeur valide avant d’exécute le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-179">If the <xref:System.Diagnostics.EventLog.Log%2A> of the <xref:System.Diagnostics.EventLog> that is passed in is an empty string (""), you must set the <xref:System.Diagnostics.EventLog.Log%2A> property to a valid value before the installer executes.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f7d81-180">Le composant spécifié n'est pas <see cref="T:System.Diagnostics.EventLog" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-180">The specified component is not an <see cref="T:System.Diagnostics.EventLog" />.</span></span>  
  
 <span data-ttu-id="f7d81-181">- ou -</span><span class="sxs-lookup"><span data-stu-id="f7d81-181">-or-</span></span>  
  
 <span data-ttu-id="f7d81-182">La propriété <see cref="P:System.Diagnostics.EventLog.Log" /> ou <see cref="P:System.Diagnostics.EventLog.Source" /> du composant spécifié est <see langword="null" /> ou vide.</span><span class="sxs-lookup"><span data-stu-id="f7d81-182">The <see cref="P:System.Diagnostics.EventLog.Log" /> or <see cref="P:System.Diagnostics.EventLog.Source" /> property of the specified component is either <see langword="null" /> or empty.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Install">
      <MemberSignature Language="C#" Value="public override void Install (System.Collections.IDictionary stateSaver);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Install(class System.Collections.IDictionary stateSaver) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.Install(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Install (stateSaver As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Install(System::Collections::IDictionary ^ stateSaver);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="stateSaver" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="stateSaver"><span data-ttu-id="f7d81-183"><see cref="T:System.Collections.IDictionary" /> utilisé pour enregistrer les informations nécessaires à l'exécution d'une opération de restauration ou de désinstallation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-183">An <see cref="T:System.Collections.IDictionary" /> used to save information needed to perform a rollback or uninstall operation.</span></span></param>
        <summary><span data-ttu-id="f7d81-184">Exécute l'installation et écrit les informations du journal des événements dans le Registre.</span><span class="sxs-lookup"><span data-stu-id="f7d81-184">Performs the installation and writes event log information to the registry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-185">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode écrit des informations de journal des événements dans le Registre et associe le journal des événements à un journal qui est spécifié par le <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-185">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method writes event log information to the registry, and associates the event log with a log that is specified by the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span> <span data-ttu-id="f7d81-186">Si le journal n’existe pas déjà (et une source est spécifiée), <xref:System.Diagnostics.EventLogInstaller.Install%2A> crée un journal et lui associe la nouvelle source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-186">If the log does not already exist (and a source is specified), <xref:System.Diagnostics.EventLogInstaller.Install%2A> creates a log and associates the new source with it.</span></span>  
  
 <span data-ttu-id="f7d81-187">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> à partir de votre code ; elles sont généralement appelées uniquement par le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span><span class="sxs-lookup"><span data-stu-id="f7d81-187">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> from within your code; they are generally called only by the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span></span> <span data-ttu-id="f7d81-188">L’outil appelle automatiquement la <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode pendant le processus d’installation pour écrire des informations de Registre qui sont associées avec le journal des événements en cours d’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-188">The tool automatically calls the <xref:System.Diagnostics.EventLogInstaller.Install%2A> method during the installation process to write registry information that is associated with the event log being installed.</span></span> <span data-ttu-id="f7d81-189">Installation étant transactionnelle, s’il existe une défaillance d’un composant de projet d’installation lors de l’installation, tous les composants précédemment installés sont restaurées à leur état avant l’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-189">Installation is transactional, so if there is a failure of any installation project component during the installation, all the previously-installed components are rolled back to their pre-installation states.</span></span> <span data-ttu-id="f7d81-190">Cela est accompli en appelant de chaque composant <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="f7d81-190">This is accomplished by calling each component's <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> method.</span></span>  
  
 <span data-ttu-id="f7d81-191">Utilisez <xref:System.Diagnostics.EventLogInstaller> pour inscrire une nouvelle source pour un journal des événements nouveau ou existant ; n’utilisez pas <xref:System.Diagnostics.EventLogInstaller> pour modifier une source existante.</span><span class="sxs-lookup"><span data-stu-id="f7d81-191">Use <xref:System.Diagnostics.EventLogInstaller> to register a new source for a new or existing event log; do not use <xref:System.Diagnostics.EventLogInstaller> to change an existing source.</span></span> <span data-ttu-id="f7d81-192">La <xref:System.Diagnostics.EventLogInstaller> classe ne modifie pas les propriétés de configuration d’une source existante pour faire correspondre les propriétés d’installation spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-192">The <xref:System.Diagnostics.EventLogInstaller> class does not modify the configuration properties of an existing source to match the specified installation properties.</span></span> <span data-ttu-id="f7d81-193">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode lève une exception si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est enregistré pour un autre journal des événements sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-193">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method throws an exception if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is registered for a different event log on the computer.</span></span> <span data-ttu-id="f7d81-194">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode ignore l’enregistrement de la source si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est déjà inscrite pour le même journal des événements spécifié dans le <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-194">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method skips registering the source if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is already registered for the same event log specified in the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-195">Routine d’installation d’une application utilise le programme d’installation de projet <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> propriété gérer automatiquement les informations sur les composants qui ont déjà été installés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-195">An application's install routine uses the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> property to automatically maintain information about the components that have already been installed.</span></span> <span data-ttu-id="f7d81-196">Ces informations d’état, qui sont passées à <xref:System.Diagnostics.EventLogInstaller.Install%2A> comme le `stateSaver` paramètre, est régulièrement mis à jour que l’outil d’installation de chaque <xref:System.Diagnostics.EventLogInstaller>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-196">This state information, which is passed to <xref:System.Diagnostics.EventLogInstaller.Install%2A> as the `stateSaver` parameter, is continuously updated as the tool installs each <xref:System.Diagnostics.EventLogInstaller>.</span></span> <span data-ttu-id="f7d81-197">En règle générale, il n’est pas nécessaire pour votre code de modifier explicitement ces informations d’état.</span><span class="sxs-lookup"><span data-stu-id="f7d81-197">Usually, it is not necessary for your code to explicitly modify this state information.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="f7d81-198">La plateforme que le programme d'installation tente d'utiliser n'est pas Windows NT 4.0 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="f7d81-198">The platform the installer is trying to use is not Windows NT 4.0 or later.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="f7d81-199">Le nom spécifié dans la propriété <see cref="P:System.Diagnostics.EventLogInstaller.Source" /> est déjà enregistré pour un journal des événements différent.</span><span class="sxs-lookup"><span data-stu-id="f7d81-199">The name specified in the <see cref="P:System.Diagnostics.EventLogInstaller.Source" /> property is already registered for a different event log.</span></span></exception>
        <altmember cref="M:System.Diagnostics.EventLogInstaller.Rollback(System.Collections.IDictionary)" />
        <altmember cref="M:System.Diagnostics.EventLogInstaller.Uninstall(System.Collections.IDictionary)" />
        <altmember cref="T:System.Collections.IDictionary" />
      </Docs>
    </Member>
    <Member MemberName="IsEquivalentInstaller">
      <MemberSignature Language="C#" Value="public override bool IsEquivalentInstaller (System.Configuration.Install.ComponentInstaller otherInstaller);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool IsEquivalentInstaller(class System.Configuration.Install.ComponentInstaller otherInstaller) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.IsEquivalentInstaller(System.Configuration.Install.ComponentInstaller)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function IsEquivalentInstaller (otherInstaller As ComponentInstaller) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool IsEquivalentInstaller(System::Configuration::Install::ComponentInstaller ^ otherInstaller);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="otherInstaller" Type="System.Configuration.Install.ComponentInstaller" />
      </Parameters>
      <Docs>
        <param name="otherInstaller"><span data-ttu-id="f7d81-200">Programme d'installation à comparer.</span><span class="sxs-lookup"><span data-stu-id="f7d81-200">The installer to compare.</span></span></param>
        <summary><span data-ttu-id="f7d81-201">Détermine si un programme d'installation et un autre programme d'installation spécifié font référence à la même source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-201">Determines whether an installer and another specified installer refer to the same source.</span></span></summary>
        <returns>
          <span data-ttu-id="f7d81-202"><see langword="true" /> si ce programme d'installation et le programme d'installation spécifié par le paramètre <paramref name="otherInstaller" /> installent ou désinstallent la même source ; sinon, <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-202"><see langword="true" /> if this installer and the installer specified by the <paramref name="otherInstaller" /> parameter would install or uninstall the same source; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-203">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> à partir de votre code ; elles sont généralement appelées uniquement par l’outil Installer tool (Installutil.exe).</span><span class="sxs-lookup"><span data-stu-id="f7d81-203">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> from within your code; they are generally called only by the Installer tool (Installutil.exe).</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Diagnostics.EventLogInstaller.CopyFromComponent(System.ComponentModel.IComponent)" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-204">Obtient ou définit le nom du journal pour lequel définir la source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-204">Gets or sets the name of the log to set the source to.</span></span></summary>
        <value><span data-ttu-id="f7d81-205">Nom du journal.</span><span class="sxs-lookup"><span data-stu-id="f7d81-205">The name of the log.</span></span> <span data-ttu-id="f7d81-206">Il peut s'agir d'application, système ou d'un nom de journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-206">This can be Application, System, or a custom log name.</span></span> <span data-ttu-id="f7d81-207">La valeur par défaut est une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="f7d81-207">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-208">Vous pouvez utiliser la <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété pour associer la source que vous spécifiez dans le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété avec un journal existant ou un nouveau journal sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="f7d81-208">You can use the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property to associate the source you specify in the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property with either an existing log or a new log on the local computer.</span></span> <span data-ttu-id="f7d81-209">Le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md) utilise ces informations pour mapper la source du journal dans le Registre de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-209">The [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md) uses this information to map the source to the log in the computer's registry.</span></span> <span data-ttu-id="f7d81-210">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-210">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="f7d81-211">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="f7d81-211">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="f7d81-212">Pour écrire des entrées dans un journal des événements, vous devez créer une source et l’inscrire auprès d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-212">To write entries to an event log, you must create a source and register it with an event log.</span></span> <span data-ttu-id="f7d81-213">Une source d’événement peut uniquement écrire dans un journal à la fois.</span><span class="sxs-lookup"><span data-stu-id="f7d81-213">An event source can only write to one log at a time.</span></span> <span data-ttu-id="f7d81-214">Le programme d’installation utilise la valeur de la <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété pour inscrire votre application avec le journal des événements comme source valide d’entrées.</span><span class="sxs-lookup"><span data-stu-id="f7d81-214">The installer uses the value of the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property to register your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="f7d81-215">Si vous ne spécifiez pas un nom de journal avant l’exécution du programme d’installation, le programme d’installation enregistre votre source dans le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="f7d81-215">If you do not specify a log name before the installer runs, the installer registers your source to the Application log.</span></span> <span data-ttu-id="f7d81-216">Si vous spécifiez une nouvelle source et un journal existant, le programme d’installation crée une source d’événement et l’associe au journal spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-216">If you specify a new source and an existing log, the installer creates a new event source and associates it with the log you specify.</span></span> <span data-ttu-id="f7d81-217">Si vous spécifiez une nouvelle source et un nouveau journal, le programme d’installation associe la nouvelle source dans le nouveau journal dans le Registre, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-217">If you specify both a new source and a new log, the installer associates the new source with the new log in the registry, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="f7d81-218">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="f7d81-218">The operating system stores event logs as files.</span></span> <span data-ttu-id="f7d81-219">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-219">When you use <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="f7d81-220">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="f7d81-220">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="f7d81-221">Utilisez <xref:System.Diagnostics.EventLogInstaller> pour inscrire une nouvelle source pour un journal des événements nouveau ou existant ; n’utilisez pas <xref:System.Diagnostics.EventLogInstaller> pour modifier une source existante.</span><span class="sxs-lookup"><span data-stu-id="f7d81-221">Use <xref:System.Diagnostics.EventLogInstaller> to register a new source for a new or existing event log; do not use <xref:System.Diagnostics.EventLogInstaller> to change an existing source.</span></span> <span data-ttu-id="f7d81-222">La <xref:System.Diagnostics.EventLogInstaller> classe ne modifie pas les propriétés de configuration d’une source existante pour faire correspondre les propriétés d’installation spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-222">The <xref:System.Diagnostics.EventLogInstaller> class does not modify the configuration properties of an existing source to match the specified installation properties.</span></span> <span data-ttu-id="f7d81-223">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode lève une exception si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est enregistré pour un autre journal des événements sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-223">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method throws an exception if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is registered for a different event log on the computer.</span></span> <span data-ttu-id="f7d81-224">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode n’enregistre pas la source si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est déjà inscrite pour le même journal des événements spécifié dans le <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-224">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method does not register the source if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is already registered for the same event log specified in the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-225">Pour plus d’informations sur les comportements des journaux des événements et des sources, consultez le <xref:System.Diagnostics.EventLog> classe documentation pour le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.Source%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-225">For more detailed information about the behaviors of event logs and sources, see the <xref:System.Diagnostics.EventLog> class documentation for the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.Source%2A> properties.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="T:System.Diagnostics.EventLog" />
      </Docs>
    </Member>
    <Member MemberName="MessageResourceFile">
      <MemberSignature Language="C#" Value="public string MessageResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MessageResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.MessageResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MessageResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Windows.Forms.Design.FileNameEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-226">Obtient ou définit le chemin d'accès du fichier de ressources qui contient des chaînes de mise en forme du message pour la source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-226">Gets or sets the path of the resource file that contains message formatting strings for the source.</span></span></summary>
        <value><span data-ttu-id="f7d81-227">Chemin d'accès au fichier de ressources du message.</span><span class="sxs-lookup"><span data-stu-id="f7d81-227">The path of the message resource file.</span></span> <span data-ttu-id="f7d81-228">La valeur par défaut est une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="f7d81-228">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-229">Utilisez le <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> pour configurer une source de journal des événements pour écrire des messages d’événement localisés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-229">Use the <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> property to configure an event log source to write localized event messages.</span></span> <span data-ttu-id="f7d81-230">Messages d’événement sont des chaînes définies par l’application qui décrivent l’événement à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-230">Event messages are application-defined strings that describe the event to the user.</span></span>  
  
 <span data-ttu-id="f7d81-231">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="f7d81-231">Your application can write event log entries using resource identifiers.</span></span> <span data-ttu-id="f7d81-232">Un identificateur de ressource indexe un message se trouvant dans le <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-232">A resource identifier indexes a message located in the <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A>.</span></span> <span data-ttu-id="f7d81-233">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource localisée selon les paramètres de langue actuels.</span><span class="sxs-lookup"><span data-stu-id="f7d81-233">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span>  
  
 <span data-ttu-id="f7d81-234">La source d’événements doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-234">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="f7d81-235">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées localisées pour une source configurée avec un fichier de ressources du message.</span><span class="sxs-lookup"><span data-stu-id="f7d81-235">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="f7d81-236">Si votre application écrit les chaînes de message d’événement directement, au lieu d’utiliser un identificateur de ressource dans un fichier de ressources localisé, ne définissez pas le <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-236">If your application writes event message strings directly, rather than using a resource identifier in a localized resource file, do not set the <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-237">Si le <xref:System.Diagnostics.EventLog.MachineName%2A> propriété n’est pas l’identificateur de l’ordinateur local («. »), le .NET Framework suppose que le fichier de ressources est sur un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="f7d81-237">If the <xref:System.Diagnostics.EventLog.MachineName%2A> property is not the local computer identifier ("."), the .NET Framework assumes that the resource file is on a remote computer.</span></span> <span data-ttu-id="f7d81-238">Si le <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> valeur de propriété contient une lettre de lecteur, le fichier de ressources est supposé se pour trouver sur le \\ \\< machinename\>\\< lecteur\>partage $ (par exemple, \\\server \c$).</span><span class="sxs-lookup"><span data-stu-id="f7d81-238">If the <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> property value contains a drive letter, the resource file is assumed to be on the \\\\<machinename\>\\<drive\>$ share (for example, \\\server\c$).</span></span> <span data-ttu-id="f7d81-239">Si la valeur contient la chaîne % systemroot%, le fichier de ressources est censé pour se trouver sur le \\ \\< machinename\>\admin$ partage (par exemple, \\\server\admin$).</span><span class="sxs-lookup"><span data-stu-id="f7d81-239">If the value contains the string %systemroot%, the resource file is assumed to be on the \\\\<machinename\>\admin$ share (for example, \\\server\admin$).</span></span>  
  
 <span data-ttu-id="f7d81-240">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="f7d81-240">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f7d81-241">L’exemple de code suivant définit les propriétés d’installation pour une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-241">The following code example sets the installation properties for a new event source.</span></span> <span data-ttu-id="f7d81-242">L’exemple de code définit le nom de source d’événement, nom du journal des événements et fichier de ressources pour le texte de l’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-242">The code example sets the event source name, event log name, and resource file for localized event text.</span></span>  
  
 [!code-cpp[EventLogInstaller_Resources#1](~/samples/snippets/cpp/VS_Snippets_CLR/eventlogInstaller_Resources/CPP/source.cpp#1)]
 [!code-csharp[EventLogInstaller_Resources#1](~/samples/snippets/csharp/VS_Snippets_CLR/eventlogInstaller_Resources/CS/source.cs#1)]
 [!code-vb[EventLogInstaller_Resources#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlogInstaller_Resources/VB/source.vb#1)]  
  
 <span data-ttu-id="f7d81-243">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="f7d81-243">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="f7d81-244">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-244">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="f7d81-245">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f7d81-245">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.MessageResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="ParameterResourceFile">
      <MemberSignature Language="C#" Value="public string ParameterResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ParameterResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.ParameterResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property ParameterResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ParameterResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Windows.Forms.Design.FileNameEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-246">Obtient ou définit le chemin d'accès du fichier de ressources qui contient des chaînes de paramètre du message pour la source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-246">Gets or sets the path of the resource file that contains message parameter strings for the source.</span></span></summary>
        <value><span data-ttu-id="f7d81-247">Chemin d'accès au fichier de ressources de paramètre du message.</span><span class="sxs-lookup"><span data-stu-id="f7d81-247">The path of the message parameter resource file.</span></span> <span data-ttu-id="f7d81-248">La valeur par défaut est une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="f7d81-248">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-249">Utilisez le <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> pour configurer une source de journal des événements pour écrire des messages d’événement localisés avec des chaînes de paramètre insérées.</span><span class="sxs-lookup"><span data-stu-id="f7d81-249">Use the <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> property to configure an event log source to write localized event messages with inserted parameter strings.</span></span> <span data-ttu-id="f7d81-250">Chaque message d’événement localisé spécifié dans le <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> propriété peut contenir des espaces réservés pour les chaînes d’insertion.</span><span class="sxs-lookup"><span data-stu-id="f7d81-250">Each localized event message specified in the <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> property can contain placeholders for insertion strings.</span></span> <span data-ttu-id="f7d81-251">Ces espaces réservés sont utilisés pour spécifier la position et l’identificateur de ressource pour une chaîne indépendante du langage dans le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-251">These placeholders are used to specify the position and resource identifier for a language-independent string within the event message.</span></span> <span data-ttu-id="f7d81-252">L’Observateur d’événements remplace les espaces réservés par les chaînes correspondantes de la <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> et met en forme le message du journal des événements pour l’entrée d’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-252">The Event Viewer replaces the placeholders with the corresponding strings from the <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> and formats the event log message for the localized event entry.</span></span>  
  
 <span data-ttu-id="f7d81-253">Par exemple, la section suivante d’un fichier texte de message définit une chaîne avec un espace réservé de paramètre :</span><span class="sxs-lookup"><span data-stu-id="f7d81-253">For example, the following section of a message text file defines a string with a parameter placeholder:</span></span>  
  
```  
  
MessageId = 1501  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_STARTING  
Language=English  
Component %%6050 is starting.  
.  
```  
  
 <span data-ttu-id="f7d81-254">Dans le fichier de ressources de paramètre, la chaîne d’insertion doit être définie avec l’identificateur de ressource qui correspond à l’espace réservé, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="f7d81-254">Within the parameter resource file, the insertion string must be defined with the resource identifier that corresponds to the placeholder, as shown below:</span></span>  
  
```  
MessageId = 6050  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_NAME_MSGID  
Language=English  
TRIGGER.EXE  
.  
```  
  
 <span data-ttu-id="f7d81-255">La source d’événements doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="f7d81-255">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="f7d81-256">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées localisées pour une source configurée avec un fichier de ressources du message.</span><span class="sxs-lookup"><span data-stu-id="f7d81-256">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="f7d81-257">Si votre application écrit les chaînes de message d’événement directement dans le journal des événements, ou si votre <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> ne contient pas de messages avec des espaces réservés de paramètre d’insertion, ne définissez pas le <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-257">If your application writes event message strings directly to the event log, or if your <xref:System.Diagnostics.EventLogInstaller.MessageResourceFile%2A> does not contain messages with parameter insertion placeholders, do not set the <xref:System.Diagnostics.EventLogInstaller.ParameterResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-258">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="f7d81-258">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="f7d81-259">L’exemple de code suivant définit les propriétés d’installation pour une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-259">The following code example sets the installation properties for a new event source.</span></span> <span data-ttu-id="f7d81-260">L’exemple de code définit le nom de source d’événement, nom du journal des événements et fichier de ressources pour le texte de l’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-260">The code example sets the event source name, event log name, and resource file for localized event text.</span></span>  
  
 [!code-cpp[EventLogInstaller_Resources#1](~/samples/snippets/cpp/VS_Snippets_CLR/eventlogInstaller_Resources/CPP/source.cpp#1)]
 [!code-csharp[EventLogInstaller_Resources#1](~/samples/snippets/csharp/VS_Snippets_CLR/eventlogInstaller_Resources/CS/source.cs#1)]
 [!code-vb[EventLogInstaller_Resources#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlogInstaller_Resources/VB/source.vb#1)]  
  
 <span data-ttu-id="f7d81-261">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="f7d81-261">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="f7d81-262">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-262">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="f7d81-263">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f7d81-263">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="f7d81-264">Plus précisément, le message défini pour l’identificateur de ressource 1004 utilise un espace réservé pour un paramètre de chaîne pour l’identificateur de ressource 5002.</span><span class="sxs-lookup"><span data-stu-id="f7d81-264">Specifically, the message defined for resource identifier 1004 uses a placeholder for a parameter string defined for resource identifier 5002.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.ParameterResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="Rollback">
      <MemberSignature Language="C#" Value="public override void Rollback (System.Collections.IDictionary savedState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Rollback(class System.Collections.IDictionary savedState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.Rollback(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Rollback (savedState As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Rollback(System::Collections::IDictionary ^ savedState);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="savedState" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="savedState"><span data-ttu-id="f7d81-265"><see cref="T:System.Collections.IDictionary" /> qui contient l'état qui était celui de l'ordinateur avant l'installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-265">An <see cref="T:System.Collections.IDictionary" /> that contains the pre-installation state of the computer.</span></span></param>
        <summary><span data-ttu-id="f7d81-266">Restaure l'état qui était celui de l'ordinateur avant l'installation en restaurant les informations du journal des événements écrites dans le Registre pendant la procédure d'installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-266">Restores the computer to the state it was in before the installation by rolling back the event log information that the installation procedure wrote to the registry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-267">Le <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> méthode annule les effets de la <xref:System.Diagnostics.EventLogInstaller.Install%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="f7d81-267">The <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> method undoes the effects of the <xref:System.Diagnostics.EventLogInstaller.Install%2A> method.</span></span> <span data-ttu-id="f7d81-268"><xref:System.Diagnostics.EventLogInstaller.Rollback%2A> est appelée si l’installation d’un composant dans le projet d’installation échoue.</span><span class="sxs-lookup"><span data-stu-id="f7d81-268"><xref:System.Diagnostics.EventLogInstaller.Rollback%2A> is called if the installation of any component in the installation project fails.</span></span> <span data-ttu-id="f7d81-269">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode crée ou définit les propriétés d’un journal des événements et la source d’événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-269">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method creates or sets the properties for an event log and event source.</span></span> <span data-ttu-id="f7d81-270"><xref:System.Diagnostics.EventLogInstaller.Rollback%2A> Supprime le journal des événements et la source ou réinitialise les propriétés d’une source à ses valeurs avant l’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-270"><xref:System.Diagnostics.EventLogInstaller.Rollback%2A> either deletes the event log and source or resets the properties of a pre-existing source to its pre-installation values.</span></span>  
  
 <span data-ttu-id="f7d81-271">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> à partir de votre code ; elles sont généralement appelées uniquement par le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span><span class="sxs-lookup"><span data-stu-id="f7d81-271">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> from within your code; they are generally called only by the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md).</span></span> <span data-ttu-id="f7d81-272">L’outil appelle la <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> méthode, lorsque ce composant ou un autre composant a échoué pour installer, pour annuler les modifications déjà apportées par le processus d’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-272">The tool calls the <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> method, when this or another component has failed to install, to undo any changes that the installation process has already made.</span></span>  
  
 <span data-ttu-id="f7d81-273">Routine d’installation d’une application utilise le programme d’installation de projet <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> propriété gérer automatiquement les informations sur les composants qui ont déjà été installés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-273">An application's install routine uses the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> property to automatically maintain information about the components that have already been installed.</span></span> <span data-ttu-id="f7d81-274">Ces informations d’état, qui sont passées à <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> comme le `savedState` paramètre, est régulièrement mis à jour que l’outil restaure chaque <xref:System.Diagnostics.EventLogInstaller>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-274">This state information, which is passed to <xref:System.Diagnostics.EventLogInstaller.Rollback%2A> as the `savedState` parameter, is continuously updated as the tool rolls back each <xref:System.Diagnostics.EventLogInstaller>.</span></span> <span data-ttu-id="f7d81-275">En règle générale, il n’est pas nécessaire pour votre code de modifier explicitement ces informations d’état.</span><span class="sxs-lookup"><span data-stu-id="f7d81-275">Usually, it is not necessary for your code to explicitly modify this state information.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Diagnostics.EventLogInstaller.Install(System.Collections.IDictionary)" />
        <altmember cref="M:System.Diagnostics.EventLogInstaller.Uninstall(System.Collections.IDictionary)" />
        <altmember cref="T:System.Collections.IDictionary" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-276">Obtient ou définit le nom de source à enregistrer auprès du journal.</span><span class="sxs-lookup"><span data-stu-id="f7d81-276">Gets or sets the source name to register with the log.</span></span></summary>
        <value><span data-ttu-id="f7d81-277">Nom à enregistrer auprès du journal des événements comme source d'entrées.</span><span class="sxs-lookup"><span data-stu-id="f7d81-277">The name to register with the event log as a source of entries.</span></span> <span data-ttu-id="f7d81-278">La valeur par défaut est une chaîne vide ("").</span><span class="sxs-lookup"><span data-stu-id="f7d81-278">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-279">La source d’événements indique ce qui consigne l’événement.</span><span class="sxs-lookup"><span data-stu-id="f7d81-279">The event source indicates what logs the event.</span></span> <span data-ttu-id="f7d81-280">Il est souvent le nom de l’application ou le nom d’un composant au sein d’une application volumineuse.</span><span class="sxs-lookup"><span data-stu-id="f7d81-280">It is often the name of the application, or the name of a component within a large application.</span></span>  
  
 <span data-ttu-id="f7d81-281">Le programme d’installation utilise la valeur de la <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété pour inscrire votre application avec le journal des événements comme source valide d’entrées.</span><span class="sxs-lookup"><span data-stu-id="f7d81-281">The installer uses the value of the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property to register your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="f7d81-282">Un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="f7d81-282">A new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="f7d81-283">Chaque source ne peut écrire dans un journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-283">Each source can only write to one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="f7d81-284">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="f7d81-284">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="f7d81-285">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-285">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="f7d81-286">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="f7d81-286">Device drivers should write to the System log.</span></span> <span data-ttu-id="f7d81-287">Si vous ne spécifiez pas un nom de journal avant l’exécution du programme d’installation, le programme d’installation enregistre votre source dans le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="f7d81-287">If you do not specify a log name before the installer runs, the installer registers your source to the Application log.</span></span> <span data-ttu-id="f7d81-288">Si vous spécifiez le nom d’un journal qui n’existe pas, le système enregistre le <xref:System.Diagnostics.EventLogInstaller.Source%2A> au journal des événements, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="f7d81-288">If you specify the name of a log that does not exist, the system registers the <xref:System.Diagnostics.EventLogInstaller.Source%2A> to that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="f7d81-289">Utilisez <xref:System.Diagnostics.EventLogInstaller> pour inscrire une nouvelle source pour un journal des événements nouveau ou existant ; n’utilisez pas <xref:System.Diagnostics.EventLogInstaller> pour modifier une source existante.</span><span class="sxs-lookup"><span data-stu-id="f7d81-289">Use <xref:System.Diagnostics.EventLogInstaller> to register a new source for a new or existing event log; do not use <xref:System.Diagnostics.EventLogInstaller> to change an existing source.</span></span> <span data-ttu-id="f7d81-290">La <xref:System.Diagnostics.EventLogInstaller> classe ne modifie pas les propriétés de configuration d’une source existante pour faire correspondre les propriétés d’installation spécifié.</span><span class="sxs-lookup"><span data-stu-id="f7d81-290">The <xref:System.Diagnostics.EventLogInstaller> class does not modify the configuration properties of an existing source to match the specified installation properties.</span></span> <span data-ttu-id="f7d81-291">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode lève une exception si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est enregistré pour un autre journal des événements sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="f7d81-291">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method throws an exception if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is registered for a different event log on the computer.</span></span> <span data-ttu-id="f7d81-292">Le <xref:System.Diagnostics.EventLogInstaller.Install%2A> méthode n’enregistre pas la source si le <xref:System.Diagnostics.EventLogInstaller.Source%2A> propriété correspond à un nom de source qui est déjà inscrite pour le même journal des événements spécifié dans le <xref:System.Diagnostics.EventLogInstaller.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="f7d81-292">The <xref:System.Diagnostics.EventLogInstaller.Install%2A> method does not register the source if the <xref:System.Diagnostics.EventLogInstaller.Source%2A> property matches a source name that is already registered for the same event log specified in the <xref:System.Diagnostics.EventLogInstaller.Log%2A> property.</span></span>  
  
 <span data-ttu-id="f7d81-293">Pour plus d’informations sur les comportements des journaux des événements et des sources, consultez le <xref:System.Diagnostics.EventLog> classe documentation pour le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.Source%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-293">For more detailed information about the behaviors of event logs and sources, see the <xref:System.Diagnostics.EventLog> class documentation for the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.Source%2A> properties.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLog" />
      </Docs>
    </Member>
    <Member MemberName="Uninstall">
      <MemberSignature Language="C#" Value="public override void Uninstall (System.Collections.IDictionary savedState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Uninstall(class System.Collections.IDictionary savedState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLogInstaller.Uninstall(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Uninstall (savedState As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Uninstall(System::Collections::IDictionary ^ savedState);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="savedState" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="savedState"><span data-ttu-id="f7d81-294"><see cref="T:System.Collections.IDictionary" /> qui contient l'état qui était celui de l'ordinateur avant l'installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-294">An <see cref="T:System.Collections.IDictionary" /> that contains the pre-installation state of the computer.</span></span></param>
        <summary><span data-ttu-id="f7d81-295">Supprime une installation en enlevant du Registre les informations du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="f7d81-295">Removes an installation by removing event log information from the registry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-296">Si le <xref:System.Diagnostics.EventLogInstaller.UninstallAction%2A> valeur de propriété est `Remove`, le <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> méthode supprime la source et le journal associé que le programme d’installation créé si le <xref:System.Diagnostics.EventLogInstaller.Log%2A> et <xref:System.Diagnostics.EventLogInstaller.Source%2A> les propriétés spécifiées de la création d’un nouveau journal des événements et une source.</span><span class="sxs-lookup"><span data-stu-id="f7d81-296">If the <xref:System.Diagnostics.EventLogInstaller.UninstallAction%2A> property value is `Remove`, the <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> method deletes the source and the associated log that the installer created if the <xref:System.Diagnostics.EventLogInstaller.Log%2A> and <xref:System.Diagnostics.EventLogInstaller.Source%2A> properties specified the creation of a new event log and source.</span></span>  
  
 <span data-ttu-id="f7d81-297">En règle générale, vous n’appelez pas les méthodes de la <xref:System.Diagnostics.EventLogInstaller> à partir de votre code ; elles sont généralement appelées uniquement par le [Installutil.exe (outil Installer)](~/docs/framework/tools/installutil-exe-installer-tool.md) en mode de désinstallation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-297">Typically, you do not call the methods of the <xref:System.Diagnostics.EventLogInstaller> from within your code; they are generally called only by the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md) in uninstall mode.</span></span> <span data-ttu-id="f7d81-298">L’outil appelle automatiquement la <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> méthode pour restaurer les parties du système qui ont été affectés par l’installation à leur état avant l’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-298">The tool automatically calls the <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> method to restore the parts of the system that were affected by the installation to their pre-installation states.</span></span> <span data-ttu-id="f7d81-299">Cela comprend la suppression des informations du Registre qui sont associées avec le journal des événements en cours de désinstallation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-299">This includes deleting registry information that is associated with the event log being uninstalled.</span></span>  
  
 <span data-ttu-id="f7d81-300">D’une application routine désinstallation utilise le programme d’installation de projet <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> propriété gérer automatiquement les informations sur les composants qui ont déjà été désinstallés.</span><span class="sxs-lookup"><span data-stu-id="f7d81-300">An application's uninstall routine uses the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType> property to automatically maintain information about the components that have already been uninstalled.</span></span> <span data-ttu-id="f7d81-301">Ces informations d’état, qui sont passées à <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> comme le `savedState` paramètre, est régulièrement mis à jour lors de l’outil de la désinstallation chaque <xref:System.Diagnostics.EventLogInstaller>.</span><span class="sxs-lookup"><span data-stu-id="f7d81-301">This state information, which is passed to <xref:System.Diagnostics.EventLogInstaller.Uninstall%2A> as the `savedState` parameter, is continuously updated as the tool uninstalls each <xref:System.Diagnostics.EventLogInstaller>.</span></span> <span data-ttu-id="f7d81-302">En règle générale, il n’est pas nécessaire pour votre code de modifier explicitement ces informations d’état.</span><span class="sxs-lookup"><span data-stu-id="f7d81-302">Usually, it is not necessary for your code to explicitly modify this state information.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Diagnostics.EventLogInstaller.Install(System.Collections.IDictionary)" />
        <altmember cref="T:System.Collections.IDictionary" />
      </Docs>
    </Member>
    <Member MemberName="UninstallAction">
      <MemberSignature Language="C#" Value="public System.Configuration.Install.UninstallAction UninstallAction { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Configuration.Install.UninstallAction UninstallAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLogInstaller.UninstallAction" />
      <MemberSignature Language="VB.NET" Value="Public Property UninstallAction As UninstallAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Configuration::Install::UninstallAction UninstallAction { System::Configuration::Install::UninstallAction get(); void set(System::Configuration::Install::UninstallAction value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Configuration.Install</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Configuration.Install.UninstallAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="f7d81-303">Obtient ou définit une valeur qui indique si l’[outil d’installation (Installutil.exe)](~/docs/framework/tools/installutil-exe-installer-tool.md) doit supprimer le journal des événements ou le laisser à son état d’installation au moment de la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-303">Gets or sets a value that indicates whether the [Installutil.exe (Installer Tool)](~/docs/framework/tools/installutil-exe-installer-tool.md) should remove the event log or leave it in its installed state at uninstall time.</span></span></summary>
        <value><span data-ttu-id="f7d81-304">Une des valeurs <see cref="T:System.Configuration.Install.UninstallAction" /> qui indique dans quel état laisser le journal des événements une fois <see cref="T:System.Diagnostics.EventLog" /> désinstallé.</span><span class="sxs-lookup"><span data-stu-id="f7d81-304">One of the <see cref="T:System.Configuration.Install.UninstallAction" /> values that indicates what state to leave the event log in when the <see cref="T:System.Diagnostics.EventLog" /> is uninstalled.</span></span> <span data-ttu-id="f7d81-305">La valeur par défaut est <see langword="Remove" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-305">The default is <see langword="Remove" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="f7d81-306">Lorsque vous installez un journal des événements, vous pouvez éventuellement le connecter à un journal existant.</span><span class="sxs-lookup"><span data-stu-id="f7d81-306">When you install an event log, you can optionally connect it to an existing log.</span></span> <span data-ttu-id="f7d81-307">Si vous le faites, vous devez décider si le journal doit retourner à son état avant l’installation, ou si elle doit rester dans son état actuel après l’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-307">If you do so, you must decide whether the log should return to its pre-installation state, or remain in its current, post-installation state.</span></span> <span data-ttu-id="f7d81-308">Si vous choisissez retourner le journal des événements à son état avant l’installation, les modifications apportées aux entrées de journal des événements lors de l’installation ne sont pas restaurées.</span><span class="sxs-lookup"><span data-stu-id="f7d81-308">If you elect to return the event log to its pre-installation state, changes to the event log entries at installation are not restored.</span></span> <span data-ttu-id="f7d81-309">Vous pouvez réinitialiser uniquement les propriétés du journal des événements qui sont associées les <xref:System.Diagnostics.EventLogInstaller> à leurs valeurs avant l’installation.</span><span class="sxs-lookup"><span data-stu-id="f7d81-309">You can reset only the event log properties that are associated with the <xref:System.Diagnostics.EventLogInstaller> to their pre-installation values.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="f7d81-310"><see cref="P:System.Diagnostics.EventLogInstaller.UninstallAction" /> contient une valeur non valide.</span><span class="sxs-lookup"><span data-stu-id="f7d81-310"><see cref="P:System.Diagnostics.EventLogInstaller.UninstallAction" /> contains an invalid value.</span></span> <span data-ttu-id="f7d81-311">Les seules valeurs valides pour cette propriété sont <see langword="Remove" /> et <see langword="NoAction" />.</span><span class="sxs-lookup"><span data-stu-id="f7d81-311">The only valid values for this property are <see langword="Remove" /> and <see langword="NoAction" />.</span></span></exception>
      </Docs>
    </Member>
  </Members>
</Type>