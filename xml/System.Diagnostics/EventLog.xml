<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="9d1d55650794a0dbf45b3b81bb454cf8fbec5629" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36344320" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <TypeSignature Language="F#" Value="type EventLog = class&#xA;    inherit Component&#xA;    interface ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="bc382-101">Provides interaction with Windows event logs.</span>
      <span class="sxs-lookup">
        <span data-stu-id="bc382-101">Provides interaction with Windows event logs.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-102"><xref:System.Diagnostics.EventLog> vous permet d’accéder ou de personnaliser les journaux des événements Windows, qui enregistrent des informations sur les événements importants de logiciel ou matériel.</span><span class="sxs-lookup"><span data-stu-id="bc382-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="bc382-103">À l’aide de <xref:System.Diagnostics.EventLog>, vous pouvez lire les journaux existants, écrire des entrées dans les journaux, créer ou supprimer des sources d’événements, supprimer des journaux et répondre aux entrées de journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="bc382-104">Vous pouvez également créer des nouveaux journaux lors de la création d’une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="bc382-105">Ce type implémente le <xref:System.IDisposable> interface.</span><span class="sxs-lookup"><span data-stu-id="bc382-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="bc382-106">Lorsque vous avez fini d’utiliser le type, vous devez la supprimer directement ou indirectement.</span><span class="sxs-lookup"><span data-stu-id="bc382-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="bc382-107">Pour supprimer le type directement, vous devez appeler sa <xref:System.IDisposable.Dispose%2A> méthode dans un `try` / `catch` bloc.</span><span class="sxs-lookup"><span data-stu-id="bc382-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="bc382-108">Pour la supprimer indirectement, utiliser une construction de langage telles que `using` (en c#) ou `Using` (en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="bc382-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="bc382-109">Pour plus d’informations, consultez la section « Utilisant un objet qui implémente IDisposable » dans la <xref:System.IDisposable> rubrique de l’interface.</span><span class="sxs-lookup"><span data-stu-id="bc382-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="bc382-110">En plus de fournir l’accès aux journaux des événements individuels et leurs entrées, la <xref:System.Diagnostics.EventLog> classe vous permet d’accéder à la collection de tous les journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="bc382-111">Vous pouvez utiliser la `static` membres de <xref:System.Diagnostics.EventLog> pour supprimer les journaux, obtenir les listes de journaux, créer ou supprimer une source ou déterminer si un ordinateur contient déjà une source particulière.</span><span class="sxs-lookup"><span data-stu-id="bc382-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="bc382-112">Il existe trois journaux d’événements par défaut : Application, système et sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="bc382-113">Un journal de sécurité est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="bc382-113">A Security log is read-only.</span></span> <span data-ttu-id="bc382-114">Autres applications et services que vous installez, tels qu’Active Directory, peuvent avoir des journaux des événements supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bc382-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="bc382-115">Il existe des considérations sur la sécurité lorsque vous utilisez la <xref:System.Diagnostics.EventLog> classe.</span><span class="sxs-lookup"><span data-stu-id="bc382-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="bc382-116"><xref:System.Diagnostics.EventLog> requiert <xref:System.Diagnostics.EventLogPermission> des autorisations pour des actions spécifiques dans le .NET Framework 2.0 et versions ultérieures, ou une confiance totale dans le .NET Framework 1.0 et 1.1.</span><span class="sxs-lookup"><span data-stu-id="bc382-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="bc382-117">Nous vous recommandons <xref:System.Diagnostics.EventLogPermission> ne pas accordée à du code partiellement fiable.</span><span class="sxs-lookup"><span data-stu-id="bc382-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="bc382-118">Vous ne devez jamais passer n’importe quel objet de journal des événements, y compris <xref:System.Diagnostics.EventLogEntryCollection> et <xref:System.Diagnostics.EventLogEntry> objets, au code de confiance inférieur.</span><span class="sxs-lookup"><span data-stu-id="bc382-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="bc382-119">Par exemple, en créant un <xref:System.Diagnostics.EventLog> objet, l’écriture d’une entrée, puis en passant le <xref:System.Diagnostics.EventLog> objet à du code partiellement fiable peut créer un problème de sécurité, étant donné que la possibilité de lire et écrire dans le journal des événements permet d’effectuer des actions telles que l’exécution de code messages du journal des événements dans le nom d’une autre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="bc382-120">À compter de Windows Vista, le contrôle de compte d’utilisateur (UAC) détermine les informations d’identification d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="bc382-121">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-122">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-123">Pour exécuter le code qui accède au journal de sécurité, vous devez d’abord élever vos informations d’identification d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="bc382-124">Faire cela lorsque vous démarrez une application en ouvrant le menu contextuel de l’application (si vous utilisez une souris, cliquez sur l’icône de l’application) et en indiquant que vous souhaitez exécuter en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="bc382-125">Vous pouvez utiliser <xref:System.Diagnostics.EventLog> pour créer des journaux des événements personnalisés que vous pouvez afficher via le serveur de l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="bc382-126">Utilisez la <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> méthode pour afficher un nom localisé pour votre journal des événements dans l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="bc382-127">Utilisez la <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> méthode permettant de configurer le comportement de votre journal des événements lorsqu’il atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="bc382-128">Pour lire à partir d’un journal des événements, spécifier le nom du journal (<xref:System.Diagnostics.EventLog.Log%2A> propriété) et le nom de l’ordinateur serveur (<xref:System.Diagnostics.EventLog.MachineName%2A> propriété pour le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="bc382-129">Si vous ne spécifiez pas le nom du serveur, l’ordinateur local, «. », est utilisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="bc382-130">Il n’est pas nécessaire de spécifier la source d’événements (<xref:System.Diagnostics.EventLog.Source%2A> propriété), car une source est requise uniquement pour l’écriture dans les journaux.</span><span class="sxs-lookup"><span data-stu-id="bc382-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="bc382-131">Le <xref:System.Diagnostics.EventLog.Entries%2A> propriété est automatiquement remplie avec liste du journal des événements des entrées.</span><span class="sxs-lookup"><span data-stu-id="bc382-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="bc382-132">Pour écrire dans un journal des événements, spécifier ou créer une source d’événement (<xref:System.Diagnostics.EventLog.Source%2A> propriété).</span><span class="sxs-lookup"><span data-stu-id="bc382-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="bc382-133">Vous devez disposer des informations d’identification administratives sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="bc382-134">La source d’événements inscrit votre application avec le journal des événements comme source valide d’entrées.</span><span class="sxs-lookup"><span data-stu-id="bc382-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="bc382-135">Vous pouvez utiliser la source d’événement à écrire dans un journal seul à la fois.</span><span class="sxs-lookup"><span data-stu-id="bc382-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="bc382-136">Le <xref:System.Diagnostics.EventLog.Source%2A> propriété peut être n’importe quelle chaîne aléatoire, mais le nom doit être distinct des autres sources sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="bc382-137">La source d’événements est généralement le nom de l’application ou une autre chaîne d’identification.</span><span class="sxs-lookup"><span data-stu-id="bc382-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="bc382-138">La tentative de création d’un doublon <xref:System.Diagnostics.EventLog.Source%2A> valeur lève une exception.</span><span class="sxs-lookup"><span data-stu-id="bc382-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="bc382-139">Toutefois, un seul journal des événements peut être associé à plusieurs sources.</span><span class="sxs-lookup"><span data-stu-id="bc382-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="bc382-140">Si la source d’événements pour le journal des événements associé à le <xref:System.Diagnostics.EventLog> instance n’existe pas, une nouvelle source d’événements est créée.</span><span class="sxs-lookup"><span data-stu-id="bc382-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="bc382-141">Pour créer une source d’événements dans Windows Vista et versions ultérieures ou sur Windows Server 2003, vous devez disposer des informations d’identification administratives.</span><span class="sxs-lookup"><span data-stu-id="bc382-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="bc382-142">Cette exigence est, car tous les journaux des événements, y compris les journaux de sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-143">À compter de Windows Vista, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="bc382-144">Création ou la suppression d’une source d’événements requiert la synchronisation du code sous-jacent à l’aide d’un mutex nommé.</span><span class="sxs-lookup"><span data-stu-id="bc382-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="bc382-145">Si une application hautement privilégiée verrouille le mutex nommé, toute tentative de créer ou supprimer une source d’événement provoque l’application cesse de répondre jusqu'à ce que le verrou est libéré.</span><span class="sxs-lookup"><span data-stu-id="bc382-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="bc382-146">Pour éviter ce problème, jamais accorder <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> autorisation de code non fiable.</span><span class="sxs-lookup"><span data-stu-id="bc382-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="bc382-147">En outre, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> autorisation permet d’ignorer d’autres autorisations potentiellement et ne doit être accordée au code hautement approuvé.</span><span class="sxs-lookup"><span data-stu-id="bc382-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="bc382-148">Applications et services doivent écrire dans le journal de l’Application ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="bc382-149">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="bc382-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="bc382-150">Si vous ne définissez pas explicitement la <xref:System.Diagnostics.EventLog.Log%2A> propriété, le journal des événements par défaut le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-151">Il n’y a rien pour protéger une application à partir de l’écriture de toute source inscrite.</span><span class="sxs-lookup"><span data-stu-id="bc382-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="bc382-152">Si une application est accordée <xref:System.Diagnostics.EventLogPermissionAccess.Write> autorisation, il peut écrire des événements pour n’importe quelle source valide inscrite sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="bc382-153">Utilisez le <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthodes pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="bc382-154">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-155">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-156">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-157">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous essayez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-158">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller> objet ou le <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-159">Vous devez disposer des informations d’identification administratives sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-160">Chaque source peut écrire qu’un seul journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="bc382-161">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="bc382-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="bc382-162">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="bc382-163">Si d’autres applications ou composants utilisent la source existante, créez une nouvelle source avec la configuration mise à jour au lieu de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="bc382-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="bc382-164">Vous pouvez inscrire la source d’événements avec des ressources localisées pour vos chaînes de catégorie et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="bc382-165">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources au lieu de spécifier les valeurs de chaîne réelle.</span><span class="sxs-lookup"><span data-stu-id="bc382-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="bc382-166">Reportez-vous à la <xref:System.Diagnostics.EventLogInstaller> et <xref:System.Diagnostics.EventSourceCreationData> classes pour plus d’informations sur la configuration de la source des fichiers de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="bc382-167">Si votre application écrit les valeurs de chaîne directement dans le journal des événements, il est inutile de paramétrer les propriétés de la source de la ressource.</span><span class="sxs-lookup"><span data-stu-id="bc382-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="bc382-168">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-169">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-170">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-171">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="bc382-172">Lorsque vous écrivez des événements, vous devez au moins spécifier une chaîne de message ou l’identificateur de ressource pour une chaîne de message.</span><span class="sxs-lookup"><span data-stu-id="bc382-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="bc382-173">Autres propriétés de l’événement sont facultatifs.</span><span class="sxs-lookup"><span data-stu-id="bc382-173">Other event properties are optional.</span></span> <span data-ttu-id="bc382-174">Exemples de paramètres d’événements facultatifs sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="bc382-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="bc382-175">Vous pouvez définir le <xref:System.Diagnostics.EventLogEntryType> pour spécifier l’icône que l’Observateur d’événements affiche pour l’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="bc382-176">Vous pouvez spécifier un identificateur de la catégorie de l’événement, si votre application utilise des catégories pour filtrer les événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="bc382-177">Vous pouvez joindre des données binaires à votre entrée d’événement si vous souhaitez associer des informations supplémentaires à un événement donné.</span><span class="sxs-lookup"><span data-stu-id="bc382-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="bc382-178">Journalisation des événements utilise l’espace disque, de temps processeur et d’autres ressources système.</span><span class="sxs-lookup"><span data-stu-id="bc382-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="bc382-179">Il est important d’enregistrer uniquement les informations essentielles.</span><span class="sxs-lookup"><span data-stu-id="bc382-179">It is important to log only essential information.</span></span> <span data-ttu-id="bc382-180">Nous vous recommandons de placer des appels du journal des événements dans un chemin d’accès de l’erreur plutôt que dans le chemin d’accès du code principal, par conséquent, ils ne pas nuire aux performances.</span><span class="sxs-lookup"><span data-stu-id="bc382-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="bc382-181">Pour obtenir la liste de valeurs de propriété initiales d’une instance de <xref:System.Diagnostics.EventLog>, consultez la <xref:System.Diagnostics.EventLog.%23ctor%2A> constructeur.</span><span class="sxs-lookup"><span data-stu-id="bc382-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-182">L’exemple suivant crée la source d’événements `MySource` si elle n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-183">À compter de Windows Vista, vous devez exécuter cette application en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="bc382-186">Does not associate the instance with any log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-186">Does not associate the instance with any log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-187">Avant d’appeler <xref:System.Diagnostics.EventLog.WriteEntry%2A>, spécifiez la <xref:System.Diagnostics.EventLog.Source%2A> propriété de la <xref:System.Diagnostics.EventLog> instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="bc382-188">Si vous lisez uniquement <xref:System.Diagnostics.EventLog.Entries%2A> à partir du journal, vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="bc382-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-189">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-190">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="bc382-191">Propriété</span><span class="sxs-lookup"><span data-stu-id="bc382-191">Property</span></span>|<span data-ttu-id="bc382-192">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="bc382-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="bc382-193">Une chaîne vide (« »).</span><span class="sxs-lookup"><span data-stu-id="bc382-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="bc382-194">Une chaîne vide (« »).</span><span class="sxs-lookup"><span data-stu-id="bc382-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="bc382-195">L’ordinateur local («. »).</span><span class="sxs-lookup"><span data-stu-id="bc382-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="bc382-196">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-197">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-197">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-198">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog logName" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-199">The name of the log on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-199">The name of the log on the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="bc382-201">Associates the instance with a log on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-201">Associates the instance with a log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-202">Cette surcharge affecte le <xref:System.Diagnostics.EventLog.Log%2A> propriété le `logName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="bc382-203">Avant d’appeler <xref:System.Diagnostics.EventLog.WriteEntry%2A>, spécifiez la <xref:System.Diagnostics.EventLog.Source%2A> propriété de la <xref:System.Diagnostics.EventLog> instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="bc382-204">Si vous lisez uniquement <xref:System.Diagnostics.EventLog.Entries%2A> à partir du journal, vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="bc382-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-205">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="bc382-206">Cette surcharge du constructeur spécifie la <xref:System.Diagnostics.EventLog.Log%2A> propriété, mais vous pouvez modifier cela avant de lire le <xref:System.Diagnostics.EventLog.Entries%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="bc382-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="bc382-207">Si la source que vous spécifiez dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété est unique à partir d’autres sources sur l’ordinateur, un appel ultérieur à <xref:System.Diagnostics.EventLog.WriteEntry%2A> crée un journal avec le nom spécifié, s’il n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="bc382-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="bc382-208">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="bc382-209">Propriété</span><span class="sxs-lookup"><span data-stu-id="bc382-209">Property</span></span>|<span data-ttu-id="bc382-210">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="bc382-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="bc382-211">Une chaîne vide (« »).</span><span class="sxs-lookup"><span data-stu-id="bc382-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="bc382-212">Le `logName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="bc382-213">L’ordinateur local («. »).</span><span class="sxs-lookup"><span data-stu-id="bc382-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="bc382-214">L’exemple suivant lit les entrées dans le journal des événements « myNewLog » sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-215">The log name is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-215">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-216">The log name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-216">The log name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-217">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-217">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-218">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-219">The name of the log on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-219">The name of the log on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-220">The computer on which the log exists.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-220">The computer on which the log exists.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="bc382-222">Associates the instance with a log on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-222">Associates the instance with a log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-223">Cette surcharge affecte le <xref:System.Diagnostics.EventLog.Log%2A> propriété le `logName` paramètre et le <xref:System.Diagnostics.EventLog.MachineName%2A> propriété le `machineName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="bc382-224">Avant d’appeler <xref:System.Diagnostics.EventLog.WriteEntry%2A>, spécifiez la <xref:System.Diagnostics.EventLog.Source%2A> propriété de la <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="bc382-225">Si vous lisez uniquement <xref:System.Diagnostics.EventLog.Entries%2A> à partir du journal, vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="bc382-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-226">Cette surcharge du constructeur spécifie la <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés, mais vous pouvez les modifier avant de lire le <xref:System.Diagnostics.EventLog.Entries%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="bc382-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="bc382-227">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="bc382-228">Propriété</span><span class="sxs-lookup"><span data-stu-id="bc382-228">Property</span></span>|<span data-ttu-id="bc382-229">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="bc382-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="bc382-230">Une chaîne vide (« »).</span><span class="sxs-lookup"><span data-stu-id="bc382-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="bc382-231">Le `logName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="bc382-232">Le `machineName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="bc382-233">L’exemple suivant lit les entrées dans le journal des événements « myNewLog » sur l’ordinateur « myServer ».</span><span class="sxs-lookup"><span data-stu-id="bc382-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-234">The log name is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-234">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-235">The log name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-235">The log name is invalid.</span>
          </span>
          <span data-ttu-id="bc382-236">-or-  The computer name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-236">-or-  The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-237">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-237">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-238">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-238">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName, source)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-239">The name of the log on the specified computer</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-239">The name of the log on the specified computer</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-240">The computer on which the log exists.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-240">The computer on which the log exists.</span>
          </span>
        </param>
        <param name="source">
          <span data-ttu-id="bc382-241">The source of event log entries.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-241">The source of event log entries.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-242">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-242">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="bc382-243">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-243">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-244">Ce constructeur définit la <xref:System.Diagnostics.EventLog.Log%2A> propriété le `logName` paramètre, le <xref:System.Diagnostics.EventLog.MachineName%2A> propriété le `machineName` paramètre et le <xref:System.Diagnostics.EventLog.Source%2A> propriété le `source` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-244">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="bc382-245">Le <xref:System.Diagnostics.EventLog.Source%2A> propriété est requise lors de l’écriture dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-245">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="bc382-246">Toutefois, si vous êtes uniquement la lecture à partir d’un journal des événements, uniquement le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés sont requises (tant que le journal des événements sur le serveur a déjà associé à une source).</span><span class="sxs-lookup"><span data-stu-id="bc382-246">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="bc382-247">Si vous êtes uniquement la lecture du journal des événements, une autre surcharge du constructeur peut suffire.</span><span class="sxs-lookup"><span data-stu-id="bc382-247">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="bc382-248">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-248">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="bc382-249">Propriété</span><span class="sxs-lookup"><span data-stu-id="bc382-249">Property</span></span>|<span data-ttu-id="bc382-250">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="bc382-250">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="bc382-251">Le `source` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-251">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="bc382-252">Le `logName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-252">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="bc382-253">Le `machineName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-253">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="bc382-254">L’exemple suivant écrit une entrée dans un journal des événements, « MyNewLog », sur l’ordinateur local, à l’aide de la source « Entrées ».</span><span class="sxs-lookup"><span data-stu-id="bc382-254">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-255">The log name is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-255">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-256">The log name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-256">The log name is invalid.</span>
          </span>
          <span data-ttu-id="bc382-257">-or-  The computer name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-257">-or-  The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-258">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-258">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-259">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-259">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberSignature Language="F#" Value="abstract member BeginInit : unit -&gt; unit&#xA;override this.BeginInit : unit -&gt; unit" Usage="eventLog.BeginInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-260">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-260">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span>
          </span>
          <span data-ttu-id="bc382-261">The initialization occurs at runtime.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-261">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-262">Le [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] environnement utilise cette méthode pour démarrer l’initialisation d’un composant utilisé dans un formulaire ou par un autre composant de conception.</span><span class="sxs-lookup"><span data-stu-id="bc382-262">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="bc382-263">Le <xref:System.Diagnostics.EventLog.EndInit%2A> méthode termine l’initialisation.</span><span class="sxs-lookup"><span data-stu-id="bc382-263">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="bc382-264">À l’aide de la <xref:System.Diagnostics.EventLog.BeginInit%2A> et <xref:System.Diagnostics.EventLog.EndInit%2A> méthodes empêchent le contrôle de l’utilisation avant son initialisation complète.</span><span class="sxs-lookup"><span data-stu-id="bc382-264">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-265">
            <see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-265">
              <see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-266">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-266">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-267">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-267">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberSignature Language="F#" Value="member this.Clear : unit -&gt; unit" Usage="eventLog.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-268">Removes all entries from the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-268">Removes all entries from the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-269">Journaux des événements sont définies avec une taille maximale qui détermine le nombre d’entrées qu’ils peuvent contenir.</span><span class="sxs-lookup"><span data-stu-id="bc382-269">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="bc382-270">Lorsqu’un journal des événements est plein, il arrête l’enregistrement de nouvelles informations d’événement ou commence à remplacer les entrées précédentes.</span><span class="sxs-lookup"><span data-stu-id="bc382-270">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="bc382-271">Si l’enregistrement d’événements s’arrête, vous pouvez utiliser cette méthode pour effacer le journal des entrées existantes et l’autoriser à nouveau de démarrer l’enregistrement des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-271">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="bc382-272">Vous devez disposer des autorisations d’administrateur sur l’ordinateur sur lequel se trouve le journal pour effacer des entrées de journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-272">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="bc382-273"><xref:System.Diagnostics.EventLog.Clear%2A> ferme le journal des événements, libère les handles d’événement, récupère de nouveaux lire et écrire des handles et rouvre le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-273"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="bc382-274">Les événements reçus après l’appel à la méthode ne sont pas effacés, ainsi que les événements existants.</span><span class="sxs-lookup"><span data-stu-id="bc382-274">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-275">L’exemple suivant efface un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-275">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="bc382-276">Étant donné que l’Application, système, sécurité et autres journaux non personnalisés peut contenir des informations fondamentales ; Veillez à spécifier un journal personnalisé avant d’exécuter cet exemple de code.</span><span class="sxs-lookup"><span data-stu-id="bc382-276">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="bc382-277">Cet exemple supprime le journal personnalisé `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-277">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-278">The event log was not cleared successfully.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-278">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="bc382-279">-or-  The log cannot be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-279">-or-  The log cannot be opened.</span>
          </span>
          <span data-ttu-id="bc382-280">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-280">A Windows error code is not available.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-281">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-281">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span>
          </span>
          <span data-ttu-id="bc382-282">Make sure the log name is not an empty string.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-282">Make sure the log name is not an empty string.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-283">The log does not exist.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-283">The log does not exist.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-284">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-284">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-285">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-285">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="eventLog.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-286">Closes the event log and releases read and write handles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-286">Closes the event log and releases read and write handles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-287">Le <xref:System.Diagnostics.EventLog.Close%2A> méthode est appelée par la méthode protégée <xref:System.ComponentModel.Component.Dispose%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-287">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="bc382-288">Vous n’avez pas besoin d’appeler <xref:System.Diagnostics.EventLog.Close%2A> avant d’appeler <xref:System.ComponentModel.Component.Dispose%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-288">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-289">The event log's read handle or write handle was not released successfully.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-289">The event log's read handle or write handle was not released successfully.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-290">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-290">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-291">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-291">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-292">Establishes an application as able to write event information to a particular log on the system.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-292">Establishes an application as able to write event information to a particular log on the system.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : System.Diagnostics.EventSourceCreationData -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource sourceData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" />
      </Parameters>
      <Docs>
        <param name="sourceData">
          <span data-ttu-id="bc382-293">The configuration properties for the event source and its target event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-293">The configuration properties for the event source and its target event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-294">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-294">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-295">Utilisez cette surcharge pour configurer une nouvelle source pour écrire des entrées dans un journal des événements sur l’ordinateur local ou un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="bc382-295">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="bc382-296">Il n’est pas nécessaire d’utiliser cette méthode pour lire à partir d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-296">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="bc382-297">Le <xref:System.Diagnostics.EventLog.CreateEventSource%2A> méthode utilise l’entrée `sourceData` <xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> et <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> propriétés afin de créer des valeurs de Registre sur l’ordinateur cible pour la nouvelle source et son journal des événements associé.</span><span class="sxs-lookup"><span data-stu-id="bc382-297">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="bc382-298">Un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existants sur l’ordinateur cible.</span><span class="sxs-lookup"><span data-stu-id="bc382-298">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="bc382-299">Si le <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> propriété n’est pas définie, la source est inscrite pour le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-299">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="bc382-300">Si le <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> n’est pas défini, la source est inscrite sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-300">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-301">Pour créer une source d’événements dans Windows Vista et versions ultérieures ou sur Windows Server 2003, vous devez disposer des privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-301">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="bc382-302">La raison de cette exigence est que tous les journaux des événements, y compris la sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-302">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-303">À compter de Windows Vista, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-303">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="bc382-304">À compter de Windows Vista, le contrôle de compte d’utilisateur (UAC) détermine les privilèges d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-304">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-305">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-305">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-306">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-306">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-307">Pour exécuter le code qui accède au journal de sécurité, vous devez d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-307">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-308">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-308">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="bc382-309">Utilisez <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-309">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="bc382-310">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-310">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-311">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-311">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-312">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-312">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-313">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-313">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-314">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-314">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-315">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-315">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-316">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-316">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="bc382-317">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-317">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="bc382-318">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bc382-318">The operating system stores event logs as files.</span></span> <span data-ttu-id="bc382-319">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-319">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="bc382-320">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventLog.Log%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="bc382-320">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="bc382-321">Chaque source ne peut écrire qu’un seul journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-321">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="bc382-322">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="bc382-322">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="bc382-323">Vous pouvez inscrire la source d’événements avec les fichiers de ressources localisés pour vos chaînes de catégorie et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-323">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="bc382-324">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources, au lieu de spécifier la chaîne réelle.</span><span class="sxs-lookup"><span data-stu-id="bc382-324">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="bc382-325">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource localisée selon les paramètres de langue actuels.</span><span class="sxs-lookup"><span data-stu-id="bc382-325">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="bc382-326">Vous pouvez enregistrer un fichier distinct pour les catégories d’événements, les messages et les chaînes d’insertion de paramètre, ou vous pouvez inscrire le même fichier de ressources pour les trois types de chaînes.</span><span class="sxs-lookup"><span data-stu-id="bc382-326">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="bc382-327">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, et <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> propriétés pour configurer la source pour écrire des entrées localisées dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-327">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="bc382-328">Si votre application écrit les valeurs des chaînes directement dans le journal des événements, il est inutile de définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="bc382-328">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="bc382-329">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-329">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-330">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-330">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-331">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-331">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-332">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-332">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="bc382-333">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-333">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="bc382-334">Si d’autres applications ou composants utilisent la source existante, créer une nouvelle source avec la configuration mise à jour, plutôt que de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="bc382-334">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-335">Si une source est configurée pour un journal des événements, et que vous reconfigurez pour un autre journal des événements, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-335">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-336">L’exemple suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-336">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="bc382-337">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-337">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="bc382-338">Enfin, l’exemple définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="bc382-338">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="bc382-339">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-339">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-340">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-340">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-341">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-341">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="bc382-342">Plus précisément, l’identificateur de ressource 5001 est défini pour le nom localisé du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-342">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-343">The computer name specified in <paramref name="sourceData" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-343">The computer name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-344">\- or -  The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-344">\- or -  The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-345">\- or -  The log name specified in <paramref name="sourceData" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-345">\- or -  The log name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-346">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-346">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="bc382-347">\- or -  The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-347">\- or -  The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="bc382-348">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-348">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="bc382-349">\- or -  The log name matches an existing event source name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-349">\- or -  The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="bc382-350">\- or -  The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-350">\- or -  The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="bc382-351">\- or -  The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-351">\- or -  The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span>
          </span>
          <span data-ttu-id="bc382-352">\- or -  The source name specified in <paramref name="sourceData" /> is already registered.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-352">\- or -  The source name specified in <paramref name="sourceData" /> is already registered.</span>
          </span>
          <span data-ttu-id="bc382-353">\- or -  The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-353">\- or -  The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-354">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-354">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-355">
            <paramref name="sourceData" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-355">
              <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-356">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-356">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-357">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-357">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-358">The source name by which the application is registered on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-358">The source name by which the application is registered on the local computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="bc382-359">The name of the log the source's entries are written to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-359">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="bc382-360">Possible values include Application, System, or a custom event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-360">Possible values include Application, System, or a custom event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-361">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-361">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span>
          </span>
          <span data-ttu-id="bc382-362">This method can also create a new custom log on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-362">This method can also create a new custom log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-363">Utilisez cette surcharge pour créer un journal personnalisé ou pour créer et inscrire un <xref:System.Diagnostics.EventLog.Source%2A> dans un journal existant sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-363">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="bc382-364">Si `logName` est `null` ou une chaîne vide (" ») lorsque vous appelez <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-364">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="bc382-365">Si le journal n’existe pas sur l’ordinateur local, le système crée un journal personnalisé et inscrit votre application comme une <xref:System.Diagnostics.EventLog.Source%2A> de ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-365">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-366">Pour créer une source d’événements dans Windows Vista et versions ultérieures ou sur Windows Server 2003, vous devez disposer des privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-366">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="bc382-367">La raison de cette exigence est que tous les journaux des événements, y compris la sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-367">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-368">À compter de Windows Vista, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-368">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="bc382-369">Dans Windows Vista et version ultérieure, le contrôle de compte d'utilisateur détermine les privilèges d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-369">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-370">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-370">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-371">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-371">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-372">Pour exécuter le code qui accède au journal de sécurité, vous devez d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-372">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-373">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-373">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="bc382-374">Vous devez uniquement créer une source d’événements si vous écrivez dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-374">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="bc382-375">Avant d’écrire une entrée dans un journal des événements, vous devez inscrire la source d’événements avec le journal des événements comme source valide d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-375">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="bc382-376">Lorsque vous écrivez une entrée de journal, le système utilise le <xref:System.Diagnostics.EventLog.Source%2A> pour trouver le journal approprié dans lequel placer votre entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-376">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="bc382-377">Si vous lisez le journal des événements, vous pouvez spécifier le <xref:System.Diagnostics.EventLog.Source%2A>, ou un <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-377">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-378">Vous n’êtes pas obligé de spécifier le <xref:System.Diagnostics.EventLog.MachineName%2A> si vous vous connectez à un journal sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-378">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="bc382-379">Si vous ne spécifiez pas le <xref:System.Diagnostics.EventLog.MachineName%2A> lors de la lecture à partir d’un journal de l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-379">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-380">Utilisez <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-380">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="bc382-381">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-381">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-382">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-382">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-383">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-383">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-384">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-384">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-385">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-385">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-386">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-386">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-387">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-387">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="bc382-388">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-388">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="bc382-389">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bc382-389">The operating system stores event logs as files.</span></span> <span data-ttu-id="bc382-390">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-390">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="bc382-391">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventLog.Log%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="bc382-391">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="bc382-392">La source doit être unique sur l’ordinateur local ; un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="bc382-392">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="bc382-393">Chaque source peut écrire qu’un seul journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-393">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="bc382-394">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="bc382-394">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="bc382-395">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-395">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-396">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-396">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-397">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-397">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-398">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-398">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="bc382-399">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-399">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="bc382-400">Si d’autres applications ou composants utilisent la source existante, créer une nouvelle source avec la configuration mise à jour, plutôt que de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="bc382-400">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-401">Si une source a déjà été mappée à un journal et vous remappez à un nouveau journal, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-401">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-402">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-402">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-403">
            <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-403">
              <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-404">\- or -  <paramref name="logName" /> is not a valid event log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-404">\- or -  <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="bc382-405">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-405">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="bc382-406">\- or -  <paramref name="logName" /> is not valid for user log creation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-406">\- or -  <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="bc382-407">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-407">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="bc382-408">\- or -  The log name matches an existing event source name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-408">\- or -  The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="bc382-409">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-409">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="bc382-410">\- or -  The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-410">\- or -  The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span>
          </span>
          <span data-ttu-id="bc382-411">\- or -  The source cannot be registered because it already exists on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-411">\- or -  The source cannot be registered because it already exists on the local computer.</span>
          </span>
          <span data-ttu-id="bc382-412">\- or -  The source name matches an existing event log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-412">\- or -  The source name matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-413">The registry key for the event log could not be opened on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-413">The registry key for the event log could not be opened on the local computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-414">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-414">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-415">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-415">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-416">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-416">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="bc382-417">The name of the log the source's entries are written to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-417">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="bc382-418">Possible values include Application, System, or a custom event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-418">Possible values include Application, System, or a custom event log.</span>
          </span>
          <span data-ttu-id="bc382-419">If you do not specify a value, <c>logName</c> defaults to Application.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-419">If you do not specify a value, <c>logName</c> defaults to Application.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-420">The name of the computer to register this event source with, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-420">The name of the computer to register this event source with, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-421">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-421">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span>
          </span>
          <span data-ttu-id="bc382-422">This method can also be used to create a new custom log on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-422">This method can also be used to create a new custom log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-423">Utilisez cette surcharge pour créer un journal personnalisé ou pour créer et inscrire un <xref:System.Diagnostics.EventLog.Source%2A> dans un journal existant sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-423">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="bc382-424">Si `logName` est `null` ou une chaîne vide (" ») lorsque vous appelez <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-424">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="bc382-425">Si le journal n’existe pas sur l’ordinateur spécifié, le système crée un journal personnalisé et inscrit votre application comme une <xref:System.Diagnostics.EventLog.Source%2A> de ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-425">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="bc382-426">Vous devez uniquement créer une source d’événements si vous écrivez dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-426">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="bc382-427">Avant d’écrire une entrée dans un journal des événements, vous devez inscrire la source d’événements avec le journal des événements comme source valide d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-427">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="bc382-428">Lorsque vous écrivez une entrée de journal, le système utilise le <xref:System.Diagnostics.EventLog.Source%2A> pour trouver le journal approprié dans lequel placer votre entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-428">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="bc382-429">Si vous lisez le journal des événements, vous pouvez spécifier le <xref:System.Diagnostics.EventLog.Source%2A>, ou un <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-429">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-430">Pour créer une source d’événements dans Windows Vista et versions ultérieures ou sur Windows Server 2003, vous devez disposer des privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-430">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="bc382-431">La raison de cette exigence est que tous les journaux des événements, y compris la sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-431">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-432">Dans Windows Vista et versions ultérieures, les utilisateurs ne peuvent pas accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-432">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="bc382-433">Dans Windows Vista et version ultérieure, le contrôle de compte d'utilisateur détermine les privilèges d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-433">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-434">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-434">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-435">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-435">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-436">Pour exécuter le code qui accède au journal de sécurité, vous devez d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-436">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-437">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-437">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="bc382-438">Utilisez <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-438">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="bc382-439">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-439">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-440">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-440">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-441">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-441">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-442">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-442">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-443">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-443">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-444">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-444">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-445">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-445">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="bc382-446">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-446">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="bc382-447">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bc382-447">The operating system stores event logs as files.</span></span> <span data-ttu-id="bc382-448">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-448">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="bc382-449">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventLog.Log%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="bc382-449">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="bc382-450">La source doit être unique sur l’ordinateur local ; un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="bc382-450">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="bc382-451">Chaque source peut écrire qu’un seul journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-451">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="bc382-452">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="bc382-452">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="bc382-453">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-453">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-454">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-454">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-455">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-455">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-456">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-456">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="bc382-457">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-457">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="bc382-458">Si d’autres applications ou composants utilisent la source existante, créer une nouvelle source avec la configuration mise à jour, plutôt que de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="bc382-458">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-459">Si une source a déjà été mappée à un journal et vous remappez à un nouveau journal, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-459">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-460">L’exemple suivant crée la source de `MySource` sur l’ordinateur `MyServer`et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-460">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-461">The <paramref name="machineName" /> is not a valid computer name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-461">The <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
          <span data-ttu-id="bc382-462">\- or -  <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-462">\- or -  <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-463">\- or -  <paramref name="logName" /> is not a valid event log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-463">\- or -  <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="bc382-464">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-464">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="bc382-465">\- or -  <paramref name="logName" /> is not valid for user log creation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-465">\- or -  <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="bc382-466">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-466">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="bc382-467">\- or -  The log name matches an existing event source name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-467">\- or -  The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="bc382-468">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-468">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="bc382-469">\- or -  The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-469">\- or -  The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span>
          </span>
          <span data-ttu-id="bc382-470">\- or -  The source cannot be registered because it already exists on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-470">\- or -  The source cannot be registered because it already exists on the specified computer.</span>
          </span>
          <span data-ttu-id="bc382-471">\- or -  The source name matches an existing event source name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-471">\- or -  The source name matches an existing event source name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-472">The registry key for the event log could not be opened on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-472">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-473">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-473">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-474">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-474">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-475">Removes a log resource.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-475">Removes a log resource.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-476">The name of the log to delete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-476">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="bc382-477">Possible values include: Application, Security, System, and any custom event logs on the computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-477">Possible values include: Application, Security, System, and any custom event logs on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-478">Removes an event log from the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-478">Removes an event log from the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-479">Utilisez cette méthode lorsque le journal que vous souhaitez supprimer est sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-479">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="bc382-480">Vous pouvez supprimer n’importe quel journal sur l’ordinateur, si vous disposez des autorisations de Registre appropriées.</span><span class="sxs-lookup"><span data-stu-id="bc382-480">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="bc382-481"><xref:System.Diagnostics.EventLog.Delete%2A> Supprime le journal spécifié par `logName` à partir de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-481"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="bc382-482">Si vous souhaitez supprimer uniquement la source inscrite dans un journal, appelez <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-482">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="bc382-483">Si vous souhaitez uniquement supprimer les entrées de journal, appelez <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-483">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="bc382-484"><xref:System.Diagnostics.EventLog.Delete%2A> et <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> sont `static` méthodes, peuvent donc être appelés sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-484"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="bc382-485">Il n’est pas nécessaire de créer une nouvelle instance de <xref:System.Diagnostics.EventLog> pour appeler une méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-485">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="bc382-486">Le <xref:System.Diagnostics.EventLog.Delete%2A> méthode supprime tout d’abord le fichier qui contient le contenu du journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-486">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="bc382-487">Ensuite, il accède au Registre et supprime toutes les sources d’événements inscrites pour ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-487">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="bc382-488">Si vous recréez le journal à un moment ultérieur, vous devez inscrire les sources d’événements, s’ils doivent être réutilisés.</span><span class="sxs-lookup"><span data-stu-id="bc382-488">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="bc382-489">Si vous n’enregistrez pas les sources d’événements et d’autres utilisateurs écrivent dans une source d’événement sans spécifier un nom de journal, la source d’événements est créée dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-489">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="bc382-490">Par conséquent, les applications qui pouvaient précédemment écrire des entrées dans le journal que vous avez supprimé et recréé écrit dans le journal des applications à la place, car il contient maintenant la source d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-490">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-491">Recréation d’un journal des événements peut être difficile.</span><span class="sxs-lookup"><span data-stu-id="bc382-491">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="bc382-492">Évitez de supprimer les journaux des événements de créé par le système, telles que le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-492">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="bc382-493">Suppression d’un journal par un appel à <xref:System.Diagnostics.EventLog.Delete%2A> supprime automatiquement les sources inscrites dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-493">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="bc382-494">Cela peut rendre d’autres applications à l’aide de ce journal inopérantes.</span><span class="sxs-lookup"><span data-stu-id="bc382-494">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-495">L’exemple suivant supprime un journal de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-495">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="bc382-496">L’exemple détermine le journal à partir de sa source.</span><span class="sxs-lookup"><span data-stu-id="bc382-496">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-497">Plusieurs sources peuvent écrire dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-497">More than one source might write to an event log.</span></span> <span data-ttu-id="bc382-498">Avant de supprimer un journal personnalisé, assurez-vous qu’aucune source de l’écriture dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-498">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-499">
            <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-499">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-500">The registry key for the event log could not be opened on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-500">The registry key for the event log could not be opened on the local computer.</span>
          </span>
          <span data-ttu-id="bc382-501">\- or -  The log does not exist on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-501">\- or -  The log does not exist on the local computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-502">The event log was not cleared successfully.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-502">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="bc382-503">-or-  The log cannot be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-503">-or-  The log cannot be opened.</span>
          </span>
          <span data-ttu-id="bc382-504">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-504">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-505">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-505">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-506">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-506">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Delete : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-507">The name of the log to delete.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-507">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="bc382-508">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-508">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-509">The name of the computer to delete the log from, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-509">The name of the computer to delete the log from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-510">Removes an event log from the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-510">Removes an event log from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-511">Utilisez cette méthode lorsque le journal que vous souhaitez supprimer est sur un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="bc382-511">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="bc382-512">Vous pouvez supprimer n’importe quel journal sur l’ordinateur, si vous disposez des autorisations de Registre appropriées.</span><span class="sxs-lookup"><span data-stu-id="bc382-512">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="bc382-513"><xref:System.Diagnostics.EventLog.Delete%2A> Supprime le journal spécifié par `logName` à partir de l’ordinateur spécifié par `machineName`.</span><span class="sxs-lookup"><span data-stu-id="bc382-513"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="bc382-514">Si vous souhaitez supprimer uniquement la source inscrite dans un journal, appelez <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-514">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="bc382-515">Si vous souhaitez uniquement supprimer les entrées de journal, appelez <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-515">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="bc382-516"><xref:System.Diagnostics.EventLog.Delete%2A> et <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> sont `static` méthodes, peuvent donc être appelés sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-516"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="bc382-517">Il n’est pas nécessaire de créer une instance de <xref:System.Diagnostics.EventLog> pour appeler une méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-517">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="bc382-518">Cette méthode supprime tout d’abord le fichier qui contient le contenu du journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-518">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="bc382-519">Ensuite, il accède au Registre et supprime toutes les sources d’événements inscrites pour ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-519">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="bc382-520">Si vous recréez le journal à un moment ultérieur, vous devez inscrire les sources d’événements, s’ils doivent être réutilisés.</span><span class="sxs-lookup"><span data-stu-id="bc382-520">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="bc382-521">Si vous n’enregistrez pas les sources d’événements et d’autres utilisateurs écrivent dans une source d’événement sans spécifier un nom de journal, la source d’événements est créée dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-521">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="bc382-522">Par conséquent, les applications qui pouvaient précédemment écrire des entrées dans le journal que vous avez supprimé et recréé écrit dans le journal des applications à la place, car il contient maintenant la source d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-522">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-523">Recréation d’un journal des événements peut être difficile.</span><span class="sxs-lookup"><span data-stu-id="bc382-523">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="bc382-524">Évitez de supprimer les journaux des événements de créé par le système, telles que le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-524">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="bc382-525">Suppression d’un journal par un appel à <xref:System.Diagnostics.EventLog.Delete%2A> supprime automatiquement les sources inscrites dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-525">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="bc382-526">Cela peut rendre d’autres applications à l’aide de ce journal inopérantes.</span><span class="sxs-lookup"><span data-stu-id="bc382-526">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-527">L’exemple suivant supprime un journal de l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-527">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="bc382-528">L’exemple détermine le journal à partir de sa source.</span><span class="sxs-lookup"><span data-stu-id="bc382-528">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-529">Plusieurs sources peuvent écrire dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-529">More than one source might write to an event log.</span></span> <span data-ttu-id="bc382-530">Avant de supprimer un journal personnalisé, assurez-vous qu’aucune source de l’écriture dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-530">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-531">
            <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-531">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-532">\- or -  <paramref name="machineName" /> is not a valid computer name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-532">\- or -  <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-533">The registry key for the event log could not be opened on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-533">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
          <span data-ttu-id="bc382-534">\- or -  The log does not exist on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-534">\- or -  The log does not exist on the specified computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-535">The event log was not cleared successfully.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-535">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="bc382-536">-or-  The log cannot be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-536">-or-  The log cannot be opened.</span>
          </span>
          <span data-ttu-id="bc382-537">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-537">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-538">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-538">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-539">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-539">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-540">Removes an application's event source registration from the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-540">Removes an application's event source registration from the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-541">The name by which the application is registered in the event log system.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-541">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-542">Removes the event source registration from the event log of the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-542">Removes the event source registration from the event log of the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-543">Utilisez cette méthode pour supprimer l’inscription d’un <xref:System.Diagnostics.EventLog.Source%2A> à partir de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-543">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="bc382-544"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accède au Registre sur l’ordinateur local et supprime l’inscription de votre application en tant que source d’événements valide.</span><span class="sxs-lookup"><span data-stu-id="bc382-544"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="bc382-545">Si vous n’avez plus besoin d’écrire des entrées dans ce journal, vous pouvez supprimer votre composant comme source d’événements valide.</span><span class="sxs-lookup"><span data-stu-id="bc382-545">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="bc382-546">Par exemple, vous pouvez effectuer cela si vous devez modifier votre composant à partir d’un journal à l’autre.</span><span class="sxs-lookup"><span data-stu-id="bc382-546">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="bc382-547">Car une source peut uniquement être enregistrée dans un journal à la fois, changez le journal, vous devez supprimer l’enregistrement en cours.</span><span class="sxs-lookup"><span data-stu-id="bc382-547">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="bc382-548"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> Supprime uniquement la source inscrite dans un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-548"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="bc382-549">Si vous souhaitez supprimer le journal lui-même, appelez <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-549">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="bc382-550">Si vous souhaitez uniquement supprimer les entrées de journal, appelez <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-550">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="bc382-551"><xref:System.Diagnostics.EventLog.Delete%2A> et <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> sont `static` méthodes, peuvent donc être appelés sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-551"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="bc382-552">Il n’est pas nécessaire de créer une instance de <xref:System.Diagnostics.EventLog> pour appeler une méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-552">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="bc382-553">Suppression d’un journal par un appel à <xref:System.Diagnostics.EventLog.Delete%2A> supprime automatiquement les sources inscrites dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="bc382-554">Cela peut rendre d’autres applications à l’aide de ce journal inopérantes.</span><span class="sxs-lookup"><span data-stu-id="bc382-554">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-555">Si une source a déjà été mappée à un journal et vous remappez à un nouveau journal, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-555">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-556">L’exemple suivant supprime une source de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-556">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="bc382-557">L’exemple détermine le journal à partir de sa source, puis supprime le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-557">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-558">Plusieurs sources peuvent écrire dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-558">More than one source might write to an event log.</span></span> <span data-ttu-id="bc382-559">Avant de supprimer un journal personnalisé, assurez-vous qu’aucune source de l’écriture dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-559">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-560">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-560">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span>
          </span>
          <span data-ttu-id="bc382-561">\- or -  You do not have write access on the registry key for the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-561">\- or -  You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-562">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-562">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-563">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-563">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-564">The name by which the application is registered in the event log system.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-564">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-565">The name of the computer to remove the registration from, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-565">The name of the computer to remove the registration from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-566">Removes the application's event source registration from the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-566">Removes the application's event source registration from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-567">Utilisez cette surcharge pour supprimer l’inscription d’un <xref:System.Diagnostics.EventLog.Source%2A> à partir d’un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="bc382-567">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="bc382-568"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accède au Registre sur l’ordinateur spécifié par `machineName` et supprime l’inscription de votre application comme une source valide d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-568"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="bc382-569">Si vous n’avez plus besoin d’écrire des entrées dans ce journal, vous pouvez supprimer votre composant comme source d’événements valide.</span><span class="sxs-lookup"><span data-stu-id="bc382-569">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="bc382-570">Par exemple, vous pouvez effectuer cela si vous devez modifier votre composant à partir d’un journal à l’autre.</span><span class="sxs-lookup"><span data-stu-id="bc382-570">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="bc382-571">Car une source peut uniquement être enregistrée dans un journal à la fois, changez le journal, vous devez supprimer l’enregistrement en cours.</span><span class="sxs-lookup"><span data-stu-id="bc382-571">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="bc382-572"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> Supprime uniquement la source inscrite dans un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-572"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="bc382-573">Si vous souhaitez supprimer le journal lui-même, appelez <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-573">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="bc382-574">Si vous souhaitez uniquement supprimer les entrées de journal, appelez <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-574">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="bc382-575"><xref:System.Diagnostics.EventLog.Delete%2A> et <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> sont `static` méthodes, peuvent donc être appelés sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-575"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="bc382-576">Il n’est pas nécessaire de créer une instance de <xref:System.Diagnostics.EventLog> pour appeler une méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-576">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="bc382-577">Suppression d’un journal par un appel à <xref:System.Diagnostics.EventLog.Delete%2A> supprime automatiquement les sources inscrites dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-577">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="bc382-578">Cela peut rendre d’autres applications à l’aide de ce journal inopérantes.</span><span class="sxs-lookup"><span data-stu-id="bc382-578">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-579">Si une source a déjà été mappée à un journal et vous remappez à un nouveau journal, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-579">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-580">L’exemple suivant supprime une source de l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-580">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="bc382-581">L’exemple détermine le journal à partir de sa source, puis supprime le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-581">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-582">Plusieurs sources peuvent écrire dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-582">More than one source might write to an event log.</span></span> <span data-ttu-id="bc382-583">Avant de supprimer un journal personnalisé, assurez-vous qu’aucune source de l’écriture dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-583">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-584">The <paramref name="machineName" /> parameter is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-584">The <paramref name="machineName" /> parameter is invalid.</span>
          </span>
          <span data-ttu-id="bc382-585">\- or -  The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-585">\- or -  The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span>
          </span>
          <span data-ttu-id="bc382-586">\- or -  You do not have write access on the registry key for the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-586">\- or -  You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-587">
            <paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-587">
              <paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-588">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-588">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-589">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-589">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="bc382-590">
            <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-590">
              <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-591">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-591">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-592">Cette méthode est appelée par le public `Dispose()` (méthode) et le <xref:System.Object.Finalize%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-592">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="bc382-593">`Dispose()` appelle la méthode protégée `Dispose(Boolean)` méthode avec la `disposing` paramètre la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="bc382-593">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="bc382-594"><xref:System.Object.Finalize%2A> appelle `Dispose` avec `disposing` la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="bc382-594"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="bc382-595">Lorsque le `disposing` paramètre a la valeur true, cette méthode libère toutes les ressources détenues par les objets managés référencés par ce <xref:System.Diagnostics.EventLog> références.</span><span class="sxs-lookup"><span data-stu-id="bc382-595">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="bc382-596">Cette méthode appelle la méthode `Dispose()` de chaque objet référencé.</span><span class="sxs-lookup"><span data-stu-id="bc382-596">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <span data-ttu-id="bc382-597">
            <para>
              <see langword="Dispose" /> peut être appelée plusieurs fois par d’autres objets. Lors de la substitution <see langword="Dispose(Boolean)" /> veillez à ne pas référencer des objets qui ont été supprimés lors d’un appel précédent à <see langword="Dispose" />. Pour plus d’informations sur l’implémentation <see langword="Dispose(Boolean)" />, consultez [implémentation d’un Method](~/docs/standard/garbage-collection/implementing-dispose.md) de suppression.  Pour plus d’informations sur <see langword="Dispose" /> et <see cref="M:System.Object.Finalize" />, consultez [nettoyage de non managé Resources](~/docs/standard/garbage-collection/unmanaged.md).</para>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-597">
              <para>
                <see langword="Dispose" /> can be called multiple times by other objects. When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />. For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).  For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</para>
            </span>
          </span>
        </block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableRaisingEvents : bool with get, set" Usage="System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-598">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-598">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-599">
            <see langword="true" /> si <see cref="T:System.Diagnostics.EventLog" /> reçoit la notification quand une entrée est écrite dans le journal ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-599">
              <see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-600">Le <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> propriété détermine si le <xref:System.Diagnostics.EventLog> déclenche des événements lorsque les entrées sont écrites dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-600">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="bc382-601">Lorsque la propriété est `true`, les composants qui reçoivent le <xref:System.Diagnostics.EventLog.EntryWritten> événement recevront une notification chaque fois qu’une entrée est écrite dans le journal qui est spécifié dans le <xref:System.Diagnostics.EventLog.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="bc382-601">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="bc382-602">Si <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> est `false`, aucun événement est déclenché.</span><span class="sxs-lookup"><span data-stu-id="bc382-602">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-603">Vous pouvez recevoir des notifications d’événements uniquement lorsque les entrées sont écrites sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-603">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="bc382-604">Vous ne pouvez pas recevoir des notifications pour les entrées écrites sur des ordinateurs distants.</span><span class="sxs-lookup"><span data-stu-id="bc382-604">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-605">L’exemple suivant gère un <xref:System.Diagnostics.EventLog.EntryWritten> événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-605">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-606">The event log is on a remote computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-606">The event log is on a remote computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-607">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-607">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-608">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-608">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberSignature Language="F#" Value="abstract member EndInit : unit -&gt; unit&#xA;override this.EndInit : unit -&gt; unit" Usage="eventLog.EndInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-609">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-609">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span>
          </span>
          <span data-ttu-id="bc382-610">The initialization occurs at runtime.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-610">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-611">Le [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] environnement utilise cette méthode pour terminer l’initialisation d’un composant utilisé dans un formulaire ou par un autre composant de conception.</span><span class="sxs-lookup"><span data-stu-id="bc382-611">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="bc382-612">Le <xref:System.Diagnostics.EventLog.BeginInit%2A> méthode démarre l’initialisation.</span><span class="sxs-lookup"><span data-stu-id="bc382-612">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="bc382-613">À l’aide de la <xref:System.Diagnostics.EventLog.BeginInit%2A> et <xref:System.Diagnostics.EventLog.EndInit%2A> méthodes empêche le contrôle avant son initialisation complète.</span><span class="sxs-lookup"><span data-stu-id="bc382-613">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-614">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-614">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-615">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-615">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Entries : System.Diagnostics.EventLogEntryCollection" Usage="System.Diagnostics.EventLog.Entries" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-616">Gets the contents of the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-616">Gets the contents of the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-617">
            <see cref="T:System.Diagnostics.EventLogEntryCollection" /> contenant les entrées dans le journal des événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-617">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span>
          </span>
          <span data-ttu-id="bc382-618">Chaque entrée est associée à une instance de la classe <see cref="T:System.Diagnostics.EventLogEntry" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-618">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-619">Utilisez le <xref:System.Diagnostics.EventLog.Entries%2A> membre lors de la lecture du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-619">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="bc382-620">Étant donné que la propriété est en lecture seule, vous ne peut pas modifier une entrée ou écrire dans le journal à l’aide de <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-620">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="bc382-621">Au lieu de cela, spécifiez un <xref:System.Diagnostics.EventLog.Source%2A> et appelez <xref:System.Diagnostics.EventLog.WriteEntry%2A> pour écrire une nouvelle entrée de journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-621">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="bc382-622">Vous pouvez utiliser <xref:System.Diagnostics.EventLog.Entries%2A> pour compter le nombre d’entrées dans le journal des événements et afficher chaque <xref:System.Diagnostics.EventLogEntry> dans la collection.</span><span class="sxs-lookup"><span data-stu-id="bc382-622">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="bc382-623">Utilisez indexés <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> membre pour récupérer des informations sur une entrée spécifique, tel que <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, ou <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-623">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="bc382-624">Il n’est pas nécessaire de spécifier un <xref:System.Diagnostics.EventLog.Source%2A> lors de la lecture à partir d’un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-624">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="bc382-625">Vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> nom et <xref:System.Diagnostics.EventLog.MachineName%2A> propriétés (nom de l’ordinateur serveur) pour le <xref:System.Diagnostics.EventLog> instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-625">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="bc382-626">Dans les deux cas, le <xref:System.Diagnostics.EventLog.Entries%2A> membres est automatiquement rempli avec liste du journal des événements des entrées.</span><span class="sxs-lookup"><span data-stu-id="bc382-626">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="bc382-627">Vous pouvez sélectionner l’index approprié pour un élément dans cette liste pour lire les entrées individuelles.</span><span class="sxs-lookup"><span data-stu-id="bc382-627">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="bc382-628">Une distinction importante entre lecture et écriture des entrées de journal est qu’il n’est pas nécessaire d’appeler explicitement une méthode de lecture.</span><span class="sxs-lookup"><span data-stu-id="bc382-628">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="bc382-629">Après le <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A> sont spécifiés, le <xref:System.Diagnostics.EventLog.Entries%2A> propriété est remplie automatiquement.</span><span class="sxs-lookup"><span data-stu-id="bc382-629">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="bc382-630">Si vous modifiez la valeur de la <xref:System.Diagnostics.EventLog.Log%2A> ou <xref:System.Diagnostics.EventLog.MachineName%2A> propriété, le <xref:System.Diagnostics.EventLog.Entries%2A> propriété est rempli à nouveau la prochaine fois que vous les ayez lues.</span><span class="sxs-lookup"><span data-stu-id="bc382-630">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-631">Vous n’êtes pas obligé de spécifier le <xref:System.Diagnostics.EventLog.MachineName%2A> si vous vous connectez à un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-631">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="bc382-632">Si vous ne spécifiez pas le <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local, «. », est utilisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-632">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-633">L’exemple suivant lit les entrées dans le journal des événements, « MyNewLog », sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-633">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-634">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-634">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-635">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-635">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberSignature Language="F#" Value="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " Usage="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-636">Occurs when an entry is written to an event log on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-636">Occurs when an entry is written to an event log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-637">Pour obtenir des notifications d’événements, vous devez définir <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> à `true`.</span><span class="sxs-lookup"><span data-stu-id="bc382-637">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="bc382-638">Vous pouvez uniquement recevoir des notifications d’événements lorsque les entrées sont écrites sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-638">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="bc382-639">Vous ne pouvez pas recevoir des notifications pour les entrées écrites sur des ordinateurs distants.</span><span class="sxs-lookup"><span data-stu-id="bc382-639">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="bc382-640">Lorsque vous créez un délégué <xref:System.Diagnostics.EventLog.EntryWritten>, vous identifiez la méthode qui gérera l'événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-640">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="bc382-641">Pour associer l'événement au gestionnaire d'événements, ajoutez une instance du délégué à l'événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-641">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="bc382-642">Le Gestionnaire d’événements est appelé chaque fois que l’événement se produit, jusqu'à ce que vous supprimez le délégué.</span><span class="sxs-lookup"><span data-stu-id="bc382-642">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="bc382-643">Pour plus d’informations sur la gestion des événements avec des délégués, consultez [gestion et déclenchement d’événements](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="bc382-643">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="bc382-644">Le système répond à <xref:System.Diagnostics.EventLog.WriteEntry%2A> uniquement si le dernier événement d’écriture s’est produite au moins six secondes.</span><span class="sxs-lookup"><span data-stu-id="bc382-644">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="bc382-645">Cela implique que vous recevez uniquement un <xref:System.Diagnostics.EventLog.EntryWritten> notification d’événement dans un intervalle de six secondes, même si plusieurs événements journal modification se produit.</span><span class="sxs-lookup"><span data-stu-id="bc382-645">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="bc382-646">Si vous insérez un intervalle de mise en veille suffisamment long (environ 10 secondes) entre les appels à <xref:System.Diagnostics.EventLog.WriteEntry%2A>, vous êtes moins enclin à manquer un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-646">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="bc382-647">Toutefois, si les événements d’écriture se produisent plus fréquemment, vous ne pouvez pas recevoir la notification d’événement jusqu’au prochain intervalle.</span><span class="sxs-lookup"><span data-stu-id="bc382-647">However, if write events occur more frequently, you might not recieve the event notification until the next interval.</span></span> <span data-ttu-id="bc382-648">En règle générale, notifications d’événements manquées ne sont pas perdues, mais différées.</span><span class="sxs-lookup"><span data-stu-id="bc382-648">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-649">L’exemple suivant gère un événement EntryWritten.</span><span class="sxs-lookup"><span data-stu-id="bc382-649">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-650">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-650">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-651">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-651">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-652">Determines whether the specified log exists.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-652">Determines whether the specified log exists.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-653">The name of the log to search for.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-653">The name of the log to search for.</span>
          </span>
          <span data-ttu-id="bc382-654">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-654">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-655">Determines whether the log exists on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-655">Determines whether the log exists on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-656">
            <see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-656">
              <see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-657">Utilisez cette méthode pour déterminer si un journal existe sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-657">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="bc382-658">Si vous souhaitez déterminer si une source existe sur l’ordinateur local, utilisez <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-658">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="bc382-659">Étant donné que cette méthode accède au Registre, vous devez disposer des autorisations de Registre appropriées sur l’ordinateur local ; Sinon, la requête retourne `false`.</span><span class="sxs-lookup"><span data-stu-id="bc382-659">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="bc382-660">Étant donné que vous ne pouvez pas donner à un nouveau journal le nom d’un journal existant sur le même ordinateur, utilisez cette méthode avant de créer un nouveau journal pour déterminer si le texte spécifié `logName` existe déjà sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-660">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="bc382-661">Le `logName` paramètre n’est pas la casse.</span><span class="sxs-lookup"><span data-stu-id="bc382-661">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="bc382-662"><xref:System.Diagnostics.EventLog.Exists%2A> est un `static` (méthode), elle peut donc être appelée sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-662"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="bc382-663">Il n’est pas nécessaire de créer une instance de <xref:System.Diagnostics.EventLog> pour appeler <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-663">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-664">The logName is <see langword="null" /> or the value is empty.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-664">The logName is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-665">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-665">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-666">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-666">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Exists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="bc382-667">The log for which to search.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-667">The log for which to search.</span>
          </span>
          <span data-ttu-id="bc382-668">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-668">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-669">The name of the computer on which to search for the log, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-669">The name of the computer on which to search for the log, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-670">Determines whether the log exists on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-670">Determines whether the log exists on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-671">
            <see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-671">
              <see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-672">Utilisez cette méthode pour déterminer si un journal existe sur un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="bc382-672">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="bc382-673">Si vous souhaitez déterminer si une source existe sur un ordinateur distant, utilisez <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-673">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="bc382-674">Étant donné que cette méthode accède au Registre, vous devez disposer des autorisations de Registre appropriées sur l’ordinateur spécifié ; Sinon, la requête retourne `false`.</span><span class="sxs-lookup"><span data-stu-id="bc382-674">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="bc382-675">Étant donné que vous ne pouvez pas donner à un nouveau journal le nom d’un journal existant sur le même ordinateur, utilisez cette méthode avant de créer un nouveau journal pour déterminer si un avec l’objet `logName` existe déjà sur le serveur spécifié par le `machineName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-675">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="bc382-676">Le `logName` et `machineName` paramètres ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="bc382-676">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="bc382-677"><xref:System.Diagnostics.EventLog.Exists%2A> est un `static` (méthode), elle peut donc être appelée sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-677"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="bc382-678">Il n’est pas nécessaire de créer une nouvelle instance de <xref:System.Diagnostics.EventLog> pour appeler <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-678">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-679">The <paramref name="machineName" /> parameter is an invalid format.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-679">The <paramref name="machineName" /> parameter is an invalid format.</span>
          </span>
          <span data-ttu-id="bc382-680">Make sure you have used proper syntax for the computer on which you are searching.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-680">Make sure you have used proper syntax for the computer on which you are searching.</span>
          </span>
          <span data-ttu-id="bc382-681">-or-  The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-681">-or-  The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-682">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-682">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-683">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-683">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-684">Creates an array of the event logs.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-684">Creates an array of the event logs.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : unit -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bc382-685">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-685">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-686">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-686">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-687">Le tableau de <xref:System.Diagnostics.EventLog> objets est un instantané de tous les journaux des événements sur l’ordinateur local lors de l’appel à <xref:System.Diagnostics.EventLog.GetEventLogs%2A> est effectuée.</span><span class="sxs-lookup"><span data-stu-id="bc382-687">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="bc382-688">Cela n’est pas un regroupement dynamique, afin qu’il ne reflète pas la suppression ou la création de journaux en temps réel.</span><span class="sxs-lookup"><span data-stu-id="bc382-688">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="bc382-689">Vous devez vérifier l’existence d’un journal dans le tableau avant de lire ou écrire dessus.</span><span class="sxs-lookup"><span data-stu-id="bc382-689">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="bc382-690">Le tableau inclut généralement au moins trois journaux : Application, système et sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-690">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="bc382-691">Si vous avez créé des journaux personnalisés sur l’ordinateur local, ils s’affichent dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="bc382-691">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="bc382-692">Pour récupérer la liste des journaux des événements, vous devez disposer des autorisations de Registre appropriées.</span><span class="sxs-lookup"><span data-stu-id="bc382-692">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="bc382-693">Ces autorisations sont identiques à celles requises pour appeler <xref:System.Diagnostics.EventLog.Exists%2A> et <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-693">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-694">L’exemple suivant énumère les journaux des événements définis sur l’ordinateur local et affiche les détails de configuration pour chaque journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-694">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException">
          <span data-ttu-id="bc382-695">You do not have read access to the registry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-695">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="bc382-696">-or-  There is no event log service on the computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-696">-or-  There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-697">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-697">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-698">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-698">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : string -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="bc382-699">The computer on which to search for event logs.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-699">The computer on which to search for event logs.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-700">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-700">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-701">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-701">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-702">Le tableau de <xref:System.Diagnostics.EventLog> objets est un instantané de tous les journaux des événements sur l’ordinateur spécifié par le `machineName` paramètre lors de l’appel à <xref:System.Diagnostics.EventLog.GetEventLogs%2A> est effectuée.</span><span class="sxs-lookup"><span data-stu-id="bc382-702">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="bc382-703">Cela n’est pas un regroupement dynamique, afin qu’il ne reflète pas la suppression ou la création de journaux en temps réel.</span><span class="sxs-lookup"><span data-stu-id="bc382-703">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="bc382-704">Vous devez vérifier l’existence d’un journal dans le tableau avant de lire ou écrire dessus.</span><span class="sxs-lookup"><span data-stu-id="bc382-704">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="bc382-705">Le tableau inclut généralement au moins trois journaux : Application, système et sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-705">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="bc382-706">Si vous avez créé des journaux personnalisés sur l’ordinateur spécifié, ils s’affichent dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="bc382-706">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="bc382-707"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> est un `static` (méthode), il peut donc être appelée sur la <xref:System.Diagnostics.EventLog> classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-707"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="bc382-708">Il n’est pas nécessaire de créer une instance d’un <xref:System.Diagnostics.EventLog> objet pour effectuer un appel à la méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-708">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="bc382-709">Pour récupérer la liste des journaux des événements, vous devez disposer des autorisations de Registre appropriées.</span><span class="sxs-lookup"><span data-stu-id="bc382-709">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="bc382-710">Ces autorisations sont identiques à celles requises pour appeler <xref:System.Diagnostics.EventLog.Exists%2A> et <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-710">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-711">L’exemple suivant obtient une liste des journaux sur l’ordinateur « myServer ».</span><span class="sxs-lookup"><span data-stu-id="bc382-711">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="bc382-712">Il génère ensuite le nom de chaque journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-712">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-713">The <paramref name="machineName" /> parameter is an invalid computer name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-713">The <paramref name="machineName" /> parameter is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-714">You do not have read access to the registry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-714">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="bc382-715">-or-  There is no event log service on the computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-715">-or-  There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-716">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-716">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-717">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-717">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Log : string with get, set" Usage="System.Diagnostics.EventLog.Log" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-718">Gets or sets the name of the log to read from or write to.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-718">Gets or sets the name of the log to read from or write to.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-719">Nom du journal.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-719">The name of the log.</span>
          </span>
          <span data-ttu-id="bc382-720">Il peut s'agir d'application, système, sécurité ou d'un nom de journal personnalisé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-720">This can be Application, System, Security, or a custom log name.</span>
          </span>
          <span data-ttu-id="bc382-721">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-721">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-722">Trois fichiers journaux existent par défaut sur le serveur : Application, système et sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-722">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="bc382-723">Applications et services utilisent le fichier de journal d’Application.</span><span class="sxs-lookup"><span data-stu-id="bc382-723">Applications and services use the Application log file.</span></span> <span data-ttu-id="bc382-724">Pilotes de périphériques utilisent le fichier journal système.</span><span class="sxs-lookup"><span data-stu-id="bc382-724">Device drivers use the System log file.</span></span> <span data-ttu-id="bc382-725">Le système génère auditer les événements de réussite et d’échec dans le journal de sécurité lors de l’audit est activé.</span><span class="sxs-lookup"><span data-stu-id="bc382-725">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="bc382-726">Si vous avez d’autres applications installées, comme Active Directory sur les serveurs Windows, il peut exister d’autres fichiers de journaux par défaut.</span><span class="sxs-lookup"><span data-stu-id="bc382-726">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="bc382-727">En outre, vous pouvez créer des fichiers journaux personnalisés sur un ordinateur local ou distant.</span><span class="sxs-lookup"><span data-stu-id="bc382-727">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="bc382-728">Les journaux personnalisés aident à organiser vos entrées de manière plus détaillée que celle autorisée lorsque vos composants écrivent des événements dans le journal des applications par défaut.</span><span class="sxs-lookup"><span data-stu-id="bc382-728">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-729">Les noms de journal sont limités à huit caractères.</span><span class="sxs-lookup"><span data-stu-id="bc382-729">Log names are limited to eight characters.</span></span> <span data-ttu-id="bc382-730">Selon le système, MyLogSample1 et MyLogSample2 sont le même journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-730">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="bc382-731">Si vous écrivez dans un journal des événements, il n’est pas suffisant de spécifier la <xref:System.Diagnostics.EventLog.Log%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="bc382-731">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="bc382-732">Vous devez associer un <xref:System.Diagnostics.EventLog.Source%2A> propriété avec votre ressource de journal des événements pour le connecter à un journal particulier.</span><span class="sxs-lookup"><span data-stu-id="bc382-732">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="bc382-733">Il n’est pas nécessaire de spécifier un <xref:System.Diagnostics.EventLog.Source%2A> lorsque la lecture à partir d’un journal, mais une source d’événement doit être associée à la ressource de journal des événements dans le Registre du serveur.</span><span class="sxs-lookup"><span data-stu-id="bc382-733">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="bc382-734">Vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> nom et <xref:System.Diagnostics.EventLog.MachineName%2A> (nom de l’ordinateur serveur) pour lire à partir de celui-ci.</span><span class="sxs-lookup"><span data-stu-id="bc382-734">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-735">Vous n’êtes pas obligé de spécifier le <xref:System.Diagnostics.EventLog.MachineName%2A> si vous vous connectez à un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-735">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="bc382-736">Si vous ne spécifiez pas le <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-736">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-737">Si le <xref:System.Diagnostics.EventLog.Source%2A> propriété n’a pas été spécifiée, un appel à <xref:System.Diagnostics.EventLog.Log%2A> retourne une chaîne vide si <xref:System.Diagnostics.EventLog.Log%2A> n’a pas été explicitement défini (en définissant le <xref:System.Diagnostics.EventLog.Log%2A> propriété, ou par le biais du constructeur).</span><span class="sxs-lookup"><span data-stu-id="bc382-737">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="bc382-738">Si le <xref:System.Diagnostics.EventLog.Source%2A> a été spécifié, <xref:System.Diagnostics.EventLog.Log%2A> retourne le nom du journal dans lequel cette source a été inscrite.</span><span class="sxs-lookup"><span data-stu-id="bc382-738">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="bc382-739">Une source peut uniquement être inscrit dans un journal à la fois.</span><span class="sxs-lookup"><span data-stu-id="bc382-739">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="bc382-740">Si le <xref:System.Diagnostics.EventLog.Source%2A> propriété a été définie pour une instance de <xref:System.Diagnostics.EventLog>, vous ne pouvez pas modifier le <xref:System.Diagnostics.EventLog.Log%2A> propriété qui <xref:System.Diagnostics.EventLog> sans modifier la valeur de <xref:System.Diagnostics.EventLog.Source%2A> ou en appelant <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> première.</span><span class="sxs-lookup"><span data-stu-id="bc382-740">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="bc382-741">Si vous modifiez le <xref:System.Diagnostics.EventLog.Log%2A> après le <xref:System.Diagnostics.EventLog.Source%2A> propriété a été définie, l’écriture d’une entrée de journal lève une exception.</span><span class="sxs-lookup"><span data-stu-id="bc382-741">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="bc382-742">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bc382-742">The operating system stores event logs as files.</span></span> <span data-ttu-id="bc382-743">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-743">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="bc382-744">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventLog.Log%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="bc382-744">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="bc382-745">Impossible de créer un nouveau journal à l’aide du <xref:System.Diagnostics.EventLog.Log%2A> propriété seule (sans spécifier de source pour le journal).</span><span class="sxs-lookup"><span data-stu-id="bc382-745">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="bc382-746">Vous pouvez appeler <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, en passant un nouveau nom de journal en tant que paramètre, puis appelez <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-746">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="bc382-747">Toutefois, l’intention est généralement de créer (et écrire des entrées) nouveaux journaux spécifiques à l’application, ou à lire les journaux existants.</span><span class="sxs-lookup"><span data-stu-id="bc382-747">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="bc382-748">Si le <xref:System.Diagnostics.EventLog.Log%2A> valeur change, le journal des événements est fermé et tous les handles d’événement sont libérés.</span><span class="sxs-lookup"><span data-stu-id="bc382-748">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="bc382-749">Si vous définissez la <xref:System.Diagnostics.EventLog.Log%2A> propriété le nom d’un journal qui n’existe pas, le système attache le <xref:System.Diagnostics.EventLog> dans le journal des applications, mais ne vous avertit pas qu’il utilise un journal autre que celui que vous avez spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-749">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-750">L’exemple suivant lit les entrées dans le journal des événements, « NewEventLog », sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-750">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-751">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-751">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-752">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-752">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LogDisplayName : string" Usage="System.Diagnostics.EventLog.LogDisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-753">Gets the event log's friendly name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-753">Gets the event log's friendly name.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-754">Nom qui représente le journal des événements dans l'observateur d'événements du système.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-754">A name that represents the event log in the system's event viewer.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="bc382-755">Dans Windows Vista et versions ultérieures, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-755">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="bc382-756">Si vous exécutez Windows Vista ou version ultérieure en tant qu’utilisateur, vous obtenez un <xref:System.Security.SecurityException> lorsque vous essayez d’accéder au nom d’affichage pour un événement dans le journal de sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-756">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="bc382-757">Dans Windows Vista et version ultérieure, le contrôle de compte d'utilisateur détermine les privilèges d'un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-757">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-758">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-758">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-759">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-759">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-760">Pour exécuter le code qui accède au journal de sécurité, vous devez d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-760">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-761">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-761">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-762">L’exemple suivant énumère les journaux des événements définis sur l’ordinateur local et affiche le <xref:System.Diagnostics.EventLog.LogDisplayName%2A> pour chaque journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-762">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-763">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-763">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-764">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-764">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-765">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-765">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="bc382-766">pour avoir la possibilité de lire la clé de Registre spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-766">for the ability to read the specified registry key.</span>
          </span>
          <span data-ttu-id="bc382-767">Énumération associée : <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-767">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="bc382-768">Pour pouvoir accéder au si clé de Registre spécifiée est une clé à distance.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-768">for the ability to access the specified registry key if it is a remote key.</span>
          </span>
          <span data-ttu-id="bc382-769">Énumération associée : <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-769">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member LogNameFromSourceName : string * string -&gt; string" Usage="System.Diagnostics.EventLog.LogNameFromSourceName (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-770">The name of the event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-770">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-771">The name of the computer on which to look, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-771">The name of the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-772">Gets the name of the log to which the specified source is registered.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-772">Gets the name of the log to which the specified source is registered.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-773">The name of the log associated with the specified source in the registry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-773">The name of the log associated with the specified source in the registry.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-774">La source d’événements indique ce qui consigne l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-774">The event source indicates what logs the event.</span></span> <span data-ttu-id="bc382-775">Il est souvent le nom de l’application ou le nom du sous-composant de l’application, si l’application est importante.</span><span class="sxs-lookup"><span data-stu-id="bc382-775">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="bc382-776">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-776">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="bc382-777">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="bc382-777">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="bc382-778">Lorsque vous créez une nouvelle source, qui ne peut écrire dans un journal à la fois, le système inscrit votre application avec le journal des événements comme source valide d’entrées.</span><span class="sxs-lookup"><span data-stu-id="bc382-778">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="bc382-779">Le <xref:System.Diagnostics.EventLog.Source%2A> propriété peut être n’importe quelle chaîne, mais le nom ne peut pas être utilisé par d’autres sources sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-779">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="bc382-780">Une tentative pour créer un double <xref:System.Diagnostics.EventLog.Source%2A> valeur lève une exception.</span><span class="sxs-lookup"><span data-stu-id="bc382-780">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="bc382-781">Toutefois, un seul journal des événements peut avoir de nombreuses sources différentes y écrire.</span><span class="sxs-lookup"><span data-stu-id="bc382-781">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-782">L’exemple suivant supprime une source de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-782">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="bc382-783">L’exemple détermine le journal à partir de sa source, puis supprime le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-783">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-784">Plusieurs sources peuvent écrire dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-784">More than one source might write to an event log.</span></span> <span data-ttu-id="bc382-785">Avant de supprimer un journal personnalisé, assurez-vous qu’aucune source de l’écriture dans ce journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-785">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-786">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-786">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-787">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-787">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Diagnostics.EventLog.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-788">Gets or sets the name of the computer on which to read or write events.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-788">Gets or sets the name of the computer on which to read or write events.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-789">Nom du serveur sur lequel le journal des événements réside.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-789">The name of the server on which the event log resides.</span>
          </span>
          <span data-ttu-id="bc382-790">La valeur par défaut est l'ordinateur local (".").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-790">The default is the local computer (".").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-791">Si vous écrivez dans un journal des événements, vous devez associer un <xref:System.Diagnostics.EventLog.Source%2A> à votre objet de journal des événements pour le connecter à un journal particulier.</span><span class="sxs-lookup"><span data-stu-id="bc382-791">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="bc382-792">Il n’est pas nécessaire de spécifier le <xref:System.Diagnostics.EventLog.Source%2A> propriété lors de la lecture à partir d’un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-792">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="bc382-793">Vous pouvez spécifier uniquement le <xref:System.Diagnostics.EventLog.Log%2A> nom et <xref:System.Diagnostics.EventLog.MachineName%2A> (nom de l’ordinateur serveur).</span><span class="sxs-lookup"><span data-stu-id="bc382-793">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-794">Vous ne devez pas spécifier le <xref:System.Diagnostics.EventLog.MachineName%2A> si vous vous connectez à un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-794">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="bc382-795">Si vous ne spécifiez pas le <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-795">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-796">Une source peut uniquement être inscrit dans un journal à la fois.</span><span class="sxs-lookup"><span data-stu-id="bc382-796">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="bc382-797">Si le <xref:System.Diagnostics.EventLog.Source%2A> propriété a été définie pour une instance de <xref:System.Diagnostics.EventLog>, vous ne pouvez pas modifier le <xref:System.Diagnostics.EventLog.MachineName%2A> propriété qui <xref:System.Diagnostics.EventLog> sans modifier la valeur de <xref:System.Diagnostics.EventLog.Source%2A> ou en appelant <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> première.</span><span class="sxs-lookup"><span data-stu-id="bc382-797">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="bc382-798">Si vous modifiez le <xref:System.Diagnostics.EventLog.MachineName%2A> propriété, le <xref:System.Diagnostics.EventLog> ferme tous les handles et se rattache au journal et à la source sur le nouvel ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-798">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="bc382-799">Le <xref:System.Diagnostics.EventLog.MachineName%2A> ne peut pas être une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="bc382-799">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="bc382-800">Si elle n’est pas explicitement définie, la valeur par défaut sur l’ordinateur local («. »).</span><span class="sxs-lookup"><span data-stu-id="bc382-800">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-801">L’exemple suivant lit les entrées dans le journal des événements, « NewEventLog », sur un ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc382-801">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-802">The computer name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-802">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-803">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-803">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-804">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-804">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumKilobytes : int64 with get, set" Usage="System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-805">Gets or sets the maximum event log size in kilobytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-805">Gets or sets the maximum event log size in kilobytes.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-806">Taille maximale du journal des événements en kilo-octets.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-806">The maximum event log size in kilobytes.</span>
          </span>
          <span data-ttu-id="bc382-807">La valeur par défaut est 512. Elle correspond à une taille de fichier maximale de 512 kilo-octets.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-807">The default is 512, indicating a maximum file size of 512 kilobytes.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-808">Le <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> propriété représente la limite de taille du fichier journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-808">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="bc382-809">Lorsque le journal des événements atteint la limite de taille configurée <xref:System.Diagnostics.EventLog.OverflowAction%2A> valeur détermine si les nouvelles entrées sont ignorées, ou si les nouvelles entrées remplacent les entrées plus anciennes.</span><span class="sxs-lookup"><span data-stu-id="bc382-809">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-810">Cette propriété représente un paramètre de configuration pour le journal des événements représenté par cette instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-810">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="bc382-811">Lorsque le journal des événements atteint sa taille maximale, cette propriété spécifie la façon dont le système d’exploitation gère les nouvelles entrées écrites par toutes les sources d’événements inscrits pour le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-811">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-812">L’exemple suivant énumère les journaux des événements définis sur l’ordinateur local et affiche les détails de configuration pour chaque journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-812">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="bc382-813">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-813">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-814">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-814">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="bc382-815">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-815">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-816">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-816">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-817">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-817">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinimumRetentionDays : int" Usage="System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-818">Gets the number of days to retain entries in the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-818">Gets the number of days to retain entries in the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-819">Durée de conservation en jours des entrées du journal des événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-819">The number of days that entries in the event log are retained.</span>
          </span>
          <span data-ttu-id="bc382-820">La valeur par défaut est 7.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-820">The default value is 7.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-821">Utilisez le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> propriété pour examiner le paramètre actuel d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-821">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="bc382-822">Utilisez <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> pour modifier le nombre minimal de jours pendant lesquels chaque entrée dans le journal des événements doit être conservée.</span><span class="sxs-lookup"><span data-stu-id="bc382-822">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="bc382-823">Le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valeur varie selon le comportement de dépassement de capacité configuré du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-823">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="bc382-824">Si le <xref:System.Diagnostics.OverflowAction> pour un journal des événements est définie sur <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, puis le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valeur est 0.</span><span class="sxs-lookup"><span data-stu-id="bc382-824">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="bc382-825">Si le <xref:System.Diagnostics.OverflowAction> pour un journal des événements est définie sur <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, puis le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valeur est -1.</span><span class="sxs-lookup"><span data-stu-id="bc382-825">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="bc382-826">Si le <xref:System.Diagnostics.OverflowAction> pour un journal des événements est définie sur <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, puis le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valeur est supérieure à zéro et représente le nombre de jours pendant lesquels conserver les entrées de journal des événements lorsque le journal des événements est plein.</span><span class="sxs-lookup"><span data-stu-id="bc382-826">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="bc382-827">Le comportement de dépassement de capacité se produit uniquement lorsqu’un journal des événements atteint sa limite de taille.</span><span class="sxs-lookup"><span data-stu-id="bc382-827">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="bc382-828">Lorsqu’un <xref:System.Diagnostics.EventLog> a son <xref:System.Diagnostics.EventLog.OverflowAction%2A> la valeur <xref:System.Diagnostics.OverflowAction.OverwriteOlder>et le journal des événements atteint sa taille maximale, puis les nouvelles entrées sont écrites uniquement si elles peuvent remplacer des entrées dont âge dépasse le <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> période.</span><span class="sxs-lookup"><span data-stu-id="bc382-828">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="bc382-829">En conservant les entrées d’événements pendant une période minimale est appropriée lorsque le journal des événements est archivé régulièrement.</span><span class="sxs-lookup"><span data-stu-id="bc382-829">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="bc382-830">Sinon, vous risquez de perdre des nouvelles entrées lorsque le journal des événements atteint sa limite.</span><span class="sxs-lookup"><span data-stu-id="bc382-830">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="bc382-831">Pour éviter de perdre les nouvelles informations d’événement, définissez la période de conservation minimale des événements en fonction de votre planification d’archivage pour un journal des événements spécifique.</span><span class="sxs-lookup"><span data-stu-id="bc382-831">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-832">L’exemple suivant énumère les journaux des événements définis sur l’ordinateur local et affiche les détails de configuration pour chaque journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-832">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-833">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-833">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-834">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-834">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberSignature Language="F#" Value="member this.ModifyOverflowPolicy : System.Diagnostics.OverflowAction * int -&gt; unit" Usage="eventLog.ModifyOverflowPolicy (action, retentionDays)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" />
        <Parameter Name="retentionDays" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="bc382-835">The overflow behavior for writing new entries to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-835">The overflow behavior for writing new entries to the event log.</span>
          </span>
        </param>
        <param name="retentionDays">
          <span data-ttu-id="bc382-836">The minimum number of days each event log entry is retained.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-836">The minimum number of days each event log entry is retained.</span>
          </span>
          <span data-ttu-id="bc382-837">This parameter is used only if <c>action</c> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-837">This parameter is used only if <c>action</c> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-838">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-838">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-839">Le comportement de dépassement de capacité pour un journal des événements indique que se passe-t-il lorsque de nouvelles entrées doivent être écrites dans un journal qui a atteint sa taille maximale de fichier.</span><span class="sxs-lookup"><span data-stu-id="bc382-839">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-840">Le comportement de dépassement de capacité prend effet uniquement quand un journal des événements atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-840">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="bc382-841">Le comportement de dépassement de capacité n’affecte pas l’écriture d’une nouvelle entrée dans un journal qui peut prendre en charge les entrées de journal des événements supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bc382-841">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="bc382-842">Le <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> méthode configure le comportement de dépassement de capacité d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-842">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="bc382-843"><xref:System.Diagnostics.EventLog> instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-843"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="bc382-844">Après avoir appelé cette méthode pour le journal des événements spécifié par le <xref:System.Diagnostics.EventLog.Log%2A> propriété, le <xref:System.Diagnostics.EventLog.OverflowAction%2A> et <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valeurs de propriété reflètent le comportement de dépassement de capacité qui vient d’être configuré.</span><span class="sxs-lookup"><span data-stu-id="bc382-844">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-845">Cette propriété représente un paramètre de configuration pour le journal des événements représenté par cette instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-845">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="bc382-846">Lorsque le journal des événements atteint sa taille maximale, cette propriété spécifie la façon dont le système d’exploitation gère les nouvelles entrées écrites par toutes les sources d’événements inscrits pour le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-846">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="bc382-847">Définir le `action` paramètre <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> pour indiquer qu’une nouvelle entrée remplace l’entrée la plus ancienne lorsque le <xref:System.Diagnostics.EventLog> atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-847">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="bc382-848">Si le `action` paramètre est défini sur <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, le `retentionDays` la valeur du paramètre est ignorée.</span><span class="sxs-lookup"><span data-stu-id="bc382-848">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="bc382-849">Définir le `action` paramètre <xref:System.Diagnostics.OverflowAction.OverwriteOlder> pour indiquer que chaque nouvelle entrée remplace les entrées plus anciennes lorsque le <xref:System.Diagnostics.EventLog> atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-849">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="bc382-850">Spécifiez le nombre de jours pendant lesquels les événements doivent être conservés dans le journal à l’aide de le `retentionDays` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-850">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="bc382-851">Les événements écrits dans la plage de rétention ne sont pas remplacées par les nouvelles entrées.</span><span class="sxs-lookup"><span data-stu-id="bc382-851">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="bc382-852">Définir le `action` paramètre <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> pour ignorer les nouveaux événements lorsque la taille maximale du journal est atteinte.</span><span class="sxs-lookup"><span data-stu-id="bc382-852">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="bc382-853">Si le `action` paramètre est défini sur <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, le `retentionDays` la valeur du paramètre est ignorée.</span><span class="sxs-lookup"><span data-stu-id="bc382-853">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="bc382-854">Définition de la stratégie de dépassement de capacité <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> Spécifie que les nouvelles entrées sont ignorées lorsque le journal des événements est plein.</span><span class="sxs-lookup"><span data-stu-id="bc382-854">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="bc382-855">Si vous utilisez ce paramètre, vérifiez le journal des événements est régulièrement archivé et désactivé pour éviter d’atteindre sa limite de taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-855">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-856">L’exemple suivant affiche la stratégie de dépassement de capacité configuré d’un journal des événements spécifié et permet à l’utilisateur de sélectionner un nouveau paramètre de stratégie de dépassement de capacité pour le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-856">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-857">
            <paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-857">
              <paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="bc382-858">
            <paramref name="retentionDays" /> is less than one, or larger than 365.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-858">
              <paramref name="retentionDays" /> is less than one, or larger than 365.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-859">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-859">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="bc382-860">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-860">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-861">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-861">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-862">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-862">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberSignature Language="F#" Value="member this.OverflowAction : System.Diagnostics.OverflowAction" Usage="System.Diagnostics.EventLog.OverflowAction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-863">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-863">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-864">Valeur <see cref="T:System.Diagnostics.OverflowAction" /> qui spécifie le comportement configuré pour le stockage des nouvelles entrées quand le journal des événements atteint sa taille maximale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-864">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span>
          </span>
          <span data-ttu-id="bc382-865">La valeur par défaut est <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-865">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-866">Journaux des événements croître lors de l’écriture pour les nouveaux événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-866">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="bc382-867">Chaque journal des événements a une limite de taille maximale configurée ; le <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> propriété définit le nombre maximal de kilo-octets autorisé par la taille du fichier journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-867">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="bc382-868">Utilisez la <xref:System.Diagnostics.EventLog.OverflowAction%2A> valeur de propriété à examiner le comportement de dépassement de capacité configuré d’un journal des événements atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-868">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="bc382-869">Utilisez la <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> méthode pour modifier le comportement de dépassement de capacité d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-869">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-870">Le comportement de dépassement de capacité prend effet uniquement quand un journal des événements atteint sa taille maximale.</span><span class="sxs-lookup"><span data-stu-id="bc382-870">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="bc382-871">Le comportement de dépassement de capacité n’affecte pas l’écriture d’une nouvelle entrée dans un journal qui peut prendre en charge les entrées de journal des événements supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bc382-871">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-872">L’exemple suivant énumère les journaux des événements définis sur l’ordinateur local et affiche les détails de configuration pour chaque journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-872">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-873">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-873">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-874">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-874">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberSignature Language="F#" Value="member this.RegisterDisplayName : string * int64 -&gt; unit" Usage="eventLog.RegisterDisplayName (resourceFile, resourceId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" />
        <Parameter Name="resourceId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="resourceFile">
          <span data-ttu-id="bc382-875">The fully specified path to a localized resource file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-875">The fully specified path to a localized resource file.</span>
          </span>
        </param>
        <param name="resourceId">
          <span data-ttu-id="bc382-876">The resource identifier that indexes a localized string within the resource file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-876">The resource identifier that indexes a localized string within the resource file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-877">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-877">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-878">Utilisez <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> pour enregistrer et afficher un nom localisé dans l’Observateur d’événements pour les journaux des événements personnalisés.</span><span class="sxs-lookup"><span data-stu-id="bc382-878">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="bc382-879">L’identificateur de ressource spécifié doit correspondre à une chaîne localisée définie dans le fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-879">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="bc382-880">L’Observateur d’événements affiche le nom de journal des événements personnalisé à l’aide de la chaîne localisée et les paramètres de culture actuels.</span><span class="sxs-lookup"><span data-stu-id="bc382-880">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="bc382-881">Par exemple, vous pouvez définir plusieurs noms de journal des événements localisées pour différentes cultures dans votre fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-881">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="bc382-882">L’Observateur d’événements affiche la chaîne localisée correspondant aux paramètres de culture de l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="bc382-882">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="bc382-883">Si l’Observateur d’événements ne peut pas charger la chaîne localisée du fichier de ressources, ou si aucun nom complet n’a été enregistré pour le journal des événements, l’Observateur d’événements affiche le nom du journal des événements définis dans <xref:System.Diagnostics.EventLog.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-883">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-884">Vous n’avez pas besoin d’inscrire un nom d’affichage pour les journaux des événements prédéfinis.</span><span class="sxs-lookup"><span data-stu-id="bc382-884">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="bc382-885">Le système d’exploitation enregistre les noms complets localisés pour les journaux des événements Application, système et sécurité.</span><span class="sxs-lookup"><span data-stu-id="bc382-885">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-886">L’exemple suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-886">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="bc382-887">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-887">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="bc382-888">Enfin, l’exemple définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="bc382-888">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="bc382-889">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-889">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-890">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-890">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-891">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-891">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="bc382-892">Plus précisément, l’identificateur de ressource 5001 est défini pour le nom localisé du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-892">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-893">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-893">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="bc382-894">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-894">\- or -  The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-895">
            <paramref name="resourceFile" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-895">
              <paramref name="resourceFile" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-896">pour administrer les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-896">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-897">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-897">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Source : string with get, set" Usage="System.Diagnostics.EventLog.Source" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-898">Gets or sets the source name to register and use when writing to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-898">Gets or sets the source name to register and use when writing to the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-899">Nom inscrit avec le journal des événements comme source des entrées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-899">The name registered with the event log as a source of entries.</span>
          </span>
          <span data-ttu-id="bc382-900">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-900">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-901">La source d’événements indique ce qui consigne l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-901">The event source indicates what logs the event.</span></span> <span data-ttu-id="bc382-902">Il est souvent le nom de l’application ou le nom du sous-composant de l’application, si l’application est importante.</span><span class="sxs-lookup"><span data-stu-id="bc382-902">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="bc382-903">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-903">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="bc382-904">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="bc382-904">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="bc382-905">Vous devez uniquement spécifier une source d’événements si vous écrivez dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-905">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="bc382-906">Avant d’écrire une entrée dans un journal des événements, vous devez inscrire la source d’événements avec le journal des événements comme source valide d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-906">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="bc382-907">Lorsque vous écrivez une entrée de journal, le système utilise le <xref:System.Diagnostics.EventLog.Source%2A> propriété à rechercher le journal approprié dans lequel placer votre entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-907">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="bc382-908">Si vous lisez le journal des événements, vous pouvez spécifier le <xref:System.Diagnostics.EventLog.Source%2A>, ou un <xref:System.Diagnostics.EventLog.Log%2A> et <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-908">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-909">Vous n’êtes pas obligé de spécifier le <xref:System.Diagnostics.EventLog.MachineName%2A> si vous vous connectez à un journal sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-909">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="bc382-910">Si vous ne spécifiez pas le <xref:System.Diagnostics.EventLog.MachineName%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-910">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-911">Utilisez <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-911">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="bc382-912">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-912">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-913">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-913">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-914">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-914">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-915">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-915">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-916">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-916">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-917">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-917">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-918">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-918">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="bc382-919">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-919">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="bc382-920">La source doit être unique sur l’ordinateur local ; un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="bc382-920">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="bc382-921">Chaque source peut écrire qu’un seul journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-921">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="bc382-922">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="bc382-922">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="bc382-923">Si vous modifiez le <xref:System.Diagnostics.EventLog.Source%2A> valeur, le <xref:System.Diagnostics.EventLog> pour lequel elle est inscrite est fermée et tous les handles d’événement sont libérés.</span><span class="sxs-lookup"><span data-stu-id="bc382-923">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="bc382-924">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-924">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-925">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-925">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-926">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-926">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-927">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-927">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="bc382-928">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-928">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="bc382-929">Si d’autres applications ou composants utilisent la source existante, créer une nouvelle source avec la configuration mise à jour, plutôt que de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="bc382-929">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-930">Si une source a déjà été mappée à un journal et vous remappez à un nouveau journal, vous devez redémarrer l’ordinateur pour que les modifications prennent effet.</span><span class="sxs-lookup"><span data-stu-id="bc382-930">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-931">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-931">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-932">The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-932">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-933">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-933">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-934">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-934">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-935">Searches a computer's registry for a given event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-935">Searches a computer's registry for a given event source.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-936">The name of the event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-936">The name of the event source.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-937">Determines whether an event source is registered on the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-937">Determines whether an event source is registered on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-938">
            <see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-938">
              <see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-939">Utilisez cette méthode pour déterminer si une source d’événements existe sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-939">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="bc382-940">Si vous souhaitez déterminer si un journal existe sur l’ordinateur local, utilisez <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-940">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="bc382-941">Étant donné que cette méthode accède au Registre, vous devez disposer des autorisations de Registre appropriées sur l’ordinateur local ; Sinon, un <xref:System.Security.SecurityException> sera levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-941">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-942">Pour rechercher une source d’événements dans Windows Vista et versions ultérieures ou de Windows Server 2003, vous devez disposer des privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-942">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="bc382-943">La raison de cette exigence est que tous les journaux des événements, y compris la sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-943">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-944">À compter de Windows Vista, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-944">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="bc382-945">À compter de Windows Vista, le contrôle de compte d’utilisateur (UAC) détermine les privilèges d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-945">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-946">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-946">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-947">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-947">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-948">Pour exécuter le code qui accède aux compteurs de performances, vous devez tout d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-948">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-949">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-949">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-950">Un service qui s’exécute sous le <xref:System.ServiceProcess.ServiceAccount.LocalSystem> compte ne dispose pas des privilèges requis pour exécuter cette méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-950">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="bc382-951">La solution consiste à vérifier l’existence de la source d’événements dans le <xref:System.ServiceProcess.ServiceInstaller>, et si elle n’existe pas, pour créer la source dans le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="bc382-951">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="bc382-952">Étant donné que vous ne pouvez pas donner une nouvelle source le nom d’une source existante sur le même ordinateur, utilisez cette méthode avant d’essayer d’appeler <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour vérifier qu’une source avec le nom spécifié par `source` n’existe pas déjà sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-952">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="bc382-953">Le `source` paramètre n’est pas sensible à la casse.</span><span class="sxs-lookup"><span data-stu-id="bc382-953">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-954">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-954">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bc382-955">
            <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-955">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-956">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-956">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-957">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-957">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-958">The name of the event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-958">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="bc382-959">The name the computer on which to look, or "." for the local computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-959">The name the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-960">Determines whether an event source is registered on a specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-960">Determines whether an event source is registered on a specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bc382-961">
            <see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-961">
              <see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-962">Utilisez cette méthode pour déterminer si une source d’événements existe sur l’ordinateur spécifié par le `machineName` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-962">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="bc382-963">Si vous souhaitez déterminer si un journal existe sur l’ordinateur spécifié, utilisez <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-963">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="bc382-964">Car cette méthode accède au Registre, vous devez disposer des autorisations de Registre appropriées sur le serveur donné ; Sinon, un <xref:System.Security.SecurityException> sera levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-964">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-965">Pour rechercher une source d’événements dans Windows Vista et versions ultérieures ou de Windows Server 2003, vous devez disposer des privilèges d’administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-965">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="bc382-966">La raison de cette exigence est que tous les journaux des événements, y compris la sécurité, doivent être recherchés pour déterminer si la source d’événements est unique.</span><span class="sxs-lookup"><span data-stu-id="bc382-966">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="bc382-967">À compter de Windows Vista, les utilisateurs n’êtes pas autorisé à accéder au journal de sécurité ; Par conséquent, un <xref:System.Security.SecurityException> est levée.</span><span class="sxs-lookup"><span data-stu-id="bc382-967">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="bc382-968">À compter de Windows Vista, le contrôle de compte d’utilisateur (UAC) détermine les privilèges d’un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-968">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="bc382-969">Si vous êtes membre du groupe Administrateurs intégrés, deux jetons d'accès au moment de l'exécution vous sont assignés : un jeton d'accès utilisateur standard et un jeton d'accès administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-969">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="bc382-970">Par défaut, vous êtes dans le rôle d'utilisateur standard.</span><span class="sxs-lookup"><span data-stu-id="bc382-970">By default, you are in the standard user role.</span></span> <span data-ttu-id="bc382-971">Pour exécuter le code qui accède aux compteurs de performances, vous devez tout d’abord élever vos privilèges d’utilisateur standard à administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-971">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="bc382-972">Vous pouvez effectuer cela au démarrage d'une application en cliquant avec le bouton droit sur l'icône de l'application et en indiquant que vous voulez l'exécuter en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-972">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-973">Un service qui s’exécute sous le <xref:System.ServiceProcess.ServiceAccount.LocalSystem> compte ne dispose pas des privilèges requis pour exécuter cette méthode.</span><span class="sxs-lookup"><span data-stu-id="bc382-973">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="bc382-974">La solution consiste à vérifier l’existence de la source d’événements dans le <xref:System.ServiceProcess.ServiceInstaller>, et si elle n’existe pas, pour créer la source dans le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="bc382-974">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="bc382-975">Étant donné que vous ne pouvez pas donner une nouvelle source le nom d’une source existante sur le même ordinateur, utilisez cette méthode avant d’essayer d’appeler <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour vérifier qu’une source avec le nom spécifié par `source` n’existe pas déjà sur l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="bc382-975">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="bc382-976">Le `source` et `machineName` paramètres ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="bc382-976">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="bc382-977"><xref:System.Diagnostics.EventLog.SourceExists%2A> est un `static` (méthode), elle peut donc être appelée sur la classe elle-même.</span><span class="sxs-lookup"><span data-stu-id="bc382-977"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="bc382-978">Il n’est pas nécessaire de créer une instance de <xref:System.Diagnostics.EventLog> pour appeler <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-978">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-979">L’exemple suivant crée la source de `MySource` sur l’ordinateur `MyServer`et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-979">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-980">
            <paramref name="machineName" /> is an invalid computer name.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-980">
              <paramref name="machineName" /> is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bc382-981">
            <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-981">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-982">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-982">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-983">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-983">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-984">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-984">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bc382-985">
            <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> utilisé pour marshaler des appels du gestionnaire d'événements émis à la suite d'un événement <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> dans le journal des événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-985">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-986">Lorsque <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> est `null`, méthodes qui gèrent la <xref:System.Diagnostics.EventLog.EntryWritten> événement sont appelées sur un thread du pool de threads système.</span><span class="sxs-lookup"><span data-stu-id="bc382-986">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="bc382-987">Pour plus d’informations sur les pools de threads système, consultez <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="bc382-987">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="bc382-988">Lorsque le <xref:System.Diagnostics.EventLog.EntryWritten> événement est géré par un Windows Forms visual composant, tel qu’un bouton, l’accès au composant via le pool de threads système peut ne pas fonctionne ou résulter en une exception.</span><span class="sxs-lookup"><span data-stu-id="bc382-988">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="bc382-989">Éviter ce problème en définissant <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> à un composant Windows Forms, ce qui entraîne les méthodes qui gèrent la <xref:System.Diagnostics.EventLog.EntryWritten> événement à être appelé sur le même thread que celui sur lequel le composant a été créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-989">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="bc382-990">Si le <xref:System.Diagnostics.EventLog> est utilisé à l’intérieur de [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] dans un concepteur Windows Forms, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> est automatiquement défini sur le contrôle contenant le <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="bc382-990">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="bc382-991">Par exemple, si vous placez un <xref:System.Diagnostics.EventLog> sur un concepteur pour Form1 (qui hérite de <xref:System.Windows.Forms.Form>) le <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> propriété du <xref:System.Diagnostics.EventLog> est définie sur l’instance de Form1.</span><span class="sxs-lookup"><span data-stu-id="bc382-991">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-992">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-992">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-993">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-993">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-994">Writes an entry in the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-994">Writes an entry in the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string -&gt; unit" Usage="eventLog.WriteEntry message" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="bc382-995">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-995">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-996">Writes an information type entry, with the given message text, to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-996">Writes an information type entry, with the given message text, to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-997">Utilisez cette méthode pour écrire une entrée d’informations dans le journal des événements associé à cet <xref:System.Diagnostics.EventLog> instance.</span><span class="sxs-lookup"><span data-stu-id="bc382-997">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="bc382-998">Si vous souhaitez spécifier n’importe quel autre <xref:System.Diagnostics.EventLogEntryType>, utilisez une autre surcharge de <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-998">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-999">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-999">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1000">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1000">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1001">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant de pouvoir écrire des entrées dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1001">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="bc382-1002">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1002">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-1003">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1003">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1004">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1004">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1005">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1005">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1006">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1006">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1007">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1007">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1008">Si la source spécifiée dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété de ce <xref:System.Diagnostics.EventLog> instance n’est pas inscrit sur l’ordinateur sur lequel votre composant est écrit, <xref:System.Diagnostics.EventLog.WriteEntry%2A> appelle <xref:System.Diagnostics.EventLog.CreateEventSource%2A> et inscrit la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1008">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1009">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1009">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1010">Si le système doit enregistrer le <xref:System.Diagnostics.EventLog.Source%2A> via un appel à <xref:System.Diagnostics.EventLog.WriteEntry%2A> et <xref:System.Diagnostics.EventLog.Log%2A> propriété n’a pas été définie sur votre <xref:System.Diagnostics.EventLog> instance, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-1010">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1011">La plupart des exceptions répertoriées ci-dessus sont générés par des erreurs déclenchées au cours du processus d’inscription de le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1011">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1012">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1012">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1013">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1013">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1014">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1014">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1015">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1015">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1016">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1016">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1017">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1017">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1018">Si vous écrivez une entrée à un ordinateur distant, la valeur du message (la chaîne de texte) ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1018">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1019">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1019">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1020">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-1020">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1021">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1021">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1022">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1022">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1023">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1023">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1024">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1024">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1025">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1025">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1026">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1026">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1027">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1027">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1028">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1028">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1029">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1029">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1030">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1030">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="eventLog.WriteEntry (message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="bc382-1031">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1031">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1032">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1032">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1033">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1033">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1034">Utilisez cette méthode pour écrire une entrée d’un <xref:System.Diagnostics.EventLogEntryType> au journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1034">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="bc382-1035">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1035">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1036">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1036">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1037">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1037">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1038">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant de pouvoir écrire des entrées dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1038">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="bc382-1039">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1039">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-1040">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1040">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1041">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1041">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1042">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1042">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1043">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1043">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1044">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1044">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1045">Si la source spécifiée dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété de ce <xref:System.Diagnostics.EventLog> instance n’est pas inscrit sur l’ordinateur sur lequel votre composant est écrit, <xref:System.Diagnostics.EventLog.WriteEntry%2A> appelle <xref:System.Diagnostics.EventLog.CreateEventSource%2A> et inscrit la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1045">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1046">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1046">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1047">Si le système doit enregistrer le <xref:System.Diagnostics.EventLog.Source%2A> via un appel à <xref:System.Diagnostics.EventLog.WriteEntry%2A> et <xref:System.Diagnostics.EventLog.Log%2A> propriété n’a pas été définie sur votre <xref:System.Diagnostics.EventLog> instance, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-1047">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1048">De nombreuses exceptions répertoriées ci-dessus sont générées par des erreurs déclenchées au cours du processus d’inscription de le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1048">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1049">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1049">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1050">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1050">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1051">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1051">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1052">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1052">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1053">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1053">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1054">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1054">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1055">Si vous écrivez une entrée à un ordinateur distant, la valeur du message (la chaîne de texte) ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1055">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1056">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1056">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1057">L’exemple suivant écrit une entrée d’avertissement dans un journal des événements, « MyNewLog », sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-1057">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1058">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1058">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1059">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1059">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1060">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1060">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1061">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1061">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1062">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1062">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1063">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1063">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1064">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1064">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1065">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1065">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1066">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1066">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1067">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1067">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1068">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1068">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1069">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1069">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="bc382-1070">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1070">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1071">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1071">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1072">Utilisez cette méthode pour écrire une entrée d’informations dans le journal des événements, à l’aide d’une source qui est déjà inscrite comme source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1072">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1073">Si vous souhaitez spécifier n’importe quel autre <xref:System.Diagnostics.EventLogEntryType>, utilisez une autre surcharge de <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1073">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1074">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1074">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1075">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1075">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1076">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1076">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1077">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1077">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1078">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1078">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1079">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1079">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1080">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1080">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1081">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1081">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1082">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1082">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1083">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1083">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1084">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1084">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1085">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1085">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1086">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1086">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="bc382-1087">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1087">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1088">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1088">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1089">L’exemple suivant crée la source de `MySource` s’il n’existe pas déjà et écrit une entrée dans le journal des événements `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-1089">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1090">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1090">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1091">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1091">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1092">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1092">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1093">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1093">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1094">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1094">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1095">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1095">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1096">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1096">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1097">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1097">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1098">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1098">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="bc382-1099">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1099">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1100">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1100">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1101">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1101">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1102">Writes an entry with the given message text and application-defined event identifier to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1102">Writes an entry with the given message text and application-defined event identifier to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1103">Utilisez cette méthode pour écrire une entrée avec un définies par l’application `eventID` dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1103">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="bc382-1104">Le `eventID` ainsi que la source identifient un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1104">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="bc382-1105">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1105">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1106">Observateurs d’événements affichent ces valeurs de chaîne pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1106">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1107">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1107">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1108">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1108">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1109">En plus de l’identificateur d’événement, vous pouvez spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1109">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1110">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1110">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1111">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1111">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1112">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant de pouvoir écrire des entrées dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1112">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="bc382-1113">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1113">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-1114">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1114">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1115">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1115">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1116">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1116">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1117">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1117">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1118">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1118">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1119">Si la source spécifiée dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété de ce <xref:System.Diagnostics.EventLog> instance n’est pas inscrit sur l’ordinateur sur lequel votre composant est écrit, <xref:System.Diagnostics.EventLog.WriteEntry%2A> appelle <xref:System.Diagnostics.EventLog.CreateEventSource%2A> et inscrit la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1119">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1120">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1120">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1121">Si le système doit enregistrer le <xref:System.Diagnostics.EventLog.Source%2A> via un appel à <xref:System.Diagnostics.EventLog.WriteEntry%2A> et <xref:System.Diagnostics.EventLog.Log%2A> propriété n’a pas été définie sur votre <xref:System.Diagnostics.EventLog> instance, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-1121">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1122">De nombreuses exceptions répertoriées ci-dessus sont générées par des erreurs déclenchées au cours du processus d’inscription de le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1122">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1123">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1123">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1124">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1124">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1125">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1125">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1126">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1126">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1127">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1127">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1128">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1128">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1129">Si vous écrivez une entrée à un ordinateur distant, la valeur du message (la chaîne de texte) ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1129">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1130">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1130">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1131">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1131">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1132">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1132">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1133">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1133">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1134">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1134">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1135">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1135">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1136">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1136">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1137">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1137">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1138">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1138">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1139">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1139">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1140">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1140">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1141">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1141">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1142">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1142">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1143">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1143">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="bc382-1144">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1144">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1145">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1145">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1146">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1146">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1147">Utilisez cette méthode pour écrire une entrée d’un <xref:System.Diagnostics.EventLogEntryType> dans le journal des événements à l’aide d’une source déjà inscrite comme source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1147">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1148">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1148">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1149">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1149">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1150">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1150">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1151">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1151">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1152">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1152">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1153">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1153">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1154">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1154">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1155">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1155">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1156">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1156">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1157">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1157">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1158">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1158">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1159">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1159">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1160">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1160">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1161">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1161">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1162">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1162">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1163">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1163">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1164">L’exemple suivant écrit une entrée d’avertissement dans un journal des événements, « MyNewLog », sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-1164">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1165">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1165">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1166">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1166">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1167">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1167">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1168">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1168">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1169">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1169">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1170">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1170">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1171">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1171">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1172">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1172">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1173">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1173">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1174">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1174">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="bc382-1175">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1175">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1176">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1176">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1177">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1177">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="bc382-1178">The application-specific subcategory associated with the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1178">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1179">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1179">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1180">Utilisez cette méthode pour écrire une entrée avec un définies par l’application `category` dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1180">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="bc382-1181">L’Observateur d’événements utilise la catégorie pour filtrer les événements écrits par une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1181">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="bc382-1182">L’Observateur d’événements peut afficher la catégorie en tant que valeur numérique, ou utiliser la catégorie comme identificateur de ressource pour afficher une chaîne de catégorie localisée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1182">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1183">Le `category` paramètre doit être une valeur positive.</span><span class="sxs-lookup"><span data-stu-id="bc382-1183">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="bc382-1184">Valeurs de catégorie négatives apparaissent sous la forme d’un nombre positif complémentaire dans l’événement visionneuse.</span><span class="sxs-lookup"><span data-stu-id="bc382-1184">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="bc382-1185">Par exemple, -10 s’affiche sous la forme 65 526 et, une valeur -1 à 65 535.</span><span class="sxs-lookup"><span data-stu-id="bc382-1185">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1186">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1186">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1187">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1187">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1188">Pour afficher les chaînes de catégorie localisée dans l’Observateur d’événements, vous devez utiliser une source d’événement configuré avec un fichier de ressources de catégorie et définir le `category` à un identificateur de ressource dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="bc382-1188">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="bc382-1189">Si la source d’événements n’a pas un fichier de ressources de catégorie configuré ou spécifié `category` n’indexe pas une chaîne dans le fichier de ressources de catégorie, puis l’Observateur d’événements affiche la valeur de catégorie numérique pour cette entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1189">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="bc382-1190">Configurer le fichier de ressources de catégorie, ainsi que le nombre de chaînes de catégorie dans le fichier de ressources, à l’aide de la <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="bc382-1190">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="bc382-1191">En plus de la catégorie, vous pouvez spécifier un identificateur d’événement pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1191">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1192">Les identificateurs d’événements, ainsi que la source d’événements, identifient de manière unique un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1192">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="bc382-1193">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1193">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1194">Observateurs d’événements affichent ces valeurs de chaîne pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1194">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="bc382-1195">Enfin, vous pouvez spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1195">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1196">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1196">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1197">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1197">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1198">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant de pouvoir écrire des entrées dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1198">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="bc382-1199">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1199">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-1200">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1200">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1201">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1201">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1202">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1202">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1203">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1203">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1204">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1204">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1205">Si la source spécifiée dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété de ce <xref:System.Diagnostics.EventLog> instance n’est pas inscrit sur l’ordinateur sur lequel votre composant est écrit, <xref:System.Diagnostics.EventLog.WriteEntry%2A> appelle <xref:System.Diagnostics.EventLog.CreateEventSource%2A> et inscrit la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1205">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1206">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1206">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1207">Si le système doit enregistrer le <xref:System.Diagnostics.EventLog.Source%2A> via un appel à <xref:System.Diagnostics.EventLog.WriteEntry%2A> et <xref:System.Diagnostics.EventLog.Log%2A> propriété n’a pas été définie sur votre <xref:System.Diagnostics.EventLog> instance, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-1207">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1208">De nombreuses exceptions répertoriées ci-dessus sont générées par des erreurs déclenchées au cours du processus d’inscription de le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1208">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1209">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1209">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1210">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1210">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1211">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1211">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1212">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1212">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1213">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1213">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1214">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1214">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1215">Si vous écrivez une entrée à un ordinateur distant, la valeur du message (la chaîne de texte) ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1215">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1216">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1216">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1217">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1217">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1218">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1218">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1219">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1219">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1220">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1220">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1221">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1221">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1222">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1222">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1223">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1223">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1224">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1224">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1225">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1225">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1226">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1226">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1227">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1227">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1228">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1228">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1229">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1229">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="bc382-1230">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1230">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1231">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1231">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1232">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1232">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1233">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1233">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1234">Utilisez cette méthode pour écrire une entrée avec un définies par l’application `eventID` dans le journal des événements à l’aide d’une source déjà inscrite comme source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1234">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1235">Le `eventID`, ainsi que la source, identifient un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1235">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="bc382-1236">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1236">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1237">Observateurs d’événements affiche ces chaînes à l’utilisateur pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1237">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1238">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1238">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1239">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1239">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="bc382-1240">En plus de l’identificateur d’événement, cette surcharge de <xref:System.Diagnostics.EventLog.WriteEntry%2A> vous permet de spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1240">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1241">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1241">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1242">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1242">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1243">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1243">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1244">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1244">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1245">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1245">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1246">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1246">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1247">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1247">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1248">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1248">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1249">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1249">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1250">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1250">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1251">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1251">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1252">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1252">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1253">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1253">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1254">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1254">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1255">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1255">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1256">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1256">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1257">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1257">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1258">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1258">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1259">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1259">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1260">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1260">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1261">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1261">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1262">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1262">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1263">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1263">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1264">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1264">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1265">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1265">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1266">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1266">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="bc382-1267">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1267">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1268">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1268">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1269">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1269">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="bc382-1270">The application-specific subcategory associated with the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1270">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="bc382-1271">An array of bytes that holds the binary data associated with the entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1271">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1272">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1272">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1273">Utilisez cette surcharge pour écrire des données de spécifiques à l’événement défini par l’application dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1273">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="bc382-1274">L’Observateur d’événements n’interprète pas ces données ; Il affiche les données brutes uniquement dans un format combiné hexadécimal et texte.</span><span class="sxs-lookup"><span data-stu-id="bc382-1274">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="bc382-1275">Utiliser avec parcimonie les données spécifiques à l’événement en incluant uniquement si vous êtes sûr qu’il sera utile à une personne déboguer le problème.</span><span class="sxs-lookup"><span data-stu-id="bc382-1275">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="bc382-1276">Vous pouvez également utiliser des données spécifiques à l’événement pour stocker les informations de que l’application peut traiter indépendamment de l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1276">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="bc382-1277">Par exemple, vous pourriez écrire une visionneuse spécifique pour vos événements ou écrire un programme qui analyse le fichier journal et crée des rapports qui incluent des informations à partir des données spécifiques à l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1277">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="bc382-1278">En plus des données binaires, vous pouvez spécifier une catégorie définie par l’application et un identificateur d’événement défini par l’application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1278">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="bc382-1279">L’Observateur d’événements utilise la catégorie pour filtrer les événements écrits par une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1279">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="bc382-1280">L’Observateur d’événements peut afficher la catégorie en tant que valeur numérique, ou utiliser la catégorie comme identificateur de ressource pour afficher une chaîne de catégorie localisée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1280">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1281">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1281">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1282">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1282">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1283">Le `category` paramètre doit être une valeur positive.</span><span class="sxs-lookup"><span data-stu-id="bc382-1283">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="bc382-1284">Valeurs de catégorie négatives apparaissent sous la forme d’un nombre positif complémentaire dans l’événement visionneuse.</span><span class="sxs-lookup"><span data-stu-id="bc382-1284">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="bc382-1285">Par exemple, -10 s’affiche sous la forme 65 526 et, une valeur -1 à 65 535.</span><span class="sxs-lookup"><span data-stu-id="bc382-1285">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="bc382-1286">Pour afficher les chaînes de catégorie localisée dans l’Observateur d’événements, vous devez utiliser une source d’événement configuré avec un fichier de ressources de catégorie et définir le `category` à un identificateur de ressource dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="bc382-1286">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="bc382-1287">Si la source d’événements n’a pas un fichier de ressources de catégorie configuré ou spécifié `category` n’indexe pas une chaîne dans le fichier de ressources de catégorie, puis l’Observateur d’événements affiche la valeur de catégorie numérique pour cette entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1287">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="bc382-1288">Configurer le fichier de ressources de catégorie, ainsi que le nombre de chaînes de catégorie dans le fichier de ressources, à l’aide de la <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="bc382-1288">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="bc382-1289">Les identificateurs d’événements, ainsi que la source d’événements, identifient de manière unique un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1289">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="bc382-1290">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1290">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1291">Observateurs d’événements affichent ces valeurs de chaîne pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1291">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="bc382-1292">Enfin, vous pouvez spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1292">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1293">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1293">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1294">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1294">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1295">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant de pouvoir écrire des entrées dans le journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1295">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="bc382-1296">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1296">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="bc382-1297">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1297">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1298">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1298">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1299">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1299">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1300">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1300">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1301">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1301">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1302">Si la source spécifiée dans le <xref:System.Diagnostics.EventLog.Source%2A> propriété de ce <xref:System.Diagnostics.EventLog> instance n’est pas inscrit sur l’ordinateur sur lequel votre composant est écrit, <xref:System.Diagnostics.EventLog.WriteEntry%2A> appelle <xref:System.Diagnostics.EventLog.CreateEventSource%2A> et inscrit la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1302">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1303">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1303">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1304">Si le système doit enregistrer le <xref:System.Diagnostics.EventLog.Source%2A> via un appel à <xref:System.Diagnostics.EventLog.WriteEntry%2A> et <xref:System.Diagnostics.EventLog.Log%2A> propriété n’a pas été définie sur votre <xref:System.Diagnostics.EventLog> instance, le journal par défaut est le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="bc382-1304">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1305">De nombreuses exceptions répertoriées ci-dessus sont générées par des erreurs déclenchées au cours du processus d’inscription de le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1305">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="bc382-1306">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1306">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1307">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1307">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1308">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1308">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1309">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1309">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1310">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1310">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1311">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1311">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1312">Si vous écrivez une entrée à un ordinateur distant, la valeur du message (la chaîne de texte) ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1312">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1313">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1313">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1314">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1314">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1315">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1315">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1316">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1316">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1317">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1317">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1318">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1318">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1319">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1319">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1320">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1320">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1321">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1321">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1322">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1322">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1323">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1323">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1324">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1324">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1325">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1325">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1326">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1326">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="bc382-1327">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1327">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1328">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1328">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1329">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1329">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="bc382-1330">The application-specific subcategory associated with the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1330">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1331">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1331">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span>
          </span>
          <span data-ttu-id="bc382-1332">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1332">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1333">Utilisez cette méthode pour écrire une entrée avec un définies par l’application `category` dans le journal des événements, à l’aide d’une source qui est déjà inscrite comme source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1333">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1334">L’Observateur d’événements utilise la catégorie pour filtrer les événements écrits par une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1334">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="bc382-1335">L’Observateur d’événements peut afficher la catégorie en tant que valeur numérique, ou utiliser la catégorie comme identificateur de ressource pour afficher une chaîne de catégorie localisée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1335">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1336">Le `category` paramètre doit être une valeur positive.</span><span class="sxs-lookup"><span data-stu-id="bc382-1336">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="bc382-1337">Valeurs de catégorie négatives apparaissent sous la forme d’un nombre positif complémentaire dans l’événement visionneuse.</span><span class="sxs-lookup"><span data-stu-id="bc382-1337">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="bc382-1338">Par exemple, -10 s’affiche sous la forme 65 526 et, une valeur -1 à 65 535.</span><span class="sxs-lookup"><span data-stu-id="bc382-1338">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="bc382-1339">Pour afficher les chaînes de catégorie localisée dans l’Observateur d’événements, vous devez utiliser une source d’événement configuré avec un fichier de ressources de catégorie et définir le `category` à un identificateur de ressource dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="bc382-1339">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="bc382-1340">Si la source d’événements n’a pas un fichier de ressources de catégorie configuré ou spécifié `category` n’indexe pas une chaîne dans le fichier de ressources de catégorie, puis l’Observateur d’événements affiche la valeur de catégorie numérique pour cette entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1340">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="bc382-1341">Configurer le fichier de ressources de catégorie, ainsi que le nombre de chaînes de catégorie dans le fichier de ressources, à l’aide de la <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="bc382-1341">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="bc382-1342">En plus de la catégorie, vous pouvez spécifier un identificateur d’événement pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1342">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1343">Les identificateurs d’événements, ainsi que la source d’événements, identifient de manière unique un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1343">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="bc382-1344">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1344">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1345">Observateurs d’événements affichent ces valeurs de chaîne pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1345">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="bc382-1346">Enfin, vous pouvez spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1346">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1347">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1347">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1348">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1348">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1349">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1349">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1350">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1350">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1351">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1351">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1352">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1352">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1353">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1353">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1354">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1354">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1355">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1355">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1356">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1356">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1357">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1357">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1358">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1358">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1359">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1359">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1360">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1360">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1361">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1361">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="bc382-1362">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1362">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1363">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1363">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1364">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1364">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1365">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1365">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1366">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1366">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1367">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1367">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1368">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1368">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1369">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1369">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1370">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1370">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1371">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1371">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1372">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1372">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1373">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1373">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1374">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1374">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1375">The source by which the application is registered on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1375">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="bc382-1376">The string to write to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1376">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="bc382-1377">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1377">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="bc382-1378">The application-specific identifier for the event.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1378">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="bc382-1379">The application-specific subcategory associated with the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1379">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="bc382-1380">An array of bytes that holds the binary data associated with the entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1380">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1381">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1381">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1382">Utilisez cette méthode pour écrire des données de spécifiques à l’événement défini par l’application dans le journal des événements, à l’aide d’une source déjà inscrite en tant que source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1382">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1383">L’Observateur d’événements n’interprète pas ces données ; Il affiche les données brutes uniquement dans un format combiné hexadécimal et texte.</span><span class="sxs-lookup"><span data-stu-id="bc382-1383">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="bc382-1384">Utiliser des données spécifiques à l’événement. inclure uniquement si vous êtes sûr qu’il sera utile.</span><span class="sxs-lookup"><span data-stu-id="bc382-1384">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="bc382-1385">Vous pouvez également utiliser des données spécifiques à l’événement pour stocker les informations de que l’application peut traiter indépendamment de l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1385">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="bc382-1386">Par exemple, vous pourriez écrire une visionneuse spécifique pour vos événements ou écrire un programme qui analyse le fichier journal et crée des rapports qui incluent des informations à partir des données spécifiques à l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1386">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="bc382-1387">En plus des données binaires, vous pouvez spécifier une catégorie définie par l’application et un identificateur d’événement défini par l’application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1387">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="bc382-1388">L’Observateur d’événements utilise la catégorie pour filtrer les événements écrits par une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1388">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="bc382-1389">L’Observateur d’événements peut afficher la catégorie en tant que valeur numérique, ou utiliser la catégorie comme identificateur de ressource pour afficher une chaîne de catégorie localisée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1389">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1390">Le `category` paramètre doit être une valeur positive.</span><span class="sxs-lookup"><span data-stu-id="bc382-1390">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="bc382-1391">Valeurs de catégorie négatives apparaissent sous la forme d’un nombre positif complémentaire dans l’événement visionneuse.</span><span class="sxs-lookup"><span data-stu-id="bc382-1391">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="bc382-1392">Par exemple, -10 s’affiche sous la forme 65 526 et, une valeur -1 à 65 535.</span><span class="sxs-lookup"><span data-stu-id="bc382-1392">For example, a –10 will appear as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="bc382-1393">Pour afficher les chaînes de catégorie localisée dans l’Observateur d’événements, vous devez utiliser une source d’événement configuré avec un fichier de ressources de catégorie et définir le `category` à un identificateur de ressource dans le fichier de ressources de catégorie.</span><span class="sxs-lookup"><span data-stu-id="bc382-1393">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="bc382-1394">Si la source d’événements n’a pas un fichier de ressources de catégorie configuré ou spécifié `category` n’indexe pas une chaîne dans le fichier de ressources de catégorie, puis l’Observateur d’événements affiche la valeur de catégorie numérique pour cette entrée.</span><span class="sxs-lookup"><span data-stu-id="bc382-1394">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="bc382-1395">Configurer le fichier de ressources de catégorie, ainsi que le nombre de chaînes de catégorie dans le fichier de ressources, à l’aide de la <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="bc382-1395">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="bc382-1396">Les identificateurs d’événements, ainsi que la source d’événements, identifient de manière unique un événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1396">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="bc382-1397">Chaque application peut définir ses propres événements numérotés et les chaînes de description à laquelle ils sont mappés.</span><span class="sxs-lookup"><span data-stu-id="bc382-1397">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="bc382-1398">Observateurs d’événements affichent ces valeurs de chaîne pour aider l’utilisateur à comprendre la cause du problème et suggérer les mesures à prendre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1398">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="bc382-1399">Enfin, vous pouvez spécifier un <xref:System.Diagnostics.EventLogEntryType> pour l’événement en cours d’écriture dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1399">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="bc382-1400">Le `type` est indiqué par une icône et le texte de la colonne de Type dans l’Observateur d’événements pour un journal.</span><span class="sxs-lookup"><span data-stu-id="bc382-1400">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="bc382-1401">Ce paramètre indique si le type d’événement est erreur, avertissement, information, d’audit des succès ou audit des échecs.</span><span class="sxs-lookup"><span data-stu-id="bc382-1401">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="bc382-1402">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1402">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1403">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1403">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1404">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1404">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1405">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1405">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1406">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1406">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1407">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1407">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1408">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1408">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1409">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="bc382-1409">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="bc382-1410">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1410">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="bc382-1411">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1411">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1412">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1412">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1413">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1413">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1414">Si le `message` paramètre contient un caractère NUL, le message dans le journal des événements est arrêté au caractère NUL.</span><span class="sxs-lookup"><span data-stu-id="bc382-1414">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="bc382-1415">Le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1415">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1416">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1416">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1417">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1417">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1418">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1418">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1419">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1419">\- or -  <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1420">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1420">\- or -  The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="bc382-1421">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1421">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="bc382-1422">
            <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1422">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1423">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1423">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1424">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1424">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1425">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1425">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1426">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1426">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1427">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1427">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bc382-1428">Writes a localized event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1428">Writes a localized event entry to the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="bc382-1429">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1429">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="bc382-1430">An array of strings to merge into the message text of the event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1430">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1431">Writes a localized entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1431">Writes a localized entry to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1432">Utilisez cette méthode pour écrire une entrée localisée dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1432">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="bc382-1433">Vous spécifiez les propriétés d’événement avec les identificateurs de ressources au lieu des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="bc382-1433">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="bc382-1434">L’Observateur d’événements utilise les identificateurs de ressource pour afficher les chaînes correspondants à partir du fichier de ressources localisé pour le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1434">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="bc382-1435">Vous devez inscrire la source avec le fichier de ressources correspondant avant d’écrire des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1435">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="bc382-1436">L’entrée `instance` instance spécifie les propriétés et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1436">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="bc382-1437">Définir le <xref:System.Diagnostics.EventInstance.InstanceId%2A> de la `instance` d’entrée pour le message défini dans le fichier de ressources du message source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1437">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="bc382-1438">Vous pouvez éventuellement définir le <xref:System.Diagnostics.EventInstance.CategoryId%2A> et <xref:System.Diagnostics.EventInstance.EntryType%2A> de la `instance` entrée pour définir le type de catégorie et les événements de votre entrée d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1438">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="bc382-1439">Vous pouvez également spécifier un tableau de chaînes indépendant du langage à insérer dans le texte du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1439">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="bc382-1440">Définissez `values` à `null` si le message d’événement ne contient pas de mise en forme des espaces réservés pour les chaînes de remplacement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1440">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="bc382-1441">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant d’utiliser <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1441">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="bc382-1442">La source spécifiée doit être configurée pour écrire des entrées localisées dans le journal ; la source doit au moins avoir un fichier de ressources de message défini.</span><span class="sxs-lookup"><span data-stu-id="bc382-1442">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="bc382-1443">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1443">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1444">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1444">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1445">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1445">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1446">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1446">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1447">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1447">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1448">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1448">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1449">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1449">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1450">Utilisez la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode si votre application écrit les valeurs de chaîne directement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1450">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="bc382-1451">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1451">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1452">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1452">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1453">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1453">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1454">Si vous écrivez une entrée à un ordinateur distant, la valeur de la `message` chaîne ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1454">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="bc382-1455">En outre, le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1455">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1456">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1456">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1457">L’exemple suivant écrit deux entrées d’audit dans le journal des événements `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-1457">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="bc382-1458">L’exemple crée une nouvelle source d’événement et un journal des événements s’ils n’existent pas sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-1458">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="bc382-1459">Le texte de message d’événement est spécifié à l’aide d’un identificateur de ressource dans un fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1459">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="bc382-1460">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-1460">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-1461">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1461">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-1462">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1462">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1463">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1463">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1464">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1464">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1465">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1465">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1466">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1466">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1467">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1467">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="bc382-1468">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1468">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="bc382-1469">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1469">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-1470">
            <paramref name="instance" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1470">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1471">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1471">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1472">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1472">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1473">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1473">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1474">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1474">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1475">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1475">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="bc382-1476">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1476">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="bc382-1477">An array of bytes that holds the binary data associated with the entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1477">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="bc382-1478">An array of strings to merge into the message text of the event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1478">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1479">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1479">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1480">Utilisez cette méthode pour écrire une entrée localisée avec d’autres données spécifiques à l’événement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1480">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="bc382-1481">Vous spécifiez les propriétés d’événement avec les identificateurs de ressources au lieu des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="bc382-1481">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="bc382-1482">L’Observateur d’événements utilise les identificateurs de ressource pour afficher les chaînes correspondants à partir du fichier de ressources localisé pour le <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1482">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="bc382-1483">Vous devez inscrire la source avec le fichier de ressources correspondant avant d’écrire des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1483">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="bc382-1484">L’entrée `instance` instance spécifie les propriétés et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1484">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="bc382-1485">Définir le <xref:System.Diagnostics.EventInstance.InstanceId%2A> de la `instance` d’entrée pour le message défini dans le fichier de ressources du message source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1485">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="bc382-1486">Vous pouvez éventuellement définir le <xref:System.Diagnostics.EventInstance.CategoryId%2A> et <xref:System.Diagnostics.EventInstance.EntryType%2A> de la `instance` entrée pour définir le type de catégorie et les événements de votre entrée d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1486">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="bc382-1487">Vous pouvez également spécifier un tableau de chaînes indépendant du langage à insérer dans le texte du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1487">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="bc382-1488">Définissez `values` à `null` si le message d’événement ne contient pas de mise en forme des espaces réservés pour les chaînes de remplacement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1488">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="bc382-1489">Spécifiez les données binaires avec un événement lorsqu’il est nécessaire de fournir des détails supplémentaires pour l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1489">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="bc382-1490">Par exemple, utiliser le `data` paramètre pour inclure des informations sur une erreur spécifique.</span><span class="sxs-lookup"><span data-stu-id="bc382-1490">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="bc382-1491">L’Observateur d’événements n’interprète pas les données d’événement associées ; Il affiche les données dans un format combiné hexadécimal et texte.</span><span class="sxs-lookup"><span data-stu-id="bc382-1491">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="bc382-1492">Utiliser des données spécifiques à l’événement. inclure uniquement si vous êtes sûr qu’il sera utile.</span><span class="sxs-lookup"><span data-stu-id="bc382-1492">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="bc382-1493">Vous pouvez également utiliser des données spécifiques à l’événement pour stocker les informations de que l’application peut traiter indépendamment de l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1493">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="bc382-1494">Par exemple, vous pourriez écrire une visionneuse spécifique pour vos événements ou écrire un programme qui analyse le journal des événements et crée des rapports qui incluent des informations à partir des données spécifiques à l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1494">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="bc382-1495">Vous devez définir le <xref:System.Diagnostics.EventLog.Source%2A> propriété sur votre <xref:System.Diagnostics.EventLog> composant avant le composant avant d’utiliser <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1495">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="bc382-1496">La source spécifiée doit être configurée pour écrire des entrées localisées dans le journal ; la source doit au moins avoir un fichier de ressources de message défini.</span><span class="sxs-lookup"><span data-stu-id="bc382-1496">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="bc382-1497">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1497">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1498">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1498">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1499">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1499">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1500">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1500">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1501">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1501">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1502">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1502">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1503">Si vous ne spécifiez pas un <xref:System.Diagnostics.EventLog.MachineName%2A> pour votre <xref:System.Diagnostics.EventLog> avant d’appeler l’instance <xref:System.Diagnostics.EventLog.WriteEvent%2A>, l’ordinateur local («. ») est supposé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1503">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="bc382-1504">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1504">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1505">Utilisez la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode si votre application écrit les valeurs de chaîne directement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1505">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="bc382-1506">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1506">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1507">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1507">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1508">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1508">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bc382-1509">Si vous écrivez une entrée à un ordinateur distant, la valeur de la `message` chaîne ne peut pas être ce que vous attendez si l’ordinateur distant ne fonctionne pas le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="bc382-1509">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="bc382-1510">En outre, le `message` chaîne ne peut pas contenir %*n*, où *n* est une valeur entière (par exemple, %1), car l’Observateur d’événements traite comme une chaîne d’insertion.</span><span class="sxs-lookup"><span data-stu-id="bc382-1510">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="bc382-1511">Étant donné que le protocole d’Internet, version 6 (IPv6) adresse peut contenir cette séquence de caractères, un message d’événement qui contient une adresse IPv6 ne peut pas se connecter.</span><span class="sxs-lookup"><span data-stu-id="bc382-1511">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1512">L’exemple suivant écrit deux entrées d’audit dans le journal des événements `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="bc382-1512">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="bc382-1513">L’exemple crée une nouvelle source d’événement et un journal des événements s’ils n’existent pas sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="bc382-1513">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="bc382-1514">Le texte de message d’événement est spécifié à l’aide d’un identificateur de ressource dans un fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1514">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="bc382-1515">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-1515">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-1516">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1516">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-1517">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1517">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1518">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1518">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="bc382-1519">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1519">-or-  The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="bc382-1520">\- or -  The source is already registered for a different event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1520">\- or -  The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="bc382-1521">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1521">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1522">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1522">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="bc382-1523">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1523">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="bc382-1524">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1524">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-1525">
            <paramref name="instance" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1525">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1526">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1526">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1527">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1527">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1528">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1528">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1529">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1529">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1530">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1530">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1531">The name of the event source registered for the application on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1531">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="bc382-1532">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1532">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="bc382-1533">An array of strings to merge into the message text of the event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1533">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1534">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1534">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1535">Utilisez cette méthode pour écrire une entrée localisée dans le journal des événements à l’aide d’une source déjà inscrite en tant que source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1535">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1536">Vous spécifiez les propriétés d’événement avec les identificateurs de ressources au lieu des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="bc382-1536">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="bc382-1537">L’Observateur d’événements utilise les identificateurs de ressource pour afficher les chaînes correspondants à partir du fichier de ressources localisé pour la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1537">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="bc382-1538">Vous devez inscrire la source avec le fichier de ressources correspondant avant d’écrire des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1538">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="bc382-1539">L’entrée `instance` instance spécifie les propriétés et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1539">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="bc382-1540">Définir le <xref:System.Diagnostics.EventInstance.InstanceId%2A> de la `instance` d’entrée pour le message défini dans le fichier de ressources du message source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1540">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="bc382-1541">Vous pouvez éventuellement définir le <xref:System.Diagnostics.EventInstance.CategoryId%2A> et <xref:System.Diagnostics.EventInstance.EntryType%2A> de la `instance` entrée pour définir le type de catégorie et les événements de votre entrée d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1541">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="bc382-1542">Vous pouvez également spécifier un tableau de chaînes indépendant du langage à insérer dans le texte du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1542">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="bc382-1543">Définissez `values` à `null` si le message d’événement ne contient pas de mise en forme des espaces réservés pour les chaînes de remplacement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1543">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="bc382-1544">La source spécifiée doit être enregistrée pour un journal des événements avant d’utiliser <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1544">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="bc382-1545">La source spécifiée doit être configurée pour écrire des entrées localisées dans le journal ; la source doit au moins avoir un fichier de ressources de message défini.</span><span class="sxs-lookup"><span data-stu-id="bc382-1545">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="bc382-1546">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1546">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1547">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1547">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1548">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1548">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1549">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1549">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1550">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1550">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1551">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1551">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1552">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1552">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1553">Utilisez la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode si votre application écrit les valeurs de chaîne directement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1553">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="bc382-1554">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1554">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1555">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1555">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1556">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1556">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1557">L’exemple suivant écrit une entrée d’événement d’information et d’une entrée d’événement avertissement dans un journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="bc382-1557">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="bc382-1558">Le texte de message d’événement est spécifié à l’aide d’un identificateur de ressource dans un fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1558">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="bc382-1559">L’exemple suppose que le fichier de ressources correspondant a été enregistré pour la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1559">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="bc382-1560">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-1560">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-1561">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1561">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-1562">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1562">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1563">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1563">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1564">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1564">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1565">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1565">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1566">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1566">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="bc382-1567">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1567">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="bc382-1568">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1568">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-1569">
            <paramref name="instance" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1569">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1570">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1570">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1571">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1571">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1572">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1572">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1573">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1573">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1574">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1574">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="bc382-1575">The name of the event source registered for the application on the specified computer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1575">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="bc382-1576">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1576">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="bc382-1577">An array of bytes that holds the binary data associated with the entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1577">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="bc382-1578">An array of strings to merge into the message text of the event log entry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1578">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bc382-1579">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1579">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bc382-1580">Utilisez cette méthode pour écrire une entrée localisée avec d’autres données spécifiques à l’événement dans le journal des événements, à l’aide d’une source déjà inscrite en tant que source d’événements pour le journal approprié.</span><span class="sxs-lookup"><span data-stu-id="bc382-1580">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="bc382-1581">Vous spécifiez les propriétés d’événement avec les identificateurs de ressources au lieu des valeurs de chaîne.</span><span class="sxs-lookup"><span data-stu-id="bc382-1581">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="bc382-1582">L’Observateur d’événements utilise les identificateurs de ressource pour afficher les chaînes correspondants à partir du fichier de ressources localisé pour la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1582">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="bc382-1583">Vous devez inscrire la source avec le fichier de ressources correspondant avant d’écrire des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1583">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="bc382-1584">L’entrée `instance` instance spécifie les propriétés et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1584">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="bc382-1585">Définir le <xref:System.Diagnostics.EventInstance.InstanceId%2A> de la `instance` d’entrée pour le message défini dans le fichier de ressources du message source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1585">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="bc382-1586">Vous pouvez éventuellement définir le <xref:System.Diagnostics.EventInstance.CategoryId%2A> et <xref:System.Diagnostics.EventInstance.EntryType%2A> de la `instance` entrée pour définir le type de catégorie et les événements de votre entrée d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1586">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="bc382-1587">Vous pouvez également spécifier un tableau de chaînes indépendant du langage à insérer dans le texte du message localisé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1587">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="bc382-1588">Définissez `values` à `null` si le message d’événement ne contient pas de mise en forme des espaces réservés pour les chaînes de remplacement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1588">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="bc382-1589">Spécifiez les données binaires avec un événement lorsqu’il est nécessaire de fournir des détails supplémentaires pour l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1589">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="bc382-1590">Par exemple, utiliser le `data` paramètre pour inclure des informations sur une erreur spécifique.</span><span class="sxs-lookup"><span data-stu-id="bc382-1590">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="bc382-1591">L’Observateur d’événements n’interprète pas les données d’événement associées ; Il affiche les données dans un format combiné hexadécimal et texte.</span><span class="sxs-lookup"><span data-stu-id="bc382-1591">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="bc382-1592">Utiliser des données spécifiques à l’événement. inclure uniquement si vous êtes sûr qu’il sera utile.</span><span class="sxs-lookup"><span data-stu-id="bc382-1592">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="bc382-1593">Vous pouvez également utiliser des données spécifiques à l’événement pour stocker les informations de que l’application peut traiter indépendamment de l’Observateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1593">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="bc382-1594">Par exemple, vous pourriez écrire une visionneuse spécifique pour vos événements ou écrire un programme qui analyse le journal des événements et crée des rapports qui incluent des informations à partir des données spécifiques à l’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1594">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="bc382-1595">La source spécifiée doit être enregistrée pour un journal des événements avant d’utiliser <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc382-1595">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="bc382-1596">La source spécifiée doit être configurée pour écrire des entrées localisées dans le journal ; la source doit au moins avoir un fichier de ressources de message défini.</span><span class="sxs-lookup"><span data-stu-id="bc382-1596">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="bc382-1597">Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1597">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="bc382-1598">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="bc382-1598">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="bc382-1599">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrites et leur configuration.</span><span class="sxs-lookup"><span data-stu-id="bc382-1599">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="bc382-1600">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="bc382-1600">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="bc382-1601">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="bc382-1601">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="bc382-1602">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="bc382-1602">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="bc382-1603">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1603">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="bc382-1604">Utilisez la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode si votre application écrit les valeurs de chaîne directement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1604">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="bc382-1605">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc382-1605">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="bc382-1606">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="bc382-1606">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="bc382-1607">Créez une autre source, sans fichiers de ressources et utilisez-la dans le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1607">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bc382-1608">L’exemple suivant écrit une entrée d’événement d’information et d’une entrée d’événement avertissement dans un journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="bc382-1608">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="bc382-1609">Le texte de message d’événement est spécifié à l’aide d’un identificateur de ressource dans un fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="bc382-1609">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="bc382-1610">L’exemple suppose que le fichier de ressources correspondant a été enregistré pour la source.</span><span class="sxs-lookup"><span data-stu-id="bc382-1610">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="bc382-1611">L’exemple utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="bc382-1611">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="bc382-1612">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="bc382-1612">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="bc382-1613">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc382-1613">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bc382-1614">The <paramref name="source" /> value is an empty string ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1614">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="bc382-1615">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1615">\- or -  The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="bc382-1616">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1616">\- or -  <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="bc382-1617">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1617">\- or -  <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="bc382-1618">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1618">\- or -  One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="bc382-1619">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1619">\- or -  The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="bc382-1620">
            <paramref name="instance" /> is <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1620">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bc382-1621">The registry key for the event log could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1621">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="bc382-1622">The operating system reported an error when writing the event entry to the event log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1622">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="bc382-1623">A Windows error code is not available.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1623">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="bc382-1624">pour écrire les informations du journal des événements sur l’ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1624">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="bc382-1625">Énumération associée : <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="bc382-1625">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>