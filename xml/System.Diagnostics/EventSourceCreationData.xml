<Type Name="EventSourceCreationData" FullName="System.Diagnostics.EventSourceCreationData">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="cc5fb64c08e7407b6912a57b42da416cf47201c6" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30399683" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class EventSourceCreationData" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventSourceCreationData extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventSourceCreationData" />
  <TypeSignature Language="VB.NET" Value="Public Class EventSourceCreationData" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventSourceCreationData" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="84c66-101">Représente les paramètres de configuration utilisés pour créer une source de journal des événements sur l'ordinateur local ou un ordinateur distant.</span>
      <span class="sxs-lookup">
        <span data-stu-id="84c66-101">Represents the configuration settings used to create an event log source on the local computer or a remote computer.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-102">Utilisez la <xref:System.Diagnostics.EventSourceCreationData> classe permettant de configurer une nouvelle source pour écrire des entrées localisées dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-102">Use the <xref:System.Diagnostics.EventSourceCreationData> class to configure a new source for writing localized entries to an event log.</span></span> <span data-ttu-id="84c66-103">Il n’est pas nécessaire d’utiliser cette classe pour lire à partir d’un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-103">It is not necessary to use this class to read from an event log.</span></span>  
  
 <span data-ttu-id="84c66-104">Cette classe définit les paramètres de configuration pour une source d’événement et son journal des événements associé.</span><span class="sxs-lookup"><span data-stu-id="84c66-104">This class defines the configuration settings for a new event source and its associated event log.</span></span> <span data-ttu-id="84c66-105">Le journal des événements associé peut être sur l’ordinateur local ou un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="84c66-105">The associated event log can be on the local computer or a remote computer.</span></span> <span data-ttu-id="84c66-106">Pour créer une nouvelle source pour un journal des événements nouveau ou existant sur l’ordinateur local, définissez le <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> et <xref:System.Diagnostics.EventSourceCreationData.Source%2A> propriétés d’un <xref:System.Diagnostics.EventSourceCreationData> et appelez le <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="84c66-106">To create a new source for a new or existing event log on the local computer, set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.Source%2A> properties of an <xref:System.Diagnostics.EventSourceCreationData> and call the <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="84c66-107">Cette méthode crée la source d’événements que vous spécifiez dans le <xref:System.Diagnostics.EventSourceCreationData.Source%2A> propriété et des registres pour le journal des événements spécifié dans <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>.</span><span class="sxs-lookup"><span data-stu-id="84c66-107">This method creates the event source you specify in the <xref:System.Diagnostics.EventSourceCreationData.Source%2A> property and registers it for the event log specified in <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>.</span></span> <span data-ttu-id="84c66-108">Ce comportement est similaire à celle de la <xref:System.Diagnostics.EventLogInstaller> classe pour inscrire une source d’événements pour un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-108">This behavior is similar to using the <xref:System.Diagnostics.EventLogInstaller> class to register an event source for an event log.</span></span>  
  
 <span data-ttu-id="84c66-109">Utilisez le <xref:System.Diagnostics.EventLog.WriteEvent%2A> et <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthodes pour écrire des événements dans un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-109">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="84c66-110">Vous devez spécifier une source d’événement pour écrire des événements ; Vous devez créer et configurer la source d’événements avant d’écrire la première entrée avec la source.</span><span class="sxs-lookup"><span data-stu-id="84c66-110">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="84c66-111">Créer la source d’événements pendant l’installation de votre application.</span><span class="sxs-lookup"><span data-stu-id="84c66-111">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="84c66-112">Ainsi, le temps nécessaire au système d’exploitation à actualiser sa liste de sources d’événements inscrits et leurs configurations.</span><span class="sxs-lookup"><span data-stu-id="84c66-112">This allows time for the operating system to refresh its list of registered event sources and their configurations.</span></span> <span data-ttu-id="84c66-113">Si le système d’exploitation n’a pas actualisé sa liste de sources d’événements, et que vous tentez d’écrire un événement avec la nouvelle source, que l’opération d’écriture échouera.</span><span class="sxs-lookup"><span data-stu-id="84c66-113">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="84c66-114">Vous pouvez configurer une nouvelle source en utilisant un <xref:System.Diagnostics.EventLogInstaller>, ou à l’aide de la <xref:System.Diagnostics.EventLog.CreateEventSource%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="84c66-114">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="84c66-115">Vous devez disposer des droits d’administration sur l’ordinateur pour créer une source d’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-115">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="84c66-116">Vous pouvez créer une source d’événements pour un journal des événements existant ou un journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-116">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="84c66-117">Lorsque vous créez une nouvelle source pour un journal des événements, le système inscrit la source de ce journal, mais le journal n’est pas créé tant que l’écriture de la première entrée.</span><span class="sxs-lookup"><span data-stu-id="84c66-117">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="84c66-118">Chaque source ne peut écrire dans un journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-118">Each source can only write to one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="84c66-119">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="84c66-119">For example, your application might need multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="84c66-120">Pour modifier les détails de configuration d’une source existante, vous devez supprimer la source et puis de le créer avec la nouvelle configuration.</span><span class="sxs-lookup"><span data-stu-id="84c66-120">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="84c66-121">Si d’autres applications ou composants utilisent la source existante, créer une nouvelle source avec la configuration mise à jour, plutôt que de supprimer la source existante.</span><span class="sxs-lookup"><span data-stu-id="84c66-121">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
 <span data-ttu-id="84c66-122">Vous pouvez inscrire la source d’événements avec des ressources localisées pour vos chaînes de catégorie et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-122">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="84c66-123">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources, au lieu de spécifier la chaîne réelle.</span><span class="sxs-lookup"><span data-stu-id="84c66-123">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="84c66-124">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource localisée selon les paramètres de langue actuels.</span><span class="sxs-lookup"><span data-stu-id="84c66-124">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="84c66-125">Vous pouvez enregistrer un fichier distinct pour les catégories d’événements, les messages et les chaînes d’insertion de paramètre, ou vous pouvez inscrire le même fichier de ressources pour les trois types de chaînes.</span><span class="sxs-lookup"><span data-stu-id="84c66-125">You can register a separate file for event categories, messages, and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="84c66-126">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, et <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> propriétés pour configurer la source pour écrire des entrées localisées dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-126">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="84c66-127">Si votre application écrit les valeurs de chaîne directement dans le journal des événements, il est inutile de définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="84c66-127">If your application writes string values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="84c66-128">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="84c66-128">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="84c66-129">Le <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode écrit la chaîne donnée directement dans le journal des événements ; elle n’utilise pas un fichier de ressources du message localisable.</span><span class="sxs-lookup"><span data-stu-id="84c66-129">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="84c66-130">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des événements à l’aide d’un fichier de ressources du message localisé.</span><span class="sxs-lookup"><span data-stu-id="84c66-130">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="84c66-131">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="84c66-131">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="84c66-132">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-132">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="84c66-133">Créer une autre source, sans fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements à l’aide de cette source.</span><span class="sxs-lookup"><span data-stu-id="84c66-133">Then create a different source without resource files and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-134">L’exemple de code suivant définit les propriétés de configuration pour une source d’événement à partir des arguments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="84c66-134">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="84c66-135">Les arguments d’entrée spécifient le nom de source d’événement, nom du journal des événements, nom de l’ordinateur et événements message fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="84c66-135">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="84c66-136">L’exemple de code vérifie que la source n’est pas en conflit avec une source d’événement existant et qu’il crée ensuite la nouvelle source d’événements pour le journal des événements spécifié.</span><span class="sxs-lookup"><span data-stu-id="84c66-136">The code example verifies that the source does not conflict with an existing event source, and then creates the new event source for the specified event log.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#1)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#1)]
 [!code-vb[EventLog_EventSourceCreation_Properties#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <permission cref="T:System.Security.Permissions.SecurityPermission">
      <span data-ttu-id="84c66-137">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
      <span class="sxs-lookup">
        <span data-stu-id="84c66-137">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
      </span>
      <span data-ttu-id="84c66-138">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
      <span class="sxs-lookup">
        <span data-stu-id="84c66-138">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
      </span>
    </permission>
    <altmember cref="T:System.Diagnostics.EventLog" />
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventSourceCreationData (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventSourceCreationData.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventSourceCreationData(System::String ^ source, System::String ^ logName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="84c66-139">Nom à enregistrer auprès du journal des événements comme source d'entrées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-139">The name to register with the event log as a source of entries.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="84c66-140">Nom du journal dans lequel les entrées de la source sont écrites.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-140">The name of the log to which entries from the source are written.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="84c66-141">Initialise une nouvelle instance de la classe <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une source d'événements et un nom de journal des événements spécifiés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-141">Initializes a new instance of the <see cref="T:System.Diagnostics.EventSourceCreationData" /> class with a specified event source and event log name.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-142">Pour écrire des entrées dans un journal des événements, que vous devez d’abord créer une source d’événement du journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-142">To write entries to an event log, you must first create an event source for the event log.</span></span> <span data-ttu-id="84c66-143">Pour enregistrer une nouvelle source, initialisez une <xref:System.Diagnostics.EventSourceCreationData> d’une instance, configurer les propriétés de l’instance de votre application, puis appelez le <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="84c66-143">To register a new source, initialize an <xref:System.Diagnostics.EventSourceCreationData> instance, configure the instance properties for your application, and call the <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="84c66-144">Une fois que la source est inscrite, vous pouvez écrire des entrées à partir de la source à l’aide de la <xref:System.Diagnostics.EventLog.WriteEvent%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthodes.</span><span class="sxs-lookup"><span data-stu-id="84c66-144">After the source is registered, you can write entries from the source using the <xref:System.Diagnostics.EventLog.WriteEvent%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods.</span></span>  
  
 <span data-ttu-id="84c66-145">Vous pouvez inscrire la source d’événements avec des ressources localisées pour vos chaînes de catégorie et le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-145">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="84c66-146">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources, au lieu de spécifier la chaîne réelle.</span><span class="sxs-lookup"><span data-stu-id="84c66-146">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="84c66-147">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource localisée selon les paramètres de langue actuels.</span><span class="sxs-lookup"><span data-stu-id="84c66-147">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="84c66-148">Vous pouvez enregistrer un fichier distinct pour les catégories d’événements, les messages et les chaînes d’insertion de paramètre, ou vous pouvez inscrire le même fichier de ressources pour les trois types de chaînes.</span><span class="sxs-lookup"><span data-stu-id="84c66-148">You can register a separate file for event categories, messages, and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="84c66-149">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, et <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> propriétés pour configurer la source pour écrire des entrées localisées dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-149">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="84c66-150">Si votre application écrit les valeurs de chaîne directement dans le journal des événements, il est inutile de définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="84c66-150">If your application writes string values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="84c66-151">La source doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="84c66-151">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="84c66-152">Si votre application écrit des entrées à l’aide d’identificateurs de ressources et les valeurs de chaîne, vous devez inscrire deux sources distinctes.</span><span class="sxs-lookup"><span data-stu-id="84c66-152">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="84c66-153">Par exemple, configurez une source des fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées à l’aide d’identificateurs de ressource dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-153">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="84c66-154">Créer une autre source, sans fichiers de ressources, puis utilisez cette source dans la <xref:System.Diagnostics.EventLog.WriteEntry%2A> méthode pour écrire des chaînes directement dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-154">Then create a different source without resource files and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log.</span></span>  
  
 <span data-ttu-id="84c66-155">Le tableau suivant montre les valeurs initiales des propriétés pour un <xref:System.Diagnostics.EventSourceCreationData>.</span><span class="sxs-lookup"><span data-stu-id="84c66-155">The following table shows initial property values for an <xref:System.Diagnostics.EventSourceCreationData>.</span></span>  
  
|<span data-ttu-id="84c66-156">Property</span><span class="sxs-lookup"><span data-stu-id="84c66-156">Property</span></span>|<span data-ttu-id="84c66-157">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="84c66-157">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventSourceCreationData.Source%2A>|<span data-ttu-id="84c66-158">Paramètre `source`.</span><span class="sxs-lookup"><span data-stu-id="84c66-158">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>|<span data-ttu-id="84c66-159">Paramètre `logName`.</span><span class="sxs-lookup"><span data-stu-id="84c66-159">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>|<span data-ttu-id="84c66-160">L’ordinateur local («. »).</span><span class="sxs-lookup"><span data-stu-id="84c66-160">The local computer (".").</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>|<span data-ttu-id="84c66-161">Zéro</span><span class="sxs-lookup"><span data-stu-id="84c66-161">Zero</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>|<span data-ttu-id="84c66-162">`null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="84c66-162">`null` (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>|<span data-ttu-id="84c66-163">`null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="84c66-163">`null` (`Nothing` in Visual Basic).</span></span>|  
|<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>|<span data-ttu-id="84c66-164">`null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="84c66-164">`null` (`Nothing` in Visual Basic).</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="84c66-165">L’exemple de code suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="84c66-165">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="84c66-166">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-166">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="84c66-167">Enfin, l’exemple de code définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="84c66-167">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="84c66-168">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="84c66-168">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="84c66-169">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="84c66-169">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="84c66-170">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="84c66-170">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-171">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-171">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-172">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-172">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.Source" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.LogName" />
      </Docs>
    </Member>
    <Member MemberName="CategoryCount">
      <MemberSignature Language="C#" Value="public int CategoryCount { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 CategoryCount" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.CategoryCount" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryCount As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int CategoryCount { int get(); void set(int value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-173">Obtient ou définit le numéro de catégorie dans le fichier de ressources de catégorie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-173">Gets or sets the number of categories in the category resource file.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-174">Numéro de catégories dans le fichier de ressources de catégorie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-174">The number of categories in the category resource file.</span>
          </span>
          <span data-ttu-id="84c66-175">La valeur par défaut est 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-175">The default value is zero.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-176">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> et <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> propriétés pour écrire les événements avec localisées des chaînes de catégorie.</span><span class="sxs-lookup"><span data-stu-id="84c66-176">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="84c66-177">L’Observateur d’événements affiche la catégorie pour une entrée d’événement si vous fournissez une catégorie lorsque vous écrivez l’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-177">The Event Viewer displays the category for an event entry if you supply a category when you write the event.</span></span> <span data-ttu-id="84c66-178">Catégories du journal des événements sont des chaînes définies par l’application qui aident à filtrer des événements ou fournissent des informations supplémentaires sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-178">Event log categories are application-defined strings that help filter events, or provide further information on the event.</span></span> <span data-ttu-id="84c66-179">Par exemple, votre application peut définir des catégories séparées pour des composants différents ou des opérations différentes.</span><span class="sxs-lookup"><span data-stu-id="84c66-179">For example, your application can define separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="84c66-180">Catégories d’événements sont facultatifs ; Si votre application n’utilise pas de catégories, ne définissez pas le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> et <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="84c66-180">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="84c66-181">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="84c66-181">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-182">L’exemple de code suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="84c66-182">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="84c66-183">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-183">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="84c66-184">Enfin, l’exemple de code définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="84c66-184">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="84c66-185">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="84c66-185">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="84c66-186">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="84c66-186">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="84c66-187">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="84c66-187">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="84c66-188">La propriété est définie avec une valeur négative ou avec une valeur supérieure à <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-188">The property is set to a negative value or to a value larger than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-189">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-189">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-190">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-190">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryResourceFile" />
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryCount" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
      </Docs>
    </Member>
    <Member MemberName="CategoryResourceFile">
      <MemberSignature Language="C#" Value="public string CategoryResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CategoryResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.CategoryResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property CategoryResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ CategoryResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-191">Obtient ou définit le chemin d'accès du fichier de ressources contenant des chaînes de catégorie pour la source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-191">Gets or sets the path of the resource file that contains category strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-192">Chemin d'accès au fichier de ressources de catégorie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-192">The path of the category resource file.</span>
          </span>
          <span data-ttu-id="84c66-193">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-193">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-194">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> et <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> propriétés pour écrire les événements avec localisées des chaînes de catégorie.</span><span class="sxs-lookup"><span data-stu-id="84c66-194">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties to write events with localized category strings.</span></span> <span data-ttu-id="84c66-195">L’Observateur d’événements affiche la catégorie pour une entrée d’événement si vous fournissez une catégorie lorsque vous écrivez l’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-195">The Event Viewer displays the category for an event entry if you supply a category when you write the event.</span></span> <span data-ttu-id="84c66-196">Catégories du journal des événements sont des chaînes définies par l’application qui aident à filtrer des événements ou fournissent des informations supplémentaires sur l’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-196">Event log categories are application-defined strings that help filter events, or provide further information on the event.</span></span> <span data-ttu-id="84c66-197">Par exemple, votre application peut définir des catégories séparées pour des composants différents ou des opérations différentes.</span><span class="sxs-lookup"><span data-stu-id="84c66-197">For example, your application can define separate categories for different components or different operations.</span></span>  
  
 <span data-ttu-id="84c66-198">Catégories d’événements sont facultatifs ; Si votre application n’utilise pas de catégories, ne définissez pas le <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> et <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> propriétés.</span><span class="sxs-lookup"><span data-stu-id="84c66-198">Event categories are optional; if your application does not use categories, do not set the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A> and <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A> properties.</span></span>  
  
 <span data-ttu-id="84c66-199">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="84c66-199">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-200">L’exemple de code suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="84c66-200">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="84c66-201">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-201">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="84c66-202">Enfin, l’exemple de code définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="84c66-202">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="84c66-203">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="84c66-203">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="84c66-204">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="84c66-204">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="84c66-205">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="84c66-205">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-206">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-206">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-207">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-207">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.CategoryCount" />
        <altmember cref="P:System.Diagnostics.EventLogInstaller.CategoryResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="LogName">
      <MemberSignature Language="C#" Value="public string LogName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.LogName" />
      <MemberSignature Language="VB.NET" Value="Public Property LogName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-208">Obtient ou définit le nom du journal des événements dans lequel la source écrit des entrées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-208">Gets or sets the name of the event log to which the source writes entries.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-209">Nom du journal des événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-209">The name of the event log.</span>
          </span>
          <span data-ttu-id="84c66-210">Il peut s'agir d'application, système ou d'un nom de journal personnalisé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-210">This can be Application, System, or a custom log name.</span>
          </span>
          <span data-ttu-id="84c66-211">La valeur par défaut est « application ».</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-211">The default value is "Application."</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-212">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> pour identifier le journal des événements que votre application écrit des entrées à l’aide de la nouvelle source de propriété.</span><span class="sxs-lookup"><span data-stu-id="84c66-212">Use the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property to identify the event log that your application writes entries to using the new source.</span></span> <span data-ttu-id="84c66-213">Le journal des événements peut être un nouveau journal ou un journal existant.</span><span class="sxs-lookup"><span data-stu-id="84c66-213">The event log can be a new log or an existing log.</span></span> <span data-ttu-id="84c66-214">Applications et services doivent écrire dans le journal des applications ou dans un journal personnalisé.</span><span class="sxs-lookup"><span data-stu-id="84c66-214">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="84c66-215">Pilotes de périphérique doivent écrire dans le journal système.</span><span class="sxs-lookup"><span data-stu-id="84c66-215">Device drivers should write to the System log.</span></span> <span data-ttu-id="84c66-216">Si vous ne définissez pas explicitement la <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> propriété, le journal des événements par défaut le journal des applications.</span><span class="sxs-lookup"><span data-stu-id="84c66-216">If you do not explicitly set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="84c66-217">Le journal de sécurité est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="84c66-217">The Security log is read-only.</span></span>  
  
 <span data-ttu-id="84c66-218">Pour cibler un journal existant pour la nouvelle source, affectez le <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> propriété le nom de journal des événements existant.</span><span class="sxs-lookup"><span data-stu-id="84c66-218">To target an existing log for the new source, set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property to the existing event log name.</span></span> <span data-ttu-id="84c66-219">Pour créer un nouveau journal des événements pour la source, vous devez définir le <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="84c66-219">To create a new event log for the source, you must set the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property.</span></span> <span data-ttu-id="84c66-220">Les noms des journaux d’événements doivent comporter des caractères imprimables et ne peuvent pas inclure les caractères « \* », « ? » ou « \\ ».</span><span class="sxs-lookup"><span data-stu-id="84c66-220">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span> <span data-ttu-id="84c66-221">Les 8 premiers caractères du nom du journal des événements doivent être différents dans les 8 premiers caractères des noms existants de journaux des événements sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="84c66-221">The first 8 characters of the event log name must be different from the first 8 characters of existing names of event logs on the specified computer.</span></span>  
  
 <span data-ttu-id="84c66-222">Le système d’exploitation stocke les journaux des événements sous forme de fichiers.</span><span class="sxs-lookup"><span data-stu-id="84c66-222">The operating system stores event logs as files.</span></span> <span data-ttu-id="84c66-223">Lorsque vous utilisez <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> pour créer un nouveau journal des événements, le fichier associé est stocké dans le répertoire %SystemRoot%\System32\Config sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="84c66-223">When you use <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="84c66-224">Le nom de fichier est défini en ajoutant les 8 premiers caractères de la <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> propriété avec l’extension de nom de fichier « .evt ».</span><span class="sxs-lookup"><span data-stu-id="84c66-224">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property with the ".evt" file name extension.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-225">L’exemple de code suivant définit les propriétés de configuration pour une source d’événement à partir des arguments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="84c66-225">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="84c66-226">Les arguments d’entrée spécifient le nom de source d’événement, nom du journal des événements, nom de l’ordinateur et événements message fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="84c66-226">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="84c66-227">Cet exemple fait partie d’un exemple plus complet fourni pour la <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="84c66-227">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-228">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-228">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-229">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-229">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-230">Obtient ou définit le nom de l'ordinateur à utiliser pour enregistrer la source d'événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-230">Gets or sets the name of the computer on which to register the event source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-231">Nom du système sur lequel enregistrer la source d'événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-231">The name of the system on which to register the event source.</span>
          </span>
          <span data-ttu-id="84c66-232">La valeur par défaut est l'ordinateur local (".").</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-232">The default is the local computer (".").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-233">Le <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> ne peut pas être une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="84c66-233">The <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="84c66-234">Si le nom de l’ordinateur n’est pas défini explicitement, la valeur par défaut sur l’ordinateur local («. »).</span><span class="sxs-lookup"><span data-stu-id="84c66-234">If the machine name is not explicitly set, it defaults to the local computer (".").</span></span>  
  
 <span data-ttu-id="84c66-235">Lorsque vous enregistrez une source sur un ordinateur distant, vous devez disposer des droits d’administrateur sur cet ordinateur pour écrire les valeurs de Registre avec des autorisations suffisantes.</span><span class="sxs-lookup"><span data-stu-id="84c66-235">When registering a source on a remote computer, you must have administrative rights on that computer to write the registry values with sufficient permissions.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-236">L’exemple de code suivant définit les propriétés de configuration pour une source d’événement à partir des arguments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="84c66-236">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="84c66-237">Les arguments d’entrée spécifient le nom de source d’événement, nom du journal des événements, nom de l’ordinateur et événements message fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="84c66-237">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="84c66-238">Cet exemple fait partie d’un exemple plus complet fourni pour la <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="84c66-238">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="84c66-239">Le nom d'ordinateur est non valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-239">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-240">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-240">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-241">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-241">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventSourceCreationData.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MessageResourceFile">
      <MemberSignature Language="C#" Value="public string MessageResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MessageResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.MessageResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MessageResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-242">Obtient ou définit le chemin d'accès du fichier de ressources du message contenant des chaînes de mise en forme du message pour la source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-242">Gets or sets the path of the message resource file that contains message formatting strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-243">Chemin d'accès au fichier de ressources du message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-243">The path of the message resource file.</span>
          </span>
          <span data-ttu-id="84c66-244">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-244">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-245">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> pour configurer une source de journal des événements pour écrire des messages d’événement localisés.</span><span class="sxs-lookup"><span data-stu-id="84c66-245">Use the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property to configure an event log source to write localized event messages.</span></span> <span data-ttu-id="84c66-246">Messages d’événement sont des chaînes définies par l’application qui décrivent l’événement à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="84c66-246">Event messages are application-defined strings that describe the event to the user.</span></span>  
  
 <span data-ttu-id="84c66-247">Votre application peut écrire des entrées de journal des événements à l’aide d’identificateurs de ressources.</span><span class="sxs-lookup"><span data-stu-id="84c66-247">Your application can write event log entries using resource identifiers.</span></span> <span data-ttu-id="84c66-248">Un identificateur de ressource indexe un message se trouvant dans le <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>.</span><span class="sxs-lookup"><span data-stu-id="84c66-248">A resource identifier indexes a message located in the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>.</span></span> <span data-ttu-id="84c66-249">L’Observateur d’événements utilise l’identificateur de ressource pour rechercher et afficher la chaîne correspondante à partir du fichier de ressource de message localisé en fonction des paramètres de langue actuel.</span><span class="sxs-lookup"><span data-stu-id="84c66-249">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized message resource file based on current language settings.</span></span>  
  
 <span data-ttu-id="84c66-250">La source d’événements doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="84c66-250">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="84c66-251">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées localisées pour une source configurée avec un fichier de ressources du message.</span><span class="sxs-lookup"><span data-stu-id="84c66-251">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="84c66-252">Si votre application écrit les chaînes de message d’événement directement, au lieu d’utiliser un identificateur de ressource dans un fichier de ressources localisé, ne définissez pas le <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="84c66-252">If your application writes event message strings directly, rather than using a resource identifier in a localized resource file, do not set the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="84c66-253">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="84c66-253">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-254">L’exemple de code suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="84c66-254">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="84c66-255">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-255">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="84c66-256">Enfin, l’exemple de code définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="84c66-256">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="84c66-257">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="84c66-257">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="84c66-258">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="84c66-258">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="84c66-259">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="84c66-259">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-260">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-260">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-261">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-261">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.MessageResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="ParameterResourceFile">
      <MemberSignature Language="C#" Value="public string ParameterResourceFile { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ParameterResourceFile" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.ParameterResourceFile" />
      <MemberSignature Language="VB.NET" Value="Public Property ParameterResourceFile As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ParameterResourceFile { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-262">Obtient ou définit le chemin d'accès du fichier de ressources qui contient des chaînes de paramètre du message pour la source.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-262">Gets or sets the path of the resource file that contains message parameter strings for the source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-263">Chemin d'accès au fichier de ressources du paramètre.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-263">The path of the parameter resource file.</span>
          </span>
          <span data-ttu-id="84c66-264">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-264">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-265">Utilisez le <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> pour configurer une source de journal des événements pour écrire des messages d’événement localisés avec des chaînes de paramètre insérées.</span><span class="sxs-lookup"><span data-stu-id="84c66-265">Use the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> property to configure an event log source to write localized event messages with inserted parameter strings.</span></span> <span data-ttu-id="84c66-266">Chaque message d’événement localisé spécifié dans le <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> propriété peut contenir des espaces réservés pour les chaînes d’insertion.</span><span class="sxs-lookup"><span data-stu-id="84c66-266">Each localized event message specified in the <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property can contain placeholders for insertion strings.</span></span> <span data-ttu-id="84c66-267">Ces espaces réservés sont utilisés pour spécifier la position et l’identificateur de ressource pour une chaîne indépendante du langage dans le message d’événement.</span><span class="sxs-lookup"><span data-stu-id="84c66-267">These placeholders are used to specify the position and resource identifier for a language-independent string within the event message.</span></span> <span data-ttu-id="84c66-268">L’Observateur d’événements remplit les espaces réservés avec les chaînes correspondantes à partir de la <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> et met en forme le message du journal des événements pour l’entrée d’événement localisée.</span><span class="sxs-lookup"><span data-stu-id="84c66-268">The Event Viewer fills in the placeholders using the corresponding strings from the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> and formats the event log message for the localized event entry.</span></span>  
  
 <span data-ttu-id="84c66-269">Par exemple, la section suivante d’un fichier texte de message définit une chaîne avec un espace réservé de paramètre :</span><span class="sxs-lookup"><span data-stu-id="84c66-269">For example, the following section of a message text file defines a string with a parameter placeholder:</span></span>  
  
```  
  
MessageId = 1501  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_STARTING  
Language=English  
Component %%6050 is starting.  
.  
```  
  
 <span data-ttu-id="84c66-270">Dans le fichier de ressources de paramètre, la chaîne d’insertion doit être définie avec l’identificateur de ressource qui correspond à l’espace réservé, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="84c66-270">Within the parameter resource file, the insertion string must be defined with the resource identifier that corresponds to the placeholder, as shown below:</span></span>  
  
```  
MessageId = 6050  
Severity = Success  
Facility = Application  
SymbolicName = COMPONENT_NAME_MSGID  
Language=English  
TRIGGER.EXE  
.  
```  
  
 <span data-ttu-id="84c66-271">La source d’événements doit être configurée pour écrire des entrées localisées ou l’écriture de chaînes directes.</span><span class="sxs-lookup"><span data-stu-id="84c66-271">The event source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="84c66-272">Utilisez la <xref:System.Diagnostics.EventLog.WriteEvent%2A> méthode pour écrire des entrées localisées pour une source configurée avec un fichier de ressources du message.</span><span class="sxs-lookup"><span data-stu-id="84c66-272">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write localized entries for a source configured with a message resource file.</span></span>  
  
 <span data-ttu-id="84c66-273">Si votre application écrit les chaînes de message d’événement directement dans le journal des événements, ou si votre <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> propriété ne contient pas de messages avec des espaces réservés de paramètre d’insertion, ne définissez pas le <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="84c66-273">If your application writes event message strings directly to the event log, or if your <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A> property does not contain messages with parameter insertion placeholders, do not set the <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> property.</span></span>  
  
 <span data-ttu-id="84c66-274">Pour plus d’informations sur la définition des messages d’événement et la création de fichiers de ressources d’événement, consultez la rubrique « Message Compiler » dans la documentation Platform SDK à [ http://msdn.microsoft.com ](http://msdn.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="84c66-274">For details about defining event messages and building event resource files, see the "Message Compiler" topic in the Platform SDK documentation at [http://msdn.microsoft.com](http://msdn.microsoft.com/).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-275">L’exemple de code suivant détermine si la source d’événements nommé `SampleApplicationSource` est enregistré sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="84c66-275">The following code example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="84c66-276">Si la source d’événements n’existe pas, l’exemple définit le fichier de ressources pour la source de message et crée la nouvelle source d’événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-276">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="84c66-277">Enfin, l’exemple de code définit le nom complet localisé du journal des événements, à l’aide de la valeur d’identificateur de ressource dans `DisplayNameMsgId` et le chemin d’accès du fichier de ressources dans `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="84c66-277">Finally, the code example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="84c66-278">L’exemple de code utilise le fichier texte du message suivant, incorporé dans la bibliothèque de ressources EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="84c66-278">The code example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="84c66-279">Un fichier texte du message est la source à partir de laquelle le fichier de ressource de message est créé.</span><span class="sxs-lookup"><span data-stu-id="84c66-279">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="84c66-280">Le fichier texte de message définit les identificateurs de ressources et le texte de la catégorie, message d’événement et les chaînes d’insertion de paramètre.</span><span class="sxs-lookup"><span data-stu-id="84c66-280">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="84c66-281">Plus précisément, le message défini pour l’identificateur de ressource 1004 utilise un espace réservé pour un paramètre de chaîne pour l’identificateur de ressource 5002.</span><span class="sxs-lookup"><span data-stu-id="84c66-281">Specifically, the message defined for resource identifier 1004 uses a placeholder for a parameter string defined for resource identifier 5002.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-282">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-282">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-283">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-283">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.ParameterResourceFile" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventSourceCreationData.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="84c66-284">Obtient ou définit le nom à enregistrer auprès du journal des événements en tant que source d'événements.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-284">Gets or sets the name to register with the event log as an event source.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="84c66-285">Nom à enregistrer auprès du journal des événements comme source d'entrées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-285">The name to register with the event log as a source of entries.</span>
          </span>
          <span data-ttu-id="84c66-286">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-286">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="84c66-287">Le nom de la source est souvent le nom de l’application ou le nom d’un composant au sein d’une application volumineuse.</span><span class="sxs-lookup"><span data-stu-id="84c66-287">The source name is often the name of the application, or the name of a component within a large application.</span></span> <span data-ttu-id="84c66-288">Le <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> utilise le <xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>, et <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> propriétés afin de créer des valeurs de Registre sur l’ordinateur cible pour la nouvelle source et son journal des événements associé.</span><span class="sxs-lookup"><span data-stu-id="84c66-288">The <xref:System.Diagnostics.EventLog.CreateEventSource%28System.Diagnostics.EventSourceCreationData%29?displayProperty=nameWithType> method uses the <xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A>, and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="84c66-289">Un nouveau nom de la source ne peut pas correspondre à un nom de source existant ou un nom de journal des événements existants sur l’ordinateur cible.</span><span class="sxs-lookup"><span data-stu-id="84c66-289">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span>  
  
 <span data-ttu-id="84c66-290">Une fois créés, les valeurs de Registre pour la source de votre application peut utiliser la source pour écrire des entrées dans le journal des événements configuré.</span><span class="sxs-lookup"><span data-stu-id="84c66-290">After the registry values for the source are created, your application can use the source to write entries to the configured event log.</span></span>  
  
 <span data-ttu-id="84c66-291">Chaque source ne peut écrire dans un journal des événements à la fois. Toutefois, votre application peut utiliser plusieurs sources pour écrire dans plusieurs journaux des événements.</span><span class="sxs-lookup"><span data-stu-id="84c66-291">Each source can only write to one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="84c66-292">Par exemple, votre application peut nécessiter des sources multiples configurées pour des journaux des événements ou des fichiers de ressources différents.</span><span class="sxs-lookup"><span data-stu-id="84c66-292">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="84c66-293">L’exemple de code suivant définit les propriétés de configuration pour une source d’événement à partir des arguments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="84c66-293">The following code example sets the configuration properties for an event source from command-line arguments.</span></span> <span data-ttu-id="84c66-294">Les arguments d’entrée spécifient le nom de source d’événement, nom du journal des événements, nom de l’ordinateur et événements message fichier de ressources.</span><span class="sxs-lookup"><span data-stu-id="84c66-294">The input arguments specify the event source name, event log name, computer name, and event message resource file.</span></span> <span data-ttu-id="84c66-295">Cet exemple fait partie d’un exemple plus complet fourni pour la <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="84c66-295">This example is part of a larger example provided for the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 [!code-cpp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CPP/source.cpp#2)]
 [!code-csharp[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/CS/source.cs#2)]
 [!code-vb[EventLog_EventSourceCreation_Properties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_EventSourceCreation_Properties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="84c66-296">pour appeler les membres de <see cref="T:System.Diagnostics.EventSourceCreationData" /> avec une confiance totale.</span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-296">for calling any member of <see cref="T:System.Diagnostics.EventSourceCreationData" /> with full trust.</span>
          </span>
          <span data-ttu-id="84c66-297">Énumération associée : <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="84c66-297">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLogInstaller.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
  </Members>
</Type>