<Type Name="ListViewInsertionMark" FullName="System.Windows.Forms.ListViewInsertionMark">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="2e7383a0bdc59f7b3f55dd5bd6162c3f0cd7390c" />
    <Meta Name="ms.sourcegitcommit" Value="5a49536d99d2d0b54e4cb7280870903e043272df" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="07/03/2018" />
    <Meta Name="ms.locfileid" Value="37509995" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class ListViewInsertionMark" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ListViewInsertionMark extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.ListViewInsertionMark" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ListViewInsertionMark" />
  <TypeSignature Language="C++ CLI" Value="public ref class ListViewInsertionMark sealed" />
  <TypeSignature Language="F#" Value="type ListViewInsertionMark = class" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="52f71-101">Sert à indiquer l'emplacement cible attendu lorsqu'un élément est glissé vers une nouvelle position dans un contrôle <see cref="T:System.Windows.Forms.ListView" />.</span>
      <span class="sxs-lookup">
        <span data-stu-id="52f71-101">Used to indicate the expected drop location when an item is dragged to a new position in a <see cref="T:System.Windows.Forms.ListView" /> control.</span>
      </span>
      <span data-ttu-id="52f71-102">Cette fonctionnalité n'est disponible que sur Windows XP et versions ultérieures.</span>
      <span class="sxs-lookup">
        <span data-stu-id="52f71-102">This functionality is available only on Windows XP and later.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-103">Vous pouvez récupérer un <xref:System.Windows.Forms.ListViewInsertionMark> à partir de la <xref:System.Windows.Forms.ListView.InsertionMark%2A> propriété d’un <xref:System.Windows.Forms.ListView> contrôle et l’utiliser pour indiquer visuellement l’emplacement cible attendu dans une opération de glisser-déplacer lorsqu’un élément est déplacé vers une nouvelle position.</span><span class="sxs-lookup"><span data-stu-id="52f71-103">You can retrieve a <xref:System.Windows.Forms.ListViewInsertionMark> from the <xref:System.Windows.Forms.ListView.InsertionMark%2A> property of a <xref:System.Windows.Forms.ListView> control and use it to visually indicate the expected drop location in a drag-and-drop operation when an item is dragged to a new position.</span></span>  
  
 <span data-ttu-id="52f71-104">Cette fonctionnalité fonctionne uniquement lorsque le <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType> propriété est définie sur `true` et à quel moment le <xref:System.Windows.Forms.ListView> contrôle ne trie pas automatiquement les éléments.</span><span class="sxs-lookup"><span data-stu-id="52f71-104">This feature works only when the <xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType> property is set to `true` and when the <xref:System.Windows.Forms.ListView> control does not sort the items automatically.</span></span> <span data-ttu-id="52f71-105">Pour empêcher le tri automatique, le <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType> propriété doit être définie sur <xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> et <xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType> propriété doit être définie sur <xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>, <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>, ou <xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="52f71-105">To prevent automatic sorting, the <xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.SortOrder.None?displayProperty=nameWithType> and the <xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType> property must be set to <xref:System.Windows.Forms.View.LargeIcon?displayProperty=nameWithType>, <xref:System.Windows.Forms.View.SmallIcon?displayProperty=nameWithType>, or <xref:System.Windows.Forms.View.Tile?displayProperty=nameWithType>.</span></span> <span data-ttu-id="52f71-106">En outre, la fonctionnalité de marque d’insertion ne peut pas être utilisée avec le <xref:System.Windows.Forms.ListView> fonctionnalité de regroupement, car la fonctionnalité de regroupement trie les éléments par appartenance au groupe.</span><span class="sxs-lookup"><span data-stu-id="52f71-106">Additionally, the insertion mark feature cannot be used with the <xref:System.Windows.Forms.ListView> grouping feature because the grouping feature orders the items by group membership.</span></span>  
  
 <span data-ttu-id="52f71-107">Le <xref:System.Windows.Forms.ListViewInsertionMark> classe est généralement utilisée dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> ou <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> événement à mettre à jour la position de la marque d’insertion, comme un élément est glissé.</span><span class="sxs-lookup"><span data-stu-id="52f71-107">The <xref:System.Windows.Forms.ListViewInsertionMark> class is typically used in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event to update the position of the insertion mark as an item is dragged.</span></span> <span data-ttu-id="52f71-108">Il est également utilisé dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> ou <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> événement pour insérer un élément glissé à l’emplacement correct.</span><span class="sxs-lookup"><span data-stu-id="52f71-108">It is also used in a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event to insert a dragged item at the correct location.</span></span>  
  
 <span data-ttu-id="52f71-109">Pour mettre à jour la position de la marque d’insertion, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="52f71-109">To update the position of the insertion mark, follow these steps:</span></span>  
  
1.  <span data-ttu-id="52f71-110">Dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> ou <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> événement, utilisez le <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType> propriété pour accéder à la <xref:System.Windows.Forms.ListViewInsertionMark> objet associé à la <xref:System.Windows.Forms.ListView> contrôle.</span><span class="sxs-lookup"><span data-stu-id="52f71-110">In a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType> property to access the <xref:System.Windows.Forms.ListViewInsertionMark> object associated with the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
2.  <span data-ttu-id="52f71-111">Utilisez le <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> méthode pour récupérer l’index de l’élément le plus proche pour le pointeur de la souris.</span><span class="sxs-lookup"><span data-stu-id="52f71-111">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
3.  <span data-ttu-id="52f71-112">Passer la valeur d’index à la <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> méthode pour récupérer le rectangle englobant de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-112">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
4.  <span data-ttu-id="52f71-113">Si le pointeur de la souris se trouve à gauche du milieu du rectangle englobant, définissez le <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propriété `false`; sinon, affectez-lui la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="52f71-113">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
5.  <span data-ttu-id="52f71-114">Définir le <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propriété avec la valeur d’index récupérée à partir de la <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="52f71-114">Set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to the index value retrieved from the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method.</span></span> <span data-ttu-id="52f71-115">La marque d’insertion apparaît en regard de l’élément avec l’index spécifié, soit vers la gauche ou droite, selon le <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="52f71-115">The insertion mark appears next to item with the specified index, either to the left or the right, depending on the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property value.</span></span> <span data-ttu-id="52f71-116">Si un élément est glissé sur lui-même, l’index est -1 et la marque d’insertion est masquée.</span><span class="sxs-lookup"><span data-stu-id="52f71-116">If an item is dragged over itself, the index is -1 and the insertion mark is hidden.</span></span>  
  
 <span data-ttu-id="52f71-117">Pour insérer l’élément déplacé à l’emplacement correct, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="52f71-117">To insert the dragged item at the correct location, follow these steps:</span></span>  
  
1.  <span data-ttu-id="52f71-118">Dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> ou <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> événement, utilisez le <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propriété afin de déterminer l’emplacement actuel de la marque d’insertion.</span><span class="sxs-lookup"><span data-stu-id="52f71-118">In a handler for the <xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType> or <xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType> event, use the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to determine the current location of the insertion mark.</span></span> <span data-ttu-id="52f71-119">Store cette valeur à utiliser ultérieurement comme index d’insertion.</span><span class="sxs-lookup"><span data-stu-id="52f71-119">Store this value to be used later as the insertion index.</span></span>  
  
2.  <span data-ttu-id="52f71-120">Si le <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propriété est définie sur `true`, incrémentez la valeur d’index d’insertion stocké.</span><span class="sxs-lookup"><span data-stu-id="52f71-120">If the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `true`, increment the stored insertion index value.</span></span>  
  
3.  <span data-ttu-id="52f71-121">Utilisez le <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType> méthode pour insérer un clone de l’élément déplacé dans le <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection à l’index d’insertion stocké.</span><span class="sxs-lookup"><span data-stu-id="52f71-121">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType> method to insert a clone of the dragged item into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection at the stored insertion index.</span></span>  
  
4.  <span data-ttu-id="52f71-122">Utilisez le <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType> méthode pour supprimer la copie d’origine de l’élément déplacé.</span><span class="sxs-lookup"><span data-stu-id="52f71-122">Use the <xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType> method to remove the original copy of the dragged item.</span></span>  
  
 <span data-ttu-id="52f71-123">Vous devez insérer un clone de l’élément glissé avant que la copie d’origine est supprimée pour les valeurs d’index dans le <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection ne sont pas modifiées avant l’insertion.</span><span class="sxs-lookup"><span data-stu-id="52f71-123">You must insert a clone of the dragged item before the original copy is removed so the index values in the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection are not altered before the insertion.</span></span>  
  
 <span data-ttu-id="52f71-124">Pour vous assurer que les éléments sont affichés dans le même ordre que leurs valeurs d’index, vous devez définir le <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType> propriété à une implémentation de la <xref:System.Collections.IComparer> interface qui trie les éléments par valeur d’index.</span><span class="sxs-lookup"><span data-stu-id="52f71-124">To ensure that the items are displayed in the same order as their index values, you must set the <xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType> property to an implementation of the <xref:System.Collections.IComparer> interface that sorts items by index value.</span></span> <span data-ttu-id="52f71-125">Pour plus d’informations, consultez la section exemple.</span><span class="sxs-lookup"><span data-stu-id="52f71-125">For more information, see the Example section.</span></span>  
  
 <span data-ttu-id="52f71-126">Vous pouvez modifier la couleur de la marque d’insertion en utilisant la <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="52f71-126">You can modify the color of the insertion mark by using the <xref:System.Windows.Forms.ListViewInsertionMark.Color%2A> property.</span></span> <span data-ttu-id="52f71-127">Si vous avez besoin de la taille ou la position de la marque d’insertion, vous pouvez obtenir son rectangle englobant la <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="52f71-127">If you need the size or position of the insertion mark, you can get its bounding rectangle through the <xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A> property.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="52f71-128">La fonctionnalité de marque d’insertion est uniquement disponible sur Windows XP et la famille Windows Server 2003 lorsque votre application appelle la <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> (méthode).</span><span class="sxs-lookup"><span data-stu-id="52f71-128">The insertion mark feature is available only on Windows XP and the Windows Server 2003 family when your application calls the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="52f71-129">Sur les systèmes d’exploitation antérieurs, tout code concernant la marque d’insertion sera ignoré et la marque d’insertion n’apparaîtra pas.</span><span class="sxs-lookup"><span data-stu-id="52f71-129">On earlier operating systems, any code relating to the insertion mark will be ignored and the insertion mark will not appear.</span></span> <span data-ttu-id="52f71-130">Par conséquent, tout code qui dépend de la fonctionnalité de marque d’insertion peut ne pas fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="52f71-130">As a result, any code that depends on the insertion mark feature may not work correctly.</span></span> <span data-ttu-id="52f71-131">Vous pouvez inclure un test qui détermine si la fonctionnalité de marque d’insertion est disponible et fournir d’autres fonctionnalités lorsqu’il n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="52f71-131">You may want to include a test that determines whether the insertion mark feature is available, and provide alternate functionality when it is unavailable.</span></span> <span data-ttu-id="52f71-132">Par exemple, vous souhaiterez éventuellement ignorer tout le code qui implémente le repositionnement lors de l’exécution sur les systèmes d’exploitation qui ne prennent pas en charge les marques d’insertion d’éléments par glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="52f71-132">For example, you may want to bypass all code that implements drag-and-drop item repositioning when running on operating systems that do not support insertion marks.</span></span>  
>   
>  <span data-ttu-id="52f71-133">La fonctionnalité de marque d’insertion est fournie par la même bibliothèque qui fournit la fonctionnalité des thèmes du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="52f71-133">The insertion mark feature is provided by the same library that provides the operating system themes feature.</span></span> <span data-ttu-id="52f71-134">Pour vérifier la disponibilité de cette bibliothèque, appelez le <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType> surcharge de méthode et transmettez le <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType> valeur.</span><span class="sxs-lookup"><span data-stu-id="52f71-134">To check for the availability of this library, call the <xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType> method overload and pass in the <xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType> value.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="52f71-135">L’exemple de code suivant montre comment utiliser le <xref:System.Windows.Forms.ListView> fonctionnalité de marque d’insertion et la réorganisation des éléments de glisser-déplacer implémente à l’aide de la norme des événements de glisser.</span><span class="sxs-lookup"><span data-stu-id="52f71-135">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="52f71-136">La position de la marque d’insertion est mis à jour dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> événement.</span><span class="sxs-lookup"><span data-stu-id="52f71-136">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="52f71-137">Dans ce gestionnaire, la position du pointeur de la souris est comparée au milieu de l’élément le plus proche, et le résultat est utilisé pour déterminer si la marque d’insertion apparaît à gauche ou à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-137">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Windows.Forms.ListView" />
  </Docs>
  <Members>
    <Member MemberName="AppearsAfterItem">
      <MemberSignature Language="C#" Value="public bool AppearsAfterItem { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool AppearsAfterItem" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberSignature Language="VB.NET" Value="Public Property AppearsAfterItem As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool AppearsAfterItem { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.AppearsAfterItem : bool with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="52f71-138">Obtient ou définit une valeur indiquant si la marque d'insertion apparaît à droite de l'élément avec l'index spécifié par la propriété <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-138">Gets or sets a value indicating whether the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="52f71-139">
            <see langword="true" /> si la marque d'insertion apparaît à droite de l'élément avec l'index spécifié par la propriété <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-139">
              <see langword="true" /> if the insertion mark appears to the right of the item with the index specified by the <see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" /> property; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="52f71-140">La valeur par défaut est <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-140">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-141">Le <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> méthode vous permet de rechercher l’élément le plus proche pour le pointeur de la souris, mais vous devez effectuer vos propres calculs pour déterminer si la marque d’insertion doit apparaître avant ou après cet élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-141">The <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method lets you find the item closest to the mouse pointer, but you must do your own calculations to determine whether the insertion mark should appear before or after this item.</span></span>  
  
 <span data-ttu-id="52f71-142">Pour calculer la valeur requise pour le <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propriété, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="52f71-142">To calculate the value needed for the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property, follow these steps:</span></span>  
  
1.  <span data-ttu-id="52f71-143">Utilisez le <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> méthode pour récupérer l’index de l’élément le plus proche pour le pointeur de la souris.</span><span class="sxs-lookup"><span data-stu-id="52f71-143">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to the mouse pointer.</span></span>  
  
2.  <span data-ttu-id="52f71-144">Passer la valeur d’index à la <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> méthode pour récupérer le rectangle englobant de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-144">Pass the index value to the <xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType> method to retrieve the bounding rectangle of the item.</span></span>  
  
3.  <span data-ttu-id="52f71-145">Si le pointeur de la souris se trouve à gauche du milieu du rectangle englobant, définissez le <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propriété `false`; sinon, affectez-lui la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="52f71-145">If the mouse pointer is located to the left of the midpoint of the bounding rectangle, set the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property to `false`; otherwise, set it to `true`.</span></span>  
  
 <span data-ttu-id="52f71-146">Pour plus d’informations, consultez le <xref:System.Windows.Forms.ListViewInsertionMark> rubrique de référence de vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="52f71-146">For more information, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="52f71-147">L’exemple de code suivant montre comment utiliser le <xref:System.Windows.Forms.ListView> fonctionnalité de marque d’insertion et la réorganisation des éléments de glisser-déplacer implémente à l’aide de la norme des événements de glisser.</span><span class="sxs-lookup"><span data-stu-id="52f71-147">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="52f71-148">La position de la marque d’insertion est mis à jour dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> événement.</span><span class="sxs-lookup"><span data-stu-id="52f71-148">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="52f71-149">Dans ce gestionnaire, la position du pointeur de la souris est comparée au milieu de l’élément le plus proche, et le résultat est utilisé pour déterminer si la marque d’insertion apparaît à gauche ou à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-149">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="52f71-150">Pour obtenir un exemple complet, consultez le <xref:System.Windows.Forms.ListViewInsertionMark> rubrique de référence de vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="52f71-150">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Bounds">
      <MemberSignature Language="C#" Value="public System.Drawing.Rectangle Bounds { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Rectangle Bounds" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Bounds As Rectangle" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Rectangle Bounds { System::Drawing::Rectangle get(); };" />
      <MemberSignature Language="F#" Value="member this.Bounds : System.Drawing.Rectangle" Usage="System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Rectangle</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="52f71-151">Obtient le rectangle englobant de la marque d'insertion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-151">Gets the bounding rectangle of the insertion mark.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="52f71-152">
            <see cref="T:System.Drawing.Rectangle" /> qui représente la position et la taille de la marque d'insertion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-152">A <see cref="T:System.Drawing.Rectangle" /> that represents the position and size of the insertion mark.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-153">Les coordonnées dans le rectangle englobant de la marque d’insertion sont exprimées par rapport à l’angle supérieur gauche de la <xref:System.Windows.Forms.ListView> contrôle.</span><span class="sxs-lookup"><span data-stu-id="52f71-153">The coordinates in the insertion mark bounding rectangle are relative to the upper-left corner of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Color">
      <MemberSignature Language="C#" Value="public System.Drawing.Color Color { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Color Color" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberSignature Language="VB.NET" Value="Public Property Color As Color" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Drawing::Color Color { System::Drawing::Color get(); void set(System::Drawing::Color value); };" />
      <MemberSignature Language="F#" Value="member this.Color : System.Drawing.Color with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Color</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="52f71-154">Obtient ou définit la couleur de la marque d'insertion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-154">Gets or sets the color of the insertion mark.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="52f71-155">Valeur <see cref="T:System.Drawing.Color" /> qui représente la couleur de la marque d'insertion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-155">A <see cref="T:System.Drawing.Color" /> value that represents the color of the insertion mark.</span>
          </span>
          <span data-ttu-id="52f71-156">La valeur par défaut est celle de la propriété <see cref="P:System.Windows.Forms.ListView.ForeColor" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-156">The default value is the value of the <see cref="P:System.Windows.Forms.ListView.ForeColor" /> property.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-157">Cette propriété permet de définir la couleur de marque d’insertion sur une valeur autre que la couleur de premier plan de la <xref:System.Windows.Forms.ListView> contrôle.</span><span class="sxs-lookup"><span data-stu-id="52f71-157">Use this property to set the insertion mark color to a value other than the foreground color of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="52f71-158">L’exemple de code suivant montre comment utiliser le <xref:System.Windows.Forms.ListView> fonctionnalité de marque d’insertion et la réorganisation des éléments de glisser-déplacer implémente à l’aide de la norme des événements de glisser.</span><span class="sxs-lookup"><span data-stu-id="52f71-158">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="52f71-159">La position de la marque d’insertion est mis à jour dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> événement.</span><span class="sxs-lookup"><span data-stu-id="52f71-159">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="52f71-160">Dans ce gestionnaire, la position du pointeur de la souris est comparée au milieu de l’élément le plus proche, et le résultat est utilisé pour déterminer si la marque d’insertion apparaît à gauche ou à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-160">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="52f71-161">Pour obtenir un exemple complet, consultez le <xref:System.Windows.Forms.ListViewInsertionMark> rubrique de référence de vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="52f71-161">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="Index">
      <MemberSignature Language="C#" Value="public int Index { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Index" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberSignature Language="VB.NET" Value="Public Property Index As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int Index { int get(); void set(int value); };" />
      <MemberSignature Language="F#" Value="member this.Index : int with get, set" Usage="System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="52f71-162">Obtient ou définit l'index de l'élément auprès duquel la marque d'insertion apparaît.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-162">Gets or sets the index of the item next to which the insertion mark appears.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="52f71-163">L'index de l'élément auprès duquel la marque d'insertion apparaît ou -1 lorsque la marque d'insertion est masquée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-163">The index of the item next to which the insertion mark appears or -1 when the insertion mark is hidden.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-164">La marque d’insertion apparaît à gauche de l’élément avec l’index spécifié si la <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> propriété est définie sur `false`; sinon, elle apparaît à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-164">The insertion mark appears to the left of the item with the specified index if the <xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A> property is set to `false`; otherwise, it appears to the right of the item.</span></span> <span data-ttu-id="52f71-165">La marque d’insertion disparaît automatiquement lorsqu’un élément glissé est inséré dans le <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection.</span><span class="sxs-lookup"><span data-stu-id="52f71-165">The insertion mark disappears automatically when a dragged item is inserted into the <xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="52f71-166">Pour supprimer la marque d’insertion manuellement, par exemple, lorsqu’un élément est glissé sur lui-même ou en dehors du contrôle, définissez la <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> valeur-1.</span><span class="sxs-lookup"><span data-stu-id="52f71-166">To remove the insertion mark manually, for example, when an item is dragged onto itself or dragged outside the control, set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> value to -1.</span></span>  
  
 <span data-ttu-id="52f71-167">Utilisez le <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> méthode pour récupérer l’index de l’élément le plus proche à un emplacement spécifié, telles que l’emplacement du pointeur de la souris lors du positionnement d’un élément dans une opération de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="52f71-167">Use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method to retrieve the index of the item closest to a specified location, such as the location of the mouse pointer when positioning an item in a drag-and-drop operation.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="52f71-168">L’exemple de code suivant montre comment utiliser le <xref:System.Windows.Forms.ListView> fonctionnalité de marque d’insertion et la réorganisation des éléments de glisser-déplacer implémente à l’aide de la norme des événements de glisser.</span><span class="sxs-lookup"><span data-stu-id="52f71-168">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="52f71-169">La position de la marque d’insertion est mis à jour dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> événement.</span><span class="sxs-lookup"><span data-stu-id="52f71-169">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="52f71-170">Dans ce gestionnaire, la position du pointeur de la souris est comparée au milieu de l’élément le plus proche, et le résultat est utilisé pour déterminer si la marque d’insertion apparaît à gauche ou à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-170">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="52f71-171">Pour obtenir un exemple complet, consultez le <xref:System.Windows.Forms.ListViewInsertionMark> rubrique de référence de vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="52f71-171">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
    <Member MemberName="NearestIndex">
      <MemberSignature Language="C#" Value="public int NearestIndex (System.Drawing.Point pt);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 NearestIndex(valuetype System.Drawing.Point pt) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)" />
      <MemberSignature Language="VB.NET" Value="Public Function NearestIndex (pt As Point) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; int NearestIndex(System::Drawing::Point pt);" />
      <MemberSignature Language="F#" Value="member this.NearestIndex : System.Drawing.Point -&gt; int" Usage="listViewInsertionMark.NearestIndex pt" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pt" Type="System.Drawing.Point" />
      </Parameters>
      <Docs>
        <param name="pt">
          <span data-ttu-id="52f71-172">
            <see cref="T:System.Drawing.Point" /> représentant l'emplacement à partir duquel rechercher l'élément le plus proche.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-172">A <see cref="T:System.Drawing.Point" /> representing the location from which to find the nearest item.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="52f71-173">Récupère l'index de l'élément le plus proche du point spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-173">Retrieves the index of the item closest to the specified point.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="52f71-174">L'index de l'élément le plus proche du point spécifié ou -1 si l'élément le plus proche est l'élément actuellement glissé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="52f71-174">The index of the item closest to the specified point or -1 if the closest item is the item currently being dragged.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="52f71-175">Cette méthode vous permet de localiser l’élément le plus proche du pointeur de la souris lors d’une opération de glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="52f71-175">This method lets you locate the item closest to the mouse pointer when doing a drag-and-drop operation.</span></span> <span data-ttu-id="52f71-176">Utilisez la valeur d’index retournée pour définir le <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="52f71-176">Use the index value returned to set the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property.</span></span> <span data-ttu-id="52f71-177">Lorsque l’élément le plus proche pour le pointeur de la souris est l’élément déplacé, la valeur de retour de cette méthode est -1.</span><span class="sxs-lookup"><span data-stu-id="52f71-177">When the item closest to the mouse pointer is the item being dragged, the return value of this method is -1.</span></span> <span data-ttu-id="52f71-178">Dans ce cas, en définissant le <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> propriété à cette valeur masque la marque d’insertion.</span><span class="sxs-lookup"><span data-stu-id="52f71-178">In this case, setting the <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> property to this value hides the insertion mark.</span></span>  
  
 <span data-ttu-id="52f71-179">Cette méthode recherche l’élément le plus proche, quel que soit l’où le pointeur de la souris se trouve, lors de la <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> méthode retourne l’élément à l’emplacement spécifié uniquement, ou `null` s’il n’existe aucun élément à cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="52f71-179">This method finds the closest item regardless of where the mouse pointer is located, while the <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns the item at the specified location only, or `null` if there is no item at that location.</span></span> <span data-ttu-id="52f71-180">Le <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> méthode retourne `null`, par exemple, lorsque le pointeur de la souris se trouve entre deux éléments.</span><span class="sxs-lookup"><span data-stu-id="52f71-180">The <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType> method returns `null`, for example, when the mouse pointer is located between two items.</span></span> <span data-ttu-id="52f71-181">Pour cette raison, vous devez toujours utiliser le <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> méthode lors de l’utilisation d’une opération de glisser-déplacer pour positionner des éléments.</span><span class="sxs-lookup"><span data-stu-id="52f71-181">For this reason, you should always use the <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A> method when using a drag-and-drop operation to position items.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="52f71-182">L’exemple de code suivant montre comment utiliser le <xref:System.Windows.Forms.ListView> fonctionnalité de marque d’insertion et la réorganisation des éléments de glisser-déplacer implémente à l’aide de la norme des événements de glisser.</span><span class="sxs-lookup"><span data-stu-id="52f71-182">The following code example demonstrates how to use the <xref:System.Windows.Forms.ListView> insertion mark feature and implements drag-and-drop item reordering using the standard drag events.</span></span> <span data-ttu-id="52f71-183">La position de la marque d’insertion est mis à jour dans un gestionnaire pour le <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> événement.</span><span class="sxs-lookup"><span data-stu-id="52f71-183">The position of the insertion mark is updated in a handler for the <xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="52f71-184">Dans ce gestionnaire, la position du pointeur de la souris est comparée au milieu de l’élément le plus proche, et le résultat est utilisé pour déterminer si la marque d’insertion apparaît à gauche ou à droite de l’élément.</span><span class="sxs-lookup"><span data-stu-id="52f71-184">In this handler, the position of the mouse pointer is compared to the midpoint of the nearest item, and the result is used to determine whether the insertion mark appears to the left or the right of the item.</span></span>  
  
 <span data-ttu-id="52f71-185">Pour obtenir un exemple complet, consultez le <xref:System.Windows.Forms.ListViewInsertionMark> rubrique de référence de vue d’ensemble.</span><span class="sxs-lookup"><span data-stu-id="52f71-185">For the complete example, see the <xref:System.Windows.Forms.ListViewInsertionMark> overview reference topic.</span></span>  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Windows.Forms.ListView" />
      </Docs>
    </Member>
  </Members>
</Type>