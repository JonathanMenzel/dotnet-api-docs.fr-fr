<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="f362dd97709b65574ff7b9474682818d0cb2c4b1" />
    <Meta Name="ms.sourcegitcommit" Value="4b4804968da1dfdf71c501075a5b66957b54f2e8" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="04/27/2018" />
    <Meta Name="ms.locfileid" Value="32038292" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="968a1-101">Permet d'accéder à une file d'attente sur un serveur Message Queuing.</span>
      <span class="sxs-lookup">
        <span data-stu-id="968a1-101">Provides access to a queue on a Message Queuing server.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-102">La technologie Message Queuing permet aux applications en cours d’exécution à différents moments de communiquer sur des réseaux hétérogènes et systèmes qui peuvent être temporairement hors connexion.</span><span class="sxs-lookup"><span data-stu-id="968a1-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="968a1-103">Applications envoyer, recevoir ou lire des messages (lecture sans supprimer) des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="968a1-104">Message Queuing est un composant facultatif de [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] et Windows NT et doit être installé séparément.</span><span class="sxs-lookup"><span data-stu-id="968a1-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="968a1-105">La <xref:System.Messaging.MessageQueue> classe est un wrapper autour de Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="968a1-106">Il existe plusieurs versions de Message Queuing et à l’aide de la <xref:System.Messaging.MessageQueue> classe peut entraîner un comportement légèrement différent, selon le système d’exploitation que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="968a1-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="968a1-107">Pour plus d’informations sur les fonctionnalités spécifiques de chaque version de Message Queuing, consultez la rubrique « Nouveautés dans Message Queuing » dans Platform SDK sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="968a1-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="968a1-108">La <xref:System.Messaging.MessageQueue> classe fournit une référence à une file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="968a1-109">Vous pouvez spécifier un chemin d’accès dans le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur pour se connecter à une ressource existante, ou vous pouvez créer une nouvelle file d’attente sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="968a1-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="968a1-110">Avant de pouvoir appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, ou <xref:System.Messaging.MessageQueue.Receive%2A>, vous devez associer la nouvelle instance de la <xref:System.Messaging.MessageQueue> classe avec une file d’attente existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="968a1-111">À ce stade, vous pouvez manipuler les propriétés de la file d’attente comme <xref:System.Messaging.MessageQueue.Category%2A> et <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="968a1-112"><xref:System.Messaging.MessageQueue> prend en charge deux types de récupération des messages : synchrone et asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="968a1-113">Les méthodes synchrones, <xref:System.Messaging.MessageQueue.Peek%2A> et <xref:System.Messaging.MessageQueue.Receive%2A>, entraînent le thread de processus attendre un intervalle de temps spécifié pour un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-114">Les méthodes asynchrones, <xref:System.Messaging.MessageQueue.BeginPeek%2A> et <xref:System.Messaging.MessageQueue.BeginReceive%2A>, permettent aux tâches de l’application principale continue dans un thread séparé, jusqu'à ce qu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="968a1-115">Ces méthodes à l’aide des objets de rappel et les objets d’état pour communiquer des informations entre les threads de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="968a1-116">Lorsque vous créez une nouvelle instance de la <xref:System.Messaging.MessageQueue> (classe), vous ne créez pas de nouvelle file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="968a1-117">Au lieu de cela, vous pouvez utiliser la <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, et <xref:System.Messaging.MessageQueue.Purge%2A> méthodes permettant de gérer des files d’attente sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="968a1-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="968a1-118">Contrairement aux <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> et <xref:System.Messaging.MessageQueue.Delete%28System.String%29> sont `static` membres, vous pouvez les appeler sans créer une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="968a1-119">Vous pouvez définir le <xref:System.Messaging.MessageQueue> l’objet <xref:System.Messaging.MessageQueue.Path%2A> propriété avec l’un des trois noms : le nom convivial, le <xref:System.Messaging.MessageQueue.FormatName%2A>, ou <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="968a1-120">Le nom convivial, ce qui est défini par la file d’attente <xref:System.Messaging.MessageQueue.MachineName%2A> et <xref:System.Messaging.MessageQueue.QueueName%2A> propriétés, est <xref:System.Messaging.MessageQueue.MachineName%2A> \\ <xref:System.Messaging.MessageQueue.QueueName%2A> pour une file d’attente publique, et <xref:System.Messaging.MessageQueue.MachineName%2A> \\ `Private$` \\ <xref:System.Messaging.MessageQueue.QueueName%2A> pour une file d’attente privée.</span><span class="sxs-lookup"><span data-stu-id="968a1-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="968a1-121">Le <xref:System.Messaging.MessageQueue.FormatName%2A> propriété permet d’accéder hors connexion aux files d’attente de message.</span><span class="sxs-lookup"><span data-stu-id="968a1-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="968a1-122">Enfin, vous pouvez utiliser la file d’attente <xref:System.Messaging.MessageQueue.Label%2A> propriété à définir la file d’attente <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="968a1-123">Pour obtenir la liste de valeurs de propriété initiales d’une instance de <xref:System.Messaging.MessageQueue>, consultez la <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-124">L’exemple de code suivant crée de nouveaux <xref:System.Messaging.MessageQueue> objets à l’aide de divers types de syntaxes de nom de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="968a1-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="968a1-125">Dans chaque cas, il envoie un message à la file d’attente dont le chemin est défini dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="968a1-126">L’exemple de code suivant envoie un message à une file d’attente et reçoit un message d’une file d’attente, à l’aide d’une classe spécifique à l’application appelée `Order`.</span><span class="sxs-lookup"><span data-stu-id="968a1-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe>
      <span data-ttu-id="968a1-127">Uniquement la <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> méthode est thread-safe.</span>
      <span class="sxs-lookup">
        <span data-stu-id="968a1-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span>
      </span>
    </threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-128">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-129">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
          <span data-ttu-id="968a1-130">Une fois la nouvelle instance initialisée par le constructeur, vous devez définir sa propriété <see cref="P:System.Messaging.MessageQueue.Path" /> avant de pouvoir l'utiliser.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-130">After the default constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-131">Utilisez cette surcharge pour créer une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe qui n’est pas immédiatement liée à une file d’attente sur le serveur Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="968a1-132">Avant d’utiliser cette instance, vous devez le connecter à une file d’attente Message Queuing existante en définissant le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="968a1-133">Vous pouvez également définir le <xref:System.Messaging.MessageQueue> une référence vers le <xref:System.Messaging.MessageQueue.Create%28System.String%29> valeur de retour de la méthode, créant ainsi une nouvelle file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="968a1-134">Le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur instancie une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe ; il ne crée pas une nouvelle file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="968a1-135">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="968a1-136">Property</span><span class="sxs-lookup"><span data-stu-id="968a1-136">Property</span></span>|<span data-ttu-id="968a1-137">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="968a1-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="968a1-138">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-138">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="968a1-139">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-139">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="968a1-140">Toutes les valeurs de filtre sont définies `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-141">L’exemple de code suivant crée un nouveau <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-142">Emplacement de la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-143">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" /> qui fait référence à la file d'attente Message Queuing dans le chemin d'accès spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-144">Utilisez cette surcharge lorsque vous souhaitez lier le nouveau <xref:System.Messaging.MessageQueue> instance à une file d’attente Message Queuing particulière, dont vous connaissez le chemin d’accès, le nom de format ou l’étiquette.</span><span class="sxs-lookup"><span data-stu-id="968a1-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="968a1-145">Si vous souhaitez accorder un accès exclusif à la première application qui fait référence à la file d’attente, vous devez définir le <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> propriété `true` ou utilisez le constructeur qui passe un paramètre de restriction d’accès en lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="968a1-146">Le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur instancie une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe ; il ne crée pas une nouvelle file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="968a1-147">Pour créer une nouvelle file d’attente dans Message Queuing, utilisez <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="968a1-148">La syntaxe de le `path` paramètre dépend du type de file d’attente il fait référence, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-149">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-149">Queue type</span></span>|<span data-ttu-id="968a1-150">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-151">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-152">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="968a1-153">File d’attente du journal</span><span class="sxs-lookup"><span data-stu-id="968a1-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="968a1-154">File d’attente du journal machine</span><span class="sxs-lookup"><span data-stu-id="968a1-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="968a1-155">File d’attente de lettres mortes machine</span><span class="sxs-lookup"><span data-stu-id="968a1-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="968a1-156">File d’attente de lettres mortes transactionnelle machine</span><span class="sxs-lookup"><span data-stu-id="968a1-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="968a1-157">Vous pouvez également utiliser le <xref:System.Messaging.MessageQueue.FormatName%2A> ou <xref:System.Messaging.MessageQueue.Label%2A> pour décrire le chemin d’accès de la file d’attente, comme illustré dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-158">Référence</span><span class="sxs-lookup"><span data-stu-id="968a1-158">Reference</span></span>|<span data-ttu-id="968a1-159">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-159">Syntax</span></span>|<span data-ttu-id="968a1-160">Exemple</span><span class="sxs-lookup"><span data-stu-id="968a1-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="968a1-161">Nom du format</span><span class="sxs-lookup"><span data-stu-id="968a1-161">Format name</span></span>|<span data-ttu-id="968a1-162">`FormatName:` [ *nom de format* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="968a1-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="968a1-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="968a1-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="968a1-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="968a1-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="968a1-167">Ajouter des contrôles</span><span class="sxs-lookup"><span data-stu-id="968a1-167">Label</span></span>|<span data-ttu-id="968a1-168">`Label:` [ *étiquette* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="968a1-169">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="968a1-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="968a1-170">Pour travailler hors connexion, vous devez utiliser la syntaxe du nom de format, pas la syntaxe de nom de chemin d’accès pour le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="968a1-171">Sinon, une exception est levée, car le contrôleur de domaine principal n’est pas disponible pour résoudre le chemin d’accès au nom de format.</span><span class="sxs-lookup"><span data-stu-id="968a1-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="968a1-172">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-173">Ces valeurs sont basées sur les propriétés de la file d’attente Message Queuing avec le chemin d’accès spécifié par le `path` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="968a1-174">Property</span><span class="sxs-lookup"><span data-stu-id="968a1-174">Property</span></span>|<span data-ttu-id="968a1-175">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="968a1-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="968a1-176">0</span><span class="sxs-lookup"><span data-stu-id="968a1-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="968a1-177">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-177">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="968a1-178">`true`, si le paramètre de niveau de confidentialité du Message Queuing la file d’attente est « Corps » ; dans le cas contraire, `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="968a1-179">La valeur de propriété de nom d’ordinateur de la file Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="968a1-180">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-180">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="968a1-181"><xref:System.String.Empty>, si ce n’est pas définie par le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="968a1-182"><xref:System.String.Empty>, si ce n’est pas définie par le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="968a1-183">`true`, si le paramètre de journal de l’objet Message Queuing est activé ; dans le cas contraire, `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-184">L’exemple de code suivant crée de nouveaux <xref:System.Messaging.MessageQueue> objets à l’aide de divers types de syntaxes de nom de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="968a1-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="968a1-185">Dans chaque cas, il envoie un message à la file d’attente dont le chemin est défini dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-186">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'est pas valide ; elle n'a probablement pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-187">Emplacement de la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />. Cela peut correspondre à "." pour l'ordinateur local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="968a1-188">
            <see langword="true" /> pour accorder un accès en lecture exclusif à la première application qui accède à la file d'attente ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-188">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-189">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" /> qui fait référence à la file d'attente Message Queuing dans le chemin d'accès et avec la restriction d'accès en lecture spécifiés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-190">Utilisez cette surcharge lorsque vous souhaitez lier le nouveau <xref:System.Messaging.MessageQueue> à une file d’attente Message Queuing particulière, dont vous connaissez le chemin d’accès, le nom de format ou l’étiquette.</span><span class="sxs-lookup"><span data-stu-id="968a1-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="968a1-191">Si vous souhaitez accorder un accès exclusif à la première application qui fait référence à la file d’attente, définissez la `sharedModeDenyReceive` paramètre `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="968a1-192">Sinon, la valeur `sharedModeDenyReceive` à `false` ou utilisez le constructeur qui a uniquement un `path` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="968a1-193">Paramètre `sharedModeDenyReceive` à `true` affecte tous les objets qui accèdent à la file d’attente Message Queuing, y compris les autres applications.</span><span class="sxs-lookup"><span data-stu-id="968a1-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="968a1-194">Les effets du paramètre ne sont pas limitées à cette application.</span><span class="sxs-lookup"><span data-stu-id="968a1-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="968a1-195">Le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur crée une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe ; il ne crée pas une nouvelle file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="968a1-196">Pour créer une nouvelle file d’attente dans Message Queuing, utilisez <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="968a1-197">La syntaxe de le `path` paramètre varie selon le type de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="968a1-198">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-198">Queue type</span></span>|<span data-ttu-id="968a1-199">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-200">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-201">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="968a1-202">File d’attente du journal</span><span class="sxs-lookup"><span data-stu-id="968a1-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="968a1-203">File d’attente du journal machine</span><span class="sxs-lookup"><span data-stu-id="968a1-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="968a1-204">File d’attente de lettres mortes machine</span><span class="sxs-lookup"><span data-stu-id="968a1-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="968a1-205">File d’attente de lettres mortes transactionnelle machine</span><span class="sxs-lookup"><span data-stu-id="968a1-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="968a1-206">Ou bien, vous pouvez utiliser le nom de format ou l’étiquette d’une file d’attente Message Queuing pour décrire le chemin d’accès de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="968a1-207">Référence</span><span class="sxs-lookup"><span data-stu-id="968a1-207">Reference</span></span>|<span data-ttu-id="968a1-208">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-208">Syntax</span></span>|<span data-ttu-id="968a1-209">Exemple</span><span class="sxs-lookup"><span data-stu-id="968a1-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="968a1-210">Nom du format</span><span class="sxs-lookup"><span data-stu-id="968a1-210">Format name</span></span>|<span data-ttu-id="968a1-211">`FormatName:` [ *nom de format* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="968a1-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="968a1-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="968a1-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="968a1-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="968a1-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="968a1-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="968a1-216">Ajouter des contrôles</span><span class="sxs-lookup"><span data-stu-id="968a1-216">Label</span></span>|<span data-ttu-id="968a1-217">`Label:` [ *étiquette* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="968a1-218">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="968a1-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="968a1-219">Pour travailler hors connexion, vous devez utiliser la syntaxe de nom de format, plutôt que la syntaxe du nom convivial.</span><span class="sxs-lookup"><span data-stu-id="968a1-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="968a1-220">Sinon, une exception est levée, car le contrôleur de domaine principal (sur lequel Active Directory réside) n’est pas disponible pour résoudre le chemin d’accès au nom de format.</span><span class="sxs-lookup"><span data-stu-id="968a1-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="968a1-221">Si un <xref:System.Messaging.MessageQueue> ouvre une file d’attente avec le `sharedModeDenyReceive` paramètre la valeur `true`, tout <xref:System.Messaging.MessageQueue> que par la suite essaie de lire à partir de la file d’attente génère une <xref:System.Messaging.MessageQueueException> en raison d’une violation de partage.</span><span class="sxs-lookup"><span data-stu-id="968a1-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="968a1-222">A <xref:System.Messaging.MessageQueueException> est également levée si une <xref:System.Messaging.MessageQueue> essaie d’accéder à la file d’attente en mode exclusif, alors qu’un autre <xref:System.Messaging.MessageQueue> a déjà accès non exclusif à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="968a1-223">Le tableau suivant montre les valeurs initiales des propriétés d’une instance de <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-224">Ces valeurs sont basées sur les propriétés de la file d’attente Message Queuing, avec le chemin d’accès spécifié par le `path` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="968a1-225">Property</span><span class="sxs-lookup"><span data-stu-id="968a1-225">Property</span></span>|<span data-ttu-id="968a1-226">Valeur initiale</span><span class="sxs-lookup"><span data-stu-id="968a1-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="968a1-227">`false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="968a1-228">0.</span><span class="sxs-lookup"><span data-stu-id="968a1-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="968a1-229"><xref:System.Guid.Empty>.</span><span class="sxs-lookup"><span data-stu-id="968a1-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="968a1-230">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.DefaultPropertiesToSend> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-230">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="968a1-231">`true`, si le paramètre de niveau de confidentialité du Message Queuing la file d’attente est « Corps » ; dans le cas contraire, `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="968a1-232"><xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="968a1-233"><xref:System.String.Empty>.</span><span class="sxs-lookup"><span data-stu-id="968a1-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="968a1-234">La valeur de propriété de nom d’ordinateur de la file Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="968a1-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="968a1-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="968a1-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="968a1-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="968a1-237">Les valeurs définies par le constructeur par défaut de la <xref:System.Messaging.MessagePropertyFilter> classe.</span><span class="sxs-lookup"><span data-stu-id="968a1-237">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="968a1-238"><xref:System.String.Empty>, si ce n’est pas définie par le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="968a1-239"><xref:System.String.Empty>, si ce n’est pas définie par le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="968a1-240">Valeur du paramètre `sharedModeDenyReceive`.</span><span class="sxs-lookup"><span data-stu-id="968a1-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="968a1-241">`true`, si le paramètre de journal de l’objet Message Queuing est activé ; dans le cas contraire, `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-242">L’exemple de code suivant crée un nouveau <xref:System.Messaging.MessageQueue> avec un accès exclusif, définit son chemin d’accès et envoie un message à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-243">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'est pas valide ; elle n'a probablement pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-244">Emplacement de la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />. Cela peut correspondre à "." pour l'ordinateur local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="accessMode">
          <span data-ttu-id="968a1-245">Une des valeurs de <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-246">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-247">Emplacement de la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />. Cela peut correspondre à "." pour l'ordinateur local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="968a1-248">
            <see langword="true" /> pour accorder un accès en lecture exclusif à la première application qui accède à la file d'attente ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-248">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="enableCache">
          <span data-ttu-id="968a1-249">
            <see langword="true" /> pour créer et utiliser un cache de connexions, sinon <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-249">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-250">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="968a1-251">L’exemple de code suivant crée un nouveau <xref:System.Messaging.MessageQueue> avec un accès exclusif en lecture et connexion mise en cache.</span><span class="sxs-lookup"><span data-stu-id="968a1-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-252">Emplacement de la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />. Cela peut correspondre à "." pour l'ordinateur local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span>
          </span>
        </param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="968a1-253">
            <see langword="true" /> pour accorder un accès en lecture exclusif à la première application qui accède à la file d'attente ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-253">
              <see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="enableCache">
          <span data-ttu-id="968a1-254">
            <see langword="true" /> pour créer et utiliser un cache de connexions, sinon <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-254">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </param>
        <param name="accessMode">
          <span data-ttu-id="968a1-255">Une des valeurs de <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-256">Initialise une nouvelle instance de la classe <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-257">Obtient une valeur qui indique le mode d'accès pour la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-257">Gets a value that indicates the access mode for the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-258">Une des valeurs de <see cref="T:System.Messaging.QueueAccessMode" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-259">Le mode d’accès par défaut pour une file d’attente est `QueueAccessMode.SendAndReceive`, sauf indication contraire lors de l’appel du constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-260">Obtient ou définit une valeur qui indique si la file d'attente accepte uniquement les messages authentifiés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-261">
            <see langword="true" /> si la file d'attente accepte uniquement les messages authentifiés ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-261">
              <see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="968a1-262">La valeur par défaut est <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-262">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-263">L’authentification des messages fournit un moyen pour garantir l’intégrité des messages et pour vérifier qui a envoyé le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="968a1-264">Pour demander l’authentification, l’application émettrice définit le niveau d’authentification du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="968a1-265">Lorsque vous définissez <xref:System.Messaging.MessageQueue.Authenticate%2A> à `true`, vous pouvez réserver l’accès à la file d’attente sur le serveur, pas uniquement à ce <xref:System.Messaging.MessageQueue> instance.</span><span class="sxs-lookup"><span data-stu-id="968a1-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="968a1-266">Tous les clients utilisant la même file d’attente Message Queuing seront affectées.</span><span class="sxs-lookup"><span data-stu-id="968a1-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="968a1-267">Une file d’attente qui accepte uniquement les messages authentifiés rejette un message non authentifié.</span><span class="sxs-lookup"><span data-stu-id="968a1-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="968a1-268">Pour demander la notification de refus des messages, une application émettrice peut définir le <xref:System.Messaging.Message.AcknowledgeType%2A> propriété du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="968a1-269">Comme aucune indication de rejet de message n’existe, l’application émettrice peut perdre le message, sauf si vous demandez qu’il est envoyé à la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="968a1-270">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-271">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-271">Workgroup mode</span></span>|<span data-ttu-id="968a1-272">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-273">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-273">Local computer</span></span>|<span data-ttu-id="968a1-274">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-274">Yes</span></span>|  
|<span data-ttu-id="968a1-275">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-275">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-276">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-276">Yes</span></span>|  
|<span data-ttu-id="968a1-277">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-277">Remote computer</span></span>|<span data-ttu-id="968a1-278">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-278">No</span></span>|  
|<span data-ttu-id="968a1-279">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-279">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-280">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-281">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.Authenticate%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-282">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-282">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-283">Obtient ou définit la priorité de base utilisée par Message Queuing pour acheminer les messages d'une file d'attente publique sur le réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-284">Priorité de base unique pour tous les messages envoyés à la file d'attente (publique).</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-284">The single base priority for all messages sent to the (public) queue.</span>
          </span>
          <span data-ttu-id="968a1-285">La valeur par défaut est zéro (0).</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-285">The default is zero (0).</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-286">Priorité de base d’une file d’attente message spécifie comment un message en cours de route à cette file d’attente est traitée lorsqu’il transite via le réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="968a1-287">Vous pouvez définir le <xref:System.Messaging.MessageQueue.BasePriority%2A> propriété permet de conférer une priorité supérieure ou inférieure à tous les messages envoyés à la file d’attente spécifiée à celles envoyées aux autres files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="968a1-288">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-289">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification.</span><span class="sxs-lookup"><span data-stu-id="968a1-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="968a1-290">Une file d’attente de messages <xref:System.Messaging.MessageQueue.BasePriority%2A> n’est pas lié à la <xref:System.Messaging.Message.Priority%2A> propriété d’un message, qui spécifie l’ordre dans lequel un message entrant est placé dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="968a1-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> s’applique uniquement à public files d’attente dont les chemins sont spécifiés à l’aide du nom de format.</span><span class="sxs-lookup"><span data-stu-id="968a1-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="968a1-292">La priorité de base d’une file d’attente privée est toujours zéro (0).</span><span class="sxs-lookup"><span data-stu-id="968a1-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="968a1-293">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-294">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-294">Workgroup mode</span></span>|<span data-ttu-id="968a1-295">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-296">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-296">Local computer</span></span>|<span data-ttu-id="968a1-297">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-297">Yes</span></span>|  
|<span data-ttu-id="968a1-298">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-298">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-299">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-299">Yes</span></span>|  
|<span data-ttu-id="968a1-300">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-300">Remote computer</span></span>|<span data-ttu-id="968a1-301">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-301">No</span></span>|  
|<span data-ttu-id="968a1-302">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-302">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-303">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-304">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.BasePriority%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-305">La valeur de la priorité de base est non valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-305">The base priority was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-306">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-306">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="968a1-307">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-307">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="968a1-308">Lance une opération de lecture asynchrone en demandant à Message Queuing de commencer la lecture d'un message et d'avertir le gestionnaire d'événements lorsqu'elle aura terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-309">Lance une opération de lecture asynchrone n'ayant pas de délai d'attente. L'opération n'est pas terminée tant qu'un message n'est pas disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-310">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-311">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement lorsqu’un message est disponible dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="968a1-312"><xref:System.Messaging.MessageQueue.PeekCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-313">Pour utiliser <xref:System.Messaging.MessageQueue.BeginPeek%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> lance une opération de lecture asynchrone ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.PeekCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-315">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> ou en récupérant le résultat à l’aide du <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-316">Le <xref:System.Messaging.MessageQueue.BeginPeek%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-317">Étant donné que <xref:System.Messaging.MessageQueue.BeginPeek%2A> est asynchrone, vous pouvez appeler pour lire la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-318">Pour lire la file d’attente de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-319">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-320">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginPeek%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-321">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-322">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-323">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-324">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’événement de fin est déclenché, mais une exception est levée lors de l’appel <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-325">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-326">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-326">Workgroup mode</span></span>|<span data-ttu-id="968a1-327">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-328">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-328">Local computer</span></span>|<span data-ttu-id="968a1-329">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-329">Yes</span></span>|  
|<span data-ttu-id="968a1-330">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-330">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-331">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-331">Yes</span></span>|  
|<span data-ttu-id="968a1-332">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-332">Remote computer</span></span>|<span data-ttu-id="968a1-333">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-333">No</span></span>|  
|<span data-ttu-id="968a1-334">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-334">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-335">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-336">L’exemple de code suivant crée un gestionnaire d’événements nommé `MyPeekCompleted`, attache à la <xref:System.Messaging.MessageQueue.PeekCompleted> délégué de gestionnaire d’événements et appelle <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une opération de lecture asynchrone sur la file d’attente qui se trouve dans le chemin d’accès ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="968a1-337">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché, l’exemple lit le message et écrit son corps à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="968a1-338">L’exemple appelle ensuite <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une nouvelle opération de lecture asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-339">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-339">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-340">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-340">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-341">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-342">Lance une opération de lecture asynchrone ayant un délai d'attente spécifique. L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-343">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-344">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré.</span><span class="sxs-lookup"><span data-stu-id="968a1-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="968a1-345"><xref:System.Messaging.MessageQueue.PeekCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-346">Pour utiliser <xref:System.Messaging.MessageQueue.BeginPeek%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> lance une opération de lecture asynchrone ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.PeekCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-348">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> ou en récupérant le résultat à l’aide du <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-349">Le <xref:System.Messaging.MessageQueue.BeginPeek%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-350">Étant donné que <xref:System.Messaging.MessageQueue.BeginPeek%2A> est asynchrone, vous pouvez appeler pour lire la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-351">Pour lire la file d’attente de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-352">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-353">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginPeek%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-354">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-355">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-356">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-357">Cette surcharge spécifie un délai d’attente. Si l’intervalle spécifié par le `timeout` paramètre expire, ce composant déclenche le <xref:System.Messaging.MessageQueue.PeekCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="968a1-358">Parce qu’aucun message n’existe, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="968a1-359">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’événement de fin est déclenché, mais une exception est levée lors de l’appel <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-360">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-361">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-361">Workgroup mode</span></span>|<span data-ttu-id="968a1-362">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-363">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-363">Local computer</span></span>|<span data-ttu-id="968a1-364">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-364">Yes</span></span>|  
|<span data-ttu-id="968a1-365">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-365">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-366">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-366">Yes</span></span>|  
|<span data-ttu-id="968a1-367">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-367">Remote computer</span></span>|<span data-ttu-id="968a1-368">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-368">No</span></span>|  
|<span data-ttu-id="968a1-369">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-369">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-370">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-371">L’exemple de code suivant crée une opération de lecture asynchrone, en utilisant le chemin d’accès de la file d’attente ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="968a1-372">Il crée un gestionnaire d’événements, `MyPeekCompleted`et l’attache à le <xref:System.Messaging.MessageQueue.PeekCompleted> délégué de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="968a1-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="968a1-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> est appelée avec un délai d’attente d’une minute, pour initialiser l’opération de lecture asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="968a1-374">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché ou le délai d’attente expire, le message est récupéré si il en existe, son corps est écrit à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="968a1-375">Puis <xref:System.Messaging.MessageQueue.BeginPeek%2A> est rappelée pour lancer une nouvelle opération de lecture asynchrone avec le même délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-376">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-377">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-377">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-378">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-378">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-379">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="968a1-380">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-381">Lance une opération de lecture asynchrone avec un délai et un objet d'état spécifiés, permettant ainsi de disposer de données associées pendant toute la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="968a1-382">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-383">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-384">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré.</span><span class="sxs-lookup"><span data-stu-id="968a1-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="968a1-385"><xref:System.Messaging.MessageQueue.PeekCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-386">Utilisez cette surcharge pour associer à l’opération qui est conservée pendant toute la durée de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="968a1-387">Le Gestionnaire d’événements peut accéder à ces informations en examinant le <xref:System.IAsyncResult.AsyncState%2A> propriété de la <xref:System.IAsyncResult> associé à l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="968a1-388">Pour utiliser <xref:System.Messaging.MessageQueue.BeginPeek%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> lance une opération de lecture asynchrone ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.PeekCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-390">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> ou en récupérant le résultat à l’aide du <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-391">Le <xref:System.Messaging.MessageQueue.BeginPeek%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-392">Étant donné que <xref:System.Messaging.MessageQueue.BeginPeek%2A> est asynchrone, vous pouvez appeler pour lire la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-393">Pour lire la file d’attente de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-394">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Retourne un <xref:System.IAsyncResult> qui identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-396">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-397">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-398">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-399">Cette surcharge spécifie un délai d’attente et un objet d’état.</span><span class="sxs-lookup"><span data-stu-id="968a1-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="968a1-400">Si l’intervalle spécifié par le `timeout` paramètre expire, ce composant déclenche le <xref:System.Messaging.MessageQueue.PeekCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="968a1-401">Parce qu’aucun message n’existe, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="968a1-402">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-403">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="968a1-404">Pour obtenir une illustration de ce scénario, consultez la section exemple.</span><span class="sxs-lookup"><span data-stu-id="968a1-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="968a1-405">Vous pouvez également utiliser l’objet d’état pour passer des informations sur les threads de processus.</span><span class="sxs-lookup"><span data-stu-id="968a1-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="968a1-406">Si un thread est démarré, mais que le rappel est sur un thread différent dans un scénario asynchrone, l’objet d’état est marshalé et passé précédent ainsi que des informations à partir de l’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="968a1-407">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’événement de fin est déclenché, mais une exception est levée lors de l’appel <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-408">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-409">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-409">Workgroup mode</span></span>|<span data-ttu-id="968a1-410">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-411">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-411">Local computer</span></span>|<span data-ttu-id="968a1-412">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-412">Yes</span></span>|  
|<span data-ttu-id="968a1-413">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-413">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-414">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-414">Yes</span></span>|  
|<span data-ttu-id="968a1-415">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-415">Remote computer</span></span>|<span data-ttu-id="968a1-416">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-416">No</span></span>|  
|<span data-ttu-id="968a1-417">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-417">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-418">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-419">L’exemple de code suivant crée une opération de lecture asynchrone, en utilisant le chemin d’accès de la file d’attente ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="968a1-420">Il crée un gestionnaire d’événements, `MyPeekCompleted`et l’attache à le <xref:System.Messaging.MessageQueue.PeekCompleted> délégué de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="968a1-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="968a1-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> est appelée avec un délai d’attente d’une minute.</span><span class="sxs-lookup"><span data-stu-id="968a1-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="968a1-422">Chaque appel à <xref:System.Messaging.MessageQueue.BeginPeek%2A> a un entier unique qui identifie cette opération spécifique.</span><span class="sxs-lookup"><span data-stu-id="968a1-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="968a1-423">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché ou que le délai d’attente expire, le message, s’il en existe, est récupéré et son corps et l’identificateur entier correspondant à l’opération sont écrits à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="968a1-424">Puis <xref:System.Messaging.MessageQueue.BeginPeek%2A> est rappelée pour lancer une nouvelle opération de lecture asynchrone avec le même délai d’attente et l’entier associé à l’opération simplement terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-425">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-426">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-426">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-427">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-427">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-428">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="968a1-429">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="968a1-430">
            <see cref="T:System.AsyncCallback" /> qui recevra la notification de la fin de l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-431">Lance une opération de lecture asynchrone avec un délai et un objet d'état spécifiés, permettant ainsi de disposer de données associées pendant toute la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="968a1-432">Cette surcharge reçoit, via un rappel, la notification de l'identité du gestionnaire d'événements de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="968a1-433">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-434">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-435">Lorsque vous utilisez cette surcharge, le rappel spécifié dans le paramètre de rappel est appelé directement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré ; le <xref:System.Messaging.MessageQueue.PeekCompleted> événement n’est pas déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="968a1-436">Les autres surcharges de <xref:System.Messaging.MessageQueue.BeginPeek%2A> reposent sur ce composant pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="968a1-437"><xref:System.Messaging.MessageQueue.PeekCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-438">Le <xref:System.Messaging.MessageQueue.BeginPeek%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-439">Étant donné que <xref:System.Messaging.MessageQueue.BeginPeek%2A> est asynchrone, vous pouvez appeler pour lire la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-440">Pour lire la file d’attente de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-441">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Retourne un <xref:System.IAsyncResult> qui identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-443">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-444">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-445">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-446">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-447">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="968a1-448">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-449">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-449">Workgroup mode</span></span>|<span data-ttu-id="968a1-450">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-451">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-451">Local computer</span></span>|<span data-ttu-id="968a1-452">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-452">Yes</span></span>|  
|<span data-ttu-id="968a1-453">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-453">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-454">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-454">Yes</span></span>|  
|<span data-ttu-id="968a1-455">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-455">Remote computer</span></span>|<span data-ttu-id="968a1-456">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-456">No</span></span>|  
|<span data-ttu-id="968a1-457">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-457">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-458">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-459">L’exemple de code suivant crée une opération de lecture asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="968a1-460">L’exemple de code envoie un message à une file d’attente locale, puis appelle <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, en passant : une valeur de délai d’attente de dix secondes ; un entier unique qui identifie ce message particulier ; et une nouvelle instance de <xref:System.AsyncCallback> qui identifie le Gestionnaire d’événements `MyPeekCompleted`.</span><span class="sxs-lookup"><span data-stu-id="968a1-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="968a1-461">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché, le Gestionnaire d’événements lit le message et écrit le corps du message et l’entier identifiant le message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-462">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-463">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-463">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-464">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-464">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-465">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-466">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="action">
          <span data-ttu-id="968a1-467">Une des valeurs de <see cref="T:System.Messaging.PeekAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span>
          </span>
          <span data-ttu-id="968a1-468">Indique s'il faut lire le message en cours dans la file d'attente ou le message suivant.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-468">Indicates whether to peek at the current message in the queue, or the next message.</span>
          </span>
        </param>
        <param name="state">
          <span data-ttu-id="968a1-469">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="968a1-470">
            <see cref="T:System.AsyncCallback" /> qui reçoit la notification de la fin de l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-471">Initialise une opération de lecture asynchrone qui a un délai d'expiration spécifié et utilise un curseur spécifié, une action de lecture spécifiée et un objet d'état spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span>
          </span>
          <span data-ttu-id="968a1-472">L'objet d'état fournit des informations associées pendant la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-472">The state object provides associated information throughout the lifetime of the operation.</span>
          </span>
          <span data-ttu-id="968a1-473">Cette surcharge reçoit, via un rappel, la notification de l'identité du gestionnaire d'événements de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="968a1-474">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-475">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-476">Lorsque vous utilisez cette surcharge, le rappel spécifié dans le paramètre de rappel est appelé directement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré.</span><span class="sxs-lookup"><span data-stu-id="968a1-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="968a1-477">Le <xref:System.Messaging.MessageQueue.PeekCompleted> événement n’est pas déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="968a1-478">Les autres surcharges de <xref:System.Messaging.MessageQueue.BeginPeek%2A> reposent sur ce composant pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="968a1-479"><xref:System.Messaging.MessageQueue.PeekCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-480">Le <xref:System.Messaging.MessageQueue.BeginPeek%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-481">Étant donné que <xref:System.Messaging.MessageQueue.BeginPeek%2A> est asynchrone, vous pouvez appeler pour lire la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-482">Pour lire la file d’attente de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-483">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Retourne un <xref:System.IAsyncResult> qui identifie l’opération asynchrone démarrée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="968a1-485">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-486">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-487">Dans ce cas, utilisez le <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-488">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-489">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="968a1-490">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-491">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-491">Workgroup mode</span></span>|<span data-ttu-id="968a1-492">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-493">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-493">Local computer</span></span>|<span data-ttu-id="968a1-494">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-494">Yes</span></span>|  
|<span data-ttu-id="968a1-495">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-495">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-496">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-496">Yes</span></span>|  
|<span data-ttu-id="968a1-497">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-497">Remote computer</span></span>|<span data-ttu-id="968a1-498">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-498">No</span></span>|  
|<span data-ttu-id="968a1-499">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-499">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-500">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="968a1-501">Une valeur autre que <see langword="PeekAction.Current" /> ou <see langword="PeekAction.Next" /> a été spécifiée pour le paramètre <paramref name="action" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-502">Le paramètre <paramref name="cursor" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-503">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-504">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-504">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-505">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-505">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="968a1-506">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-506">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="968a1-507">Lance une opération de réception asynchrone, en demandant à Message Queuing de commencer la réception d'un message et d'avertir le gestionnaire d'événements lorsqu'elle aura terminé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-508">Lance une opération de réception asynchrone n'ayant pas de délai d'attente. L'opération n'est pas terminée tant qu'un message n'est pas disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-509">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-510">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginReceive%2A> pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement lorsqu’un message a été supprimé de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="968a1-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-512">Pour utiliser <xref:System.Messaging.MessageQueue.BeginReceive%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> lance une réception asynchrone opération ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-514">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-515">Le <xref:System.Messaging.MessageQueue.BeginReceive%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-516">Étant donné que <xref:System.Messaging.MessageQueue.BeginReceive%2A> est asynchrone, vous pouvez l’appeler pour recevoir un message à partir de la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-517">Pour recevoir un message de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Receive%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-518">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-519">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginReceive%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-520">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-521">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-522">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-523">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’événement de fin est déclenché, mais une exception est levée lors de l’appel <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-524">N’utilisez pas l’appel asynchrone <xref:System.Messaging.MessageQueue.BeginReceive%2A> avec des transactions.</span><span class="sxs-lookup"><span data-stu-id="968a1-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="968a1-525">Si vous souhaitez effectuer une opération asynchrone transactionnelle, appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A>et indiquez la transaction et (synchrone) <xref:System.Messaging.MessageQueue.Receive%2A> méthode dans le Gestionnaire d’événements que vous créez pour l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="968a1-526">Votre gestionnaire d’événements peut contenir des fonctionnalités comme le montre le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="968a1-527">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-528">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-528">Workgroup mode</span></span>|<span data-ttu-id="968a1-529">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-530">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-530">Local computer</span></span>|<span data-ttu-id="968a1-531">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-531">Yes</span></span>|  
|<span data-ttu-id="968a1-532">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-532">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-533">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-533">Yes</span></span>|  
|<span data-ttu-id="968a1-534">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-534">Remote computer</span></span>|<span data-ttu-id="968a1-535">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-535">No</span></span>|  
|<span data-ttu-id="968a1-536">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-536">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-537">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-538">L’exemple de code suivant associe plusieurs demandes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="968a1-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="968a1-539">Il suppose une file d’attente sur l’ordinateur local, appelé « myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="968a1-540">Le `Main` fonction commence l’opération asynchrone est gérée par le `MyReceiveCompleted` routine.</span><span class="sxs-lookup"><span data-stu-id="968a1-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="968a1-541">`MyReceiveCompleted` traite le message en cours et commence une nouvelle asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="968a1-542">L’exemple de code suivant des files d’attente des requêtes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="968a1-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="968a1-543">L’appel à <xref:System.Messaging.MessageQueue.BeginReceive%2A> utilise le <xref:System.IAsyncResult.AsyncWaitHandle%2A> dans sa valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="968a1-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="968a1-544">Le `Main` routine attend que toutes les opérations asynchrones doit être terminé avant de quitter.</span><span class="sxs-lookup"><span data-stu-id="968a1-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-545">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-545">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-546">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-546">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-547">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-548">Lance une opération de réception asynchrone ayant un délai d'attente spécifique. L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-549">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-550">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginReceive%2A> pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré.</span><span class="sxs-lookup"><span data-stu-id="968a1-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="968a1-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-552">Pour utiliser <xref:System.Messaging.MessageQueue.BeginReceive%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> lance une réception asynchrone opération ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-554">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> ou récupérer le résultat à l’aide du <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-555">Le <xref:System.Messaging.MessageQueue.BeginReceive%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-556">Étant donné que <xref:System.Messaging.MessageQueue.BeginReceive%2A> est asynchrone, vous pouvez l’appeler pour recevoir un message à partir de la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-557">Pour recevoir un message de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Receive%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-558">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-559">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’événement de fin est déclenché, mais une exception est levée lors de l’appel <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-560">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginReceive%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-561">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-562">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-563">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-564">Cette surcharge spécifie un délai d’attente. Si l’intervalle spécifié par le `timeout` paramètre expire, ce composant déclenche le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="968a1-565">Parce qu’aucun message n’existe, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="968a1-566">N’utilisez pas l’appel asynchrone <xref:System.Messaging.MessageQueue.BeginReceive%2A> avec des transactions.</span><span class="sxs-lookup"><span data-stu-id="968a1-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="968a1-567">Si vous souhaitez effectuer une opération asynchrone transactionnelle, appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A>et indiquez la transaction et (synchrone) <xref:System.Messaging.MessageQueue.Receive%2A> méthode dans le Gestionnaire d’événements que vous créez pour l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="968a1-568">Votre gestionnaire d’événements peut contenir des fonctionnalités comme le montre le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="968a1-569">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-570">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-570">Workgroup mode</span></span>|<span data-ttu-id="968a1-571">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-572">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-572">Local computer</span></span>|<span data-ttu-id="968a1-573">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-573">Yes</span></span>|  
|<span data-ttu-id="968a1-574">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-574">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-575">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-575">Yes</span></span>|  
|<span data-ttu-id="968a1-576">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-576">Remote computer</span></span>|<span data-ttu-id="968a1-577">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-577">No</span></span>|  
|<span data-ttu-id="968a1-578">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-578">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-579">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-580">L’exemple de code suivant crée une commande asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="968a1-581">L’exemple de code crée un gestionnaire d’événements, `MyReceiveCompleted`et l’attache à le <xref:System.Messaging.MessageQueue.ReceiveCompleted> délégué de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="968a1-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="968a1-582">L’exemple de code envoie un message à une file d’attente locale, puis appelle <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, en passant une valeur de délai d’attente de dix secondes.</span><span class="sxs-lookup"><span data-stu-id="968a1-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="968a1-583">Lorsqu’un <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché, le Gestionnaire d’événements reçoit le message et écrit le corps du message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-584">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide ; il s'agit probablement d'un nombre négatif.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-585">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-585">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-586">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-586">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-587">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="968a1-588">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-589">Lance une opération de réception asynchrone avec un délai et un objet d'état spécifiés, permettant ainsi de disposer de données associées pendant toute la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="968a1-590">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-591">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-592">Dans le traitement asynchrone, vous utilisez <xref:System.Messaging.MessageQueue.BeginReceive%2A> pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré.</span><span class="sxs-lookup"><span data-stu-id="968a1-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="968a1-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-594">Utilisez cette surcharge pour associer à l’opération qui est conservée pendant toute la durée de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="968a1-595">Le Gestionnaire d’événements peut détecter ces informations en examinant le <xref:System.IAsyncResult.AsyncState%2A> propriété de la <xref:System.IAsyncResult> associé à l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="968a1-596">Pour utiliser <xref:System.Messaging.MessageQueue.BeginReceive%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> lance une réception asynchrone opération ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-598">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> ou récupérer le résultat à l’aide du <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-599">Le <xref:System.Messaging.MessageQueue.BeginReceive%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-600">Étant donné que <xref:System.Messaging.MessageQueue.BeginReceive%2A> est asynchrone, vous pouvez l’appeler pour recevoir un message à partir de la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-601">Pour recevoir un message de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Receive%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-602">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-603">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginReceive%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-604">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-605">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-606">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-607">Cette surcharge spécifie un délai d’attente et un objet d’état.</span><span class="sxs-lookup"><span data-stu-id="968a1-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="968a1-608">Si l’intervalle spécifié par le `timeout` paramètre expire, ce composant déclenche le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="968a1-609">Parce qu’aucun message n’existe, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="968a1-610">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-611">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginReceive%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="968a1-612">Vous pouvez également utiliser l’objet d’état pour passer des informations sur les threads de processus.</span><span class="sxs-lookup"><span data-stu-id="968a1-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="968a1-613">Si un thread est démarré, mais que le rappel est sur un thread différent dans un scénario asynchrone, l’objet d’état est marshalé et passé précédent ainsi que des informations à partir de l’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="968a1-614">N’utilisez pas l’appel asynchrone <xref:System.Messaging.MessageQueue.BeginReceive%2A> avec des transactions.</span><span class="sxs-lookup"><span data-stu-id="968a1-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="968a1-615">Si vous souhaitez effectuer une opération asynchrone transactionnelle, appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A>et indiquez la transaction et (synchrone) <xref:System.Messaging.MessageQueue.Receive%2A> méthode dans le Gestionnaire d’événements que vous créez pour l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="968a1-616">Votre gestionnaire d’événements peut contenir des fonctionnalités comme le montre le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="968a1-617">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-618">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-618">Workgroup mode</span></span>|<span data-ttu-id="968a1-619">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-620">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-620">Local computer</span></span>|<span data-ttu-id="968a1-621">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-621">Yes</span></span>|  
|<span data-ttu-id="968a1-622">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-622">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-623">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-623">Yes</span></span>|  
|<span data-ttu-id="968a1-624">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-624">Remote computer</span></span>|<span data-ttu-id="968a1-625">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-625">No</span></span>|  
|<span data-ttu-id="968a1-626">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-626">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-627">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-628">L’exemple de code suivant crée une commande asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="968a1-629">L’exemple de code crée un gestionnaire d’événements, `MyReceiveCompleted`et l’attache à le <xref:System.Messaging.MessageQueue.ReceiveCompleted> délégué de gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="968a1-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="968a1-630">L’exemple de code envoie un message à une file d’attente locale, puis appelle <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, en passant une valeur de délai d’attente de dix secondes et un entier unique qui identifie ce message particulier.</span><span class="sxs-lookup"><span data-stu-id="968a1-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="968a1-631">Lorsqu’un <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché, le Gestionnaire d’événements reçoit le message et écrit le corps du message et l’entier identifiant le message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-632">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-633">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-633">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-634">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-634">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-635">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="stateObject">
          <span data-ttu-id="968a1-636">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="968a1-637">
            <see cref="T:System.AsyncCallback" /> qui recevra la notification de la fin de l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-638">Lance une opération de réception asynchrone avec un délai et un objet d'état spécifiés, permettant ainsi de disposer de données associées pendant toute la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span>
          </span>
          <span data-ttu-id="968a1-639">Cette surcharge reçoit, via un rappel, la notification de l'identité du gestionnaire d'événements de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="968a1-640">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-641">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-642">Lorsque vous utilisez cette surcharge, le rappel spécifié dans le paramètre de rappel est appelé directement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré ; le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement n’est pas déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="968a1-643">Les autres surcharges de <xref:System.Messaging.MessageQueue.BeginReceive%2A> reposent sur ce composant pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="968a1-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-645">Pour utiliser <xref:System.Messaging.MessageQueue.BeginReceive%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> lance une réception asynchrone opération ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-647">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> ou récupérer le résultat à l’aide du <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-648">Le <xref:System.Messaging.MessageQueue.BeginReceive%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-649">Étant donné que <xref:System.Messaging.MessageQueue.BeginReceive%2A> est asynchrone, vous pouvez l’appeler pour recevoir un message à partir de la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-650">Pour recevoir un message de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Receive%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-651">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-652">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginReceive%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-653">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-654">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-655">Dans ce cas, vous utilisez la <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-656">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-657">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginReceive%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="968a1-658">Vous pouvez également utiliser l’objet d’état pour passer des informations sur les threads de processus.</span><span class="sxs-lookup"><span data-stu-id="968a1-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="968a1-659">Si un thread est démarré, mais que le rappel est sur un thread différent dans un scénario asynchrone, l’objet d’état est marshalé et passé précédent ainsi que des informations à partir de l’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="968a1-660">N’utilisez pas l’appel asynchrone <xref:System.Messaging.MessageQueue.BeginReceive%2A> avec des transactions.</span><span class="sxs-lookup"><span data-stu-id="968a1-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="968a1-661">Si vous souhaitez effectuer une opération asynchrone transactionnelle, appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A>et indiquez la transaction et (synchrone) <xref:System.Messaging.MessageQueue.Receive%2A> méthode dans le Gestionnaire d’événements que vous créez pour l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="968a1-662">Votre gestionnaire d’événements peut contenir des fonctionnalités comme le montre le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="968a1-663">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-664">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-664">Workgroup mode</span></span>|<span data-ttu-id="968a1-665">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-666">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-666">Local computer</span></span>|<span data-ttu-id="968a1-667">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-667">Yes</span></span>|  
|<span data-ttu-id="968a1-668">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-668">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-669">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-669">Yes</span></span>|  
|<span data-ttu-id="968a1-670">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-670">Remote computer</span></span>|<span data-ttu-id="968a1-671">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-671">No</span></span>|  
|<span data-ttu-id="968a1-672">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-672">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-673">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-674">L’exemple de code suivant crée une commande asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="968a1-675">L’exemple de code envoie un message à une file d’attente locale, puis appelle <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, en passant : une valeur de délai d’attente de dix secondes ; un entier unique qui identifie ce message particulier ; et une nouvelle instance de <xref:System.AsyncCallback> qui identifie le Gestionnaire d’événements `MyReceiveCompleted`.</span><span class="sxs-lookup"><span data-stu-id="968a1-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="968a1-676">Lorsqu’un <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché, le Gestionnaire d’événements reçoit le message et écrit le corps du message et l’entier identifiant le message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-677">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-678">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-678">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-679">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-679">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-680">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente pour qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-681">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="state">
          <span data-ttu-id="968a1-682">Objet d'état, spécifié par l'application, qui comporte les données associées à l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span>
          </span>
        </param>
        <param name="callback">
          <span data-ttu-id="968a1-683">
            <see cref="T:System.AsyncCallback" /> qui reçoit la notification de la fin de l'opération asynchrone.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-684">Lance une opération de réception asynchrone qui a un délai d'attente spécifié et utilise un curseur spécifié et un objet d'état spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span>
          </span>
          <span data-ttu-id="968a1-685">L'objet d'état fournit des informations associées pendant la durée de vie de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-685">The state object provides associated information throughout the lifetime of the operation.</span>
          </span>
          <span data-ttu-id="968a1-686">Cette surcharge reçoit, via un rappel, la notification de l'identité du gestionnaire d'événements de l'opération.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span>
          </span>
          <span data-ttu-id="968a1-687">L'opération ne se termine que lorsqu'un message est disponible dans la file ou lorsque le délai d'attente a expiré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-688">
            <see cref="T:System.IAsyncResult" /> qui identifie la requête asynchrone publiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-689">Lorsque vous utilisez cette surcharge, le rappel spécifié dans le paramètre de rappel est appelé directement lorsqu’un message est disponible dans la file d’attente ou lorsque l’intervalle de temps spécifié a expiré ; le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement n’est pas déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="968a1-690">Les autres surcharges de <xref:System.Messaging.MessageQueue.BeginReceive%2A> reposent sur ce composant pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="968a1-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> est également déclenché si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-692">Pour utiliser <xref:System.Messaging.MessageQueue.BeginReceive%2A>, créez un gestionnaire d’événements qui traite les résultats de l’opération asynchrone et associez-le à votre délégué d’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="968a1-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> lance une réception asynchrone opération ; le <xref:System.Messaging.MessageQueue> est prévenu via le déclenchement de le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement, lorsqu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="968a1-694">Le <xref:System.Messaging.MessageQueue> peut alors accéder au message en appelant <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> ou récupérer le résultat à l’aide du <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="968a1-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="968a1-695">Le <xref:System.Messaging.MessageQueue.BeginReceive%2A> méthode est retournée immédiatement, mais l’opération asynchrone n’est pas terminée tant que le Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="968a1-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="968a1-696">Étant donné que <xref:System.Messaging.MessageQueue.BeginReceive%2A> est asynchrone, vous pouvez l’appeler pour recevoir un message à partir de la file d’attente sans bloquer le thread en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="968a1-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="968a1-697">Pour recevoir un message de manière synchrone, utilisez la <xref:System.Messaging.MessageQueue.Receive%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-698">Une fois qu’une opération asynchrone se termine, vous pouvez appeler <xref:System.Messaging.MessageQueue.BeginPeek%2A> ou <xref:System.Messaging.MessageQueue.BeginReceive%2A> dans le Gestionnaire d’événements pour continuer à recevoir des notifications.</span><span class="sxs-lookup"><span data-stu-id="968a1-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="968a1-699">Le <xref:System.IAsyncResult> qui <xref:System.Messaging.MessageQueue.BeginReceive%2A> retourne identifie l’opération asynchrone lancée par la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="968a1-700">Vous pouvez utiliser cette <xref:System.IAsyncResult> tout au long de la durée de vie de l’opération, bien que vous n’utilisez généralement pas que <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> est appelée.</span><span class="sxs-lookup"><span data-stu-id="968a1-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="968a1-701">Toutefois, si vous lancez plusieurs opérations asynchrones, vous pouvez placer leurs <xref:System.IAsyncResult> valeurs dans un tableau et spécifier s’il faut attendre que toutes les opérations ou d’une opération à effectuer.</span><span class="sxs-lookup"><span data-stu-id="968a1-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="968a1-702">Dans ce cas, utilisez le <xref:System.IAsyncResult.AsyncWaitHandle%2A> propriété de la <xref:System.IAsyncResult> pour identifier l’opération terminée.</span><span class="sxs-lookup"><span data-stu-id="968a1-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="968a1-703">L’objet d’état associe des informations d’état de l’opération.</span><span class="sxs-lookup"><span data-stu-id="968a1-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="968a1-704">Par exemple, si vous appelez <xref:System.Messaging.MessageQueue.BeginReceive%2A> plusieurs fois pour initialiser plusieurs opérations, vous pouvez identifier chaque opération via un objet d’état distinct que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="968a1-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="968a1-705">Vous pouvez également utiliser l’objet d’état pour passer des informations sur les threads de processus.</span><span class="sxs-lookup"><span data-stu-id="968a1-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="968a1-706">Si un thread est démarré, mais que le rappel est sur un thread différent dans un scénario asynchrone, l’objet d’état est marshalé et passé précédent ainsi que des informations à partir de l’événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="968a1-707">N’utilisez pas l’appel asynchrone <xref:System.Messaging.MessageQueue.BeginReceive%2A> avec des transactions.</span><span class="sxs-lookup"><span data-stu-id="968a1-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="968a1-708">Si vous souhaitez effectuer une opération asynchrone transactionnelle, appelez <xref:System.Messaging.MessageQueue.BeginPeek%2A>et indiquez la transaction et (synchrone) <xref:System.Messaging.MessageQueue.Receive%2A> méthode dans le Gestionnaire d’événements que vous créez pour l’opération de lecture.</span><span class="sxs-lookup"><span data-stu-id="968a1-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="968a1-709">Votre gestionnaire d’événements peut contenir des fonctionnalités comme le montre le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="968a1-710">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-711">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-711">Workgroup mode</span></span>|<span data-ttu-id="968a1-712">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-713">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-713">Local computer</span></span>|<span data-ttu-id="968a1-714">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-714">Yes</span></span>|  
|<span data-ttu-id="968a1-715">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-715">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-716">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-716">Yes</span></span>|  
|<span data-ttu-id="968a1-717">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-717">Remote computer</span></span>|<span data-ttu-id="968a1-718">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-718">No</span></span>|  
|<span data-ttu-id="968a1-719">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-719">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-720">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-721">Le paramètre <paramref name="cursor" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-722">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-723">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-723">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-724">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-724">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-725">Obtient une valeur qui indique si <see cref="T:System.Messaging.MessageQueue" /> peut être lu.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-726">
            <see langword="true" /> si <see cref="T:System.Messaging.MessageQueue" /> existe et que l'application peut lire à partir de celui-ci, sinon <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-726">
              <see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-727"><xref:System.Messaging.MessageQueue.CanRead%2A> Indique si l’application est en mesure de lire ou de recevoir des messages de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="968a1-728">Si <xref:System.Messaging.MessageQueue.CanRead%2A> est `true`, le <xref:System.Messaging.MessageQueue> peut recevoir ou lire des messages à partir de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="968a1-729">Dans le cas contraire, il ne peut pas.</span><span class="sxs-lookup"><span data-stu-id="968a1-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="968a1-730"><xref:System.Messaging.MessageQueue.CanRead%2A> est `false` si une file d’attente est déjà ouverte avec un accès exclusif en lecture (ou si elle est ouverte avec un accès non exclusif et si ce <xref:System.Messaging.MessageQueue> demande un accès exclusif), ou si l’application ne dispose pas des droits suffisants pour y accéder.</span><span class="sxs-lookup"><span data-stu-id="968a1-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="968a1-731">Si votre application tente de lire à partir d’une file d’attente lorsque <xref:System.Messaging.MessageQueue.CanRead%2A> est `false`, l’accès est refusé.</span><span class="sxs-lookup"><span data-stu-id="968a1-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="968a1-732">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-733">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-733">Workgroup mode</span></span>|<span data-ttu-id="968a1-734">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-735">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-735">Local computer</span></span>|<span data-ttu-id="968a1-736">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-736">Yes</span></span>|  
|<span data-ttu-id="968a1-737">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-737">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-738">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-738">Yes</span></span>|  
|<span data-ttu-id="968a1-739">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-739">Remote computer</span></span>|<span data-ttu-id="968a1-740">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-740">No</span></span>|  
|<span data-ttu-id="968a1-741">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-741">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-742">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-743">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.CanRead%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-744">Obtient une valeur qui indique si <see cref="T:System.Messaging.MessageQueue" /> peut être accessible en écriture.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-745">
            <see langword="true" /> si <see cref="T:System.Messaging.MessageQueue" /> existe et que l'application peut écrire dans celui-ci ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-745">
              <see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> Indique si l’application est en mesure d’envoyer des messages à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="968a1-747">Si <xref:System.Messaging.MessageQueue.CanWrite%2A> est `true`, le <xref:System.Messaging.MessageQueue> peut envoyer des messages à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="968a1-748">Dans le cas contraire, il ne peut pas.</span><span class="sxs-lookup"><span data-stu-id="968a1-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="968a1-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> est `false` si une file d’attente est déjà ouverte avec accès en écriture exclusif (ou si elle est ouverte avec un accès non exclusif et si ce <xref:System.Messaging.MessageQueue> demande un accès exclusif), ou si l’application ne dispose pas des droits suffisants pour y accéder.</span><span class="sxs-lookup"><span data-stu-id="968a1-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="968a1-750">Si votre application tente d’écrire dans une file d’attente lorsque <xref:System.Messaging.MessageQueue.CanWrite%2A> est `false`, l’accès est refusé.</span><span class="sxs-lookup"><span data-stu-id="968a1-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="968a1-751">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-752">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-752">Workgroup mode</span></span>|<span data-ttu-id="968a1-753">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-754">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-754">Local computer</span></span>|<span data-ttu-id="968a1-755">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-755">Yes</span></span>|  
|<span data-ttu-id="968a1-756">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-756">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-757">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-757">Yes</span></span>|  
|<span data-ttu-id="968a1-758">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-758">Remote computer</span></span>|<span data-ttu-id="968a1-759">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-759">No</span></span>|  
|<span data-ttu-id="968a1-760">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-760">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-761">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-762">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.CanWrite%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-763">Obtient ou définit la catégorie de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-763">Gets or sets the queue category.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-764">
            <see cref="T:System.Guid" /> qui représente la catégorie de file d'attente (identificateur de type Message Queuing) qui permet à une application de classer par catégorie ses files d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span>
          </span>
          <span data-ttu-id="968a1-765">La valeur par défaut est <see langword="Guid.empty" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-765">The default is <see langword="Guid.empty" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-766">La catégorie de la file d’attente permet à une application classer par catégorie ses files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="968a1-767">Par exemple, vous pouvez placer toutes les files d’attente de la facturation dans une catégorie et toutes les files d’attente de commande dans un autre.</span><span class="sxs-lookup"><span data-stu-id="968a1-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="968a1-768">Le <xref:System.Messaging.MessageQueue.Category%2A> propriété fournit l’accès à la propriété ID de Type de Message Queuing (qui est en lecture/écriture), accessible via la **propriétés de la file d’attente** boîte de dialogue dans la Console de gestion d’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="968a1-769">Vous pouvez définir une nouvelle catégorie.</span><span class="sxs-lookup"><span data-stu-id="968a1-769">You can define a new category.</span></span> <span data-ttu-id="968a1-770">Bien que vous puissiez utiliser <xref:System.Guid.NewGuid%2A> pour créer une valeur de catégorie qui est unique pour tous les <xref:System.Guid> des valeurs, une telle action n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="968a1-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="968a1-771">La valeur de catégorie doit être différente uniquement à partir d’autres catégories, pas de tous les autres <xref:System.Guid> valeurs.</span><span class="sxs-lookup"><span data-stu-id="968a1-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="968a1-772">Par exemple, vous pouvez affecter {00000000-0000-0000-0000-000000000001} comme le <xref:System.Messaging.MessageQueue.Category%2A> pour un ensemble de files d’attente et {00000000-0000-0000-0000-000000000002} en tant que le <xref:System.Messaging.MessageQueue.Category%2A> d’un autre ensemble.</span><span class="sxs-lookup"><span data-stu-id="968a1-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="968a1-773">Il n’est pas nécessaire de définir la <xref:System.Messaging.MessageQueue.Category%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="968a1-774">La valeur peut être `null`.</span><span class="sxs-lookup"><span data-stu-id="968a1-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="968a1-775">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-776">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification.</span><span class="sxs-lookup"><span data-stu-id="968a1-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="968a1-777">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-778">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-778">Workgroup mode</span></span>|<span data-ttu-id="968a1-779">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-780">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-780">Local computer</span></span>|<span data-ttu-id="968a1-781">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-781">Yes</span></span>|  
|<span data-ttu-id="968a1-782">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-782">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-783">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-783">Yes</span></span>|  
|<span data-ttu-id="968a1-784">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-784">Remote computer</span></span>|<span data-ttu-id="968a1-785">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-785">No</span></span>|  
|<span data-ttu-id="968a1-786">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-786">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-787">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-788">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.Category%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-789">La catégorie de file d'attente définie est non valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-789">The queue category was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-790">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-790">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-791">Vide le cache de connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-791">Clears the connection cache.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-792">Lorsque vous appelez <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, les noms de formats stockés dans le cache sont supprimés et les handles ouverts et stockés dans le cache sont fermés.</span><span class="sxs-lookup"><span data-stu-id="968a1-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="968a1-793">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-794">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-794">Workgroup mode</span></span>|<span data-ttu-id="968a1-795">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-796">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-796">Local computer</span></span>|<span data-ttu-id="968a1-797">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-797">Yes</span></span>|  
|<span data-ttu-id="968a1-798">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-798">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-799">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-799">Yes</span></span>|  
|<span data-ttu-id="968a1-800">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-800">Remote computer</span></span>|<span data-ttu-id="968a1-801">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-801">Yes</span></span>|  
|<span data-ttu-id="968a1-802">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-802">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-803">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-804">L'exemple de code suivant appelle <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-805">Libère toutes les ressources allouées par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-806"><xref:System.Messaging.MessageQueue.Close%2A> Libère toutes les ressources associées à un <xref:System.Messaging.MessageQueue>, y compris des ressources partagées si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="968a1-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="968a1-807">Le système acquiert une nouvelle fois ces ressources automatiquement si elles sont toujours disponibles, par exemple, lorsque vous appelez le <xref:System.Messaging.MessageQueue.Send%28System.Object%29> méthode, comme dans le code c# suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="968a1-808">Lorsque vous appelez <xref:System.Messaging.MessageQueue.Close%2A>, tous les <xref:System.Messaging.MessageQueue> propriétés qui accèdent directement à la file d’attente Message Queuing sont supprimées. Le <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, et <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> tous demeurent inchangés.</span><span class="sxs-lookup"><span data-stu-id="968a1-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="968a1-809"><xref:System.Messaging.MessageQueue.Close%2A> ne pas toujours disponible en lecture handles et d’écriture à une file d’attente, car ils peuvent être partagés.</span><span class="sxs-lookup"><span data-stu-id="968a1-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="968a1-810">Vous pouvez prendre l’une des étapes suivantes pour vous assurer que <xref:System.Messaging.MessageQueue.Close%2A> libère les handles de lecture et d’écriture à une file d’attente :</span><span class="sxs-lookup"><span data-stu-id="968a1-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="968a1-811">Créer le <xref:System.Messaging.MessageQueue> avec un accès exclusif.</span><span class="sxs-lookup"><span data-stu-id="968a1-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="968a1-812">Pour ce faire, appelez le <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> ou <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> et ensemble la `sharedModeDenyReceive` paramètre `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="968a1-813">Créer le <xref:System.Messaging.MessageQueue> avec connexion mise en cache désactivée.</span><span class="sxs-lookup"><span data-stu-id="968a1-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="968a1-814">Pour ce faire, appelez le <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructeur et définissez la `enableConnectionCache` paramètre `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="968a1-815">Désactiver la mise en cache de la connexion.</span><span class="sxs-lookup"><span data-stu-id="968a1-815">Disable connection caching.</span></span> <span data-ttu-id="968a1-816">Pour ce faire, définissez la <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> propriété `false`.</span><span class="sxs-lookup"><span data-stu-id="968a1-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="968a1-817">Vous devez appeler <xref:System.Messaging.MessageQueue.Close%2A> pour une file d’attente avant de supprimer la file d’attente sur le serveur Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="968a1-818">Sinon, les messages envoyés à la file d’attente peuvent lever des exceptions ou s’affichent dans la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="968a1-819">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-820">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-820">Workgroup mode</span></span>|<span data-ttu-id="968a1-821">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-822">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-822">Local computer</span></span>|<span data-ttu-id="968a1-823">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-823">Yes</span></span>|  
|<span data-ttu-id="968a1-824">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-824">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-825">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-825">Yes</span></span>|  
|<span data-ttu-id="968a1-826">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-826">Remote computer</span></span>|<span data-ttu-id="968a1-827">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-827">Yes</span></span>|  
|<span data-ttu-id="968a1-828">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-828">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-829">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-830">L’exemple de code suivant ferme une file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-831">Crée une nouvelle file d'attente dans le chemin d'accès spécifié sur le serveur Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-831">Creates a new queue at the specified path on a Message Queuing server.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-832">Chemin de la file d'attente à créer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-832">The path of the queue to create.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-833">Crée une file d'attente Message Queuing non transactionnelle dans le chemin d'accès spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-833">Creates a non-transactional Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-834">
            <see cref="T:System.Messaging.MessageQueue" /> qui représente la nouvelle file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-835">Utilisez cette surcharge pour créer une file d’attente Message Queuing non transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="968a1-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="968a1-836">Pour créer une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe dans votre application et les lier à une file d’attente existante, utilisez le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="968a1-837">Pour créer une nouvelle file d’attente dans Message Queuing, appelez <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="968a1-838">La syntaxe de le `path` paramètre dépend du type de file d’attente il fait référence, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-839">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-839">Queue type</span></span>|<span data-ttu-id="968a1-840">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-841">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-842">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="968a1-843">Utilisez «. » pour l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-843">Use "." for the local computer.</span></span> <span data-ttu-id="968a1-844">Pour plus de syntaxe, consultez le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="968a1-845">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-846">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-846">Workgroup mode</span></span>|<span data-ttu-id="968a1-847">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-848">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-848">Local computer</span></span>|<span data-ttu-id="968a1-849">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-849">Yes</span></span>|  
|<span data-ttu-id="968a1-850">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-850">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-851">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-851">Yes</span></span>|  
|<span data-ttu-id="968a1-852">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-852">Remote computer</span></span>|<span data-ttu-id="968a1-853">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-853">No</span></span>|  
|<span data-ttu-id="968a1-854">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-854">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-855">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-856">L’exemple de code suivant crée des files d’attente publiques et privées.</span><span class="sxs-lookup"><span data-stu-id="968a1-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="968a1-857">Il envoie un message aux files d’attente sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="968a1-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-858">Le paramètre <paramref name="path" /> est <see langword="null" /> ou une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-859">Une file d'attente existe déjà au niveau du chemin spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-859">A queue already exists at the specified path.</span>
          </span>
          <span data-ttu-id="968a1-860">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-860">-or-</span>
          </span>
          <span data-ttu-id="968a1-861">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-861">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-862">Chemin de la file d'attente à créer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-862">The path of the queue to create.</span>
          </span>
        </param>
        <param name="transactional">
          <span data-ttu-id="968a1-863">
            <see langword="true" /> pour créer une file d'attente transactionnelle ; <see langword="false" /> pour créer une file d'attente non transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-863">
              <see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-864">Crée une file d'attente Message Queuing transactionnelle ou non transactionnelle dans le chemin d'accès spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-865">
            <see cref="T:System.Messaging.MessageQueue" /> qui représente la nouvelle file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-866">Vous pouvez utiliser cette surcharge pour créer une file d’attente transactionnelle dans Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="968a1-867">Vous pouvez créer une file d’attente non transactionnelle, en définissant le `transactional` paramètre `false` ou en appelant l’autre surcharge de <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="968a1-868">Pour créer une nouvelle instance de la <xref:System.Messaging.MessageQueue> classe dans votre application et les lier à une file d’attente existante, utilisez le <xref:System.Messaging.MessageQueue.%23ctor%2A> constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="968a1-869">Pour créer une nouvelle file d’attente dans Message Queuing, appelez <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="968a1-870">La syntaxe de le `path` paramètre dépend du type de file d’attente il fait référence, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-871">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-871">Queue type</span></span>|<span data-ttu-id="968a1-872">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-873">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-874">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="968a1-875">Utilisez «. » pour l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-875">Use "." for the local computer.</span></span> <span data-ttu-id="968a1-876">Pour plus de syntaxe, consultez le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="968a1-877">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-878">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-878">Workgroup mode</span></span>|<span data-ttu-id="968a1-879">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-880">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-880">Local computer</span></span>|<span data-ttu-id="968a1-881">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-881">Yes</span></span>|  
|<span data-ttu-id="968a1-882">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-882">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-883">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-883">Yes</span></span>|  
|<span data-ttu-id="968a1-884">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-884">Remote computer</span></span>|<span data-ttu-id="968a1-885">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-885">No</span></span>|  
|<span data-ttu-id="968a1-886">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-886">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-887">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-888">L’exemple de code suivant crée des files d’attente transactionnelles publiques et privées.</span><span class="sxs-lookup"><span data-stu-id="968a1-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="968a1-889">Il envoie un message aux files d’attente sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="968a1-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-890">Le paramètre <paramref name="path" /> est <see langword="null" /> ou une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-891">Une file d'attente existe déjà au niveau du chemin spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-891">A queue already exists at the specified path.</span>
          </span>
          <span data-ttu-id="968a1-892">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-892">-or-</span>
          </span>
          <span data-ttu-id="968a1-893">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-894">Crée un <see cref="T:System.Messaging.Cursor" /> pour la file d'attente de messages active.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-895">Nouveau <see cref="T:System.Messaging.Cursor" /> pour la file d'attente de messages active.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span>
          </span>
          <span data-ttu-id="968a1-896">Ce curseur est utilisé pour conserver un emplacement spécifique dans la file d'attente lors de la lecture des messages de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-897">Obtient l'heure et la date de création de la file d'attente dans Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-897">Gets the time and date that the queue was created in Message Queuing.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-898">
            <see cref="T:System.DateTime" /> qui représente la date et l'heure de création de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> fait référence à la file d’attente sur le serveur Message Queuing, pas le <xref:System.Messaging.MessageQueue> instance.</span><span class="sxs-lookup"><span data-stu-id="968a1-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="968a1-900">Si la file d’attente existe, cette propriété représente l’heure de que création de la file d’attente, ajusté à l’heure locale du serveur sur lequel se trouve la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="968a1-901">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-902">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-902">Workgroup mode</span></span>|<span data-ttu-id="968a1-903">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-904">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-904">Local computer</span></span>|<span data-ttu-id="968a1-905">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-905">Yes</span></span>|  
|<span data-ttu-id="968a1-906">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-906">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-907">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-907">Yes</span></span>|  
|<span data-ttu-id="968a1-908">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-908">Remote computer</span></span>|<span data-ttu-id="968a1-909">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-909">No</span></span>|  
|<span data-ttu-id="968a1-910">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-910">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-911">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-912">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.CreateTime%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-913">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-913">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-914">Obtient ou définit les valeurs de propriétés de message par défaut à utiliser lorsque l'application envoie des messages vers la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-915">
            <see cref="T:System.Messaging.DefaultPropertiesToSend" /> qui contient les valeurs de propriétés de message Message Queuing par défaut utilisées lorsque l'application envoie des objets autres que des instances de <see cref="T:System.Messaging.Message" /> dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-916">Lorsque vous envoyez un objet qui n’est pas de type <xref:System.Messaging.Message> à la file d’attente, le <xref:System.Messaging.MessageQueue> insère un objet dans un Message message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="968a1-917">À ce stade, le <xref:System.Messaging.MessageQueue> s’applique au message les valeurs de propriété que vous spécifiez dans le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="968a1-918">À l’inverse, si vous envoyez un <xref:System.Messaging.Message> à la file d’attente, ces propriétés sont déjà spécifiées pour l’instance de lui-même, par conséquent, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> est ignoré pour les <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="968a1-919">Bien que vous définissez les propriétés via la <xref:System.Messaging.MessageQueue> objet, le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> fait référence aux propriétés des messages qui sont envoyés à la file d’attente, pas à la file d’attente elle-même.</span><span class="sxs-lookup"><span data-stu-id="968a1-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="968a1-920">Les valeurs par défaut pour les propriétés sont affichées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-921">Property</span><span class="sxs-lookup"><span data-stu-id="968a1-921">Property</span></span>|<span data-ttu-id="968a1-922">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="968a1-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="968a1-923">Zéro (0)</span><span class="sxs-lookup"><span data-stu-id="968a1-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="968a1-924">Un tableau d’octets de longueur zéro</span><span class="sxs-lookup"><span data-stu-id="968a1-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="968a1-925">Une chaîne vide (« »)</span><span class="sxs-lookup"><span data-stu-id="968a1-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="968a1-926">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-927">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-927">Workgroup mode</span></span>|<span data-ttu-id="968a1-928">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-929">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-929">Local computer</span></span>|<span data-ttu-id="968a1-930">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-930">Yes</span></span>|  
|<span data-ttu-id="968a1-931">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-931">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-932">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-932">Yes</span></span>|  
|<span data-ttu-id="968a1-933">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-933">Remote computer</span></span>|<span data-ttu-id="968a1-934">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-934">Yes</span></span>|  
|<span data-ttu-id="968a1-935">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-935">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-936">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-937">L’exemple de code suivant utilise la priorité d’un message pour déterminer les propriétés par défaut pour l’envoi du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-938">Les propriétés par défaut de la file d'attente n'ont pas pu être définies. Une des propriétés n'est sans doute pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-939">Emplacement de la file d'attente à supprimer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-939">The location of the queue to be deleted.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-940">Supprime une file d'attente sur un serveur Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-940">Deletes a queue on a Message Queuing server.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-941">La syntaxe de le `path` paramètre varie selon le type de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="968a1-942">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-942">Queue type</span></span>|<span data-ttu-id="968a1-943">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-944">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-945">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="968a1-946">Pour plus de syntaxe, consultez le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="968a1-947">Vous pouvez également utiliser le <xref:System.Messaging.MessageQueue.FormatName%2A> ou <xref:System.Messaging.MessageQueue.Label%2A> pour décrire le chemin d’accès de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="968a1-948">Référence</span><span class="sxs-lookup"><span data-stu-id="968a1-948">Reference</span></span>|<span data-ttu-id="968a1-949">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="968a1-950">Nom du format</span><span class="sxs-lookup"><span data-stu-id="968a1-950">Format name</span></span>|<span data-ttu-id="968a1-951">FormatName : [ *nom de format* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="968a1-952">Ajouter des contrôles</span><span class="sxs-lookup"><span data-stu-id="968a1-952">Label</span></span>|<span data-ttu-id="968a1-953">Étiquette : [ *étiquette* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="968a1-954">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-955">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-955">Workgroup mode</span></span>|<span data-ttu-id="968a1-956">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-957">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-957">Local computer</span></span>|<span data-ttu-id="968a1-958">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-958">Yes</span></span>|  
|<span data-ttu-id="968a1-959">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-959">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-960">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-960">Yes</span></span>|  
|<span data-ttu-id="968a1-961">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-961">Remote computer</span></span>|<span data-ttu-id="968a1-962">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-962">No</span></span>|  
|<span data-ttu-id="968a1-963">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-963">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-964">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-965">L’exemple de code suivant supprime une file d’attente Message Queuing, si elle existe.</span><span class="sxs-lookup"><span data-stu-id="968a1-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-966">Le paramètre <paramref name="path" /> est <see langword="null" /> ou une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-967">La syntaxe du paramètre <paramref name="path" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-967">The syntax for the <paramref name="path" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="968a1-968">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-968">-or-</span>
          </span>
          <span data-ttu-id="968a1-969">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-969">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-970">Obtient ou définit une valeur qui indique si ce <see cref="T:System.Messaging.MessageQueue" /> a un droit d'accès exclusif pour la réception des messages de la file d'attente Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-971">
            <see langword="true" /> si ce <see cref="T:System.Messaging.MessageQueue" /> a des droits exclusifs pour la réception des messages de la file d'attente ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-971">
              <see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="968a1-972">La valeur par défaut est <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-972">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> Spécifie le mode partagé de la file d’attente référencée par ce <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-974">Définir <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> à `true` pour indiquer que seul ce <xref:System.Messaging.MessageQueue> doivent avoir accès à lire ou de recevoir des messages de la file d’attente avec l’objet <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="968a1-975">Si un autre <xref:System.Messaging.MessageQueue> ou une autre application est associée à la même ressource de file d’attente, cette instance ou application ne sera pas en mesure de lire ou de recevoir des messages, mais il peut toujours envoyer les.</span><span class="sxs-lookup"><span data-stu-id="968a1-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="968a1-976">Si <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> est `false`, la file d’attente est disponible pour plusieurs applications pour envoyer, lire ou recevoir des messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="968a1-977">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-978">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-978">Workgroup mode</span></span>|<span data-ttu-id="968a1-979">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-980">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-980">Local computer</span></span>|<span data-ttu-id="968a1-981">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-981">Yes</span></span>|  
|<span data-ttu-id="968a1-982">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-982">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-983">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-983">Yes</span></span>|  
|<span data-ttu-id="968a1-984">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-984">Remote computer</span></span>|<span data-ttu-id="968a1-985">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-985">Yes</span></span>|  
|<span data-ttu-id="968a1-986">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-986">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-987">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-988">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="968a1-989">
            <see langword="true" /> pour libérer les ressources managées et non managées ; <see langword="false" /> pour ne libérer que les ressources non managées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-989">
              <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-990">Libère les ressources (autres que la mémoire) utilisées par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-991">Appelez la méthode <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> une fois que vous avez terminé d'utiliser <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-992">La méthode <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> rend le <xref:System.Messaging.MessageQueue> inutilisable.</span><span class="sxs-lookup"><span data-stu-id="968a1-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="968a1-993">Après avoir appelé <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, vous devez libérer toutes les références à la <xref:System.Messaging.MessageQueue> afin que la mémoire occupée puisse être récupérée par le garbage collection.</span><span class="sxs-lookup"><span data-stu-id="968a1-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="968a1-994">Vous devez appeler <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> avant de libérer votre dernière référence à le <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-995">Dans le cas contraire, les ressources du <xref:System.Messaging.MessageQueue> est à l’aide n’est pas libérée tant que le garbage collection du <xref:System.Messaging.MessageQueue> destructeur de l’objet.</span><span class="sxs-lookup"><span data-stu-id="968a1-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-996">Obtient ou définit une valeur qui indique si l'application conservera un cache de connexions.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-997">
            <see langword="true" /> pour créer et utiliser un cache de connexions, sinon <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-997">
              <see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-998">Un cache de connexions est une liste de références à des structures qui contiennent la lecture ou d’écriture de handles aux files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="968a1-999">Lorsque <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> est `true`, le <xref:System.Messaging.MessageQueue> emprunte handles à partir du cache à chaque fois que vous appelez <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, ou <xref:System.Messaging.MessageQueue.Receive%2A>, au lieu d’ouvrir de nouveaux handles.</span><span class="sxs-lookup"><span data-stu-id="968a1-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="968a1-1000">Cela peut améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="968a1-1000">This can improve performance.</span></span> <span data-ttu-id="968a1-1001">À l’aide d’un cache de connexions isole également le <xref:System.Messaging.MessageQueue> des modifications dans la topologie du réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="968a1-1002">Si vous créez une nouvelle connexion à une file d’attente lorsque le cache de connexions est saturé, le <xref:System.Messaging.MessageQueue> remplace la moins récemment consultée structure avec la nouvelle connexion.</span><span class="sxs-lookup"><span data-stu-id="968a1-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="968a1-1003">Vous pouvez effacer le cache entièrement en appelant <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, par exemple, si vous travaillez avec des files d’attente, les noms de format ont été modifiés pour que la précédente lire et écrire des handles ne sont plus valides.</span><span class="sxs-lookup"><span data-stu-id="968a1-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="968a1-1004">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1005">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1005">Workgroup mode</span></span>|<span data-ttu-id="968a1-1006">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1007">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1007">Local computer</span></span>|<span data-ttu-id="968a1-1008">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1008">Yes</span></span>|  
|<span data-ttu-id="968a1-1009">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1009">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1010">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1010">Yes</span></span>|  
|<span data-ttu-id="968a1-1011">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1011">Remote computer</span></span>|<span data-ttu-id="968a1-1012">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1012">Yes</span></span>|  
|<span data-ttu-id="968a1-1013">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1014">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1015">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1016">Obtient ou définit une valeur qui indique si la file d'attente accepte uniquement les messages non privés (non chiffrés).</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1017">Une des valeurs de <see cref="T:System.Messaging.EncryptionRequired" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span>
          </span>
          <span data-ttu-id="968a1-1018">La valeur par défaut est <see langword="None" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1018">The default is <see langword="None" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1019">Lorsque vous spécifiez que le chiffrement est requis pour les messages envoyés à une file d’attente, les corps des messages sont chiffrés.</span><span class="sxs-lookup"><span data-stu-id="968a1-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="968a1-1020">Les autres membres (par exemple, le <xref:System.Messaging.Message.Label%2A> et <xref:System.Messaging.Message.SenderId%2A> propriétés) ne peut pas être chiffrée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="968a1-1021">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-1022">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification.</span><span class="sxs-lookup"><span data-stu-id="968a1-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="968a1-1023">Chiffrement d’un message fait un message privé.</span><span class="sxs-lookup"><span data-stu-id="968a1-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="968a1-1024">Vous pouvez spécifier d’exigence de chiffrement de la file d’attente pour être `None`, `Body`, ou `Optional` en définissant le <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> propriété correctement.</span><span class="sxs-lookup"><span data-stu-id="968a1-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="968a1-1025">Le <xref:System.Messaging.Message.UseEncryption%2A> paramètre du message doit correspondre à l’exigence de chiffrement de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="968a1-1026">Si le message n’est pas chiffré, mais la file d’attente spécifie `Body`, ou si le message est chiffré mais que la file d’attente spécifie `None`, le message est rejeté par la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="968a1-1027">Si l’application émettrice demande un message d’accusé de réception négatif dans ce cas, Message Queuing indique rejet du message à l’application émettrice.</span><span class="sxs-lookup"><span data-stu-id="968a1-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="968a1-1028">Si le <xref:System.Messaging.Message.UseDeadLetterQueue%2A> propriété est `true`, un message de chiffrement est envoyé à la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="968a1-1029">Sinon, le message est perdu.</span><span class="sxs-lookup"><span data-stu-id="968a1-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="968a1-1030">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1031">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1031">Workgroup mode</span></span>|<span data-ttu-id="968a1-1032">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1033">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1033">Local computer</span></span>|<span data-ttu-id="968a1-1034">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1034">Yes</span></span>|  
|<span data-ttu-id="968a1-1035">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1035">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1036">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1036">Yes</span></span>|  
|<span data-ttu-id="968a1-1037">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1037">Remote computer</span></span>|<span data-ttu-id="968a1-1038">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1038">No</span></span>|  
|<span data-ttu-id="968a1-1039">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1040">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1041">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1042">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1042">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="968a1-1043">
            <see cref="T:System.IAsyncResult" /> qui identifie l'opération de lecture asynchrone à terminer, et à partir de laquelle un résultat final doit être récupéré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1044">Termine l'opération de lecture asynchrone spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1044">Completes the specified asynchronous peek operation.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1045">
            <see cref="T:System.Messaging.Message" /> associé à l'opération asynchrone terminée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1046">Lorsque le <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> termine l’opération qui a été initiée par le <xref:System.Messaging.MessageQueue.BeginPeek%2A> appeler.</span><span class="sxs-lookup"><span data-stu-id="968a1-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="968a1-1047">Pour ce faire, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> lit le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="968a1-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> peut spécifier un délai d’attente, ce qui entraîne la <xref:System.Messaging.MessageQueue.PeekCompleted> événement soit déclenché si le délai d’expiration se produit avant qu’un message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="968a1-1049">Lorsqu’un dépassement de délai se produit sans un message arrive dans la file d’attente, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="968a1-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> est utilisé pour lire le message qui a provoqué le <xref:System.Messaging.MessageQueue.PeekCompleted> événement soit déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="968a1-1051">Si vous souhaitez continuer à lire des messages en mode asynchrone, vous pouvez appeler à nouveau <xref:System.Messaging.MessageQueue.BeginPeek%2A> après l’appel <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-1052">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1053">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1053">Workgroup mode</span></span>|<span data-ttu-id="968a1-1054">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1055">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1055">Local computer</span></span>|<span data-ttu-id="968a1-1056">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1056">Yes</span></span>|  
|<span data-ttu-id="968a1-1057">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1057">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1058">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1058">Yes</span></span>|  
|<span data-ttu-id="968a1-1059">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1059">Remote computer</span></span>|<span data-ttu-id="968a1-1060">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1060">No</span></span>|  
|<span data-ttu-id="968a1-1061">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1062">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1063">L’exemple de code suivant crée un gestionnaire d’événements nommé `MyPeekCompleted`, attache à la <xref:System.Messaging.MessageQueue.PeekCompleted> délégué de gestionnaire d’événements et appelle <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une opération de lecture asynchrone sur la file d’attente qui se trouve dans le chemin d’accès ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="968a1-1064">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché, l’exemple lit le message et écrit son corps à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="968a1-1065">L’exemple appelle ensuite <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une nouvelle opération de lecture asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1066">Le paramètre <paramref name="asyncResult" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1067">La syntaxe du paramètre <paramref name="asyncResult" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1068">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1068">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult">
          <span data-ttu-id="968a1-1069">
            <see cref="T:System.IAsyncResult" /> qui identifie l'opération de réception asynchrone à terminer, et à partir de laquelle un résultat final doit être récupéré.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1070">Termine l'opération de réception asynchrone spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1070">Completes the specified asynchronous receive operation.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1071">
            <see cref="T:System.Messaging.Message" /> associé à l'opération asynchrone terminée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1072">Lorsque le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> termine l’opération qui a été initiée par le <xref:System.Messaging.MessageQueue.BeginReceive%2A> appeler.</span><span class="sxs-lookup"><span data-stu-id="968a1-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="968a1-1073">Pour ce faire, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> reçoit le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="968a1-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> peut spécifier un délai d’attente, ce qui entraîne la <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement soit déclenché si le délai d’expiration se produit avant qu’un message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="968a1-1075">Lorsqu’un dépassement de délai se produit sans un message arrive dans la file d’attente, un appel ultérieur à <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> lève une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="968a1-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> permet de lire (en supprimant de la file d’attente) le message qui a provoqué le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement soit déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="968a1-1077">Si vous souhaitez continuer à recevoir des messages de façon asynchrone, vous pouvez appeler à nouveau <xref:System.Messaging.MessageQueue.BeginReceive%2A> après l’appel <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="968a1-1078">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1079">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1079">Workgroup mode</span></span>|<span data-ttu-id="968a1-1080">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1081">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1081">Local computer</span></span>|<span data-ttu-id="968a1-1082">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1082">Yes</span></span>|  
|<span data-ttu-id="968a1-1083">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1083">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1084">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1084">Yes</span></span>|  
|<span data-ttu-id="968a1-1085">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1085">Remote computer</span></span>|<span data-ttu-id="968a1-1086">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1086">No</span></span>|  
|<span data-ttu-id="968a1-1087">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1088">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1089">L’exemple de code suivant associe plusieurs demandes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="968a1-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="968a1-1090">Il suppose une file d’attente sur l’ordinateur local, appelé « myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="968a1-1091">Le `Main` fonction commence l’opération asynchrone est gérée par le `MyReceiveCompleted` routine.</span><span class="sxs-lookup"><span data-stu-id="968a1-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="968a1-1092">`MyReceiveCompleted` traite le message en cours et commence une nouvelle asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1093">Le paramètre <paramref name="asyncResult" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1094">La syntaxe du paramètre <paramref name="asyncResult" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1095">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1095">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">
          <span data-ttu-id="968a1-1096">Emplacement de la file d'attente à rechercher.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1096">The location of the queue to find.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1097">Détermine si une file d'attente Message Queuing existe dans le chemin d'accès spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1097">Determines whether a Message Queuing queue exists at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1098">
            <see langword="true" /> si une file d'attente existe dans le chemin d'accès spécifié ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1098">
              <see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1099">Le <xref:System.Messaging.MessageQueue.Exists%28System.String%29> méthode détermine si une file d’attente Message Queuing existe dans un chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="968a1-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="968a1-1100">Il n’existe aucune méthode pour déterminer l’existence d’une file d’attente avec un nom de format spécifié.</span><span class="sxs-lookup"><span data-stu-id="968a1-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="968a1-1101">Pour plus d’informations sur la syntaxe de nom de format et d’autres formes de syntaxe de chemin d’accès, consultez le <xref:System.Messaging.MessageQueue.Path%2A> propriété.)</span><span class="sxs-lookup"><span data-stu-id="968a1-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="968a1-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> est une opération coûteuse.</span><span class="sxs-lookup"><span data-stu-id="968a1-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="968a1-1103">Utilisez-la uniquement lorsqu’il est nécessaire au sein de l’application.</span><span class="sxs-lookup"><span data-stu-id="968a1-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="968a1-1104">Le <xref:System.Messaging.MessageQueue.Exists%28System.String%29> méthode ne prend pas en charge la <xref:System.Messaging.MessageQueue.FormatName%2A> préfixe.</span><span class="sxs-lookup"><span data-stu-id="968a1-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="968a1-1105">La syntaxe de le `path` paramètre varie selon le type de file d’attente, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-1106">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-1106">Queue type</span></span>|<span data-ttu-id="968a1-1107">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-1108">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="968a1-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> ne peut pas être appelée pour vérifier l’existence d’une file d’attente privée distante.</span><span class="sxs-lookup"><span data-stu-id="968a1-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="968a1-1110">Pour plus de syntaxe, consultez le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="968a1-1111">Vous pouvez également utiliser le <xref:System.Messaging.MessageQueue.Label%2A> pour décrire le chemin d’accès de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="968a1-1112">Référence</span><span class="sxs-lookup"><span data-stu-id="968a1-1112">Reference</span></span>|<span data-ttu-id="968a1-1113">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="968a1-1114">Ajouter des contrôles</span><span class="sxs-lookup"><span data-stu-id="968a1-1114">Label</span></span>|<span data-ttu-id="968a1-1115">Étiquette : [ `label` ]</span><span class="sxs-lookup"><span data-stu-id="968a1-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="968a1-1116">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1117">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1117">Workgroup mode</span></span>|<span data-ttu-id="968a1-1118">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1119">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1119">Local computer</span></span>|<span data-ttu-id="968a1-1120">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1120">Yes</span></span>|  
|<span data-ttu-id="968a1-1121">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1121">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1122">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1122">No</span></span>|  
|<span data-ttu-id="968a1-1123">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1123">Remote computer</span></span>|<span data-ttu-id="968a1-1124">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1124">No</span></span>|  
|<span data-ttu-id="968a1-1125">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1126">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1127">L’exemple de code suivant vérifie si une file d’attente Message Queuing existe, puis le supprime.</span><span class="sxs-lookup"><span data-stu-id="968a1-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1128">La syntaxe <paramref name="path" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1128">The <paramref name="path" /> syntax is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1129">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1129">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="968a1-1130">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1130">-or-</span>
          </span>
          <span data-ttu-id="968a1-1131">La méthode <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> est appelée sur une file d'attente privée distante.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1132">L'application a utilisé une syntaxe de nom de format pour vérifier l'existence de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1132">The application used format name syntax when verifying queue existence.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1133">Obtient le nom unique que Message Queuing a généré pour la file d'attente lors de sa création.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1134">Nom de la file d'attente. Il s'agit d'un nom unique sur le réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1134">The name for the queue, which is unique on the network.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1135">Le <xref:System.Messaging.MessageQueue.FormatName%2A> propriété contient le nom de format de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="968a1-1136">Message Queuing utilise le nom de format pour identifier la file d’attente pour ouvrir et comment y accéder.</span><span class="sxs-lookup"><span data-stu-id="968a1-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="968a1-1137">Contrairement à la plupart des caractéristiques de la file d’attente, le nom de format n’est pas une propriété Message Queuing de file d’attente d’application, donc vous ne pouvez pas y accéder via l’outil de gestion de Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="968a1-1138">Le nom de format est simplement un nom unique pour la file d’attente, que Message Queuing génère lorsqu’il crée la file d’attente ou que l’application génère plus tard.</span><span class="sxs-lookup"><span data-stu-id="968a1-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="968a1-1139">Si vous spécifiez un chemin d’accès à l’aide de la syntaxe du nom de chemin d’accès (tel que `myComputer\myQueue`) au lieu d’utiliser la syntaxe de nom de format lorsque vous lire ou écrivez dans la file d’attente, le contrôleur de domaine principal (qui utilise Active Directory) convertit le <xref:System.Messaging.MessageQueue.Path%2A> dans les associé<xref:System.Messaging.MessageQueue.FormatName%2A> avant d’accéder à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="968a1-1140">Si votre application fonctionne en mode hors connexion, vous devez utiliser la syntaxe de nom de format ; dans le cas contraire, le contrôleur de domaine principal ne sera pas disponible pour effectuer la conversion du chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="968a1-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="968a1-1141">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1142">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1142">Workgroup mode</span></span>|<span data-ttu-id="968a1-1143">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1144">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1144">Local computer</span></span>|<span data-ttu-id="968a1-1145">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1145">Yes</span></span>|  
|<span data-ttu-id="968a1-1146">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1146">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1147">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1147">Yes</span></span>|  
|<span data-ttu-id="968a1-1148">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1148">Remote computer</span></span>|<span data-ttu-id="968a1-1149">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1149">Yes</span></span>|  
|<span data-ttu-id="968a1-1150">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1151">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1152">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.FormatName%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1153">
            <see cref="P:System.Messaging.MessageQueue.Path" /> n’est pas défini.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span>
          </span>
          <span data-ttu-id="968a1-1154">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1154">-or-</span>
          </span>
          <span data-ttu-id="968a1-1155">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1155">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1156">Obtient ou définit le formateur utilisé pour sérialiser un objet dans le corps d'un message lu ou écrit dans la file d'attente, ou pour désérialiser l'objet à partir de celui-ci.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1157">Le <see cref="T:System.Messaging.IMessageFormatter" /> qui produit un flux à écrire dans le corps du message ou à lire à partir de celui-ci.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span>
          </span>
          <span data-ttu-id="968a1-1158">La valeur par défaut est <see cref="T:System.Messaging.XmlMessageFormatter" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1159">Le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété contient une instance d’un objet formateur qui transforme les messages lorsque votre application lit ou écrit dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="968a1-1160">Lorsque l’application envoie un message à la file d’attente, le formateur sérialise l’objet dans un flux et l’insère dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="968a1-1161">Lors de la lecture à partir d’une file d’attente, le formateur désérialise les données du message dans le <xref:System.Messaging.Message.Body%2A> propriété d’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="968a1-1162">Le <xref:System.Messaging.XmlMessageFormatter> est faiblement couplé, donc il n’est pas nécessaire d’avoir le même objet de type sur l’expéditeur et le destinataire lors de l’utilisation de ce format.</span><span class="sxs-lookup"><span data-stu-id="968a1-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="968a1-1163">Le <xref:System.Messaging.ActiveXMessageFormatter> et <xref:System.Messaging.BinaryMessageFormatter> sérialiser les données en représentation binaire.</span><span class="sxs-lookup"><span data-stu-id="968a1-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="968a1-1164">Le <xref:System.Messaging.ActiveXMessageFormatter> est utilisé lors de l’envoi ou réception de composants COM.</span><span class="sxs-lookup"><span data-stu-id="968a1-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="968a1-1165"><xref:System.Messaging.BinaryMessageFormatter> et <xref:System.Messaging.ActiveXMessageFormatter> fournissent un débit plus rapide que le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="968a1-1166">Le <xref:System.Messaging.ActiveXMessageFormatter> permet l’interopérabilité avec les applications Visual Basic 6.0 Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="968a1-1167">Lorsque votre application envoie des messages à la file d’attente, le <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> s’applique uniquement aux messages qui utilisent les propriétés de message par défaut, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="968a1-1168">Si vous envoyez un <xref:System.Messaging.Message> à la file d’attente, Message Queuing utilise le formateur défini dans le <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété à sérialiser le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="968a1-1169">Le <xref:System.Messaging.MessageQueue> classe utilisent toujours un <xref:System.Messaging.Message> pour recevoir ou lire un message à partir de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="968a1-1170">Le message est désérialisé à l’aide de la <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-1171">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1172">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1172">Workgroup mode</span></span>|<span data-ttu-id="968a1-1173">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1174">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1174">Local computer</span></span>|<span data-ttu-id="968a1-1175">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1175">Yes</span></span>|  
|<span data-ttu-id="968a1-1176">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1176">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1177">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1177">Yes</span></span>|  
|<span data-ttu-id="968a1-1178">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1178">Remote computer</span></span>|<span data-ttu-id="968a1-1179">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1179">No</span></span>|  
|<span data-ttu-id="968a1-1180">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1181">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1182">L’exemple de code suivant montre un corps de message à l’aide de la mise en forme <xref:System.Messaging.BinaryMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="968a1-1183">L’exemple de code suivant montre un corps de message à l’aide de la mise en forme <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1184">Retourne tous les messages qui figurent dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1184">Returns all the messages that are in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1185">Tableau de type <see cref="T:System.Messaging.Message" /> qui représente tous les messages de la file d'attente, dans le même ordre que celui qui est utilisé dans la file d'attente Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Retourne un instantané statique des messages figurant dans la file d’attente, non des liaisons dynamiques aux messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="968a1-1187">Par conséquent, vous ne pouvez pas utiliser le tableau pour modifier les messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="968a1-1188">Si vous souhaitez une interaction en temps réel, dynamique avec la file d’attente (par exemple, la possibilité de supprimer les messages), appelez le <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> (méthode), qui retourne une liste dynamique de messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1189">Étant donné que <xref:System.Messaging.MessageQueue.GetAllMessages%2A> retourne une copie des messages dans la file d’attente au moment où la méthode a été appelée, le tableau ne reflète pas les nouveaux messages qui arrivent dans la file d’attente ou des messages sont supprimés de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="968a1-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> récupère uniquement les propriétés ne pas filtrées par la <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="968a1-1191">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1192">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1192">Workgroup mode</span></span>|<span data-ttu-id="968a1-1193">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1194">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1194">Local computer</span></span>|<span data-ttu-id="968a1-1195">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1195">Yes</span></span>|  
|<span data-ttu-id="968a1-1196">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1196">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1197">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1197">Yes</span></span>|  
|<span data-ttu-id="968a1-1198">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1198">Remote computer</span></span>|<span data-ttu-id="968a1-1199">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1199">No</span></span>|  
|<span data-ttu-id="968a1-1200">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1201">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1202">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1203">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1203">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1204">Énumère les messages d'une file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1204">Enumerates the messages in a queue.</span>
          </span>
          <span data-ttu-id="968a1-1205">
            <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> est déconseillé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1205">
              <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span>
          </span>
          <span data-ttu-id="968a1-1206">Il est préférable d'utiliser <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1206">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1207">
            <see cref="T:System.Collections.IEnumerator" /> qui fournit une connexion dynamique aux messages de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1208">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1209">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1209">Workgroup mode</span></span>|<span data-ttu-id="968a1-1210">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1211">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1211">Local computer</span></span>|<span data-ttu-id="968a1-1212">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1212">Yes</span></span>|  
|<span data-ttu-id="968a1-1213">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1213">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1214">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1214">Yes</span></span>|  
|<span data-ttu-id="968a1-1215">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1215">Remote computer</span></span>|<span data-ttu-id="968a1-1216">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1216">No</span></span>|  
|<span data-ttu-id="968a1-1217">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1218">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1219">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="968a1-1220">Nom de l’ordinateur sur lequel se trouve la file d’attente, sans les deux barres obliques inverses initiales (\\\\).</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1221">Obtient l'identificateur de l'ordinateur sur lequel figure la file d'attente à laquelle ce <see cref="T:System.Messaging.MessageQueue" /> fait référence.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1222">
            <see cref="T:System.Guid" /> qui représente un identificateur unique pour l'ordinateur sur lequel figure la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1223">Vous pouvez utiliser l’identificateur d’un ordinateur pour deux raisons, entre autres : pour lire le journal de l’ordinateur et pour définir des certificats de sécurité.</span><span class="sxs-lookup"><span data-stu-id="968a1-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="968a1-1224">Toutefois, vous ne pouvez pas appeler <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> pour un ordinateur distant lorsque vous travaillez hors connexion, car l’application doit avoir accès au service d’annuaire sur le contrôleur de domaine.</span><span class="sxs-lookup"><span data-stu-id="968a1-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="968a1-1225">L’identificateur de l’ordinateur (ou l’identificateur de l’ordinateur) est un <xref:System.Guid> créé par Message Queuing lorsqu’un ordinateur est ajouté à l’entreprise.</span><span class="sxs-lookup"><span data-stu-id="968a1-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="968a1-1226">Message Queuing associe l’identificateur de l’ordinateur avec le `Machine` et `Journal` mots clés pour créer le nom de format du journal de l’ordinateur, dont la syntaxe `Machine=<computeridentifier>;Journal`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="968a1-1227">Le journal de l’ordinateur, également connue en tant que la file d’attente du journal, est une file d’attente système qui stocke des copies des générés par l’application des messages lorsque le <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> propriété est `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="968a1-1228">Cette syntaxe pour le journal est valide uniquement lors de la construction du nom de format pour la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="968a1-1229">La syntaxe de nom de chemin d’accès est `MachineName` \\ `Journal$`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="968a1-1230">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1231">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1231">Workgroup mode</span></span>|<span data-ttu-id="968a1-1232">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1233">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1233">Local computer</span></span>|<span data-ttu-id="968a1-1234">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1234">No</span></span>|  
|<span data-ttu-id="968a1-1235">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1235">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1236">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1236">No</span></span>|  
|<span data-ttu-id="968a1-1237">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1237">Remote computer</span></span>|<span data-ttu-id="968a1-1238">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1238">No</span></span>|  
|<span data-ttu-id="968a1-1239">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1240">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1241">L'exemple de code suivant appelle <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1242">L'identificateur de l'ordinateur n'a pas pu être récupéré. Le service d'annuaire n'est peut-être pas disponible, par exemple, si vous travaillez en mode hors connexion.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span>
          </span>
          <span data-ttu-id="968a1-1243">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1243">-or-</span>
          </span>
          <span data-ttu-id="968a1-1244">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1244">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1245">Crée un objet énumérateur pour tous les messages figurant dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1245">Creates an enumerator object for all the messages in the queue.</span>
          </span>
          <span data-ttu-id="968a1-1246">
            <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> est déconseillé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1246">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span>
          </span>
          <span data-ttu-id="968a1-1247">Il est préférable d'utiliser <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1247">
              <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1248">
            <see cref="T:System.Messaging.MessageEnumerator" /> contenant tous les messages de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> Crée une liste dynamique de tous les messages dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="968a1-1250">Vous pouvez supprimer à partir de la file d’attente le message à la position actuelle de l’énumérateur en appelant <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> pour le <xref:System.Messaging.MessageEnumerator> qui <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> retourne.</span><span class="sxs-lookup"><span data-stu-id="968a1-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="968a1-1251">Étant donné que le curseur est associé à la liste dynamique de messages dans la file d’attente, l’énumération reflète toute modification apportée aux messages dans la file d’attente, si le message est au-delà de la position actuelle du curseur.</span><span class="sxs-lookup"><span data-stu-id="968a1-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="968a1-1252">Par exemple, l’énumérateur peut accéder automatiquement à un message de priorité plus faible placé au-delà de la position du curseur en cours, mais pas un message de priorité plus élevée insérée avant cette position.</span><span class="sxs-lookup"><span data-stu-id="968a1-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="968a1-1253">Toutefois, vous pouvez réinitialiser l’énumération, ainsi placer le curseur en début de la liste, en appelant <xref:System.Messaging.MessageEnumerator.Reset%2A> pour le <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="968a1-1254">L’ordre des messages dans l’énumération reflète leur ordre dans la file d’attente, les messages de priorité plus élevée apparaissent donc avant ceux de priorité plus faible.</span><span class="sxs-lookup"><span data-stu-id="968a1-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="968a1-1255">Si vous souhaitez un instantané statique des messages dans la file d’attente plutôt qu’une connexion dynamique à ceux-ci, appelez <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="968a1-1256">Cette méthode retourne un tableau de <xref:System.Messaging.Message> objets qui représentent les messages au moment de l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="968a1-1257">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1258">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1258">Workgroup mode</span></span>|<span data-ttu-id="968a1-1259">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1260">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1260">Local computer</span></span>|<span data-ttu-id="968a1-1261">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1261">Yes</span></span>|  
|<span data-ttu-id="968a1-1262">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1262">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1263">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1263">Yes</span></span>|  
|<span data-ttu-id="968a1-1264">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1264">Remote computer</span></span>|<span data-ttu-id="968a1-1265">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1265">Yes</span></span>|  
|<span data-ttu-id="968a1-1266">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1267">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1268">L’exemple de code suivant obtient une liste dynamique de messages dans une file d’attente et compte tous les messages avec la <xref:System.Messaging.Message.Priority%2A> propriété <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1269">Crée un objet énumérateur pour tous les messages figurant dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1269">Creates an enumerator object for all the messages in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1270">
            <see cref="T:System.Messaging.MessageEnumerator" /> contenant tous les messages de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> Crée une liste dynamique de tous les messages dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="968a1-1272">Vous pouvez supprimer à partir de la file d’attente le message à la position actuelle de l’énumérateur en appelant <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> pour le <xref:System.Messaging.MessageEnumerator> qui <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> retourne.</span><span class="sxs-lookup"><span data-stu-id="968a1-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="968a1-1273">Étant donné que le curseur est associé à la liste dynamique de messages dans la file d’attente, l’énumération reflète toute modification apportée aux messages dans la file d’attente, si le message est au-delà de la position actuelle du curseur.</span><span class="sxs-lookup"><span data-stu-id="968a1-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="968a1-1274">Par exemple, l’énumérateur peut accéder automatiquement à un message de priorité plus faible placé au-delà de la position du curseur en cours, mais pas un message de priorité plus élevée insérée avant cette position.</span><span class="sxs-lookup"><span data-stu-id="968a1-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="968a1-1275">Toutefois, vous pouvez réinitialiser l’énumération, ainsi placer le curseur en début de la liste, en appelant <xref:System.Messaging.MessageEnumerator.Reset%2A> pour le <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="968a1-1276">L’ordre des messages dans l’énumération reflète leur ordre dans la file d’attente, les messages de priorité plus élevée apparaissent donc avant ceux de priorité plus faible.</span><span class="sxs-lookup"><span data-stu-id="968a1-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="968a1-1277">Si vous souhaitez un instantané statique des messages dans la file d’attente plutôt qu’une connexion dynamique à ceux-ci, appelez <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="968a1-1278">Cette méthode retourne un tableau de <xref:System.Messaging.Message> objets qui représentent les messages au moment de l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="968a1-1279">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1280">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1280">Workgroup mode</span></span>|<span data-ttu-id="968a1-1281">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1282">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1282">Local computer</span></span>|<span data-ttu-id="968a1-1283">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1283">Yes</span></span>|  
|<span data-ttu-id="968a1-1284">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1284">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1285">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1285">Yes</span></span>|  
|<span data-ttu-id="968a1-1286">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1286">Remote computer</span></span>|<span data-ttu-id="968a1-1287">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1287">Yes</span></span>|  
|<span data-ttu-id="968a1-1288">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1289">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1290">Crée un objet énumérateur pour une liste dynamique des files d'attente publiques d'un réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1291">Fournit des sémantiques de curseur avant uniquement pour l'énumération de toutes les files d'attente publiques sur le réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1292">
            <see cref="T:System.Messaging.MessageQueueEnumerator" /> qui fournit une liste dynamique de toutes les files d'attente de messages publiques sur le réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1293">Cette surcharge de <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> retourne une énumération de toutes les files d’attente publiques sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="968a1-1294">Étant donné que le curseur est associé à une liste dynamique, l’énumération reflète toute modification apportée à une liste de file d’attente pour les files d’attente supprimées ou ajoutées au-delà de la position du curseur en cours.</span><span class="sxs-lookup"><span data-stu-id="968a1-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="968a1-1295">Ajout ou la suppression de files d’attente situées avant la position du curseur en cours ne sont pas reflétées.</span><span class="sxs-lookup"><span data-stu-id="968a1-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="968a1-1296">Par exemple, l’énumérateur peut accéder automatiquement à une file d’attente ajoutée après la position du curseur, mais pas une insérée avant cette position.</span><span class="sxs-lookup"><span data-stu-id="968a1-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="968a1-1297">Toutefois, vous pouvez réinitialiser l’énumération, ainsi placer le curseur en début de la liste, en appelant <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> pour le <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="968a1-1298">Il n’existe pas de classement défini des files d’attente dans un réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="968a1-1299">Un énumérateur ne trie pas, par exemple, par ordinateur, une étiquette, état public ou privé ou tout autre critère accessible.</span><span class="sxs-lookup"><span data-stu-id="968a1-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="968a1-1300">Si vous souhaitez un instantané statique sur le réseau plutôt que sur une connexion dynamique vers les files d’attente, appelez <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> ou <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="968a1-1301">Chacune de ces deux méthodes retourne un tableau de <xref:System.Messaging.MessageQueue> objets qui représentent les files d’attente au moment de l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="968a1-1302">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1303">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1303">Workgroup mode</span></span>|<span data-ttu-id="968a1-1304">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1305">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1305">Local computer</span></span>|<span data-ttu-id="968a1-1306">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1306">No</span></span>|  
|<span data-ttu-id="968a1-1307">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1307">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1308">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1308">No</span></span>|  
|<span data-ttu-id="968a1-1309">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1309">Remote computer</span></span>|<span data-ttu-id="968a1-1310">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1310">No</span></span>|  
|<span data-ttu-id="968a1-1311">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1312">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1313">L’exemple de code suivant effectue une itération dans toutes les files d’attente de message dans le réseau et examine le chemin d’accès pour chaque file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="968a1-1314">Enfin, il affiche le nombre de files d’attente publiques sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria">
          <span data-ttu-id="968a1-1315">
            <see cref="T:System.Messaging.MessageQueueCriteria" /> qui contient les critères utilisés pour filtrer les files d'attente de messages disponibles.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1316">Fournit des sémantiques de curseur avant uniquement pour l'énumération de toutes les files d'attente publiques sur le réseau qui correspondent aux critères spécifiés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1317">
            <see cref="T:System.Messaging.MessageQueueEnumerator" /> qui fournit une liste dynamique des files d'attente de messages publiques sur le réseau qui sont conformes aux restrictions spécifiées par le paramètre <paramref name="criteria" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1318">Cette surcharge de <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> renvoie une liste de toutes les files d’attente publiques sur le réseau qui répondent aux critères définis dans l’application.</span><span class="sxs-lookup"><span data-stu-id="968a1-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="968a1-1319">Vous pouvez spécifier les critères à inclure, par exemple, la file d’attente heure de création ou de modification, nom de l’ordinateur, une étiquette, catégorie ou toute combinaison de ces.</span><span class="sxs-lookup"><span data-stu-id="968a1-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="968a1-1320">Étant donné que le curseur est associé à une liste dynamique, l’énumération reflète toute modification apportée à une file d’attente qui se produit au-delà de la position du curseur en cours.</span><span class="sxs-lookup"><span data-stu-id="968a1-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="968a1-1321">Modifications apportées à la file d’attente avant la position du curseur en cours ne sont pas reflétées.</span><span class="sxs-lookup"><span data-stu-id="968a1-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="968a1-1322">Par exemple, l’énumérateur peut accéder automatiquement à une file d’attente ajoutée après la position du curseur, mais pas une insérée avant cette position.</span><span class="sxs-lookup"><span data-stu-id="968a1-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="968a1-1323">Toutefois, vous pouvez réinitialiser l’énumération, ainsi placer le curseur en début de la liste, en appelant <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> pour le <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="968a1-1324">Il n’existe pas de classement défini des files d’attente dans un réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="968a1-1325">Un énumérateur ne trie pas, par exemple, par ordinateur, une étiquette, état public ou privé ou tout autre critère accessible.</span><span class="sxs-lookup"><span data-stu-id="968a1-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="968a1-1326">Si vous souhaitez un instantané statique sur le réseau plutôt que sur une connexion dynamique vers les files d’attente, spécifiez les critères de <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> ou appelez <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="968a1-1327">Chacune de ces deux méthodes retourne un tableau de <xref:System.Messaging.MessageQueue> objets qui représentent les files d’attente au moment de l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="968a1-1328">Appel de <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, ou <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> fournit les mêmes résultats que l’appel <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> avec les critères de filtrage de <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, et <xref:System.Messaging.MessageQueue.MachineName%2A>, respectivement.</span><span class="sxs-lookup"><span data-stu-id="968a1-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="968a1-1329">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1330">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1330">Workgroup mode</span></span>|<span data-ttu-id="968a1-1331">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1332">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1332">Local computer</span></span>|<span data-ttu-id="968a1-1333">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1333">No</span></span>|  
|<span data-ttu-id="968a1-1334">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1334">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1335">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1335">No</span></span>|  
|<span data-ttu-id="968a1-1336">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1336">Remote computer</span></span>|<span data-ttu-id="968a1-1337">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1337">No</span></span>|  
|<span data-ttu-id="968a1-1338">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1339">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1340">L’exemple de code suivant effectue une itération dans les files d’attente et affiche le chemin d’accès de chaque file d’attente qui a été créé dans le dernier jour et qui existe sur l’ordinateur « Monordinateur ».</span><span class="sxs-lookup"><span data-stu-id="968a1-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="968a1-1341">Ordinateur à partir duquel seront récupérées les files d'attente privées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1341">The computer from which to retrieve the private queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1342">Récupère toutes les files d'attente privées sur l'ordinateur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1342">Retrieves all the private queues on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1343">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> faisant référence aux files d'attente privées récupérées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> Récupère un instantané statique des files d’attente sur un ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="968a1-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="968a1-1345">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1346">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1346">Workgroup mode</span></span>|<span data-ttu-id="968a1-1347">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1348">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1348">Local computer</span></span>|<span data-ttu-id="968a1-1349">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1349">Yes</span></span>|  
|<span data-ttu-id="968a1-1350">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1350">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1351">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1351">Yes</span></span>|  
|<span data-ttu-id="968a1-1352">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1352">Remote computer</span></span>|<span data-ttu-id="968a1-1353">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1353">Yes</span></span>|  
|<span data-ttu-id="968a1-1354">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1355">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1356">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1357">Le paramètre <paramref name="machineName" /> est <see langword="null" /> ou une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1358">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1358">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1359">Récupère toutes les files d'attente publiques du réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1359">Retrieves all the public queues on the network.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1360">Récupère toutes les files d'attente publiques du réseau.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1360">Retrieves all the public queues on the network.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1361">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> faisant référence aux files d'attente publiques récupérés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1362">Utilisez cette surcharge si vous souhaitez obtenir une liste complète de toutes les files d’attente publiques sur le réseau.</span><span class="sxs-lookup"><span data-stu-id="968a1-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="968a1-1363">Si vous souhaitez limiter la liste en fonction de certains critères, tels que <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, ou de l’heure de dernière modification utilisez une autre surcharge de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="968a1-1364">(Vous pouvez également utiliser <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, ou <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span><span class="sxs-lookup"><span data-stu-id="968a1-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="968a1-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Récupère un instantané statique des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="968a1-1366">Pour interagir avec une liste dynamique de files d’attente, utilisez <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="968a1-1367">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1368">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1368">Workgroup mode</span></span>|<span data-ttu-id="968a1-1369">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1370">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1370">Local computer</span></span>|<span data-ttu-id="968a1-1371">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1371">No</span></span>|  
|<span data-ttu-id="968a1-1372">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1372">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1373">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1373">No</span></span>|  
|<span data-ttu-id="968a1-1374">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1374">Remote computer</span></span>|<span data-ttu-id="968a1-1375">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1375">No</span></span>|  
|<span data-ttu-id="968a1-1376">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1377">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1378">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1379">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1379">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria">
          <span data-ttu-id="968a1-1380">
            <see cref="T:System.Messaging.MessageQueueCriteria" /> qui contient les critères utilisés pour filtrer les files d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1381">Récupère toutes les files d'attente publiques du réseau qui correspondent aux critères spécifiés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1381">Retrieves all the public queues on the network that meet the specified criteria.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1382">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> faisant référence aux files d'attente publiques récupérés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1383">Si vous souhaitez filtrer toutes les files d’attente publiques sur le réseau par étiquette, catégorie ou nom de l’ordinateur, le <xref:System.Messaging.MessageQueue> classe contient des méthodes spécifiques qui offrent cette fonctionnalité (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, et <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectivement).</span><span class="sxs-lookup"><span data-stu-id="968a1-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="968a1-1384">Utilisez cette surcharge pour obtenir une liste de toutes les files d’attente publiques sur le réseau remplissent plus d’une de ces critères (par exemple, si vous souhaitez spécifier une étiquette et une catégorie).</span><span class="sxs-lookup"><span data-stu-id="968a1-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="968a1-1385">Vous pouvez également filtrer par critères de message autre que <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, et <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="968a1-1386">Par exemple, vous utilisez cette surcharge pour filtrer par heure de dernière modification de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="968a1-1387">Créez simplement une nouvelle instance de la <xref:System.Messaging.MessageQueueCriteria> classe, définissez les propriétés appropriées dans l’instance et passez l’instance comme le `criteria` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="968a1-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Récupère un instantané statique des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="968a1-1389">Pour interagir avec une liste dynamique de files d’attente, utilisez <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="968a1-1390">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1391">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1391">Workgroup mode</span></span>|<span data-ttu-id="968a1-1392">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1393">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1393">Local computer</span></span>|<span data-ttu-id="968a1-1394">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1394">No</span></span>|  
|<span data-ttu-id="968a1-1395">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1395">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1396">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1396">No</span></span>|  
|<span data-ttu-id="968a1-1397">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1397">Remote computer</span></span>|<span data-ttu-id="968a1-1398">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1398">No</span></span>|  
|<span data-ttu-id="968a1-1399">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1400">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1401">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1402">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1402">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category">
          <span data-ttu-id="968a1-1403">
            <see cref="T:System.Guid" /> qui regroupe le jeu de files d'attente à récupérer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1404">Récupère toutes les files d'attente publiques du réseau qui appartiennent à la catégorie spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1404">Retrieves all the public queues on the network that belong to the specified category.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1405">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> faisant référence aux files d'attente publiques récupérés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1406">Utilisez cette méthode pour filtrer les files d’attente publiques par catégorie.</span><span class="sxs-lookup"><span data-stu-id="968a1-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="968a1-1407">Le <xref:System.Messaging.MessageQueue.Category%2A> propriété fournit l’accès à la propriété Message Queuing type ID (qui est en lecture/écriture) d’une file d’attente particulière.</span><span class="sxs-lookup"><span data-stu-id="968a1-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="968a1-1408">Bien que vous puissiez utiliser <xref:System.Guid.NewGuid%2A> pour créer une valeur de catégorie qui est unique pour tous les <xref:System.Guid> valeurs, il n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="968a1-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="968a1-1409">La valeur de catégorie doit être différente uniquement à partir d’autres catégories, pas de tous les autres <xref:System.Guid> valeurs.</span><span class="sxs-lookup"><span data-stu-id="968a1-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="968a1-1410">Par exemple, vous pouvez affecter {00000000-0000-0000-0000-000000000001} comme le <xref:System.Messaging.MessageQueue.Category%2A> pour un ensemble de files d’attente et {00000000-0000-0000-0000-000000000002} en tant que le <xref:System.Messaging.MessageQueue.Category%2A> d’un autre ensemble.</span><span class="sxs-lookup"><span data-stu-id="968a1-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="968a1-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> Récupère un instantané statique des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="968a1-1412">Pour interagir avec une liste dynamique de files d’attente, utilisez <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="968a1-1413">Vous pouvez spécifier la catégorie dans le cadre de la <xref:System.Messaging.MessageQueueCriteria> vous passez à la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="968a1-1414">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1415">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1415">Workgroup mode</span></span>|<span data-ttu-id="968a1-1416">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1417">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1417">Local computer</span></span>|<span data-ttu-id="968a1-1418">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1418">No</span></span>|  
|<span data-ttu-id="968a1-1419">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1419">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1420">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1420">No</span></span>|  
|<span data-ttu-id="968a1-1421">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1421">Remote computer</span></span>|<span data-ttu-id="968a1-1422">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1422">No</span></span>|  
|<span data-ttu-id="968a1-1423">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1424">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1425">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1426">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1426">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label">
          <span data-ttu-id="968a1-1427">Étiquette qui regroupe le jeu de files d'attente à récupérer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1427">A label that groups the set of queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1428">Récupère toutes les files d'attente publiques du réseau qui sont dotées de l'étiquette spécifiée.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1428">Retrieves all the public queues on the network that carry the specified label.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1429">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> faisant référence aux files d'attente publiques récupérés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1430">Utilisez cette méthode pour filtrer les files d’attente publiques par étiquette.</span><span class="sxs-lookup"><span data-stu-id="968a1-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="968a1-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> Récupère un instantané statique des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="968a1-1432">Pour interagir avec une liste dynamique de files d’attente, utilisez <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="968a1-1433">Vous pouvez spécifier l’étiquette dans le cadre de la <xref:System.Messaging.MessageQueueCriteria> vous passez à la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="968a1-1434">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1435">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1435">Workgroup mode</span></span>|<span data-ttu-id="968a1-1436">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1437">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1437">Local computer</span></span>|<span data-ttu-id="968a1-1438">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1438">No</span></span>|  
|<span data-ttu-id="968a1-1439">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1439">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1440">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1440">No</span></span>|  
|<span data-ttu-id="968a1-1441">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1441">Remote computer</span></span>|<span data-ttu-id="968a1-1442">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1442">No</span></span>|  
|<span data-ttu-id="968a1-1443">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1444">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1445">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1446">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1446">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1447">Le paramètre <paramref name="label" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="968a1-1448">Nom de l'ordinateur contenant le jeu de files d'attente publiques à récupérer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1448">The name of the computer that contains the set of public queues to be retrieved.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1449">Récupère toutes les files d'attente publiques qui résident sur l'ordinateur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1449">Retrieves all the public queues that reside on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1450">Tableau d'objets <see cref="T:System.Messaging.MessageQueue" /> qui référencent les files d'attente publiques sur l'ordinateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1451">Utilisez cette méthode pour filtrer les files d’attente par ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="968a1-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> Récupère un instantané statique des files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="968a1-1453">Pour interagir avec une liste dynamique de files d’attente, utilisez <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="968a1-1454">Vous pouvez spécifier le nom d’ordinateur dans le cadre de la <xref:System.Messaging.MessageQueueCriteria> vous passez à la méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="968a1-1455">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1456">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1456">Workgroup mode</span></span>|<span data-ttu-id="968a1-1457">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1458">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1458">Local computer</span></span>|<span data-ttu-id="968a1-1459">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1459">No</span></span>|  
|<span data-ttu-id="968a1-1460">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1460">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1461">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1461">No</span></span>|  
|<span data-ttu-id="968a1-1462">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1462">Remote computer</span></span>|<span data-ttu-id="968a1-1463">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1463">No</span></span>|  
|<span data-ttu-id="968a1-1464">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1465">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1466">L’exemple de code suivant récupère des listes de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1467">Le paramètre <paramref name="machineName" /> possède une syntaxe incorrecte.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1468">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1468">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1469">Récupère le contexte de sécurité que MSMQ associe à l'utilisateur actuel (identité de thread) au moment de cet appel.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1470">Objet <see cref="T:System.Messaging.SecurityContext" /> qui contient le contexte de sécurité.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1471">Obtient l'identificateur unique de Message Queuing pour la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1471">Gets the unique Message Queuing identifier of the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1472">
            <see cref="P:System.Messaging.MessageQueue.Id" /> qui représente l'identificateur de message généré par l'application Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1473">Message Queuing définit le <xref:System.Messaging.MessageQueue.Id%2A> propriété lorsqu’il crée la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="968a1-1474">Cette propriété est uniquement disponible pour les files d’attente publiques.</span><span class="sxs-lookup"><span data-stu-id="968a1-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="968a1-1475">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1476">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1476">Workgroup mode</span></span>|<span data-ttu-id="968a1-1477">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1478">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1478">Local computer</span></span>|<span data-ttu-id="968a1-1479">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1479">Yes</span></span>|  
|<span data-ttu-id="968a1-1480">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1480">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1481">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1481">Yes</span></span>|  
|<span data-ttu-id="968a1-1482">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1482">Remote computer</span></span>|<span data-ttu-id="968a1-1483">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1483">No</span></span>|  
|<span data-ttu-id="968a1-1484">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1485">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1486">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.Id%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1487">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1487">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1488">Spécifie qu'il n'existe aucune restriction de taille pour la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1488">Specifies that no size restriction exists for a queue.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1489">Ce membre est fréquemment utilisé lors de la définition <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> ou <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1490">L’exemple de code suivant illustre l’utilisation de la <xref:System.Messaging.MessageQueue.InfiniteQueueSize> membre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1491">Spécifie qu'il n'existe pas de délai d'attente pour les méthodes qui lisent ou reçoivent les messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1491">Specifies that no time-out exists for methods that peek or receive messages.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1492"><xref:System.Messaging.MessageQueue> prend en charge deux types de récupération des messages : synchrone et asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="968a1-1493">Les méthodes synchrones, <xref:System.Messaging.MessageQueue.Peek%2A> et <xref:System.Messaging.MessageQueue.Receive%2A>, entraînent le thread de processus attendre un intervalle de temps spécifié pour un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1494">Si l’intervalle de temps spécifié est <xref:System.Messaging.MessageQueue.InfiniteTimeout>, le thread de processus est bloqué jusqu'à ce qu’un nouveau message est disponible.</span><span class="sxs-lookup"><span data-stu-id="968a1-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="968a1-1495">En revanche, <xref:System.Messaging.MessageQueue.BeginPeek%2A> et <xref:System.Messaging.MessageQueue.BeginReceive%2A> (les méthodes asynchrones), permettent aux tâches de l’application principale continue dans un thread séparé, jusqu'à ce qu’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1496">L’exemple de code suivant illustre l’utilisation de la <xref:System.Messaging.MessageQueue.InfiniteTimeout> membre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1497">Obtient ou définit la description de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1497">Gets or sets the queue description.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1498">Étiquette de la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1498">The label for the message queue.</span>
          </span>
          <span data-ttu-id="968a1-1499">La valeur par défaut est une chaîne vide ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1499">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1500">La longueur maximale d’une étiquette de file d’attente de message est de 124 caractères.</span><span class="sxs-lookup"><span data-stu-id="968a1-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="968a1-1501">Le <xref:System.Messaging.MessageQueue.Label%2A> propriété ne doit pas être unique dans toutes les files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="968a1-1502">Toutefois, si plusieurs files d’attente partagent le même <xref:System.Messaging.MessageQueue.Label%2A>, vous ne pouvez pas utiliser le <xref:System.Messaging.MessageQueue.Send%28System.Object%29> méthode pour diffuser un message à chacun d’eux.</span><span class="sxs-lookup"><span data-stu-id="968a1-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="968a1-1503">Si vous utilisez la syntaxe d’étiquette pour le <xref:System.Messaging.MessageQueue.Path%2A> propriété lorsque vous envoyez le message, une exception est levée si le <xref:System.Messaging.MessageQueue.Label%2A> n’est pas unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="968a1-1504">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1505">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1505">Workgroup mode</span></span>|<span data-ttu-id="968a1-1506">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1507">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1507">Local computer</span></span>|<span data-ttu-id="968a1-1508">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1508">Yes</span></span>|  
|<span data-ttu-id="968a1-1509">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1509">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1510">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1510">Yes</span></span>|  
|<span data-ttu-id="968a1-1511">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1511">Remote computer</span></span>|<span data-ttu-id="968a1-1512">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1512">No</span></span>|  
|<span data-ttu-id="968a1-1513">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1514">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1515">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.Label%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1516">La valeur de l'étiquette est non valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1516">The label was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1517">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1517">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1518">Obtient l'heure à laquelle les propriétés d'une file d'attente ont été modifiées pour la dernière fois.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1518">Gets the last time the properties of a queue were modified.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1519">
            <see cref="T:System.DateTime" /> qui indique l'heure de la dernière modification des propriétés d'une file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1520">L’heure de dernière modification comprend la création de la file d’attente et n’importe quel <xref:System.Messaging.MessageQueue> propriété qui modifie la file d’attente Message Queuing, tels que <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="968a1-1521">La valeur de la <xref:System.Messaging.MessageQueue.LastModifyTime%2A> propriété représente l’heure système de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="968a1-1522">Vous devez appeler <xref:System.Messaging.MessageQueue.Refresh%2A> avant d’obtenir le <xref:System.Messaging.MessageQueue.LastModifyTime%2A> propriété ; sinon, l’heure de modification associé à cet <xref:System.Messaging.MessageQueue> peut ne pas être en cours.</span><span class="sxs-lookup"><span data-stu-id="968a1-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="968a1-1523">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1524">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1524">Workgroup mode</span></span>|<span data-ttu-id="968a1-1525">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1526">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1526">Local computer</span></span>|<span data-ttu-id="968a1-1527">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1527">Yes</span></span>|  
|<span data-ttu-id="968a1-1528">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1528">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1529">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1529">Yes</span></span>|  
|<span data-ttu-id="968a1-1530">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1530">Remote computer</span></span>|<span data-ttu-id="968a1-1531">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1531">No</span></span>|  
|<span data-ttu-id="968a1-1532">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1533">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1534">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.LastModifyTime%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1535">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1535">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1536">Obtient ou définit le nom de l'ordinateur où se trouve la file d'attente Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1537">Nom de l'ordinateur où se trouve la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1537">The name of the computer where the queue is located.</span>
          </span>
          <span data-ttu-id="968a1-1538">La valeur par défaut de Message Queuing est ".", ce qui correspond à l'ordinateur local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1538">The Message Queuing default is ".", the local computer.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1539">Le <xref:System.Messaging.MessageQueue.MachineName%2A> est un composant intégral de la syntaxe de nom convivial de la file d’attente <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="968a1-1540">Le tableau suivant montre la syntaxe à utiliser pour une file d’attente d’un type spécifié lorsque vous souhaitez identifier le chemin d’accès de la file d’attente à l’aide de son nom convivial.</span><span class="sxs-lookup"><span data-stu-id="968a1-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="968a1-1541">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-1541">Queue type</span></span>|<span data-ttu-id="968a1-1542">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-1543">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-1544">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="968a1-1545">File d’attente du journal</span><span class="sxs-lookup"><span data-stu-id="968a1-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="968a1-1546">File d’attente du journal machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="968a1-1547">File d’attente de lettres mortes machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="968a1-1548">File d’attente de lettres mortes transactionnelle machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="968a1-1549">Utilisez «. » pour l’ordinateur local lorsque vous spécifiez la <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="968a1-1550">Le nom d’ordinateur est reconnu pour cette propriété, par exemple, `Server0`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="968a1-1551">Le <xref:System.Messaging.MessageQueue.MachineName%2A> propriété ne prend pas en charge le format d’adresse IP.</span><span class="sxs-lookup"><span data-stu-id="968a1-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="968a1-1552">Si vous définissez la <xref:System.Messaging.MessageQueue.Path%2A> en termes de la <xref:System.Messaging.MessageQueue.MachineName%2A>, l’application lève une exception lorsque vous travaillez en mode hors connexion, car le contrôleur de domaine est requis pour convertir le chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="968a1-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="968a1-1553">Par conséquent, vous devez utiliser le <xref:System.Messaging.MessageQueue.FormatName%2A> pour la <xref:System.Messaging.MessageQueue.Path%2A> syntaxe lorsque vous travaillez en mode hors connexion.</span><span class="sxs-lookup"><span data-stu-id="968a1-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="968a1-1554">Le <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, et <xref:System.Messaging.MessageQueue.QueueName%2A> propriétés sont liées.</span><span class="sxs-lookup"><span data-stu-id="968a1-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="968a1-1555">Modification de la <xref:System.Messaging.MessageQueue.MachineName%2A> propriété entraîne la <xref:System.Messaging.MessageQueue.Path%2A> propriété à modifier.</span><span class="sxs-lookup"><span data-stu-id="968a1-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="968a1-1556">Il est construit à partir de la nouvelle <xref:System.Messaging.MessageQueue.MachineName%2A> et <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="968a1-1557">Modification de la <xref:System.Messaging.MessageQueue.Path%2A> (par exemple, la syntaxe de nom de format) réinitialise la <xref:System.Messaging.MessageQueue.MachineName%2A> et <xref:System.Messaging.MessageQueue.QueueName%2A> propriétés pour faire référence à la nouvelle file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="968a1-1558">Si le <xref:System.Messaging.MessageQueue.QueueName%2A> propriété est vide, le <xref:System.Messaging.MessageQueue.Path%2A> est définie sur la file d’attente du Journal de l’ordinateur que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="968a1-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="968a1-1559">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1560">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1560">Workgroup mode</span></span>|<span data-ttu-id="968a1-1561">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1562">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1562">Local computer</span></span>|<span data-ttu-id="968a1-1563">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1563">Yes</span></span>|  
|<span data-ttu-id="968a1-1564">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1564">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1565">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1565">Yes</span></span>|  
|<span data-ttu-id="968a1-1566">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1566">Remote computer</span></span>|<span data-ttu-id="968a1-1567">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1567">Yes</span></span>|  
|<span data-ttu-id="968a1-1568">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1569">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1570">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.MachineName%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1571">Nom de l'ordinateur n'est pas valide. La syntaxe utilisée est sans doute incorrecte.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1571">The name of the computer is not valid, possibly because the syntax is incorrect.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1572">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1572">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1573">Obtient ou définit la taille maximale du journal de file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1573">Gets or sets the maximum size of the journal queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1574">Taille maximale du journal de file d'attente, en kilo-octets.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1574">The maximum size, in kilobytes, of the journal queue.</span>
          </span>
          <span data-ttu-id="968a1-1575">La valeur par défaut Message Queuing spécifie qu'il n'existe aucune limite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1575">The Message Queuing default specifies that no limit exists.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> fournit l’accès aux limites de stockage du journal de Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="968a1-1577">Il est pertinente uniquement lorsque <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> est `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1577">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="968a1-1578">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1578">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-1579">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification</span><span class="sxs-lookup"><span data-stu-id="968a1-1579">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="968a1-1580">Si vous stockez des messages dans un journal ou d’une file d’attente de lettres mortes, vous devez effacer régulièrement la file d’attente pour supprimer les messages qui ne sont plus nécessaires.</span><span class="sxs-lookup"><span data-stu-id="968a1-1580">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="968a1-1581">Nombre de messages dans une file d’attente vers le quota pour l’ordinateur sur lequel se trouve la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1581">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="968a1-1582">(L’administrateur définit le quota de l’ordinateur.)</span><span class="sxs-lookup"><span data-stu-id="968a1-1582">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="968a1-1583">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1583">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1584">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1584">Workgroup mode</span></span>|<span data-ttu-id="968a1-1585">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1585">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1586">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1586">Local computer</span></span>|<span data-ttu-id="968a1-1587">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1587">Yes</span></span>|  
|<span data-ttu-id="968a1-1588">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1588">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1589">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1589">Yes</span></span>|  
|<span data-ttu-id="968a1-1590">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1590">Remote computer</span></span>|<span data-ttu-id="968a1-1591">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1591">No</span></span>|  
|<span data-ttu-id="968a1-1592">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1592">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1593">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1593">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1594">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1594">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1595">La valeur de la taille maximale du journal de file d'attente est non valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1595">The maximum journal queue size was set to an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1596">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1596">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1597">Obtient ou définit la taille maximale de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1597">Gets or sets the maximum size of the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1598">Taille maximale de la file d'attente, en kilo-octets.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1598">The maximum size, in kilobytes, of the queue.</span>
          </span>
          <span data-ttu-id="968a1-1599">La valeur par défaut Message Queuing spécifie qu'il n'existe aucune limite.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1599">The Message Queuing default specifies that no limit exists.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1600">Le <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> fournit l’accès pour la Message Queuing limite de stockage, qui est distincte de quota de messages de l’ordinateur que l’administrateur définit.</span><span class="sxs-lookup"><span data-stu-id="968a1-1600">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="968a1-1601">Pour plus d’informations sur le quota de messages, consultez <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1601">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="968a1-1602">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-1602">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-1603">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification</span><span class="sxs-lookup"><span data-stu-id="968a1-1603">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="968a1-1604">Si une tentative est faite pour dépasser la taille maximale de file d’attente ou le quota de l’ordinateur, les messages peuvent être perdues.</span><span class="sxs-lookup"><span data-stu-id="968a1-1604">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="968a1-1605">Lorsque le quota de file d’attente est atteint, Message Queuing avertit la file d’attente d’administration de l’application émettrice pour indiquer que la file d’attente est pleine, en retournant un message d’accusé de réception négatif.</span><span class="sxs-lookup"><span data-stu-id="968a1-1605">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="968a1-1606">Message Queuing continue à envoyer des accusés de réception négatifs jusqu'à ce que la limite inférieure à la taille totale des messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1606">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="968a1-1607">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1607">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1608">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1608">Workgroup mode</span></span>|<span data-ttu-id="968a1-1609">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1609">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1610">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1610">Local computer</span></span>|<span data-ttu-id="968a1-1611">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1611">Yes</span></span>|  
|<span data-ttu-id="968a1-1612">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1612">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1613">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1613">Yes</span></span>|  
|<span data-ttu-id="968a1-1614">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1614">Remote computer</span></span>|<span data-ttu-id="968a1-1615">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1615">No</span></span>|  
|<span data-ttu-id="968a1-1616">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1616">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1617">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1617">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1618">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1618">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1619">La taille maximale de la file d'attente contient une valeur négative.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1619">The maximum queue size contains a negative value.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1620">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1620">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1621">Obtient ou définit le filtre appliqué aux propriétés lors de la réception ou de la lecture de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1621">Gets or sets the property filter for receiving or peeking messages.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1622">
            <see cref="T:System.Messaging.MessagePropertyFilter" /> utilisé par la file d'attente pour filtrer les propriétés reçues ou lues pour chaque message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1622">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1623">Ce filtre est un ensemble de valeurs booléennes en limitant les propriétés de message qui le <xref:System.Messaging.MessageQueue> reçoit ou lit.</span><span class="sxs-lookup"><span data-stu-id="968a1-1623">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="968a1-1624">Lorsque le <xref:System.Messaging.MessageQueue> reçoit ou lit un message à partir de la file d’attente du serveur, il récupère uniquement les propriétés pour lesquelles la <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> valeur est `true`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1624">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="968a1-1625">L’exemple suivant montre les valeurs initiales des propriétés pour le <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1625">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="968a1-1626">Ces paramètres sont identiques à l’appel <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> sur un <xref:System.Messaging.MessagePropertyFilter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1626">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="968a1-1627">Property</span><span class="sxs-lookup"><span data-stu-id="968a1-1627">Property</span></span>|<span data-ttu-id="968a1-1628">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="968a1-1628">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="968a1-1629">1 024 octets</span><span class="sxs-lookup"><span data-stu-id="968a1-1629">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="968a1-1630">255 octets</span><span class="sxs-lookup"><span data-stu-id="968a1-1630">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="968a1-1631">255 octets</span><span class="sxs-lookup"><span data-stu-id="968a1-1631">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="968a1-1632">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1632">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1633">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1633">Workgroup mode</span></span>|<span data-ttu-id="968a1-1634">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1634">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1635">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1635">Local computer</span></span>|<span data-ttu-id="968a1-1636">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1636">Yes</span></span>|  
|<span data-ttu-id="968a1-1637">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1637">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1638">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1638">Yes</span></span>|  
|<span data-ttu-id="968a1-1639">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1639">Remote computer</span></span>|<span data-ttu-id="968a1-1640">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1640">Yes</span></span>|  
|<span data-ttu-id="968a1-1641">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1641">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1642">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1642">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1643">Le code suivant exemple utilise le <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> pour limiter les propriétés du message reçues.</span><span class="sxs-lookup"><span data-stu-id="968a1-1643">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1644">Le filtre est <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1644">The filter is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1645">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1645">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-1646">Obtient ou définit l'adresse multicast associée à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1646">Gets or sets the multicast address associated with the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1647">
            <see cref="T:System.String" /> qui contient une adresse multicast valide (au format présenté ci-dessous) ou <see langword="null" />, indiquant que la file d'attente n'est pas associée à une adresse multicast.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1647">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span>
          </span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1648">Le <xref:System.Messaging.MessageQueue.MulticastAddress%2A> propriété est utilisée pour associer une file d’attente non transactionnelle à une adresse de multidiffusion qui peut être utilisée lors de l’envoi de messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-1648">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="968a1-1649">Vous ne pouvez pas associer une file d’attente transactionnelle en une adresse de multidiffusion.</span><span class="sxs-lookup"><span data-stu-id="968a1-1649">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="968a1-1650">Lorsque l’application émettrice envoie des messages à une adresse de multidiffusion, Message Queuing envoie une copie du message à chaque file d’attente associée à cette adresse.</span><span class="sxs-lookup"><span data-stu-id="968a1-1650">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="968a1-1651">Multidiffusion IP adresses doivent être dans la plage de la classe D comprise entre 224.0.0.0 et 239.255.255.255, ce qui correspond au paramètre de valeur égale à 1110 les quatre premiers bits de poids fort.</span><span class="sxs-lookup"><span data-stu-id="968a1-1651">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="968a1-1652">Toutefois, seules certaines plages d’adresses de cette plage sont non réservées et disponibles pour l’envoi de messages de multidiffusion.</span><span class="sxs-lookup"><span data-stu-id="968a1-1652">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="968a1-1653">Pour connaître la liste des adresses de multidiffusion réservées, consultez la [nombre autorité IANA (Internet Assigned) des adresses de multidiffusion Internet](http://go.microsoft.com/fwlink/?linkid=3859) page Web.</span><span class="sxs-lookup"><span data-stu-id="968a1-1653">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](http://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="968a1-1654">Il n’existe aucune restriction sur le numéro de port.</span><span class="sxs-lookup"><span data-stu-id="968a1-1654">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="968a1-1655">Si plusieurs ordinateurs sources envoient des messages de multidiffusion et que vous souhaitez recevoir des messages à partir d’un seul ordinateur source une file d’attente spécifique, chaque ordinateur source doit envoyer des messages à une combinaison différente de l’adresse IP et port numéro.</span><span class="sxs-lookup"><span data-stu-id="968a1-1655">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="968a1-1656">Pour dissocier une file d’attente à partir d’une adresse de multidiffusion, définissez le <xref:System.Messaging.MessageQueue.MulticastAddress%2A> propriété dans une chaîne de longueur nulle.</span><span class="sxs-lookup"><span data-stu-id="968a1-1656">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="968a1-1657">Ne la définissez pas sur `null`, tel qu’il en résulte un <xref:System.ArgumentNullException>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1657">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="968a1-1658">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1658">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1659">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1659">Workgroup mode</span></span>|<span data-ttu-id="968a1-1660">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1660">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1661">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1661">Local computer</span></span>|<span data-ttu-id="968a1-1662">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1662">Yes</span></span>|  
|<span data-ttu-id="968a1-1663">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1663">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1664">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1664">Yes</span></span>|  
|<span data-ttu-id="968a1-1665">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1665">Remote computer</span></span>|<span data-ttu-id="968a1-1666">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1666">No</span></span>|  
|<span data-ttu-id="968a1-1667">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1667">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1668">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1668">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-1669">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1669">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1670">Obtient ou définit le chemin d'accès de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1670">Gets or sets the queue's path.</span>
          </span>
          <span data-ttu-id="968a1-1671">Le paramétrage de <see cref="P:System.Messaging.MessageQueue.Path" /> force <see cref="T:System.Messaging.MessageQueue" /> à pointer vers une nouvelle file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1671">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-1672">File d'attente référencée par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1672">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-1673">La valeur par défaut varie en fonction du constructeur <see cref="M:System.Messaging.MessageQueue.#ctor" /> utilisé. Elle est égale à <see langword="null" /> ou elle est spécifiée par le paramètre <paramref name="path" /> du constructeur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1673">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1674">La syntaxe pour le <xref:System.Messaging.MessageQueue.Path%2A> propriété dépend du type de file d’attente il points à, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-1674">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-1675">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-1675">Queue type</span></span>|<span data-ttu-id="968a1-1676">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-1676">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-1677">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-1677">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-1678">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-1678">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="968a1-1679">File d’attente du journal</span><span class="sxs-lookup"><span data-stu-id="968a1-1679">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="968a1-1680">File d’attente du journal machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1680">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="968a1-1681">File d’attente de lettres mortes machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1681">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="968a1-1682">File d’attente de lettres mortes transactionnelle machine</span><span class="sxs-lookup"><span data-stu-id="968a1-1682">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="968a1-1683">Utilisez «. » pour représenter l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-1683">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="968a1-1684">Le <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, et <xref:System.Messaging.MessageQueue.QueueName%2A> propriétés sont liées.</span><span class="sxs-lookup"><span data-stu-id="968a1-1684">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="968a1-1685">Modification de la <xref:System.Messaging.MessageQueue.MachineName%2A> propriété entraîne la <xref:System.Messaging.MessageQueue.Path%2A> propriété à modifier.</span><span class="sxs-lookup"><span data-stu-id="968a1-1685">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="968a1-1686">Il est construit à partir de la nouvelle <xref:System.Messaging.MessageQueue.MachineName%2A> et <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1686">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="968a1-1687">Modification de la <xref:System.Messaging.MessageQueue.Path%2A> (par exemple, la syntaxe de nom de format) réinitialise la <xref:System.Messaging.MessageQueue.MachineName%2A> et <xref:System.Messaging.MessageQueue.QueueName%2A> propriétés pour faire référence à la nouvelle file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1687">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="968a1-1688">Vous pouvez également utiliser le <xref:System.Messaging.MessageQueue.FormatName%2A> ou <xref:System.Messaging.MessageQueue.Label%2A> pour décrire le chemin d’accès de la file d’attente, comme illustré dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-1688">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-1689">Référence</span><span class="sxs-lookup"><span data-stu-id="968a1-1689">Reference</span></span>|<span data-ttu-id="968a1-1690">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-1690">Syntax</span></span>|<span data-ttu-id="968a1-1691">Exemple</span><span class="sxs-lookup"><span data-stu-id="968a1-1691">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="968a1-1692">Nom du format</span><span class="sxs-lookup"><span data-stu-id="968a1-1692">Format name</span></span>|<span data-ttu-id="968a1-1693">`FormatName:` [ *nom de format* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-1693">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="968a1-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="968a1-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="968a1-1695">Ajouter des contrôles</span><span class="sxs-lookup"><span data-stu-id="968a1-1695">Label</span></span>|<span data-ttu-id="968a1-1696">`Label:` [ *étiquette* ]</span><span class="sxs-lookup"><span data-stu-id="968a1-1696">`Label:` [ *label* ]</span></span>|<span data-ttu-id="968a1-1697">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="968a1-1697">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="968a1-1698">Si vous utilisez la syntaxe d’étiquette pour le <xref:System.Messaging.MessageQueue.Path%2A> propriété lorsque vous envoyez le message, une exception est levée si le <xref:System.Messaging.MessageQueue.Label%2A> n’est pas unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-1698">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="968a1-1699">Pour travailler hors connexion, vous devez utiliser la syntaxe de nom de format, plutôt que la syntaxe du nom convivial de la première table.</span><span class="sxs-lookup"><span data-stu-id="968a1-1699">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="968a1-1700">Sinon, une exception est levée, car le contrôleur de domaine principal (sur lequel Active Directory réside) n’est pas disponible pour résoudre le chemin d’accès au nom de format.</span><span class="sxs-lookup"><span data-stu-id="968a1-1700">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="968a1-1701">Définir un nouveau chemin d’accès ferme la file d’attente et libère tous les handles.</span><span class="sxs-lookup"><span data-stu-id="968a1-1701">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="968a1-1702">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1702">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1703">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1703">Workgroup mode</span></span>|<span data-ttu-id="968a1-1704">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1704">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1705">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1705">Local computer</span></span>|<span data-ttu-id="968a1-1706">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1706">Yes</span></span>|  
|<span data-ttu-id="968a1-1707">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1707">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1708">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1708">Yes</span></span>|  
|<span data-ttu-id="968a1-1709">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1709">Remote computer</span></span>|<span data-ttu-id="968a1-1710">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1710">Yes</span></span>|  
|<span data-ttu-id="968a1-1711">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1711">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1712">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1712">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="968a1-1713">En mode de groupe de travail, vous pouvez uniquement utiliser les files d’attente privées.</span><span class="sxs-lookup"><span data-stu-id="968a1-1713">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="968a1-1714">Vous spécifiez le chemin d’accès à l’aide de la syntaxe de la file d’attente privée `MachineName` \\ `Private$` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="968a1-1714">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1715">L’exemple de code suivant crée de nouveaux <xref:System.Messaging.MessageQueue> objets à l’aide de divers types de syntaxes de nom de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="968a1-1715">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="968a1-1716">Dans chaque cas, il envoie un message à la file d’attente dont le chemin est défini dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-1716">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1717">Le chemin d'accès n'est pas valide. La syntaxe utilisée est sans doute incorrecte.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1717">The path is not valid, possibly because the syntax is not valid.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="968a1-1718">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1718">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="968a1-1719">Retourne une copie du premier message dans la file d'attente, sans supprimer le message de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1719">Returns a copy of the first message in the queue without removing the message from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1720">Retourne (lit) le premier message figurant dans la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" /> sans le supprimer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1720">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-1721">La méthode <see cref="M:System.Messaging.MessageQueue.Peek" /> étant synchrone, elle bloque le thread en cours jusqu'à ce qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1721">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1722">
            <see cref="T:System.Messaging.Message" /> représentant le premier message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1722">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1723">Utilisez cette surcharge pour lire une file d’attente ou attendre qu’un message existe dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1723">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1724">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode lit, mais ne supprime pas le premier message de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1724">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="968a1-1725">Par conséquent, les appels répétés à <xref:System.Messaging.MessageQueue.Peek%2A> retournent le même message, à moins qu’un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1725">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-1726">Le <xref:System.Messaging.MessageQueue.Receive%2A> (méthode), en revanche, lit et supprime le premier message de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1726">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="968a1-1727">Les appels répétés à <xref:System.Messaging.MessageQueue.Receive%2A>, par conséquent, renvoyer différents messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-1727">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="968a1-1728">Message Queuing classe les messages dans la file d’attente en fonction du temps de priorité et d’arrivée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1728">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="968a1-1729">Un nouveau message est placé avant un ancien uniquement s’il s’agit d’une priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1729">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="968a1-1730">Utilisez <xref:System.Messaging.MessageQueue.Peek%2A> lorsque le thread en cours peut faire l'objet d'un blocage en attendant l'arrivée d'un message dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1730">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1731">Étant donné que cette surcharge ne spécifie pas un délai d’attente, l’application risque d’attendre indéfiniment.</span><span class="sxs-lookup"><span data-stu-id="968a1-1731">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="968a1-1732">Si vous souhaitez que le traitement de l'application se poursuive sans attendre, utilisez la méthode <xref:System.Messaging.MessageQueue.BeginPeek%2A> asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-1732">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="968a1-1733">Vous pouvez également spécifier un délai d’expiration pour un message arrive dans la file d’attente à l’aide de la surcharge de <xref:System.Messaging.MessageQueue.Peek%2A> qui spécifie un délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1733">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="968a1-1734">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1734">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1735">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1735">Workgroup mode</span></span>|<span data-ttu-id="968a1-1736">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1736">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1737">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1737">Local computer</span></span>|<span data-ttu-id="968a1-1738">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1738">Yes</span></span>|  
|<span data-ttu-id="968a1-1739">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1739">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1740">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1740">Yes</span></span>|  
|<span data-ttu-id="968a1-1741">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1741">Remote computer</span></span>|<span data-ttu-id="968a1-1742">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1742">No</span></span>|  
|<span data-ttu-id="968a1-1743">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1743">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1744">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1744">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1745">Les exemples suivants utilisent la <xref:System.Messaging.MessageQueue.Peek%2A> méthode sur une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1745">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="968a1-1746">Dans le premier exemple, l’application attend un message est disponible dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1746">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="968a1-1747">Notez que le premier exemple n’accède pas au message qui arrive ; Il se contente de suspendre le traitement jusqu'à ce qu’un message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-1747">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="968a1-1748">Si un message existe déjà dans la file d’attente, elle est retournée immédiatement.</span><span class="sxs-lookup"><span data-stu-id="968a1-1748">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="968a1-1749">Dans le deuxième exemple, un message qui contient un définies par l’application `Order` classe est envoyé à la file d’attente, puis lu à partir de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1749">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1750">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1750">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-1751">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1751">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-1752">
            <see cref="T:System.TimeSpan" /> qui indique le délai maximal à attendre pour l'arrivée d'un message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1752">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1753">Retourne (lit) le premier message figurant dans la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" /> sans le supprimer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1753">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-1754">La méthode <see cref="M:System.Messaging.MessageQueue.Peek" /> étant synchrone, elle bloque le thread en cours jusqu'à ce qu'un message soit disponible ou que le délai spécifié expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1754">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1755">
            <see cref="T:System.Messaging.Message" /> représentant le premier message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1755">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1756">Utilisez cette surcharge pour lire une file d’attente ou pour attendre un certain temps, jusqu'à ce qu’un message existe dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1756">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="968a1-1757">La méthode retourne immédiatement si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1757">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1758">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode lit, mais ne supprime pas le premier message de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1758">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="968a1-1759">Par conséquent, les appels répétés à <xref:System.Messaging.MessageQueue.Peek%2A> retournent le même message, à moins qu’un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1759">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-1760">Le <xref:System.Messaging.MessageQueue.Receive%2A> (méthode), en revanche, lit et supprime le premier message de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1760">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="968a1-1761">Les appels répétés à <xref:System.Messaging.MessageQueue.Receive%2A>, par conséquent, renvoyer différents messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-1761">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="968a1-1762">Message Queuing classe les messages dans la file d’attente en fonction du temps de priorité et d’arrivée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1762">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="968a1-1763">Un nouveau message est placé avant un ancien uniquement s’il s’agit d’une priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1763">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="968a1-1764">Utilisez <xref:System.Messaging.MessageQueue.Peek%2A> lorsque le thread en cours peut faire l'objet d'un blocage en attendant l'arrivée d'un message dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1764">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1765">Le thread reste bloqué durant la période spécifiée, ou indéfiniment si vous avez indiqué <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1765">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="968a1-1766">Si vous souhaitez que le traitement de l'application se poursuive sans attendre, utilisez la méthode <xref:System.Messaging.MessageQueue.BeginPeek%2A> asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-1766">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-1767">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1767">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1768">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1768">Workgroup mode</span></span>|<span data-ttu-id="968a1-1769">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1769">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1770">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1770">Local computer</span></span>|<span data-ttu-id="968a1-1771">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1771">Yes</span></span>|  
|<span data-ttu-id="968a1-1772">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1772">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1773">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1773">Yes</span></span>|  
|<span data-ttu-id="968a1-1774">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1774">Remote computer</span></span>|<span data-ttu-id="968a1-1775">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1775">No</span></span>|  
|<span data-ttu-id="968a1-1776">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1776">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1777">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1777">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1778">Le code suivant exemple utilise le <xref:System.Messaging.MessageQueue.Peek%2A> méthode avec un délai d’attente de zéro pour vérifier si la file d’attente est vide.</span><span class="sxs-lookup"><span data-stu-id="968a1-1778">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1779">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1779">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1780">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1780">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-1781">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1781">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-1782">
            <see cref="T:System.TimeSpan" /> qui indique le délai maximal à attendre pour l'arrivée d'un message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1782">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-1783">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1783">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="action">
          <span data-ttu-id="968a1-1784">Une des valeurs de <see cref="T:System.Messaging.PeekAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1784">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span>
          </span>
          <span data-ttu-id="968a1-1785">Indique s'il faut lire le message en cours dans la file d'attente ou le message suivant.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1785">Indicates whether to peek at the current message in the queue, or the next message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1786">Retourne (lit) le message actuel ou le message suivant de la file d'attente sans le supprimer, à l'aide du curseur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1786">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span>
          </span>
          <span data-ttu-id="968a1-1787">La méthode <see cref="M:System.Messaging.MessageQueue.Peek" /> étant synchrone, elle bloque le thread en cours jusqu'à ce qu'un message soit disponible ou que le délai spécifié expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1787">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1788">
            <see cref="T:System.Messaging.Message" /> qui représente un message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1788">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1789">Utilisez cette surcharge pour lire une file d’attente ou pour attendre un certain temps, jusqu'à ce qu’un message existe dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1789">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="968a1-1790">La méthode retourne immédiatement si un message existe déjà dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1790">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1791">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode lit, mais ne supprime pas un message à partir de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1791">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="968a1-1792">Le <xref:System.Messaging.MessageQueue.Receive%2A> (méthode), en revanche, lit et supprime un message de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1792">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="968a1-1793">Utilisez <xref:System.Messaging.MessageQueue.Peek%2A> lorsque le thread en cours peut faire l'objet d'un blocage en attendant l'arrivée d'un message dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1793">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1794">Le thread reste bloqué durant l’intervalle spécifié, ou indéfiniment si vous avez indiqué <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1794">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="968a1-1795">Si vous souhaitez que le traitement de l'application se poursuive sans attendre, utilisez la méthode <xref:System.Messaging.MessageQueue.BeginPeek%2A> asynchrone.</span><span class="sxs-lookup"><span data-stu-id="968a1-1795">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-1796">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1796">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1797">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1797">Workgroup mode</span></span>|<span data-ttu-id="968a1-1798">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1798">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1799">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1799">Local computer</span></span>|<span data-ttu-id="968a1-1800">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1800">Yes</span></span>|  
|<span data-ttu-id="968a1-1801">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1801">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1802">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1802">Yes</span></span>|  
|<span data-ttu-id="968a1-1803">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1803">Remote computer</span></span>|<span data-ttu-id="968a1-1804">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1804">No</span></span>|  
|<span data-ttu-id="968a1-1805">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1805">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1806">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1806">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="968a1-1807">Une valeur autre que <see langword="PeekAction.Current" /> ou <see langword="PeekAction.Next" /> a été spécifiée pour le paramètre <paramref name="action" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1807">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1808">Le paramètre <paramref name="cursor" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1808">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1809">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1809">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="968a1-1810">Il est possible que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1810">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1811">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1811">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-1812">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1812">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1813">Lit un message qui correspond à un identificateur de corrélation donné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1813">Peeks a message that matches a given correlation identifier.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-1814">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à lire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1814">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1815">Lit le message qui correspond à l'identificateur de corrélation donné et lève immédiatement une exception si la file ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1815">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1816">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1816">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1817">Cette méthode recherche dans la file d’attente référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1817">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-1818">Si aucun message ne correspondant est trouvé le `correlationID` paramètre, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1818">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-1819">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-1819">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-1820">Deux autres méthodes vous permettent de lire des messages dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1820">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="968a1-1821">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-1821">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-1822">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1822">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1823">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1823">Workgroup mode</span></span>|<span data-ttu-id="968a1-1824">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1824">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1825">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1825">Local computer</span></span>|<span data-ttu-id="968a1-1826">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1826">Yes</span></span>|  
|<span data-ttu-id="968a1-1827">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1827">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1828">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1828">Yes</span></span>|  
|<span data-ttu-id="968a1-1829">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1829">Remote computer</span></span>|<span data-ttu-id="968a1-1830">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1830">No</span></span>|  
|<span data-ttu-id="968a1-1831">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1831">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1832">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1832">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1833">L’exemple de code suivant envoie et reçoit un message qui contient un ordre vers et depuis une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1833">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="968a1-1834">Il demande spécifiquement un accusé de réception positif lorsque le message d’origine atteint ou est extraite de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1834">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1835">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1835">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1836">Impossible de trouver le message avec le paramètre <paramref name="correlationId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1836">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1837">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1837">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-1838">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à lire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1838">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-1839">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1839">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1840">Lit le message qui correspond à l'identificateur de corrélation donné puis attend qu'un message ayant l'identificateur spécifié soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1840">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1841">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1841">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1842">Cette méthode recherche dans la file d’attente référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1842">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-1843">Si aucun message n’est trouvé, qui correspond à la `correlationID` paramètre et aucun nouveau message arrive dans la file d’attente dans le délai spécifié par le `timeout` paramètre, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-1843">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-1844">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1844">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-1845">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1845">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1846">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.CorrelationId%2A> du nouveau message pour voir si elle correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1846">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="968a1-1847">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-1847">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-1848">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1848">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-1849">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-1849">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-1850">Deux autres méthodes vous permettent de lire des messages dans une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1850">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="968a1-1851">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-1851">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-1852">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1852">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1853">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1853">Workgroup mode</span></span>|<span data-ttu-id="968a1-1854">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1854">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1855">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1855">Local computer</span></span>|<span data-ttu-id="968a1-1856">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1856">Yes</span></span>|  
|<span data-ttu-id="968a1-1857">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1857">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1858">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1858">Yes</span></span>|  
|<span data-ttu-id="968a1-1859">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1859">Remote computer</span></span>|<span data-ttu-id="968a1-1860">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1860">No</span></span>|  
|<span data-ttu-id="968a1-1861">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1861">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1862">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1862">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1863">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1863">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1864">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1864">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1865">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1865">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1866">Le message ayant le paramètre <paramref name="correlationId" /> spécifié n'existe pas dans la file d'attente et n'est pas arrivé avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1866">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1867">Un message n'est pas arrivé avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1867">A message did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-1868">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1868">-or-</span>
          </span>
          <span data-ttu-id="968a1-1869">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1869">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1870">Retourne une copie du message portant l'identificateur de message spécifié, sans supprimer le message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1870">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-1871">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à lire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1871">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1872">Lit le message dont l'identificateur de message correspond au paramètre <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1872">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1873">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1873">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1874">Utilisez <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> pour la lecture, sans supprimer de la file d’attente, un message qui a un identificateur de message connu.</span><span class="sxs-lookup"><span data-stu-id="968a1-1874">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="968a1-1875">L’identificateur d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1875">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="968a1-1876">Cette surcharge lève une exception si la file d’attente ne contient pas actuellement le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-1876">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="968a1-1877">Deux autres méthodes vous permettent de lire des messages dans une file d’attente : <xref:System.Messaging.MessageQueue.Peek%2A> et <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1877">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-1878">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne le premier message dans la file d’attente ; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> renvoie un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1878">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-1879">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1879">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1880">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1880">Workgroup mode</span></span>|<span data-ttu-id="968a1-1881">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1881">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1882">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1882">Local computer</span></span>|<span data-ttu-id="968a1-1883">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1883">Yes</span></span>|  
|<span data-ttu-id="968a1-1884">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1884">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1885">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1885">Yes</span></span>|  
|<span data-ttu-id="968a1-1886">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1886">Remote computer</span></span>|<span data-ttu-id="968a1-1887">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1887">No</span></span>|  
|<span data-ttu-id="968a1-1888">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1888">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1889">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1889">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1890">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1890">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1891">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1891">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1892">Il n'existe aucun message avec le paramètre <paramref name="id" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1892">No message with the specified <paramref name="id" /> exists.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1893">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-1894">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à lire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1894">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-1895">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1895">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1896">Lit le message dont l'identificateur de message correspond au paramètre <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1896">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span>
          </span>
          <span data-ttu-id="968a1-1897">Attend que le message s'affiche dans la file d'attente ou que le délai expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1897">Waits until the message appears in the queue or a time-out occurs.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1898">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1898">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1899">Utilisez <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> pour la lecture, sans supprimer de la file d’attente, un message qui a un identificateur de message connu.</span><span class="sxs-lookup"><span data-stu-id="968a1-1899">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="968a1-1900">L’identificateur d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1900">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="968a1-1901">Cette surcharge lève une exception si la file d’attente ne contient pas actuellement le message et un nouveau message n’arrive pas avant l’expiration du délai.</span><span class="sxs-lookup"><span data-stu-id="968a1-1901">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="968a1-1902">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-1902">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-1903">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1903">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-1904">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.Id%2A> du nouveau message pour voir si elle correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1904">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="968a1-1905">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-1905">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-1906">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.Id%2A> correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1906">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-1907">Deux autres méthodes vous permettent de lire des messages dans une file d’attente : <xref:System.Messaging.MessageQueue.Peek%2A> et <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1907">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-1908">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne le premier message dans la file d’attente ; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> renvoie un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1908">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-1909">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1909">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1910">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1910">Workgroup mode</span></span>|<span data-ttu-id="968a1-1911">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1911">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1912">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1912">Local computer</span></span>|<span data-ttu-id="968a1-1913">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1913">Yes</span></span>|  
|<span data-ttu-id="968a1-1914">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1914">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1915">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1915">Yes</span></span>|  
|<span data-ttu-id="968a1-1916">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1916">Remote computer</span></span>|<span data-ttu-id="968a1-1917">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1917">No</span></span>|  
|<span data-ttu-id="968a1-1918">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1918">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1919">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1919">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1920">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-1920">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-1921">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1921">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-1922">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1922">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1923">Le message avec le paramètre <paramref name="id" /> spécifié n'existe pas dans la file d'attente et n'est pas arrivé avant l'expiration du délai d'attente spécifié par le paramètre <paramref name="timeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1923">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1924">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1924">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1925">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1925">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-1926">Lit un message spécifique de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1926">Peeks at a specific message from the queue.</span>
          </span>
          <span data-ttu-id="968a1-1927">Le message peut être spécifié par un identificateur de recherche ou par sa position au début ou à la fin de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1927">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId">
          <span data-ttu-id="968a1-1928">Propriété <see cref="P:System.Messaging.Message.LookupId" /> du message à lire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1928">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1929">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1929">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-1930">Lit le message qui correspond à l'identificateur de recherche donné d'une file d'attente non transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1930">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1931">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.LookupId" /> correspond au paramètre <paramref name="lookupId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1931">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1932">Utilisez cette méthode pour lire un message avec un identificateur de recherche connu sans le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1932">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="968a1-1933">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1933">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1934">Le <xref:System.Messaging.Message.LookupId%2A> propriété d’un message unique à la file d’attente où réside le message, il y aura au plus un message dans la file d’attente qui correspond à la donnée `lookupId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1934">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-1935">Pour lire un message avec un identificateur de recherche spécifié et le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-1935">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-1936">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1936">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1937">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1937">Workgroup mode</span></span>|<span data-ttu-id="968a1-1938">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1938">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1939">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1939">Local computer</span></span>|<span data-ttu-id="968a1-1940">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1940">Yes</span></span>|  
|<span data-ttu-id="968a1-1941">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1941">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1942">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1942">Yes</span></span>|  
|<span data-ttu-id="968a1-1943">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1943">Remote computer</span></span>|<span data-ttu-id="968a1-1944">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1944">No</span></span>|  
|<span data-ttu-id="968a1-1945">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1945">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1946">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1946">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-1947">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1947">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1948">Impossible de trouver le message avec le paramètre <paramref name="lookupId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1948">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1949">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1949">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="968a1-1950">L'une des valeurs <see cref="T:System.Messaging.MessageLookupAction" />, spécifiant comment le message est lu dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1950">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="968a1-1951">Spécifiez l'une des valeurs suivantes :</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1951">Specify one of the following:</span>
          </span>
          <span data-ttu-id="968a1-1952">
            <see langword="MessageLookupAction.Current" /> : affiche un aperçu du message spécifié par <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1952">
              <see langword="MessageLookupAction.Current" />: Peeks at the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="968a1-1953">
            <see langword="MessageLookupAction.Next" /> : affiche un aperçu du message qui suit le message spécifié par <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1953">
              <see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="968a1-1954">
            <see langword="MessageLookupAction.Previous" /> : affiche un aperçu du message qui précède le message spécifié par <c>lookupId</c>.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1954">
              <see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <c>lookupId</c>.</span>
          </span>
          <span data-ttu-id="968a1-1955">
            <see langword="MessageLookupAction.First" /> : lit le premier message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1955">
              <see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span>
          </span>
          <span data-ttu-id="968a1-1956">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1956">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="968a1-1957">
            <see langword="MessageLookupAction.Last" /> : lit le dernier message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1957">
              <see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span>
          </span>
          <span data-ttu-id="968a1-1958">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1958">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="968a1-1959">Propriété <see cref="P:System.Messaging.Message.LookupId" /> du message à lire ou 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1959">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span>
          </span>
          <span data-ttu-id="968a1-1960">0 est utilisé lors de l'accès au premier ou dernier message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1960">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-1961">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1961">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-1962">Lit un message spécifique de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1962">Peeks at a specific message from the queue.</span>
          </span>
          <span data-ttu-id="968a1-1963">Le message peut être spécifié par un identificateur de recherche ou par sa position au début ou à la fin de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1963">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-1964">
            <see cref="T:System.Messaging.Message" /> spécifié par les paramètres <paramref name="action" /> et <paramref name="lookupId" /> passés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1964">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1965">Utilisez cette méthode pour lire un message avec un identificateur de recherche connu sans le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1965">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="968a1-1966">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1966">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1967">Le <xref:System.Messaging.Message.LookupId%2A> propriété d’un message unique à la file d’attente où réside le message, il y aura au plus un message dans la file d’attente qui correspond à la donnée `lookupId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-1967">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-1968">Pour lire un message avec l’identificateur spécifié et le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-1968">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-1969">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1969">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1970">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1970">Workgroup mode</span></span>|<span data-ttu-id="968a1-1971">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-1971">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-1972">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-1972">Local computer</span></span>|<span data-ttu-id="968a1-1973">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1973">Yes</span></span>|  
|<span data-ttu-id="968a1-1974">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1974">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-1975">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1975">Yes</span></span>|  
|<span data-ttu-id="968a1-1976">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-1976">Remote computer</span></span>|<span data-ttu-id="968a1-1977">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-1977">No</span></span>|  
|<span data-ttu-id="968a1-1978">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-1978">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-1979">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-1979">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-1980">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1980">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-1981">Impossible de trouver le message avec le paramètre <paramref name="lookupId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1981">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-1982">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1982">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-1983">Le paramètre <paramref name="action" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1983">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1984">Se produit lorsqu'un message est lu sans être supprimé de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1984">Occurs when a message is read without being removed from the queue.</span>
          </span>
          <span data-ttu-id="968a1-1985">Cela se produit lors de l'opération asynchrone résultant de la méthode <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1985">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> est utilisé dans le traitement asynchrone pour déclencher le <xref:System.Messaging.MessageQueue.PeekCompleted> événement lorsqu’un message est disponible dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="968a1-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> permet de terminer l’opération lancée par un appel à <xref:System.Messaging.MessageQueue.BeginPeek%2A> et de lire le message lorsque le <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="968a1-1988">Lorsque vous créez un délégué <xref:System.Messaging.PeekCompletedEventHandler>, vous identifiez la méthode qui gérera l'événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-1988">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="968a1-1989">Pour associer l'événement au gestionnaire d'événements, ajoutez une instance du délégué à l'événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-1989">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="968a1-1990">Le gestionnaire d'événements est appelé chaque fois qu'un événement se produit, sauf si vous supprimez le délégué.</span><span class="sxs-lookup"><span data-stu-id="968a1-1990">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="968a1-1991">Pour plus d’informations sur les délégués de gestionnaires d’événements, consultez [gestion et déclenchement d’événements](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="968a1-1991">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-1992">L’exemple de code suivant crée un gestionnaire d’événements nommé `MyPeekCompleted`, attache à la <xref:System.Messaging.MessageQueue.PeekCompleted> délégué de gestionnaire d’événements et appelle <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une opération de lecture asynchrone sur la file d’attente qui se trouve dans le chemin d’accès ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-1992">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="968a1-1993">Lorsqu’un <xref:System.Messaging.MessageQueue.PeekCompleted> événement est déclenché, l’exemple lit le message et écrit son corps à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-1993">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="968a1-1994">L’exemple appelle ensuite <xref:System.Messaging.MessageQueue.BeginPeek%2A> pour lancer une nouvelle opération de lecture asynchrone</span><span class="sxs-lookup"><span data-stu-id="968a1-1994">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-1995">Supprime tous les messages contenus dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-1995">Deletes all the messages contained in the queue.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-1996">Provoque la purge de la file d’attente Message Queuing définir l’indicateur de modification de file d’attente, ce qui affecte le <xref:System.Messaging.MessageQueue.LastModifyTime%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-1996">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="968a1-1997">Les messages qui sont purgés de la file d’attente sont perdus ; elles ne sont pas envoyées à la file d’attente de lettres mortes ou de la file d’attente du journal.</span><span class="sxs-lookup"><span data-stu-id="968a1-1997">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="968a1-1998">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-1998">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-1999">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-1999">Workgroup mode</span></span>|<span data-ttu-id="968a1-2000">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2000">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2001">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2001">Local computer</span></span>|<span data-ttu-id="968a1-2002">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2002">Yes</span></span>|  
|<span data-ttu-id="968a1-2003">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2003">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2004">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2004">Yes</span></span>|  
|<span data-ttu-id="968a1-2005">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2005">Remote computer</span></span>|<span data-ttu-id="968a1-2006">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2006">No</span></span>|  
|<span data-ttu-id="968a1-2007">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2007">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2008">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2008">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2009">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Purge%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2009">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2010">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2010">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2011">Obtient ou définit le nom convivial qui identifie la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2011">Gets or sets the friendly name that identifies the queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-2012">Nom identifiant la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2012">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-2013">La valeur doit être différente de <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2013">The value cannot be <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2014">Vous pouvez combiner la <xref:System.Messaging.MessageQueue.QueueName%2A> avec la <xref:System.Messaging.MessageQueue.MachineName%2A> pour créer un nom convivial de <xref:System.Messaging.MessageQueue.Path%2A> nom de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2014">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="968a1-2015">La syntaxe de nom convivial de la <xref:System.Messaging.MessageQueue.Path%2A> propriété varie selon le type de file d’attente, comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-2015">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="968a1-2016">Type de file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-2016">Queue type</span></span>|<span data-ttu-id="968a1-2017">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="968a1-2017">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="968a1-2018">File d’attente publique</span><span class="sxs-lookup"><span data-stu-id="968a1-2018">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="968a1-2019">File d’attente privée</span><span class="sxs-lookup"><span data-stu-id="968a1-2019">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="968a1-2020">File d’attente du journal</span><span class="sxs-lookup"><span data-stu-id="968a1-2020">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="968a1-2021">Utilisez «. » pour représenter l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-2021">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="968a1-2022">Modification de la <xref:System.Messaging.MessageQueue.QueueName%2A> propriété affecte le <xref:System.Messaging.MessageQueue.Path%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-2022">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="968a1-2023">Si vous définissez la <xref:System.Messaging.MessageQueue.QueueName%2A> sans définir le <xref:System.Messaging.MessageQueue.MachineName%2A> propriété, le <xref:System.Messaging.MessageQueue.Path%2A> propriété devient.\\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="968a1-2023">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="968a1-2024">Dans le cas contraire, le <xref:System.Messaging.MessageQueue.Path%2A> devient `MachineName` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="968a1-2024">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="968a1-2025">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2025">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2026">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2026">Workgroup mode</span></span>|<span data-ttu-id="968a1-2027">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2027">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2028">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2028">Local computer</span></span>|<span data-ttu-id="968a1-2029">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2029">Yes</span></span>|  
|<span data-ttu-id="968a1-2030">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2030">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2031">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2031">Yes</span></span>|  
|<span data-ttu-id="968a1-2032">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2032">Remote computer</span></span>|<span data-ttu-id="968a1-2033">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2033">Yes</span></span>|  
|<span data-ttu-id="968a1-2034">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2034">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2035">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2035">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2036">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.QueueName%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-2036">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2037">Le nom de la file d'attente est <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2037">The queue name is <see langword="null" />.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2038">Obtient le handle natif utilisé pour la lecture des messages à partir de la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2038">Gets the native handle used to read messages from the message queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-2039">Handle de l'objet file d'attente natif utilisé pour la lecture et la réception des messages à partir de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2039">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2040">Le <xref:System.Messaging.MessageQueue.ReadHandle%2A> fournit un handle Windows natif pour l’objet de file d’attente de messages qui est utilisé pour la lecture et la réception de messages à partir de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2040">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="968a1-2041">Si vous modifiez le chemin d’accès de la file d’attente, le handle est fermé et rouvert avec une nouvelle valeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-2041">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="968a1-2042">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2042">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2043">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2043">Workgroup mode</span></span>|<span data-ttu-id="968a1-2044">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2044">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2045">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2045">Local computer</span></span>|<span data-ttu-id="968a1-2046">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2046">Yes</span></span>|  
|<span data-ttu-id="968a1-2047">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2047">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2048">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2048">Yes</span></span>|  
|<span data-ttu-id="968a1-2049">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2049">Remote computer</span></span>|<span data-ttu-id="968a1-2050">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2050">No</span></span>|  
|<span data-ttu-id="968a1-2051">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2051">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2052">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2052">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2053">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2053">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe>
          <span data-ttu-id="968a1-2054">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2054">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <summary>
          <span data-ttu-id="968a1-2055">Reçoit (et supprime) le premier message figurant dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2055">Receives the first message in the queue, removing it from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2056">Reçoit le premier message disponible dans la file référencée par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2056">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-2057">Cet appel synchrone bloque le thread d'exécution en cours jusqu'à ce qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2057">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2058">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2058">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2059">Utilisez cette surcharge pour recevoir un message d’une file d’attente, ou attendez que la file d’attente contient des messages.</span><span class="sxs-lookup"><span data-stu-id="968a1-2059">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2060">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2060">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2061">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente ou des messages de priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2061">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="968a1-2062">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2062">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2063">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2063">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2064">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2064">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2065">Étant donné que cette surcharge de la <xref:System.Messaging.MessageQueue.Receive%2A> méthode spécifie un délai d’attente infini, l’application risque d’attendre indéfiniment.</span><span class="sxs-lookup"><span data-stu-id="968a1-2065">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="968a1-2066">Si le traitement de l’application doit se poursuivre sans attendre le message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2066">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2067">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2067">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2068">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2068">Workgroup mode</span></span>|<span data-ttu-id="968a1-2069">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2069">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2070">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2070">Local computer</span></span>|<span data-ttu-id="968a1-2071">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2071">Yes</span></span>|  
|<span data-ttu-id="968a1-2072">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2072">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2073">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2073">Yes</span></span>|  
|<span data-ttu-id="968a1-2074">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2074">Remote computer</span></span>|<span data-ttu-id="968a1-2075">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2075">No</span></span>|  
|<span data-ttu-id="968a1-2076">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2076">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2077">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2077">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2078">L’exemple de code suivant reçoit un message d’une file d’attente et génère des informations relatives au message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-2078">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2079">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2079">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction">
          <span data-ttu-id="968a1-2080">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2080">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2081">Reçoit le premier message disponible dans la file d'attente transactionnelle référencée par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2081">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-2082">Cet appel synchrone bloque le thread d'exécution en cours jusqu'à ce qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2082">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2083">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2083">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2084">Utilisez cette surcharge pour recevoir un message d’une file d’attente transactionnelle à l’aide du contexte de transaction interne défini par le `transaction` paramètre, ou patientez jusqu'à ce qu’il existe des messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2084">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2085">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2085">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2086">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2086">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2087">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2087">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2088">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2088">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2089">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2089">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2090">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2090">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2091">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2091">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2092">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il serait rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2092">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2093">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2093">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2094">Étant donné que cette surcharge de la <xref:System.Messaging.MessageQueue.Receive%2A> méthode spécifie un délai d’attente infini, l’application risque d’attendre indéfiniment.</span><span class="sxs-lookup"><span data-stu-id="968a1-2094">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="968a1-2095">Si le traitement de l’application doit se poursuivre sans attendre le message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2095">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2096">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2096">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2097">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2097">Workgroup mode</span></span>|<span data-ttu-id="968a1-2098">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2098">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2099">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2099">Local computer</span></span>|<span data-ttu-id="968a1-2100">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2100">Yes</span></span>|  
|<span data-ttu-id="968a1-2101">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2101">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2102">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2102">Yes</span></span>|  
|<span data-ttu-id="968a1-2103">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2103">Remote computer</span></span>|<span data-ttu-id="968a1-2104">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2104">No</span></span>|  
|<span data-ttu-id="968a1-2105">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2105">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2106">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2106">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2107">L’exemple de code suivant se connecte à une file d’attente transactionnelle sur l’ordinateur local et envoie un message à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2107">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="968a1-2108">Puis, il reçoit le message qui contient une commande.</span><span class="sxs-lookup"><span data-stu-id="968a1-2108">It then receives the message that contains an order.</span></span> <span data-ttu-id="968a1-2109">S’il rencontre une file d’attente non transactionnelle, il lève exception et restaure la transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2109">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2110">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2110">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="968a1-2111">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2111">-or-</span>
          </span>
          <span data-ttu-id="968a1-2112">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2112">The queue is non-transactional.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2113">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2113">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType">
          <span data-ttu-id="968a1-2114">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2114">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2115">Reçoit le premier message disponible dans la file référencée par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2115">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-2116">Cet appel synchrone bloque le thread d'exécution en cours jusqu'à ce qu'un message soit disponible.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2116">This call is synchronous, and blocks the current thread of execution until a message is available.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2117">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2117">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2118">Utilisez cette surcharge pour recevoir un message d’une file d’attente à l’aide d’un contexte de transaction défini par le `transactionType` paramètre, ou patientez jusqu'à ce qu’il existe des messages dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2118">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2119">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2119">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2120">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2120">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2121">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2121">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2122">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2122">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2123">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2123">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2124">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2124">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2125">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2125">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2126">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2126">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2127">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2127">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2128">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2128">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2129">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il serait rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2129">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2130">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2130">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2131">Étant donné que cette surcharge de la <xref:System.Messaging.MessageQueue.Receive%2A> méthode spécifie un délai d’attente infini, l’application risque d’attendre indéfiniment.</span><span class="sxs-lookup"><span data-stu-id="968a1-2131">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="968a1-2132">Si le traitement de l’application doit se poursuivre sans attendre le message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2132">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2133">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2133">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2134">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2134">Workgroup mode</span></span>|<span data-ttu-id="968a1-2135">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2135">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2136">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2136">Local computer</span></span>|<span data-ttu-id="968a1-2137">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2137">Yes</span></span>|  
|<span data-ttu-id="968a1-2138">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2138">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2139">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2139">Yes</span></span>|  
|<span data-ttu-id="968a1-2140">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2140">Remote computer</span></span>|<span data-ttu-id="968a1-2141">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2141">No</span></span>|  
|<span data-ttu-id="968a1-2142">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2142">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2143">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2143">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2144">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2144">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2145">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2145">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2146">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2146">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2147">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2147">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2148">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2148">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2149">Reçoit le premier message disponible dans la file d'attente référencée par <see cref="T:System.Messaging.MessageQueue" /> et attend qu'un message soit disponible dans la file ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2149">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2150">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2150">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2151">Utilisez cette surcharge pour recevoir un message et effectuer un retour dans un délai spécifié si la file d'attente ne contient aucun message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2151">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2152">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, sa suppression de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2152">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="968a1-2153">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente ou des messages de priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2153">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="968a1-2154">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2154">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2155">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2155">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2156">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2156">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2157">Le thread sera bloqué pendant la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour la `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2157">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2158">Si le traitement de l’application doit se poursuivre sans attendre de message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2158">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2159">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2159">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2160">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2160">Workgroup mode</span></span>|<span data-ttu-id="968a1-2161">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2161">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2162">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2162">Local computer</span></span>|<span data-ttu-id="968a1-2163">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2163">Yes</span></span>|  
|<span data-ttu-id="968a1-2164">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2164">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2165">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2165">Yes</span></span>|  
|<span data-ttu-id="968a1-2166">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2166">Remote computer</span></span>|<span data-ttu-id="968a1-2167">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2167">No</span></span>|  
|<span data-ttu-id="968a1-2168">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2168">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2169">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2169">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2170">L’exemple de code suivant reçoit un message d’une file d’attente et génère des informations relatives au message à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-2170">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="968a1-2171">L’exemple suspend l’exécution pendant cinq secondes lors de l’attente d’un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2171">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2172">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2172">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2173">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2173">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2174">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2174">-or-</span>
          </span>
          <span data-ttu-id="968a1-2175">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2175">An error occurred when accessing a Message Queuing method</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2176">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2176">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2177">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2177">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-2178">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2178">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2179">Reçoit le message en cours dans la file d'attente, à l'aide d'un curseur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2179">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="968a1-2180">Si aucun message n'est disponible, cette méthode attend qu'un message soit disponible ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2180">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2181">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2181">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2182">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2182">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2183">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2183">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2184">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2184">-or-</span>
          </span>
          <span data-ttu-id="968a1-2185">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2185">An error occurred when accessing a Message Queuing method</span>
          </span>
          <span data-ttu-id="968a1-2186">Utilisez cette surcharge pour recevoir un message et effectuer un retour dans un délai spécifié si la file d'attente ne contient aucun message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2186">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2187">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2187">The method is not thread safe.</span>
          </span>
        </threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2188">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2188">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2189">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2189">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2190">Reçoit le premier message disponible dans la file d'attente transactionnelle référencée par <see cref="T:System.Messaging.MessageQueue" /> et attend qu'un message soit disponible dans la file d'attente ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2190">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2191">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2191">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2192">Utilisez cette surcharge pour recevoir un message d’une file d’attente transactionnelle à l’aide du contexte de transaction interne défini par le `transaction` paramètre et retourner une période de temps s’il en existe aucun message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2192">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2193">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2193">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2194">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2194">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2195">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2195">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2196">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2196">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2197">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2197">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2198">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2198">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2199">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2199">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2200">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il serait rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2200">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2201">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2201">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2202">Le thread sera bloqué pendant la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour la `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2202">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2203">Si le traitement de l’application doit se poursuivre sans attendre de message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2203">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2204">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2204">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2205">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2205">Workgroup mode</span></span>|<span data-ttu-id="968a1-2206">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2206">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2207">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2207">Local computer</span></span>|<span data-ttu-id="968a1-2208">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2208">Yes</span></span>|  
|<span data-ttu-id="968a1-2209">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2209">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2210">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2210">Yes</span></span>|  
|<span data-ttu-id="968a1-2211">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2211">Remote computer</span></span>|<span data-ttu-id="968a1-2212">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2212">No</span></span>|  
|<span data-ttu-id="968a1-2213">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2213">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2214">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2214">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2215">L’exemple de code suivant illustre l’utilisation de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2215">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2216">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2216">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2217">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2217">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2218">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2218">-or-</span>
          </span>
          <span data-ttu-id="968a1-2219">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2219">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2220">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2220">-or-</span>
          </span>
          <span data-ttu-id="968a1-2221">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2221">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2222">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2222">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2223">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2223">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2224">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2224">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2225">Reçoit le premier message disponible dans la file référencée par <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2225">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
          <span data-ttu-id="968a1-2226">Cet appel est synchrone et attend qu'un message soit disponible dans la file d'attente ou que le délai expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2226">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2227">
            <see cref="T:System.Messaging.Message" /> référençant le premier message disponible dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2227">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2228">Utilisez cette surcharge pour recevoir un message d’une file d’attente à l’aide d’un contexte de transaction défini par le `transactionType` paramètre et retourner dans une période de temps s’il en existe aucun message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2228">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2229">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2229">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2230">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2230">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2231">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2231">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2232">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2232">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2233">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retourneront les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2233">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2234">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2234">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2235">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2235">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2236">Pour lire le premier message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2236">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2237">Le <xref:System.Messaging.MessageQueue.Peek%2A> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2237">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2238">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2238">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2239">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il serait rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2239">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2240">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2240">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2241">Le thread sera bloqué pendant la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour la `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2241">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2242">Si le traitement de l’application doit se poursuivre sans attendre de message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2242">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2243">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2243">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2244">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2244">Workgroup mode</span></span>|<span data-ttu-id="968a1-2245">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2245">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2246">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2246">Local computer</span></span>|<span data-ttu-id="968a1-2247">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2247">Yes</span></span>|  
|<span data-ttu-id="968a1-2248">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2248">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2249">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2249">Yes</span></span>|  
|<span data-ttu-id="968a1-2250">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2250">Remote computer</span></span>|<span data-ttu-id="968a1-2251">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2251">No</span></span>|  
|<span data-ttu-id="968a1-2252">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2252">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2253">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2253">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2254">L’exemple de code suivant illustre l’utilisation de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2254">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2255">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2255">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2256">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2256">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2257">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2257">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2258">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2258">-or-</span>
          </span>
          <span data-ttu-id="968a1-2259">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2259">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2260">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2260">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2261">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2261">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-2262">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2262">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2263">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2263">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2264">Reçoit le message en cours dans la file d'attente, à l'aide d'un curseur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2264">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="968a1-2265">Si aucun message n'est disponible, cette méthode attend qu'un message soit disponible ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2265">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2266">
            <see cref="T:System.Messaging.Message" /> qui référence un message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2266">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2267">Utilisez cette surcharge pour recevoir un message d’une file d’attente transactionnelle à l’aide du contexte de transaction interne défini par le `transaction` paramètre et retourner une période de temps s’il en existe aucun message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2267">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2268">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2268">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2269">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retournent les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2269">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2270">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2270">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2271">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2271">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2272">Pour lire un message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2272">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2273">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2273">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2274">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il n’y a rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2274">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2275">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2275">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2276">Le thread est bloqué pendant la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour la `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2276">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2277">Si le traitement de l’application doit se poursuivre sans attendre de message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2277">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2278">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2278">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2279">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2279">Workgroup mode</span></span>|<span data-ttu-id="968a1-2280">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2280">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2281">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2281">Local computer</span></span>|<span data-ttu-id="968a1-2282">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2282">Yes</span></span>|  
|<span data-ttu-id="968a1-2283">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2283">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2284">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2284">Yes</span></span>|  
|<span data-ttu-id="968a1-2285">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2285">Remote computer</span></span>|<span data-ttu-id="968a1-2286">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2286">No</span></span>|  
|<span data-ttu-id="968a1-2287">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2287">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2288">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2288">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2289">Le paramètre <paramref name="cursor" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2289">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-2290">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2290">-or-</span>
          </span>
          <span data-ttu-id="968a1-2291">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2291">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2292">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2292">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="968a1-2293">Il est possible que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2293">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2294">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2294">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2295">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2295">-or-</span>
          </span>
          <span data-ttu-id="968a1-2296">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2296">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2297">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2297">-or-</span>
          </span>
          <span data-ttu-id="968a1-2298">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2298">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2299">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2299">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout">
          <span data-ttu-id="968a1-2300">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2300">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="cursor">
          <span data-ttu-id="968a1-2301">
            <see cref="T:System.Messaging.Cursor" /> qui conserve une position spécifique dans la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2301">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2302">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> qui décrit le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2302">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2303">Reçoit le message en cours dans la file d'attente, à l'aide d'un curseur spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2303">Receives the current message in the queue, using a specified cursor.</span>
          </span>
          <span data-ttu-id="968a1-2304">Si aucun message n'est disponible, cette méthode attend qu'un message soit disponible ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2304">If no message is available, this method waits until either a message is available, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2305">
            <see cref="T:System.Messaging.Message" /> qui référence un message dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2305">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2306">Utilisez cette surcharge pour recevoir un message d’une file d’attente à l’aide d’un contexte de transaction défini par le `transactionType` paramètre et retourner dans une période de temps s’il en existe aucun message dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2306">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2307">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2307">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2308">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2308">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2309">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2309">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2310">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode autorise la lecture synchrone d’un message, en le supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2310">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="968a1-2311">Les appels suivants à <xref:System.Messaging.MessageQueue.Receive%2A> retournent les messages qui suivent dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2311">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2312">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message qui est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2312">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2313">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2313">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2314">Pour lire un message dans une file d’attente sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.Peek%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2314">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="968a1-2315">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2315">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="968a1-2316">Étant donné que <xref:System.Messaging.MessageQueue.Peek%2A> ne supprime pas tous les messages dans la file d’attente, il n’y a rien à restaurer par un appel à <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2316">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2317">Utilisez un appel à <xref:System.Messaging.MessageQueue.Receive%2A> lorsqu’il est acceptable pour le thread actuel peut être bloqué alors qu’il attend un message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2317">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2318">Le thread est bloqué pendant la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour la `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2318">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2319">Si le traitement de l’application doit se poursuivre sans attendre de message, envisagez d’utiliser la méthode asynchrone, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2319">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="968a1-2320">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2320">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2321">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2321">Workgroup mode</span></span>|<span data-ttu-id="968a1-2322">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2322">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2323">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2323">Local computer</span></span>|<span data-ttu-id="968a1-2324">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2324">Yes</span></span>|  
|<span data-ttu-id="968a1-2325">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2325">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2326">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2326">Yes</span></span>|  
|<span data-ttu-id="968a1-2327">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2327">Remote computer</span></span>|<span data-ttu-id="968a1-2328">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2328">No</span></span>|  
|<span data-ttu-id="968a1-2329">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2329">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2330">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2330">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2331">Le paramètre <paramref name="cursor" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2331">The <paramref name="cursor" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2332">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2332">The value specified for the <paramref name="timeout" /> parameter is not valid.</span>
          </span>
          <span data-ttu-id="968a1-2333">Il est possible que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2333">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2334">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2334">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2335">Aucun message n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2335">A message did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2336">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2336">-or-</span>
          </span>
          <span data-ttu-id="968a1-2337">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2337">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <threadsafe>
          <span data-ttu-id="968a1-2338">La méthode n’est pas thread-safe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2338">The method is not thread safe.</span>
          </span>
        </threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2339">Reçoit un message qui correspond à un identificateur de corrélation donné.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2339">Receives a message that matches a given correlation identifier.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2340">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2340">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2341">Reçoit le message qui correspond à l'identificateur de corrélation donné (à partir d'une file d'attente non transactionnelle), et lève immédiatement une exception si la file ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2341">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2342">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2342">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2343">Cette méthode recherche dans la file d’attente non transactionnelle référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2343">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2344">Si aucun message ne correspondant est trouvé le `correlationID` paramètre, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2344">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="968a1-2345">Sinon, le message est supprimé de la file d’attente et retourné à l’application.</span><span class="sxs-lookup"><span data-stu-id="968a1-2345">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="968a1-2346">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2346">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2347">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2347">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2348">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode récupère un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2348">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2349">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2349">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2350">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2350">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2351">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2351">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2352">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2352">Workgroup mode</span></span>|<span data-ttu-id="968a1-2353">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2353">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2354">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2354">Local computer</span></span>|<span data-ttu-id="968a1-2355">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2355">Yes</span></span>|  
|<span data-ttu-id="968a1-2356">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2356">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2357">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2357">Yes</span></span>|  
|<span data-ttu-id="968a1-2358">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2358">Remote computer</span></span>|<span data-ttu-id="968a1-2359">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2359">No</span></span>|  
|<span data-ttu-id="968a1-2360">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2360">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2361">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2361">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2362">L’exemple de code suivant envoie et reçoit un message qui contient un ordre vers et depuis une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2362">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="968a1-2363">Il demande spécifiquement un accusé de réception positif lorsque le message d’origine atteint ou est extraite de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2363">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2364">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2364">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2365">Impossible de trouver le message avec le paramètre <paramref name="correlationId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2365">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2366">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2366">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2367">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2367">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2368">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2368">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2369">Reçoit le message qui correspond à l'identificateur de corrélation donné (à partir d'une file d'attente transactionnelle), et lève immédiatement une exception si la file ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2369">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2370">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2370">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2371">Cette méthode recherche dans la file d’attente transactionnelle référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2371">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2372">Si aucun message ne correspondant est trouvé le `correlationID` paramètre, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2372">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="968a1-2373">Sinon, le message est supprimé de la file d’attente et retourné à l’application à l’aide du contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2373">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2374">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2374">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2375">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2375">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2376">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2376">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2377">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2377">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2378">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2378">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2379">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2379">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2380">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2380">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2381">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2381">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-2382">Étant donné que <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2382">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2383">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2383">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2384">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2384">Workgroup mode</span></span>|<span data-ttu-id="968a1-2385">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2385">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2386">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2386">Local computer</span></span>|<span data-ttu-id="968a1-2387">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2387">Yes</span></span>|  
|<span data-ttu-id="968a1-2388">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2388">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2389">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2389">Yes</span></span>|  
|<span data-ttu-id="968a1-2390">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2390">Remote computer</span></span>|<span data-ttu-id="968a1-2391">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2391">No</span></span>|  
|<span data-ttu-id="968a1-2392">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2392">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2393">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2393">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2394">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2394">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2395">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2395">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-2396">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2396">-or-</span>
          </span>
          <span data-ttu-id="968a1-2397">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2397">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2398">Impossible de trouver le message avec le paramètre <paramref name="correlationId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2398">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2399">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2399">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2400">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2400">-or-</span>
          </span>
          <span data-ttu-id="968a1-2401">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2401">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2402">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2402">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2403">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2403">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2404">Reçoit le message qui correspond à l'identificateur de corrélation donné et lève immédiatement une exception si la file d'attente ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2404">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2405">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2405">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2406">Cette méthode recherche dans la file d’attente référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2406">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2407">Si aucun message ne correspondant est trouvé le `correlationID` paramètre, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2407">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="968a1-2408">Sinon, le message est supprimé de la file d’attente et retourné à l’application à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2408">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2409">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2409">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2410">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2410">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2411">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2411">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2412">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2412">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2413">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2413">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2414">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2414">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2415">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2415">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2416">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2416">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2417">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2417">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2418">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2418">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2419">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2419">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-2420">Étant donné que <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2420">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2421">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2421">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2422">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2422">Workgroup mode</span></span>|<span data-ttu-id="968a1-2423">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2423">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2424">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2424">Local computer</span></span>|<span data-ttu-id="968a1-2425">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2425">Yes</span></span>|  
|<span data-ttu-id="968a1-2426">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2426">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2427">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2427">Yes</span></span>|  
|<span data-ttu-id="968a1-2428">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2428">Remote computer</span></span>|<span data-ttu-id="968a1-2429">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2429">No</span></span>|  
|<span data-ttu-id="968a1-2430">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2430">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2431">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2431">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2432">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2432">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2433">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2433">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2434">Impossible de trouver le message avec le paramètre <paramref name="correlationId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2434">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2435">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2435">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2436">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2436">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2437">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2437">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2438">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2438">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2439">Reçoit le message qui correspond à l'identificateur de corrélation donné, (à partir d'une file non transactionnelle), puis attend qu'un message ayant cet identificateur soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2439">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2440">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2440">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2441">Cette méthode recherche dans la file d’attente non transactionnelle référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2441">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2442">Cette méthode est retournée immédiatement si le message avec l’identificateur de corrélation spécifié par le `correlationId` paramètre figure dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2442">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="968a1-2443">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2443">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2444">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2444">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2445">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2445">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2446">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2446">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2447">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.CorrelationId%2A> du nouveau message pour voir si elle correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2447">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2448">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2448">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2449">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2449">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2450">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2450">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2451">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2451">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2452">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2452">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2453">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2453">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2454">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2454">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2455">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2456">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2456">Workgroup mode</span></span>|<span data-ttu-id="968a1-2457">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2458">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2458">Local computer</span></span>|<span data-ttu-id="968a1-2459">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2459">Yes</span></span>|  
|<span data-ttu-id="968a1-2460">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2460">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2461">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2461">Yes</span></span>|  
|<span data-ttu-id="968a1-2462">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2462">Remote computer</span></span>|<span data-ttu-id="968a1-2463">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2463">No</span></span>|  
|<span data-ttu-id="968a1-2464">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2464">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2465">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2465">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2466">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2466">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2467">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2467">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2468">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2468">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2469">Le message ayant le paramètre <paramref name="correlationId" /> spécifié n'existe pas dans la file d'attente et n'est pas arrivé avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2469">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2470">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2470">-or-</span>
          </span>
          <span data-ttu-id="968a1-2471">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2471">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2472">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2472">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2473">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2473">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2474">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2474">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2475">Reçoit le message qui correspond à l'identificateur de corrélation donné, (à partir d'une file d'attente transactionnelle), puis attend qu'un message ayant cet identificateur soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2475">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2476">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2476">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2477">Cette méthode recherche dans la file d’attente transactionnelle référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2477">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2478">Cette méthode est retournée immédiatement si le message avec l’identificateur de corrélation spécifié par le `correlationId` paramètre figure dans la file d’attente, à l’aide du contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2478">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-2479">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2479">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2480">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2480">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2481">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2481">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2482">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2482">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2483">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.CorrelationId%2A> du nouveau message pour voir si elle correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2483">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2484">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2484">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2485">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2485">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2486">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2486">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2487">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2487">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2488">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2488">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2489">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2489">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2490">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2490">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2491">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2491">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2492">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2492">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2493">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2493">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-2494">Étant donné que <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2494">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2495">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2495">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2496">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2496">Workgroup mode</span></span>|<span data-ttu-id="968a1-2497">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2497">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2498">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2498">Local computer</span></span>|<span data-ttu-id="968a1-2499">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2499">Yes</span></span>|  
|<span data-ttu-id="968a1-2500">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2500">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2501">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2501">Yes</span></span>|  
|<span data-ttu-id="968a1-2502">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2502">Remote computer</span></span>|<span data-ttu-id="968a1-2503">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2503">No</span></span>|  
|<span data-ttu-id="968a1-2504">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2504">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2505">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2505">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2506">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2506">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2507">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2507">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-2508">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2508">-or-</span>
          </span>
          <span data-ttu-id="968a1-2509">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2509">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2510">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2510">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2511">Le message ayant le paramètre <paramref name="correlationId" /> spécifié n'existe pas dans la file d'attente et n'est pas arrivé avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2511">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2512">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2512">-or-</span>
          </span>
          <span data-ttu-id="968a1-2513">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2513">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2514">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2514">-or-</span>
          </span>
          <span data-ttu-id="968a1-2515">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2515">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId">
          <span data-ttu-id="968a1-2516">Propriété <see cref="P:System.Messaging.Message.CorrelationId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2516">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2517">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2517">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2518">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2518">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2519">Reçoit le message qui correspond à l'identificateur de corrélation donné, puis attend qu'un message ayant l'identificateur spécifié soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2519">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2520">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.CorrelationId" /> correspond au paramètre <paramref name="correlationId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2520">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2521">Cette méthode recherche dans la file d’attente référencée par la <xref:System.Messaging.MessageQueue> pour un message dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à l’élément spécifié `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2521">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2522">Cette méthode est retournée immédiatement si le message avec l’identificateur de corrélation spécifié par le `correlationId` paramètre figure dans la file d’attente, à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2522">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="968a1-2523">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2523">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2524">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2524">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2525">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2525">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2526">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2526">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2527">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.CorrelationId%2A> du nouveau message pour voir si elle correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2527">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2528">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2528">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2529">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.CorrelationId%2A> correspond à la `correlationId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2529">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="968a1-2530">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2530">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2531">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2531">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2532">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2532">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2533">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2533">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2534">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2534">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2535">Le <xref:System.Messaging.Message.CorrelationId%2A> propriété est utilisée pour lier un message envoyé à la file d’attente des messages de réponse, de rapport ou d’accusé de réception associés.</span><span class="sxs-lookup"><span data-stu-id="968a1-2535">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="968a1-2536">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2536">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2537">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> méthode est utilisée pour récupérer un message en spécifiant son identificateur unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-2537">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="968a1-2538">Pour lire un message avec un identificateur de corrélation spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2538">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2539">Le <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2539">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2540">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2540">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="968a1-2541">Étant donné que <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2541">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2542">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2542">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2543">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2543">Workgroup mode</span></span>|<span data-ttu-id="968a1-2544">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2544">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2545">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2545">Local computer</span></span>|<span data-ttu-id="968a1-2546">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2546">Yes</span></span>|  
|<span data-ttu-id="968a1-2547">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2547">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2548">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2548">Yes</span></span>|  
|<span data-ttu-id="968a1-2549">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2549">Remote computer</span></span>|<span data-ttu-id="968a1-2550">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2550">No</span></span>|  
|<span data-ttu-id="968a1-2551">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2551">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2552">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2552">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2553">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2553">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2554">Le paramètre <paramref name="correlationId" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2554">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2555">Impossible de trouver le message avec le paramètre <paramref name="correlationId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2555">The message with the specified <paramref name="correlationId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2556">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2556">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2557">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2557">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2558">Le message ayant le paramètre <paramref name="correlationId" /> spécifié n'existe pas dans la file d'attente et n'est pas arrivé avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2558">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2559">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2559">-or-</span>
          </span>
          <span data-ttu-id="968a1-2560">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2560">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2561">Reçoit le message qui correspond à l'identificateur donné et le supprime de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2561">Receives the message that matches the given identifier, removing it from the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2562">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2562">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2563">Reçoit le message qui correspond à l'identificateur spécifié à partir d'une file d'attente non transactionnelle, et lève immédiatement une exception si la file ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2563">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2564">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2564">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2565">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2565">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="968a1-2566">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2566">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2567">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2567">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2568">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2568">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2569">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2569">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2570">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2570">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2571">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2571">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2572">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2572">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2573">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2573">Workgroup mode</span></span>|<span data-ttu-id="968a1-2574">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2574">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2575">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2575">Local computer</span></span>|<span data-ttu-id="968a1-2576">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2576">Yes</span></span>|  
|<span data-ttu-id="968a1-2577">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2577">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2578">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2578">Yes</span></span>|  
|<span data-ttu-id="968a1-2579">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2579">Remote computer</span></span>|<span data-ttu-id="968a1-2580">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2580">No</span></span>|  
|<span data-ttu-id="968a1-2581">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2581">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2582">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2582">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2583">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2583">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2584">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2584">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2585">Impossible de trouver le message avec le paramètre <paramref name="id" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2585">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2586">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2586">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2587">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2587">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2588">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2588">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2589">Reçoit le message qui correspond à l'identificateur spécifié (à partir d'une file d'attente transactionnelle), et lève immédiatement une exception si la file ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2589">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2590">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2590">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2591">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente, à l’aide du contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2591">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-2592">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-2592">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="968a1-2593">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2593">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2594">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2594">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2595">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2595">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2596">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2596">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2597">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2597">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2598">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2598">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2599">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2599">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2600">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2600">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="968a1-2601">Étant donné que <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2601">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2602">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2602">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2603">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2603">Workgroup mode</span></span>|<span data-ttu-id="968a1-2604">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2604">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2605">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2605">Local computer</span></span>|<span data-ttu-id="968a1-2606">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2606">Yes</span></span>|  
|<span data-ttu-id="968a1-2607">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2607">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2608">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2608">Yes</span></span>|  
|<span data-ttu-id="968a1-2609">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2609">Remote computer</span></span>|<span data-ttu-id="968a1-2610">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2610">No</span></span>|  
|<span data-ttu-id="968a1-2611">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2611">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2612">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2612">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2613">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2613">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2614">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2614">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-2615">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2615">-or-</span>
          </span>
          <span data-ttu-id="968a1-2616">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2616">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2617">Impossible de trouver le message avec le paramètre <paramref name="id" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2617">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2618">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2618">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2619">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2619">-or-</span>
          </span>
          <span data-ttu-id="968a1-2620">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2620">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2621">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2621">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2622">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2622">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2623">Reçoit le message qui correspond à l'identificateur spécifié et lève immédiatement une exception si la file d'attente ne contient aucun message correspondant à cet identificateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2623">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2624">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2624">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2625">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2625">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="968a1-2626">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2626">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="968a1-2627">Sinon, le message est supprimé de la file d’attente et retourné à l’application à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2627">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2628">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2628">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2629">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2629">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2630">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2630">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2631">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2631">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="968a1-2632">Si le message avec l’identificateur spécifié est dans une file d’attente autre que celui associé à ce <xref:System.Messaging.MessageQueue> instance, le message sera introuvable.</span><span class="sxs-lookup"><span data-stu-id="968a1-2632">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="968a1-2633">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2633">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2634">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2634">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2635">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2635">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2636">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2636">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2637">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2637">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2638">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2638">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2639">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2639">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="968a1-2640">Étant donné que <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2640">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2641">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2641">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2642">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2642">Workgroup mode</span></span>|<span data-ttu-id="968a1-2643">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2643">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2644">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2644">Local computer</span></span>|<span data-ttu-id="968a1-2645">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2645">Yes</span></span>|  
|<span data-ttu-id="968a1-2646">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2646">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2647">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2647">Yes</span></span>|  
|<span data-ttu-id="968a1-2648">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2648">Remote computer</span></span>|<span data-ttu-id="968a1-2649">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2649">No</span></span>|  
|<span data-ttu-id="968a1-2650">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2650">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2651">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2651">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2652">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2652">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2653">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2653">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2654">Impossible de trouver le message avec le paramètre <paramref name="id" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2654">The message with the specified <paramref name="id" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2655">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2655">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2656">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2656">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2657">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2657">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2658">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2658">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2659">Reçoit le message qui correspond à l'identificateur donné (à partir d'une file d'attente non transactionnelle), puis attend qu'un message ayant cet identificateur soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2659">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2660">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2660">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2661">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2661">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="968a1-2662">Cette méthode est retournée immédiatement si le message avec l’identificateur spécifié par le `id` paramètre figure dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2662">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="968a1-2663">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2663">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2664">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2664">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2665">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2665">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2666">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2666">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2667">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.Id%2A> du nouveau message pour voir si elle correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2667">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="968a1-2668">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2668">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2669">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.Id%2A> correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2669">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2670">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2670">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2671">Utilisez cette surcharge de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> lorsqu’il est acceptable pour le thread actuel peut être bloqué en tant que nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’attente spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2671">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2672">Le thread sera bloqué pendant au moins la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour le `timeout` paramètre, ou si de nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’attente spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2672">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2673">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2673">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2674">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2674">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2675">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2675">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2676">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2676">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2677">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2677">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2678">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2678">Workgroup mode</span></span>|<span data-ttu-id="968a1-2679">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2679">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2680">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2680">Local computer</span></span>|<span data-ttu-id="968a1-2681">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2681">Yes</span></span>|  
|<span data-ttu-id="968a1-2682">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2682">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2683">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2683">Yes</span></span>|  
|<span data-ttu-id="968a1-2684">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2684">Remote computer</span></span>|<span data-ttu-id="968a1-2685">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2685">No</span></span>|  
|<span data-ttu-id="968a1-2686">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2686">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2687">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2687">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2688">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2688">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2689">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2689">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2690">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2690">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2691">Aucun message possédant le paramètre <paramref name="id" /> spécifié n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2691">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2692">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2692">-or-</span>
          </span>
          <span data-ttu-id="968a1-2693">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2693">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2694">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2694">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2695">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2695">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2696">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2696">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2697">Reçoit le message qui correspond à l'identificateur donné (à partir d'une file d'attente transactionnelle), puis attend qu'un message ayant cet identificateur soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2697">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2698">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2698">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2699">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente, à l’aide du contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2699">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-2700">Cette méthode est retournée immédiatement si le message avec l’identificateur spécifié par le `id` paramètre figure dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2700">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="968a1-2701">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2701">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2702">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2702">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2703">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2703">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2704">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2704">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2705">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.Id%2A> du nouveau message pour voir si elle correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2705">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="968a1-2706">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2706">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2707">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.Id%2A> correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2707">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2708">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2708">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2709">Utilisez cette surcharge de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> lorsqu’il est acceptable pour le thread actuel peut être bloqué en tant que nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’attente spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2709">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2710">Le thread sera bloqué pendant au moins la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour le `timeout` paramètre, ou si de nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’expiration spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2710">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2711">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2711">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2712">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2712">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2713">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2713">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2714">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2714">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2715">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2715">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2716">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, afin que les appels suivants à la méthode de retournent le même message, à moins qu’un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2716">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2717">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2717">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="968a1-2718">Étant donné que <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2718">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2719">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2719">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2720">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2720">Workgroup mode</span></span>|<span data-ttu-id="968a1-2721">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2721">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2722">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2722">Local computer</span></span>|<span data-ttu-id="968a1-2723">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2723">Yes</span></span>|  
|<span data-ttu-id="968a1-2724">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2724">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2725">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2725">Yes</span></span>|  
|<span data-ttu-id="968a1-2726">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2726">Remote computer</span></span>|<span data-ttu-id="968a1-2727">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2727">No</span></span>|  
|<span data-ttu-id="968a1-2728">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2728">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2729">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2729">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2730">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2730">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2731">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2731">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-2732">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2732">-or-</span>
          </span>
          <span data-ttu-id="968a1-2733">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2733">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2734">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2734">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2735">Aucun message possédant le paramètre <paramref name="id" /> spécifié n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2735">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2736">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2736">-or-</span>
          </span>
          <span data-ttu-id="968a1-2737">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2737">The queue is non-transactional.</span>
          </span>
          <span data-ttu-id="968a1-2738">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2738">-or-</span>
          </span>
          <span data-ttu-id="968a1-2739">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2739">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id">
          <span data-ttu-id="968a1-2740">Propriété <see cref="P:System.Messaging.Message.Id" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2740">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="968a1-2741">
            <see cref="T:System.TimeSpan" /> qui indique la durée d'attente avant qu'un nouveau message ne soit accessible pour consultation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2741">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2742">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2742">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2743">Reçoit le message qui correspond à l'identificateur donné, puis attend qu'un message ayant l'identificateur spécifié soit disponible dans la file d'attente, ou que le délai d'attente expire.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2743">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2744">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.Id" /> correspond au paramètre <paramref name="id" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2744">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2745">Utilisez cette méthode pour lire un message avec un identificateur connu et le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2745">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="968a1-2746">Cette méthode est retournée immédiatement si le message avec l’identificateur spécifié par le `id` paramètre figure dans la file d’attente, à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2746">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="968a1-2747">Sinon, la méthode attend pendant la période donnée pour un nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2747">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="968a1-2748">Si un nouveau message n’arrive pas avant l’expiration du délai d’attente, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2748">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="968a1-2749">Le `timeout` paramètre ne spécifie pas le total pour l’exécution de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="968a1-2749">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="968a1-2750">Au lieu de cela, elle spécifie le délai d’attente d’un nouveau message arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2750">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="968a1-2751">Chaque fois qu’un nouveau message arrive, cette méthode examine les <xref:System.Messaging.Message.Id%2A> du nouveau message pour voir si elle correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2751">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="968a1-2752">Si ce n’est pas le cas, cette méthode reprend le délai d’attente et attend un autre nouveau message arrive.</span><span class="sxs-lookup"><span data-stu-id="968a1-2752">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="968a1-2753">Par conséquent, si de nouveaux messages continuent d’arriver dans le délai d’attente, il est possible de cette méthode continuer à s’exécuter indéfiniment, jusqu'à ce que le délai d’attente expire sans aucun nouveau message, ou jusqu'à ce qu’un message arrive dont <xref:System.Messaging.Message.Id%2A> correspond à la `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2753">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2754">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2754">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2755">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2755">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2756">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2756">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2757">Le <xref:System.Messaging.Message.Id%2A> propriété d’un message est unique dans l’entreprise Message Queuing, il y aura au plus un message dans la file d’attente qui correspond à la donnée `id` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2757">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="968a1-2758">Si le message avec l’identificateur spécifié est dans une file d’attente autre que celui associé à ce <xref:System.Messaging.MessageQueue> instance, le message sera introuvable.</span><span class="sxs-lookup"><span data-stu-id="968a1-2758">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="968a1-2759">Utilisez cette surcharge de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> lorsqu’il est acceptable pour le thread actuel peut être bloqué en tant que nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’attente spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2759">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="968a1-2760">Le thread sera bloqué pendant au moins la période donnée, ou indéfiniment si vous avez spécifié la valeur <xref:System.Messaging.MessageQueue.InfiniteTimeout> pour le `timeout` paramètre, ou si de nouveaux messages continuent d’arriver dans la file d’attente dans le délai d’attente spécifié par le `timeout` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2760">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2761">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2761">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2762">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2762">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2763">Deux autres méthodes permettent de recevoir des messages à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2763">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="968a1-2764">Le <xref:System.Messaging.MessageQueue.Receive%2A> méthode retourne le premier message dans la file d’attente et le <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> méthode est utilisée pour récupérer un accusé de réception, un rapport ou un message de réponse générés par l’application qui a été créé à la suite d’un message envoyé à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2764">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2765">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2765">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="968a1-2766">Le <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> méthode retourne toujours le premier message dans la file d’attente, les appels suivants à la méthode retournent le même message, sauf si un message de priorité plus élevé arrive dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2766">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="968a1-2767">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2767">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="968a1-2768">Étant donné que <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> ne supprime pas tous les messages dans la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2768">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2769">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2770">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2770">Workgroup mode</span></span>|<span data-ttu-id="968a1-2771">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2772">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2772">Local computer</span></span>|<span data-ttu-id="968a1-2773">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2773">Yes</span></span>|  
|<span data-ttu-id="968a1-2774">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2774">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2775">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2775">Yes</span></span>|  
|<span data-ttu-id="968a1-2776">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2776">Remote computer</span></span>|<span data-ttu-id="968a1-2777">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2777">No</span></span>|  
|<span data-ttu-id="968a1-2778">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2778">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2779">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2780">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2780">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2781">Le paramètre <paramref name="id" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2781">The <paramref name="id" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-2782">La valeur spécifiée pour le paramètre <paramref name="timeout" /> n'est pas valide. Il se peut que <paramref name="timeout" /> soit inférieur à <see cref="F:System.TimeSpan.Zero" /> ou supérieur à <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2782">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2783">Aucun message possédant le paramètre <paramref name="id" /> spécifié n'est arrivé dans la file d'attente avant l'expiration du délai d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2783">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span>
          </span>
          <span data-ttu-id="968a1-2784">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2784">-or-</span>
          </span>
          <span data-ttu-id="968a1-2785">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2785">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2786">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2786">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2787">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2787">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-2788">Reçoit un message spécifique de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2788">Receives a specific message from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2789">Le message peut être spécifié par un identificateur de recherche ou par sa position au début ou à la fin de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2789">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId">
          <span data-ttu-id="968a1-2790">Propriété <see cref="P:System.Messaging.Message.LookupId" /> du message à recevoir.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2790">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2791">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2791">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-2792">Reçoit le message qui correspond à l'identificateur de recherche donné d'une file d'attente non transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2792">Receives the message that matches the given lookup identifier from a non-transactional queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2793">
            <see cref="T:System.Messaging.Message" /> dont la propriété <see cref="P:System.Messaging.Message.LookupId" /> correspond au paramètre <paramref name="lookupId" /> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2793">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2794">Utilisez cette méthode pour lire un message avec un identificateur de recherche connu et le supprimer de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2794">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="968a1-2795">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2795">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2796">Le <xref:System.Messaging.Message.LookupId%2A> propriété d’un message unique à la file d’attente où réside le message, il y aura au plus un message dans la file d’attente qui correspond à la donnée `lookupId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2796">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2797">Pour lire un message avec un identificateur de recherche spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2797">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="968a1-2798">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2799">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2799">Workgroup mode</span></span>|<span data-ttu-id="968a1-2800">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2801">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2801">Local computer</span></span>|<span data-ttu-id="968a1-2802">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2802">Yes</span></span>|  
|<span data-ttu-id="968a1-2803">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2803">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2804">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2804">Yes</span></span>|  
|<span data-ttu-id="968a1-2805">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2805">Remote computer</span></span>|<span data-ttu-id="968a1-2806">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2806">No</span></span>|  
|<span data-ttu-id="968a1-2807">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2807">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2808">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-2809">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2809">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2810">Impossible de trouver le message avec le paramètre <paramref name="lookupId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2810">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2811">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2811">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="968a1-2812">L'une des valeurs <see cref="T:System.Messaging.MessageLookupAction" />, spécifiant comment le message est lu dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2812">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="968a1-2813">Spécifiez l'une des valeurs suivantes :</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2813">Specify one of the following:</span>
          </span>
          <span data-ttu-id="968a1-2814">
            <see langword="MessageLookupAction.Current" /> : reçoit le message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2814">
              <see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2815">
            <see langword="MessageLookupAction.Next" /> : reçoit le message qui suit message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2815">
              <see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2816">
            <see langword="MessageLookupAction.Previous" /> : reçoit le message qui précède le message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2816">
              <see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2817">
            <see langword="MessageLookupAction.First" /> : reçoit le premier message de la file d'attente et le supprime de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2817">
              <see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2818">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2818">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="968a1-2819">
            <see langword="MessageLookupAction.Last" /> : reçoit le dernier message de la file d'attente et le supprime de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2819">
              <see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2820">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2820">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="968a1-2821">Propriété <see cref="P:System.Messaging.Message.LookupId" /> du message à recevoir ou 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2821">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span>
          </span>
          <span data-ttu-id="968a1-2822">0 est utilisé lors de l'accès au premier ou dernier message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2822">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2823">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2823">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2824">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2824">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-2825">Reçoit un message spécifique d'une file d'attente transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2825">Receives a specific message from a transactional queue.</span>
          </span>
          <span data-ttu-id="968a1-2826">Le message peut être spécifié par un identificateur de recherche ou par sa position au début ou à la fin de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2826">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2827">
            <see cref="T:System.Messaging.Message" /> spécifié par les paramètres <paramref name="lookupId" /> et <paramref name="action" /> passés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2827">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2828">Utilisez cette méthode pour lire un message avec un identificateur de recherche connu et le supprimer de la file d’attente, à l’aide d’un contexte de transaction défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2828">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-2829">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2829">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2830">Le <xref:System.Messaging.Message.LookupId%2A> propriété d’un message unique à la file d’attente où réside le message, il y aura au plus un message dans la file d’attente qui correspond à la donnée `lookupId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2830">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2831">Étant donné que cette méthode est appelée sur une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2831">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2832">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2832">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2833">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2833">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="968a1-2834">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2834">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="968a1-2835">Étant donné que <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> ne supprime pas tous les messages à partir de la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2835">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2836">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2836">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2837">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2837">Workgroup mode</span></span>|<span data-ttu-id="968a1-2838">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2838">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2839">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2839">Local computer</span></span>|<span data-ttu-id="968a1-2840">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2840">Yes</span></span>|  
|<span data-ttu-id="968a1-2841">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2841">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2842">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2842">Yes</span></span>|  
|<span data-ttu-id="968a1-2843">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2843">Remote computer</span></span>|<span data-ttu-id="968a1-2844">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2844">No</span></span>|  
|<span data-ttu-id="968a1-2845">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2845">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2846">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2846">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-2847">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2847">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2848">Impossible de trouver le message avec le paramètre <paramref name="lookupId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2848">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2849">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2849">An error occurred when accessing a Message Queuing method.</span>
          </span>
          <span data-ttu-id="968a1-2850">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2850">-or-</span>
          </span>
          <span data-ttu-id="968a1-2851">La file d'attente n'est pas transactionnelle.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2851">The queue is non-transactional.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2852">Le paramètre <paramref name="action" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2852">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="968a1-2853">L'une des valeurs <see cref="T:System.Messaging.MessageLookupAction" />, spécifiant comment le message est lu dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2853">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span>
          </span>
          <span data-ttu-id="968a1-2854">Spécifiez l'une des valeurs suivantes :</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2854">Specify one of the following:</span>
          </span>
          <span data-ttu-id="968a1-2855">
            <see langword="MessageLookupAction.Current" /> : reçoit le message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2855">
              <see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2856">
            <see langword="MessageLookupAction.Next" /> : reçoit le message qui suit message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2856">
              <see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2857">
            <see langword="MessageLookupAction.Previous" /> : reçoit le message qui précède le message spécifié par <c>lookupId</c> et le supprime de la file d’attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2857">
              <see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2858">
            <see langword="MessageLookupAction.First" /> : reçoit le premier message de la file d'attente et le supprime de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2858">
              <see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2859">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2859">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
          <span data-ttu-id="968a1-2860">
            <see langword="MessageLookupAction.Last" /> : reçoit le dernier message de la file d'attente et le supprime de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2860">
              <see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2861">Le paramètre <c>lookupId</c> doit avoir la valeur 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2861">The <c>lookupId</c> parameter must be set to 0.</span>
          </span>
        </param>
        <param name="lookupId">
          <span data-ttu-id="968a1-2862">Propriété <see cref="P:System.Messaging.Message.LookupId" /> du message à recevoir ou 0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2862">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span>
          </span>
          <span data-ttu-id="968a1-2863">0 est utilisé lors de l'accès au premier ou dernier message de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2863">0 is used when accessing the first or last message in the queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-2864">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2864">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2865">Présentation dans MSMQ 3.0.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2865">Introduced in MSMQ 3.0.</span>
          </span>
          <span data-ttu-id="968a1-2866">Reçoit un message spécifique de la file d'attente, à l'aide du contexte de transaction spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2866">Receives a specific message from the queue, using the specified transaction context.</span>
          </span>
          <span data-ttu-id="968a1-2867">Le message peut être spécifié par un identificateur de recherche ou par sa position au début ou à la fin de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2867">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="968a1-2868">
            <see cref="T:System.Messaging.Message" /> spécifié par les paramètres <paramref name="action" /> et <paramref name="lookupId" /> passés.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2868">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2869">Utilisez cette méthode pour lire un message avec un identificateur de recherche connu et le supprimer de la file d’attente, à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2869">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="968a1-2870">Cette méthode lève une exception immédiatement si le message n’est pas dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2870">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2871">Le <xref:System.Messaging.Message.LookupId%2A> propriété d’un message unique à la file d’attente où réside le message, il y aura au plus un message dans la file d’attente qui correspond à la donnée `lookupId` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2871">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="968a1-2872">Pour lire un message avec l’identificateur spécifié sans le supprimer de la file d’attente, utilisez la <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="968a1-2872">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="968a1-2873">Il n’existe aucun contexte de transaction associé à un message retourné par un appel à <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2873">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="968a1-2874">Étant donné que <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> ne supprime pas tous les messages à partir de la file d’attente, il serait rien à annulée si la transaction a été abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2874">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="968a1-2875">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2875">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="968a1-2876">Spécifiez `Single` si vous souhaitez recevoir le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-2876">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-2877">Vous pouvez spécifier `None` si vous souhaitez recevoir un message d’une file d’attente transactionnelle en dehors d’un contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-2877">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="968a1-2878">Si cette méthode est appelée pour recevoir un message à partir d’une file d’attente transactionnelle, le message est reçu est retourné à la file d’attente si la transaction est abandonnée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2878">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="968a1-2879">Le message n’est pas définitivement supprimé de la file d’attente jusqu'à ce que la transaction est validée.</span><span class="sxs-lookup"><span data-stu-id="968a1-2879">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="968a1-2880">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2880">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2881">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2881">Workgroup mode</span></span>|<span data-ttu-id="968a1-2882">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2882">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2883">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2883">Local computer</span></span>|<span data-ttu-id="968a1-2884">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2884">Yes</span></span>|  
|<span data-ttu-id="968a1-2885">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2885">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2886">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2886">Yes</span></span>|  
|<span data-ttu-id="968a1-2887">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2887">Remote computer</span></span>|<span data-ttu-id="968a1-2888">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2888">No</span></span>|  
|<span data-ttu-id="968a1-2889">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2889">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2890">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2890">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="968a1-2891">MSMQ 3.0 n'est pas installé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2891">MSMQ 3.0 is not installed.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="968a1-2892">Impossible de trouver le message avec le paramètre <paramref name="lookupId" /> spécifié.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2892">The message with the specified <paramref name="lookupId" /> could not be found.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2893">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2893">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-2894">Le paramètre <paramref name="action" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageLookupAction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2894">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span>
          </span>
          <span data-ttu-id="968a1-2895">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2895">-or-</span>
          </span>
          <span data-ttu-id="968a1-2896">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2896">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2897">Se produit lorsqu'un message a été supprimé de la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2897">Occurs when a message has been removed from the queue.</span>
          </span>
          <span data-ttu-id="968a1-2898">Cet événement est déclenché par l'opération asynchrone <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2898">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> est utilisé dans le traitement asynchrone pour déclencher le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement lorsqu’un message est disponible dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="968a1-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> permet de terminer l’opération lancée par un appel à <xref:System.Messaging.MessageQueue.BeginReceive%2A> et de lire le message lorsque le <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché.</span><span class="sxs-lookup"><span data-stu-id="968a1-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="968a1-2901">Lorsque vous créez un délégué <xref:System.Messaging.ReceiveCompletedEventHandler>, vous identifiez la méthode qui gérera l'événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-2901">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="968a1-2902">Pour associer l'événement au gestionnaire d'événements, ajoutez une instance du délégué à l'événement.</span><span class="sxs-lookup"><span data-stu-id="968a1-2902">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="968a1-2903">Le gestionnaire d'événements est appelé chaque fois qu'un événement se produit, sauf si vous supprimez le délégué.</span><span class="sxs-lookup"><span data-stu-id="968a1-2903">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="968a1-2904">Pour plus d’informations sur les délégués de gestionnaires d’événements, consultez [gestion et déclenchement d’événements](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="968a1-2904">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2905">L’exemple de code suivant crée un gestionnaire d’événements nommé `MyReceiveCompleted`, attache à la <xref:System.Messaging.MessageQueue.ReceiveCompleted> délégué de gestionnaire d’événements et appelle <xref:System.Messaging.MessageQueue.BeginReceive%2A> pour lancer une opération de réception asynchrone sur la file d’attente qui se trouve dans le chemin d’accès ». \myQueue ».</span><span class="sxs-lookup"><span data-stu-id="968a1-2905">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="968a1-2906">Lorsqu’un <xref:System.Messaging.MessageQueue.ReceiveCompleted> événement est déclenché, l’exemple reçoit le message et écrit son corps à l’écran.</span><span class="sxs-lookup"><span data-stu-id="968a1-2906">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="968a1-2907">L’exemple appelle ensuite <xref:System.Messaging.MessageQueue.BeginReceive%2A> à nouveau pour lancer une nouvelle asynchrone opération de réception.</span><span class="sxs-lookup"><span data-stu-id="968a1-2907">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2908">Actualise les propriétés présentées par <see cref="T:System.Messaging.MessageQueue" /> pour refléter l'état actuel de la ressource.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2908">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronise les propriétés d’un <xref:System.Messaging.MessageQueue> avec les ressources serveur de Message Queuing qui lui sont associées.</span><span class="sxs-lookup"><span data-stu-id="968a1-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="968a1-2910">Si n’importe quelle propriété, tel que <xref:System.Messaging.MessageQueue.Label%2A> ou <xref:System.Messaging.MessageQueue.Category%2A>, a été modifié sur le serveur depuis le le <xref:System.Messaging.MessageQueue> a été créé, <xref:System.Messaging.MessageQueue.Refresh%2A> mises à jour le <xref:System.Messaging.MessageQueue> avec les nouvelles informations.</span><span class="sxs-lookup"><span data-stu-id="968a1-2910">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="968a1-2911">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2912">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2912">Workgroup mode</span></span>|<span data-ttu-id="968a1-2913">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2914">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2914">Local computer</span></span>|<span data-ttu-id="968a1-2915">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2915">Yes</span></span>|  
|<span data-ttu-id="968a1-2916">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2916">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2917">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2917">Yes</span></span>|  
|<span data-ttu-id="968a1-2918">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2918">Remote computer</span></span>|<span data-ttu-id="968a1-2919">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2919">No</span></span>|  
|<span data-ttu-id="968a1-2920">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2920">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2921">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2922">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2923">Réinitialise la liste des autorisations à l'aide des valeurs par défaut du système d'exploitation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2923">Resets the permission list to the operating system's default values.</span>
          </span>
          <span data-ttu-id="968a1-2924">Supprime les autorisations sur des files d'attente ajoutées à la liste par défaut.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2924">Removes any queue permissions you have appended to the default list.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2925">Lorsque vous appelez <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, vous renvoyer la liste des autorisations à ses valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="968a1-2925">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="968a1-2926">En général, il accorde le créateur de la file d’attente de toutes les autorisations et donne au groupe tout le monde les droits suivants :</span><span class="sxs-lookup"><span data-stu-id="968a1-2926">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="968a1-2927">Obtenir les propriétés de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2927">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="968a1-2928">Obtenir des autorisations de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2928">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="968a1-2929">Écrire dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2929">Write to the queue.</span></span>  
  
 <span data-ttu-id="968a1-2930">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2930">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2931">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2931">Workgroup mode</span></span>|<span data-ttu-id="968a1-2932">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2932">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2933">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2933">Local computer</span></span>|<span data-ttu-id="968a1-2934">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2934">Yes</span></span>|  
|<span data-ttu-id="968a1-2935">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2935">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2936">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2936">Yes</span></span>|  
|<span data-ttu-id="968a1-2937">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2937">Remote computer</span></span>|<span data-ttu-id="968a1-2938">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2938">No</span></span>|  
|<span data-ttu-id="968a1-2939">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2939">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2940">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2940">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2941">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2941">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2942">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2942">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-2943">Envoie un objet dans la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2943">Sends an object to a queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-2944">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2944">The object to send to the queue.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2945">Envoie un objet à la file d'attente non transactionnelle référencée par ce <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2945">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2946">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente référencée par le <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2946">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-2947">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message> ou tout objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-2947">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="968a1-2948">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2948">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="968a1-2949">Si vous utilisez cette surcharge pour envoyer un message à une file d’attente transactionnelle, le message sera envoyé à la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-2949">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="968a1-2950">Si vous souhaitez que le message fasse partie d’une transaction qui contient d’autres messages, utilisez une surcharge qui accepte un <xref:System.Messaging.MessageQueueTransaction> ou <xref:System.Messaging.MessageQueueTransactionType> en tant que paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2950">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="968a1-2951">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2951">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-2952">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2952">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-2953">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2953">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-2954">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-2954">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-2955">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2955">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2956">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2956">Workgroup mode</span></span>|<span data-ttu-id="968a1-2957">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2957">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2958">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2958">Local computer</span></span>|<span data-ttu-id="968a1-2959">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2959">Yes</span></span>|  
|<span data-ttu-id="968a1-2960">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2960">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2961">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2961">Yes</span></span>|  
|<span data-ttu-id="968a1-2962">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2962">Remote computer</span></span>|<span data-ttu-id="968a1-2963">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2963">No</span></span>|  
|<span data-ttu-id="968a1-2964">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2964">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2965">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2965">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2966">L’exemple de code suivant se connecte à une file d’attente et envoie un message à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2966">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="968a1-2967">L’exemple de code suivant envoie une définies par l’application `Order` classe à une file d’attente et puis reçoit un message à partir de cette file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2967">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2968">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2968">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-2969">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2969">-or-</span>
          </span>
          <span data-ttu-id="968a1-2970">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2970">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-2971">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2971">The object to send to the queue.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-2972">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2972">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-2973">Envoie un objet à la file d'attente transactionnelle référencée par ce <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2973">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-2974">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente transactionnelle référencée par la <xref:System.Messaging.MessageQueue>, à l’aide d’un contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-2974">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-2975">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message> ou tout objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-2975">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="968a1-2976">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-2976">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="968a1-2977">Si vous utilisez cette surcharge pour envoyer un message à une file d’attente non transactionnelle, le message peut être envoyé à la file d’attente de lettres mortes sans lever d’exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-2977">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="968a1-2978">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2978">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-2979">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2979">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-2980">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2980">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-2981">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-2981">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-2982"><xref:System.Messaging.MessageQueueTransaction> cloisonnement prenant en charge, par conséquent si votre état de cloisonnement est `STA`, vous ne pouvez pas utiliser la transaction dans plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="968a1-2982"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="968a1-2983">Visual Basic définit l’état du thread principal `STA`, vous devez donc appliquer le <xref:System.MTAThreadAttribute> dans les `Main` une sous-routine.</span><span class="sxs-lookup"><span data-stu-id="968a1-2983">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="968a1-2984">Sinon, l'envoi d'un message transactionnel qui utilise un autre thread lève une exception <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="968a1-2984">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="968a1-2985">Vous appliquez le <xref:System.MTAThreadAttribute> en utilisant le fragment suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-2985">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="968a1-2986">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-2986">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-2987">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-2987">Workgroup mode</span></span>|<span data-ttu-id="968a1-2988">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-2988">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-2989">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-2989">Local computer</span></span>|<span data-ttu-id="968a1-2990">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2990">Yes</span></span>|  
|<span data-ttu-id="968a1-2991">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2991">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-2992">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2992">Yes</span></span>|  
|<span data-ttu-id="968a1-2993">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-2993">Remote computer</span></span>|<span data-ttu-id="968a1-2994">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-2994">No</span></span>|  
|<span data-ttu-id="968a1-2995">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-2995">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-2996">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-2996">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-2997">L’exemple de code suivant envoie une chaîne vers une file d’attente transactionnelle et puis reçoit un message à partir de cette file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-2997">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-2998">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2998">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-2999">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-2999">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-3000">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3000">-or-</span>
          </span>
          <span data-ttu-id="968a1-3001">L'application Message Queuing a signalé une utilisation erronée de la transaction.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3001">The Message Queuing application indicated an incorrect transaction use.</span>
          </span>
          <span data-ttu-id="968a1-3002">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3002">-or-</span>
          </span>
          <span data-ttu-id="968a1-3003">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3003">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-3004">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3004">The object to send to the queue.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-3005">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3005">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3006">Envoie un objet à la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3006">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3007">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente référencée par la <xref:System.Messaging.MessageQueue>, à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3007">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="968a1-3008">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3008">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="968a1-3009">Spécifiez `Single` si vous souhaitez envoyer le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-3009">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-3010">Vous pouvez spécifier `None` si vous souhaitez envoyer un message transactionnel à un thread non transactionnel.</span><span class="sxs-lookup"><span data-stu-id="968a1-3010">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="968a1-3011">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message> ou tout objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3011">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="968a1-3012">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3012">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="968a1-3013">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3013">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-3014">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3014">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-3015">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3015">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-3016">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-3016">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-3017">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3017">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3018">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3018">Workgroup mode</span></span>|<span data-ttu-id="968a1-3019">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3019">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3020">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3020">Local computer</span></span>|<span data-ttu-id="968a1-3021">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3021">Yes</span></span>|  
|<span data-ttu-id="968a1-3022">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3022">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3023">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3023">Yes</span></span>|  
|<span data-ttu-id="968a1-3024">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3024">Remote computer</span></span>|<span data-ttu-id="968a1-3025">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3025">No</span></span>|  
|<span data-ttu-id="968a1-3026">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3026">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3027">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3027">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3028">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3028">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-3029">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3029">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3030">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3030">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-3031">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3031">-or-</span>
          </span>
          <span data-ttu-id="968a1-3032">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3032">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-3033">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3033">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="968a1-3034">Étiquette du message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3034">The label of the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3035">Envoie un objet à la file d'attente non transactionnelle référencée par ce <see cref="T:System.Messaging.MessageQueue" /> et spécifie une étiquette pour le message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3035">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3036">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente référencée par le <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3036">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="968a1-3037">Avec cette surcharge, vous pouvez spécifier l’étiquette de chaîne qui identifie le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3037">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="968a1-3038">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message>, une structure, un objet de données ou tout autre objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3038">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="968a1-3039">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3039">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="968a1-3040">Le libellé du message est distinct de l’étiquette de file d’attente de message, mais les deux dépend de l’application, n’ont pas hériter de signification pour Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-3040">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="968a1-3041">Si vous utilisez cette surcharge pour envoyer un message à une file d’attente transactionnelle, le message sera envoyé à la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-3041">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="968a1-3042">Si vous souhaitez que le message fasse partie d’une transaction qui contient d’autres messages, utilisez une surcharge qui accepte un <xref:System.Messaging.MessageQueueTransaction> ou <xref:System.Messaging.MessageQueueTransactionType> en tant que paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3042">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="968a1-3043">Le <xref:System.Messaging.MessageQueue.Path%2A> propriété pour ce <xref:System.Messaging.MessageQueue> instance doit être spécifiée avant d’envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3043">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="968a1-3044">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3044">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-3045">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3045">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-3046">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3046">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-3047">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-3047">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-3048">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3048">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3049">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3049">Workgroup mode</span></span>|<span data-ttu-id="968a1-3050">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3050">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3051">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3051">Local computer</span></span>|<span data-ttu-id="968a1-3052">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3052">Yes</span></span>|  
|<span data-ttu-id="968a1-3053">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3053">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3054">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3054">Yes</span></span>|  
|<span data-ttu-id="968a1-3055">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3055">Remote computer</span></span>|<span data-ttu-id="968a1-3056">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3056">No</span></span>|  
|<span data-ttu-id="968a1-3057">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3057">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3058">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3058">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3059">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3059">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-3060">Le paramètre <paramref name="label" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3060">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3061">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3061">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-3062">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3062">-or-</span>
          </span>
          <span data-ttu-id="968a1-3063">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3063">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-3064">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3064">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="968a1-3065">Étiquette du message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3065">The label of the message.</span>
          </span>
        </param>
        <param name="transaction">
          <span data-ttu-id="968a1-3066">Objet <see cref="T:System.Messaging.MessageQueueTransaction" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3066">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3067">Envoie un objet à la file d'attente transactionnelle référencée par ce <see cref="T:System.Messaging.MessageQueue" /> et spécifie une étiquette pour le message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3067">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3068">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente transactionnelle référencée par la <xref:System.Messaging.MessageQueue>, à l’aide d’un contexte de transaction interne défini par le `transaction` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3068">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="968a1-3069">Avec cette surcharge, vous pouvez spécifier l’étiquette de chaîne qui identifie le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3069">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="968a1-3070">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message>, une structure, un objet de données ou tout autre objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3070">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="968a1-3071">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3071">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="968a1-3072">Le libellé du message est distinct de l’étiquette de file d’attente de message, mais les deux dépend de l’application, n’ont pas hériter de signification pour Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-3072">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="968a1-3073">Si vous utilisez cette surcharge pour envoyer un message à une file d’attente non transactionnelle, le message peut être envoyé à la file d’attente de lettres mortes sans lever d’exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-3073">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="968a1-3074">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3074">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-3075">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3075">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-3076">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3076">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-3077">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété</span><span class="sxs-lookup"><span data-stu-id="968a1-3077">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="968a1-3078"><xref:System.Messaging.MessageQueueTransaction> cloisonnement prenant en charge, par conséquent si votre état de cloisonnement est `STA`, vous ne pouvez pas utiliser la transaction dans plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="968a1-3078"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="968a1-3079">Visual Basic définit l’état du thread principal `STA`, vous devez donc appliquer le <xref:System.MTAThreadAttribute> dans les `Main` une sous-routine.</span><span class="sxs-lookup"><span data-stu-id="968a1-3079">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="968a1-3080">Sinon, l'envoi d'un message transactionnel qui utilise un autre thread lève une exception <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3080">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="968a1-3081">Vous appliquez le <xref:System.MTAThreadAttribute> en utilisant le fragment suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-3081">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="968a1-3082">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3082">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3083">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3083">Workgroup mode</span></span>|<span data-ttu-id="968a1-3084">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3084">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3085">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3085">Local computer</span></span>|<span data-ttu-id="968a1-3086">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3086">Yes</span></span>|  
|<span data-ttu-id="968a1-3087">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3087">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3088">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3088">Yes</span></span>|  
|<span data-ttu-id="968a1-3089">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3089">Remote computer</span></span>|<span data-ttu-id="968a1-3090">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3090">No</span></span>|  
|<span data-ttu-id="968a1-3091">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3091">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3092">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3092">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3093">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3093">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-3094">Le paramètre <paramref name="label" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3094">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="968a1-3095">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3095">-or-</span>
          </span>
          <span data-ttu-id="968a1-3096">Le paramètre <paramref name="transaction" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3096">The <paramref name="transaction" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3097">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3097">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-3098">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3098">-or-</span>
          </span>
          <span data-ttu-id="968a1-3099">L'application Message Queuing a signalé une utilisation erronée de la transaction.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3099">The Message Queuing application indicated an incorrect transaction usage.</span>
          </span>
          <span data-ttu-id="968a1-3100">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3100">-or-</span>
          </span>
          <span data-ttu-id="968a1-3101">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3101">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj">
          <span data-ttu-id="968a1-3102">Objet à envoyer à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3102">The object to send to the queue.</span>
          </span>
        </param>
        <param name="label">
          <span data-ttu-id="968a1-3103">Étiquette du message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3103">The label of the message.</span>
          </span>
        </param>
        <param name="transactionType">
          <span data-ttu-id="968a1-3104">Une des valeurs de <see cref="T:System.Messaging.MessageQueueTransactionType" /> décrivant le type de contexte de transaction à associer au message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3104">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3105">Envoie un objet à la file d'attente référencée par ce <see cref="T:System.Messaging.MessageQueue" /> et spécifie une étiquette pour le message.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3105">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3106">Utilisez cette surcharge pour envoyer un message qui contient le `obj` paramètre à la file d’attente référencée par la <xref:System.Messaging.MessageQueue>, à l’aide d’un contexte de transaction défini par le `transactionType` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3106">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="968a1-3107">Spécifiez `Automatic` pour la `transactionType` paramètre, si un contexte de transaction externe est déjà attaché au thread que vous souhaitez utiliser pour envoyer le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3107">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="968a1-3108">Spécifiez `Single` si vous souhaitez envoyer le message comme une unique transaction interne.</span><span class="sxs-lookup"><span data-stu-id="968a1-3108">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="968a1-3109">Vous pouvez spécifier `None` si vous souhaitez envoyer un message transactionnel à un thread non transactionnel.</span><span class="sxs-lookup"><span data-stu-id="968a1-3109">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="968a1-3110">L’objet que vous envoyez à la file d’attente peut être un <xref:System.Messaging.Message> ou tout objet managé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3110">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="968a1-3111">Si vous envoyez un objet autre qu’un <xref:System.Messaging.Message>, l’objet est sérialisé et inséré dans le corps du message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3111">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="968a1-3112">Avec cette surcharge, vous pouvez spécifier l’étiquette de chaîne qui identifie le message.</span><span class="sxs-lookup"><span data-stu-id="968a1-3112">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="968a1-3113">Le libellé du message est distinct de l’étiquette de file d’attente de message, mais les deux dépend de l’application, n’ont pas hériter de signification pour Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-3113">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="968a1-3114">Si vous ne définissez pas le <xref:System.Messaging.MessageQueue.Formatter%2A> propriété avant d’appeler <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, le formateur par défaut est le <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3114">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="968a1-3115">Le <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> propriété s’applique à tout objet autre qu’un <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3115">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="968a1-3116">Si vous spécifiez, par exemple, une étiquette ou une priorité à l’aide de la <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> membre, ces valeurs s’appliquent à tout message qui contient un objet qui n’est pas de type <xref:System.Messaging.Message> lorsque votre application l’envoie à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3116">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="968a1-3117">Lors de l’envoi un <xref:System.Messaging.Message>, les valeurs de propriété définies pour le <xref:System.Messaging.Message> sont prioritaires sur les <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>et du message <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> propriété est prioritaire sur la file d’attente <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-3117">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="968a1-3118">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3118">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3119">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3119">Workgroup mode</span></span>|<span data-ttu-id="968a1-3120">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3120">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3121">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3121">Local computer</span></span>|<span data-ttu-id="968a1-3122">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3122">Yes</span></span>|  
|<span data-ttu-id="968a1-3123">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3123">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3124">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3124">Yes</span></span>|  
|<span data-ttu-id="968a1-3125">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3125">Remote computer</span></span>|<span data-ttu-id="968a1-3126">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3126">No</span></span>|  
|<span data-ttu-id="968a1-3127">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3127">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3128">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3128">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3129">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3129">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="968a1-3130">Le paramètre <paramref name="label" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3130">The <paramref name="label" /> parameter is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction">
          <span data-ttu-id="968a1-3131">L'application Message Queuing a signalé une utilisation erronée de la transaction.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3131">The Message Queuing application indicated an incorrect transaction usage.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="968a1-3132">Le paramètre <paramref name="transactionType" /> ne fait pas partie des membres <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3132">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3133">La propriété <see cref="P:System.Messaging.MessageQueue.Path" /> n'a pas été définie.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3133">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span>
          </span>
          <span data-ttu-id="968a1-3134">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3134">-or-</span>
          </span>
          <span data-ttu-id="968a1-3135">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3135">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-3136">Ajoute des autorisations au jeu en cours.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3136">Adds permissions to the current set.</span>
          </span>
          <span data-ttu-id="968a1-3137">Ceci permet de contrôler les utilisateurs ayant des droits d'accès aux propriétés de la file d'attente ainsi qu'aux messages de la file.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3137">This controls who has access rights to queue properties and messages in the queue.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl">
          <span data-ttu-id="968a1-3138">
            <see cref="T:System.Messaging.AccessControlList" /> qui contient une ou plusieurs entrées du contrôle d'accès spécifiant les tiers de confiance et les autorisations à accorder.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3138">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3139">Assigne les droits d'accès à la file d'attente en fonction du contenu d'une liste de contrôle d'accès.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3139">Assigns access rights to the queue based on the contents of an access control list.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3140">Utilisez cette surcharge pour accorder, refuser ou révoquer des droits à l’aide d’une collection d’entrées de contrôle d’accès pour spécifier les informations de tiers de confiance et les autorisations.</span><span class="sxs-lookup"><span data-stu-id="968a1-3140">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="968a1-3141">Il est utilisé, par exemple, pour accorder des autorisations à plusieurs utilisateurs en même temps.</span><span class="sxs-lookup"><span data-stu-id="968a1-3141">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="968a1-3142">Le tiers de confiance que vous spécifiez lorsque vous construisez le `ace` paramètre peut être un utilisateur individuel, un groupe d’utilisateurs ou un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-3142">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="968a1-3143">Si le tiers de confiance est un individu, utilisez le format `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="968a1-3143">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="968a1-3144">Vous pouvez spécifier «. » pour le tiers de confiance indiquer l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-3144">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="968a1-3145">Les autorisations assignées via <xref:System.Messaging.MessageQueue.SetPermissions%2A> ajouter des droits à la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3145">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="968a1-3146">Par défaut, le créateur d’une file d’attente publique ou privée a le contrôle total, et le groupe de domaines tout le monde a l’autorisation d’obtenir les propriétés de la file d’attente, obtenir les autorisations requises et écrire dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3146">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="968a1-3147">Lorsque vous appelez <xref:System.Messaging.MessageQueue.SetPermissions%2A>, les informations utilisateur et les autorisations sont ajoutées au bas de la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3147">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="968a1-3148">Le système examine chaque <xref:System.Messaging.AccessControlEntry> dans l’ordre jusqu'à ce qu’un des événements suivants se produit :</span><span class="sxs-lookup"><span data-stu-id="968a1-3148">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="968a1-3149">Refus d’accès <xref:System.Messaging.AccessControlEntry> refuse explicitement l’un des droits d’accès demandé à un tiers de confiance répertoriés dans le jeton d’accès du thread.</span><span class="sxs-lookup"><span data-stu-id="968a1-3149">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="968a1-3150">Au moins un accès autorisé <xref:System.Messaging.AccessControlEntry> éléments pour la confiance répertoriés dans le jeton d’accès du thread explicitement accorder les droits d’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3150">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="968a1-3151">Tous les <xref:System.Messaging.AccessControlEntry> éléments ont été vérifiés et il existe toujours au moins un droit d’accès demandé qui a été explicitement interdit, dans ce cas, l’accès est refusé implicitement.</span><span class="sxs-lookup"><span data-stu-id="968a1-3151">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="968a1-3152">Lorsque vous construisez le `dacl` paramètre, vous ajoutez <xref:System.Messaging.AccessControlEntry> instances à votre <xref:System.Messaging.AccessControlList> collection.</span><span class="sxs-lookup"><span data-stu-id="968a1-3152">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="968a1-3153">Lorsque vous construisez chaque entrée de contrôle d’accès, vous pouvez spécifier les droits d’accès génériques ou standard.</span><span class="sxs-lookup"><span data-stu-id="968a1-3153">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="968a1-3154">Les droits à une file d’attente peuvent être n’importe quelle combinaison des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="968a1-3154">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="968a1-3155">Supprimer</span><span class="sxs-lookup"><span data-stu-id="968a1-3155">Delete</span></span>  
  
-   <span data-ttu-id="968a1-3156">Sécurité de lecture</span><span class="sxs-lookup"><span data-stu-id="968a1-3156">Read Security</span></span>  
  
-   <span data-ttu-id="968a1-3157">Sécurité d’écriture</span><span class="sxs-lookup"><span data-stu-id="968a1-3157">Write Security</span></span>  
  
-   <span data-ttu-id="968a1-3158">Synchroniser</span><span class="sxs-lookup"><span data-stu-id="968a1-3158">Synchronize</span></span>  
  
-   <span data-ttu-id="968a1-3159">Modifier le propriétaire</span><span class="sxs-lookup"><span data-stu-id="968a1-3159">Modify Owner</span></span>  
  
-   <span data-ttu-id="968a1-3160">Lecture</span><span class="sxs-lookup"><span data-stu-id="968a1-3160">Read</span></span>  
  
-   <span data-ttu-id="968a1-3161">Write</span><span class="sxs-lookup"><span data-stu-id="968a1-3161">Write</span></span>  
  
-   <span data-ttu-id="968a1-3162">Exécuter</span><span class="sxs-lookup"><span data-stu-id="968a1-3162">Execute</span></span>  
  
-   <span data-ttu-id="968a1-3163">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="968a1-3163">Required</span></span>  
  
-   <span data-ttu-id="968a1-3164">Tous</span><span class="sxs-lookup"><span data-stu-id="968a1-3164">All</span></span>  
  
-   <span data-ttu-id="968a1-3165">Aucun.</span><span class="sxs-lookup"><span data-stu-id="968a1-3165">None</span></span>  
  
 <span data-ttu-id="968a1-3166">Ces droits sont un ensemble de bits indicateurs que vous pouvez associer à l’aide de l’opérateur de bits OR.</span><span class="sxs-lookup"><span data-stu-id="968a1-3166">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="968a1-3167">Contrôle total</span><span class="sxs-lookup"><span data-stu-id="968a1-3167">Full Control</span></span>  
  
-   <span data-ttu-id="968a1-3168">Supprimer le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3168">Delete Message</span></span>  
  
-   <span data-ttu-id="968a1-3169">Réception de Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3169">Receive Message</span></span>  
  
-   <span data-ttu-id="968a1-3170">Lire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3170">Peek Message</span></span>  
  
-   <span data-ttu-id="968a1-3171">Recevoir le Message du Journal</span><span class="sxs-lookup"><span data-stu-id="968a1-3171">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="968a1-3172">Obtenir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3172">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3173">Définir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3173">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3174">Obtenir les autorisations requises</span><span class="sxs-lookup"><span data-stu-id="968a1-3174">Get Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3175">Définir des autorisations</span><span class="sxs-lookup"><span data-stu-id="968a1-3175">Set Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3176">Prendre possession de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3176">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="968a1-3177">Écrire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3177">Write Message</span></span>  
  
 <span data-ttu-id="968a1-3178">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3178">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3179">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3179">Workgroup mode</span></span>|<span data-ttu-id="968a1-3180">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3180">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3181">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3181">Local computer</span></span>|<span data-ttu-id="968a1-3182">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3182">Yes</span></span>|  
|<span data-ttu-id="968a1-3183">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3183">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3184">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3184">Yes</span></span>|  
|<span data-ttu-id="968a1-3185">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3185">Remote computer</span></span>|<span data-ttu-id="968a1-3186">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3186">No</span></span>|  
|<span data-ttu-id="968a1-3187">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3187">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3188">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3188">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3189">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3189">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3190">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3190">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace">
          <span data-ttu-id="968a1-3191">
            <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> qui spécifie un utilisateur, un type d'accès ou un type d'autorisation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3191">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3192">Assigne des droits d'accès à la file d'attente en fonction du contenu d'une entrée du contrôle d'accès.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3192">Assigns access rights to the queue based on the contents of an access control entry.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3193">Utilisez cette surcharge pour accorder, refuser ou révoquer des droits à l’aide d’une entrée de contrôle d’accès pour spécifier des informations sur les droits et les tiers de confiance.</span><span class="sxs-lookup"><span data-stu-id="968a1-3193">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="968a1-3194">Le tiers de confiance que vous spécifiez lorsque vous construisez le `ace` paramètre peut être un utilisateur individuel, un groupe d’utilisateurs ou un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-3194">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="968a1-3195">Si le tiers de confiance est un individu, utilisez le format `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="968a1-3195">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="968a1-3196">Vous pouvez spécifier «. » pour le tiers de confiance indiquer l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-3196">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="968a1-3197">Les autorisations assignées via <xref:System.Messaging.MessageQueue.SetPermissions%2A> ajouter des droits à la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3197">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="968a1-3198">Par défaut, le créateur d’une file d’attente publique ou privée a le contrôle total, et le groupe de domaines tout le monde a l’autorisation d’obtenir les propriétés de la file d’attente, obtenir les autorisations requises et écrire dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3198">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="968a1-3199">Lorsque vous appelez <xref:System.Messaging.MessageQueue.SetPermissions%2A>, les informations utilisateur et les autorisations sont ajoutées au bas de la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3199">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="968a1-3200">Le système examine chaque <xref:System.Messaging.AccessControlEntry> dans l’ordre jusqu'à ce qu’un des événements suivants se produit :</span><span class="sxs-lookup"><span data-stu-id="968a1-3200">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="968a1-3201">Refus d’accès <xref:System.Messaging.AccessControlEntry> refuse explicitement l’un des droits d’accès demandé à un tiers de confiance répertoriés dans le jeton d’accès du thread.</span><span class="sxs-lookup"><span data-stu-id="968a1-3201">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="968a1-3202">Au moins un accès autorisé <xref:System.Messaging.AccessControlEntry> éléments pour la confiance répertoriés dans le jeton d’accès du thread explicitement accorder les droits d’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3202">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="968a1-3203">Tous les <xref:System.Messaging.AccessControlEntry> éléments ont été vérifiés et il existe toujours au moins un droit d’accès demandé qui a été explicitement interdit, dans ce cas, l’accès est refusé implicitement.</span><span class="sxs-lookup"><span data-stu-id="968a1-3203">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="968a1-3204">Les droits à une file d’attente, que vous spécifiez dans le `rights` paramètre lorsque vous construisez votre <xref:System.Messaging.MessageQueueAccessControlEntry>, peut être n’importe quelle combinaison des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="968a1-3204">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="968a1-3205">Contrôle total</span><span class="sxs-lookup"><span data-stu-id="968a1-3205">Full Control</span></span>  
  
-   <span data-ttu-id="968a1-3206">Supprimer le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3206">Delete Message</span></span>  
  
-   <span data-ttu-id="968a1-3207">Réception de Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3207">Receive Message</span></span>  
  
-   <span data-ttu-id="968a1-3208">Lire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3208">Peek Message</span></span>  
  
-   <span data-ttu-id="968a1-3209">Recevoir le Message du Journal</span><span class="sxs-lookup"><span data-stu-id="968a1-3209">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="968a1-3210">Obtenir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3210">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3211">Définir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3211">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3212">Obtenir les autorisations requises</span><span class="sxs-lookup"><span data-stu-id="968a1-3212">Get Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3213">Définir des autorisations</span><span class="sxs-lookup"><span data-stu-id="968a1-3213">Set Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3214">Prendre possession de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3214">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="968a1-3215">Écrire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3215">Write Message</span></span>  
  
 <span data-ttu-id="968a1-3216">Le `rights` paramètre que vous spécifiez dans le constructeur de la `ace` paramètre est un indicateur de la <xref:System.Messaging.MessageQueueAccessRights> énumération.</span><span class="sxs-lookup"><span data-stu-id="968a1-3216">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="968a1-3217">Il représente un ensemble de bits indicateurs que vous pouvez associer à l’aide de l’opérateur de bits OR lorsque vous construisez le `rights` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3217">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="968a1-3218">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3218">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3219">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3219">Workgroup mode</span></span>|<span data-ttu-id="968a1-3220">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3220">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3221">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3221">Local computer</span></span>|<span data-ttu-id="968a1-3222">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3222">Yes</span></span>|  
|<span data-ttu-id="968a1-3223">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3223">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3224">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3224">Yes</span></span>|  
|<span data-ttu-id="968a1-3225">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3225">Remote computer</span></span>|<span data-ttu-id="968a1-3226">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3226">No</span></span>|  
|<span data-ttu-id="968a1-3227">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3227">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3228">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3228">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3229">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3229">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3230">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3230">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user">
          <span data-ttu-id="968a1-3231">L'individu, le groupe ou l'ordinateur obtenant des droits d'accès supplémentaires à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3231">The individual, group, or computer that gets additional rights to the queue.</span>
          </span>
        </param>
        <param name="rights">
          <span data-ttu-id="968a1-3232">
            <see cref="T:System.Messaging.MessageQueueAccessRights" /> qui indique l’ensemble des droits d’accès à la file d’attente affectés par Message Queuing au <c>user</c> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3232">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3233">Donne les droits d'accès spécifiés à un ordinateur, un groupe ou un utilisateur.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3233">Gives a computer, group, or user the specified access rights.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3234">Utilisez cette surcharge pour accorder des droits spécifiés à un utilisateur individuel.</span><span class="sxs-lookup"><span data-stu-id="968a1-3234">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="968a1-3235">L’utilisateur peut être n’importe quel tiers de confiance valide, qui inclut des utilisateurs individuels, des groupes d’utilisateurs ou un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-3235">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="968a1-3236">Si l’utilisateur est un individu, utilisez le format `DOMAIN` \\ `user` pour la `user` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3236">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="968a1-3237">Vous pouvez spécifier «. » pour le `user` pour indiquer l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-3237">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="968a1-3238">Les autorisations assignées via <xref:System.Messaging.MessageQueue.SetPermissions%2A> ajouter des droits à la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3238">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="968a1-3239">Par défaut, le créateur d’une file d’attente publique ou privée a le contrôle total, et le groupe de domaines tout le monde a l’autorisation d’obtenir les propriétés de la file d’attente, obtenir les autorisations requises et écrire dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3239">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="968a1-3240">Lorsque vous appelez <xref:System.Messaging.MessageQueue.SetPermissions%2A>, les informations utilisateur et les autorisations sont ajoutées au bas de la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3240">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="968a1-3241">Le système examine chaque <xref:System.Messaging.AccessControlEntry> dans l’ordre jusqu'à ce qu’un des événements suivants se produit :</span><span class="sxs-lookup"><span data-stu-id="968a1-3241">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="968a1-3242">Refus d’accès <xref:System.Messaging.AccessControlEntry> refuse explicitement l’un des droits d’accès demandé à un tiers de confiance répertoriés dans le jeton d’accès du thread.</span><span class="sxs-lookup"><span data-stu-id="968a1-3242">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="968a1-3243">Au moins un accès autorisé <xref:System.Messaging.AccessControlEntry> éléments pour la confiance répertoriés dans le jeton d’accès du thread explicitement accorder les droits d’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3243">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="968a1-3244">Tous les <xref:System.Messaging.AccessControlEntry> éléments ont été vérifiés et il existe toujours au moins un droit d’accès demandé qui a été explicitement interdit, dans ce cas, l’accès est refusé implicitement.</span><span class="sxs-lookup"><span data-stu-id="968a1-3244">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="968a1-3245">Les droits à une file d’attente, spécifié dans le `rights` paramètre peut être n’importe quelle combinaison des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="968a1-3245">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="968a1-3246">Contrôle total</span><span class="sxs-lookup"><span data-stu-id="968a1-3246">Full Control</span></span>  
  
-   <span data-ttu-id="968a1-3247">Supprimer le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3247">Delete Message</span></span>  
  
-   <span data-ttu-id="968a1-3248">Réception de Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3248">Receive Message</span></span>  
  
-   <span data-ttu-id="968a1-3249">Lire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3249">Peek Message</span></span>  
  
-   <span data-ttu-id="968a1-3250">Recevoir le Message du Journal</span><span class="sxs-lookup"><span data-stu-id="968a1-3250">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="968a1-3251">Obtenir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3251">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3252">Définir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3252">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3253">Obtenir les autorisations requises</span><span class="sxs-lookup"><span data-stu-id="968a1-3253">Get Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3254">Définir des autorisations</span><span class="sxs-lookup"><span data-stu-id="968a1-3254">Set Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3255">Prendre possession de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3255">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="968a1-3256">Écrire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3256">Write Message</span></span>  
  
 <span data-ttu-id="968a1-3257">Le <xref:System.Messaging.MessageQueueAccessRights> énumération représente un jeu d’indicateurs binaires que vous pouvez associer à l’aide de l’opérateur au niveau du bit ou pour générer le `rights` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3257">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="968a1-3258">Avec cette surcharge, vous pouvez uniquement accorder des autorisations ; Vous ne pouvez pas révoquer ou refuser les.</span><span class="sxs-lookup"><span data-stu-id="968a1-3258">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="968a1-3259">Vous devez utiliser une autre surcharge pour octroyer explicitement <xref:System.Messaging.AccessControlEntryType> autre que `Allow`.</span><span class="sxs-lookup"><span data-stu-id="968a1-3259">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="968a1-3260">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3260">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3261">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3261">Workgroup mode</span></span>|<span data-ttu-id="968a1-3262">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3262">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3263">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3263">Local computer</span></span>|<span data-ttu-id="968a1-3264">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3264">Yes</span></span>|  
|<span data-ttu-id="968a1-3265">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3265">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3266">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3266">Yes</span></span>|  
|<span data-ttu-id="968a1-3267">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3267">Remote computer</span></span>|<span data-ttu-id="968a1-3268">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3268">No</span></span>|  
|<span data-ttu-id="968a1-3269">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3269">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3270">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3270">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3271">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3271">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="968a1-3272">
            <paramref name="user" /> a la valeur <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3272">The <paramref name="user" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3273">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3273">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user">
          <span data-ttu-id="968a1-3274">L'individu, le groupe ou l'ordinateur obtenant des droits d'accès supplémentaires à la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3274">The individual, group, or computer that gets additional rights to the queue.</span>
          </span>
        </param>
        <param name="rights">
          <span data-ttu-id="968a1-3275">
            <see cref="T:System.Messaging.MessageQueueAccessRights" /> qui indique l’ensemble des droits d’accès à la file d’attente affectés par Message Queuing au <c>user</c> passé.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3275">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span>
          </span>
        </param>
        <param name="entryType">
          <span data-ttu-id="968a1-3276">
            <see cref="T:System.Messaging.AccessControlEntryType" /> qui spécifie si les autorisations spécifiées par le paramètre <c>rights</c> doivent être accordées, refusées ou révoquées.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3276">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <c>rights</c> parameter.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="968a1-3277">Accorde à un ordinateur, à un groupe ou à un utilisateur les droits d'accès spécifiés, avec le type de contrôle d'accès spécifié (allow, deny, revoke ou set).</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3277">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3278">Utilisez cette surcharge pour accorder, refuser ou révoquer les droits spécifiés pour un utilisateur individuel.</span><span class="sxs-lookup"><span data-stu-id="968a1-3278">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="968a1-3279">L’utilisateur peut être n’importe quel tiers de confiance valide, qui inclut des utilisateurs individuels, des groupes d’utilisateurs ou un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="968a1-3279">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="968a1-3280">Si l’utilisateur est un individu, utilisez le format `DOMAIN` \\ `user` pour la `user` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3280">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="968a1-3281">Vous pouvez spécifier «. » pour le `user` pour indiquer l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="968a1-3281">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="968a1-3282">Les autorisations assignées via <xref:System.Messaging.MessageQueue.SetPermissions%2A> ajouter des droits à la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3282">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="968a1-3283">Par défaut, le créateur d’une file d’attente publique ou privée a le contrôle total, et le groupe de domaines tout le monde a l’autorisation d’obtenir les propriétés de la file d’attente, obtenir les autorisations requises et écrire dans la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3283">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="968a1-3284">Lorsque vous appelez <xref:System.Messaging.MessageQueue.SetPermissions%2A>, les informations utilisateur et les autorisations sont ajoutées au bas de la liste existante.</span><span class="sxs-lookup"><span data-stu-id="968a1-3284">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="968a1-3285">Le système examine chaque <xref:System.Messaging.AccessControlEntry> dans l’ordre jusqu'à ce qu’un des événements suivants se produit :</span><span class="sxs-lookup"><span data-stu-id="968a1-3285">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="968a1-3286">Refus d’accès <xref:System.Messaging.AccessControlEntry> refuse explicitement l’un des droits d’accès demandé à un tiers de confiance répertoriés dans le jeton d’accès du thread.</span><span class="sxs-lookup"><span data-stu-id="968a1-3286">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="968a1-3287">Au moins un accès autorisé <xref:System.Messaging.AccessControlEntry> éléments pour la confiance répertoriés dans le jeton d’accès du thread explicitement accorder les droits d’accès demandé.</span><span class="sxs-lookup"><span data-stu-id="968a1-3287">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="968a1-3288">Tous les <xref:System.Messaging.AccessControlEntry> éléments ont été vérifiés et il existe toujours au moins un droit d’accès demandé qui a été explicitement interdit, dans ce cas, l’accès est refusé implicitement.</span><span class="sxs-lookup"><span data-stu-id="968a1-3288">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="968a1-3289">Les droits à une file d’attente, spécifié dans le `rights` paramètre peut être n’importe quelle combinaison des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="968a1-3289">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="968a1-3290">Contrôle total</span><span class="sxs-lookup"><span data-stu-id="968a1-3290">Full Control</span></span>  
  
-   <span data-ttu-id="968a1-3291">Supprimer le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3291">Delete Message</span></span>  
  
-   <span data-ttu-id="968a1-3292">Réception de Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3292">Receive Message</span></span>  
  
-   <span data-ttu-id="968a1-3293">Lire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3293">Peek Message</span></span>  
  
-   <span data-ttu-id="968a1-3294">Recevoir le Message du Journal</span><span class="sxs-lookup"><span data-stu-id="968a1-3294">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="968a1-3295">Obtenir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3295">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3296">Définir les propriétés de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3296">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="968a1-3297">Obtenir les autorisations requises</span><span class="sxs-lookup"><span data-stu-id="968a1-3297">Get Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3298">Définir des autorisations</span><span class="sxs-lookup"><span data-stu-id="968a1-3298">Set Permissions</span></span>  
  
-   <span data-ttu-id="968a1-3299">Prendre possession de la file d’attente</span><span class="sxs-lookup"><span data-stu-id="968a1-3299">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="968a1-3300">Écrire le Message</span><span class="sxs-lookup"><span data-stu-id="968a1-3300">Write Message</span></span>  
  
 <span data-ttu-id="968a1-3301">Le <xref:System.Messaging.MessageQueueAccessRights> énumération représente un jeu d’indicateurs binaires que vous pouvez associer à l’aide de l’opérateur au niveau du bit ou pour générer le `rights` paramètre.</span><span class="sxs-lookup"><span data-stu-id="968a1-3301">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="968a1-3302">Le tableau suivant indique si cette méthode est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3303">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3303">Workgroup mode</span></span>|<span data-ttu-id="968a1-3304">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3305">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3305">Local computer</span></span>|<span data-ttu-id="968a1-3306">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3306">Yes</span></span>|  
|<span data-ttu-id="968a1-3307">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3307">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3308">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3308">Yes</span></span>|  
|<span data-ttu-id="968a1-3309">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3309">Remote computer</span></span>|<span data-ttu-id="968a1-3310">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3310">No</span></span>|  
|<span data-ttu-id="968a1-3311">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3311">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3312">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3313">L'exemple de code suivant montre l'utilisation de <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3313">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3314">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3314">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-3315">Obtient ou définit l'objet utilisé pour marshaler l'appel du gestionnaire d'événements consécutif à un événement <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> ou <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3315">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-3316">
            <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> qui représente l'objet utilisé pour marshaler l'appel au gestionnaire d'événements consécutif à un événement <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> ou <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3316">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span>
          </span>
          <span data-ttu-id="968a1-3317">La valeur par défaut est <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3317">The default is <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3318">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> ou <xref:System.Messaging.MessageQueue.PeekCompleted> événement résulte d’une <xref:System.Messaging.MessageQueue.BeginReceive%2A> ou <xref:System.Messaging.MessageQueue.BeginPeek%2A> demander, respectivement, à un thread spécifique.</span><span class="sxs-lookup"><span data-stu-id="968a1-3318">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="968a1-3319">En règle générale, le <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> est définie lorsque le composant associé est placé à l’intérieur d’un contrôle ou un formulaire, car ces composants sont liés à un thread spécifique.</span><span class="sxs-lookup"><span data-stu-id="968a1-3319">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="968a1-3320">En règle générale, l’objet de synchronisation marshale un appel de méthode dans un thread unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-3320">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-3321">Obtient une valeur qui indique si la file d'attente prend en charge les transactions uniquement.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3321">Gets a value that indicates whether the queue accepts only transactions.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-3322">
            <see langword="true" /> si la file d'attente accepte uniquement les messages envoyés dans le cadre d'une transaction ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3322">
              <see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3323">La messagerie transactionnelle correspond au couplage de plusieurs messages connexes dans une transaction unique.</span><span class="sxs-lookup"><span data-stu-id="968a1-3323">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="968a1-3324">Envoi de messages comme partie d’une transaction garantit que les messages sont remis dans l’ordre, une seule fois et récupérées à partir de leur file d’attente de destination.</span><span class="sxs-lookup"><span data-stu-id="968a1-3324">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="968a1-3325">Si une file d’attente est transactionnelle, elle accepte uniquement les messages qui sont envoyés dans le cadre d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="968a1-3325">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="968a1-3326">Toutefois, un message non transactionnel pouvant être envoyé ou reçu à partir d’une file d’attente de transaction locale sans explicitement à l’aide de transactionnelle <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, et <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntaxe.</span><span class="sxs-lookup"><span data-stu-id="968a1-3326">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="968a1-3327">Si un message non transactionnel est envoyé à une file d’attente transactionnelle, ce composant crée une transaction de message unique, sauf dans le cas de faisant référence à une file d’attente sur un ordinateur distant à l’aide d’un nom de format direct.</span><span class="sxs-lookup"><span data-stu-id="968a1-3327">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="968a1-3328">Dans ce cas, si vous ne spécifiez pas un contexte de transaction lors de l’envoi d’un message, n’est créée pour vous et le message sera envoyé à la file d’attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="968a1-3328">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="968a1-3329">Si vous envoyez un message non transactionnel à une file d’attente transactionnelle, vous ne pourrez pas annuler le message en cas d’une exception.</span><span class="sxs-lookup"><span data-stu-id="968a1-3329">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="968a1-3330"><xref:System.Messaging.MessageQueueTransaction> cloisonnement prenant en charge, par conséquent si votre état de cloisonnement est `STA`, vous ne pouvez pas utiliser la transaction dans plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="968a1-3330"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="968a1-3331">Visual Basic définit l’état du thread principal `STA`, vous devez donc appliquer le <xref:System.MTAThreadAttribute> dans les `Main` une sous-routine.</span><span class="sxs-lookup"><span data-stu-id="968a1-3331">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="968a1-3332">Sinon, l'envoi d'un message transactionnel qui utilise un autre thread lève une exception <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="968a1-3332">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="968a1-3333">Vous appliquez le <xref:System.MTAThreadAttribute> en utilisant le fragment suivant.</span><span class="sxs-lookup"><span data-stu-id="968a1-3333">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="968a1-3334">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3334">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3335">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3335">Workgroup mode</span></span>|<span data-ttu-id="968a1-3336">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3336">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3337">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3337">Local computer</span></span>|<span data-ttu-id="968a1-3338">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3338">Yes</span></span>|  
|<span data-ttu-id="968a1-3339">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3339">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3340">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3340">Yes</span></span>|  
|<span data-ttu-id="968a1-3341">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3341">Remote computer</span></span>|<span data-ttu-id="968a1-3342">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3342">No</span></span>|  
|<span data-ttu-id="968a1-3343">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3343">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3344">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3344">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3345">L’exemple de code suivant affiche la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.Transactional%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-3345">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3346">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3346">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-3347">Obtient ou définit une valeur qui indique si les messages reçus sont copiés dans le journal de file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3347">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-3348">
            <see langword="true" /> si les messages reçus de la file d'attente sont copiés dans le journal de file d'attente associée ; sinon, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3348">
              <see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3349">Lorsque l’application Message Queuing crée une nouvelle file d’attente de l’application, il crée automatiquement une file d’attente du journal associé au même emplacement.</span><span class="sxs-lookup"><span data-stu-id="968a1-3349">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="968a1-3350">La file d’attente du journal est utilisé pour effectuer le suivi des messages supprimés à partir d’une file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3350">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="968a1-3351">Définition de cette propriété modifie la file d’attente Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="968a1-3351">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="968a1-3352">Par conséquent, n’importe quel autre <xref:System.Messaging.MessageQueue> instances sont affectées par la modification.</span><span class="sxs-lookup"><span data-stu-id="968a1-3352">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="968a1-3353">La file d’attente du journal ne suit pas les messages supprimés de la file d’attente, car leur minuteur de délai de réception a expiré, ni celui des messages supprimés de la file d’attente à l’aide d’un service d’annuaire Message Queuing (banque d’informations ou Active Directory).</span><span class="sxs-lookup"><span data-stu-id="968a1-3353">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="968a1-3354">Les applications ne peuvent pas envoyer des messages aux files d’attente du journal ; ils sont limités à un accès en lecture seule de ces files d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3354">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="968a1-3355">En outre, Message Queuing ne supprime jamais les messages des files d’attente du journal.</span><span class="sxs-lookup"><span data-stu-id="968a1-3355">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="968a1-3356">L’application à l’aide de la file d’attente doit effacer ces messages par leur réception ou en supprimant de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3356">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="968a1-3357">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3357">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3358">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3358">Workgroup mode</span></span>|<span data-ttu-id="968a1-3359">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3359">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3360">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3360">Local computer</span></span>|<span data-ttu-id="968a1-3361">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3361">Yes</span></span>|  
|<span data-ttu-id="968a1-3362">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3362">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3363">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3363">Yes</span></span>|  
|<span data-ttu-id="968a1-3364">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3364">Remote computer</span></span>|<span data-ttu-id="968a1-3365">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3365">No</span></span>|  
|<span data-ttu-id="968a1-3366">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3366">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3367">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3367">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="968a1-3368">L’exemple de code suivant obtient et définit la valeur d’une file d’attente de messages <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="968a1-3368">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3369">Une erreur s'est produite lors de l'accès à une méthode Message Queuing.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3369">An error occurred when accessing a Message Queuing method.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="968a1-3370">Obtient le handle natif utilisé pour l'envoi des messages vers la file d'attente de messages.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3370">Gets the native handle used to send messages to the message queue.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="968a1-3371">Handle de l'objet file d'attente natif utilisé pour l'envoi des messages vers la file d'attente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3371">A handle to the native queue object that you use for sending messages to the queue.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="968a1-3372">Le <xref:System.Messaging.MessageQueue.WriteHandle%2A> fournit un handle Windows natif pour l’objet de file d’attente de messages qui est utilisé pour envoyer des messages à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="968a1-3372">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="968a1-3373">Si vous modifiez le chemin d’accès de la file d’attente, le handle est fermé et rouvert avec une nouvelle valeur.</span><span class="sxs-lookup"><span data-stu-id="968a1-3373">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="968a1-3374">Le tableau suivant indique si cette propriété est disponible dans différents modes de groupe de travail.</span><span class="sxs-lookup"><span data-stu-id="968a1-3374">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="968a1-3375">Mode groupe de travail</span><span class="sxs-lookup"><span data-stu-id="968a1-3375">Workgroup mode</span></span>|<span data-ttu-id="968a1-3376">Disponible</span><span class="sxs-lookup"><span data-stu-id="968a1-3376">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="968a1-3377">Ordinateur local</span><span class="sxs-lookup"><span data-stu-id="968a1-3377">Local computer</span></span>|<span data-ttu-id="968a1-3378">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3378">Yes</span></span>|  
|<span data-ttu-id="968a1-3379">Ordinateur local et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3379">Local computer and direct format name</span></span>|<span data-ttu-id="968a1-3380">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3380">Yes</span></span>|  
|<span data-ttu-id="968a1-3381">Ordinateur distant</span><span class="sxs-lookup"><span data-stu-id="968a1-3381">Remote computer</span></span>|<span data-ttu-id="968a1-3382">Non</span><span class="sxs-lookup"><span data-stu-id="968a1-3382">No</span></span>|  
|<span data-ttu-id="968a1-3383">Ordinateur distant et le nom de format direct</span><span class="sxs-lookup"><span data-stu-id="968a1-3383">Remote computer and direct format name</span></span>|<span data-ttu-id="968a1-3384">Oui</span><span class="sxs-lookup"><span data-stu-id="968a1-3384">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException">
          <span data-ttu-id="968a1-3385">La file d'attente de messages n'est pas accessible en écriture.</span>
          <span class="sxs-lookup">
            <span data-stu-id="968a1-3385">The message queue is not available for writing.</span>
          </span>
        </exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>