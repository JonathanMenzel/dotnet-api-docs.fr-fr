<Type Name="ManagedToNativeComInteropStubAttribute" FullName="System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="3c43f21310b8a2ad71fde9b4218d5c67801eec44" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30479053" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class ManagedToNativeComInteropStubAttribute : Attribute" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ManagedToNativeComInteropStubAttribute extends System.Attribute" />
  <TypeSignature Language="DocId" Value="T:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class ManagedToNativeComInteropStubAttribute&#xA;Inherits Attribute" />
  <TypeSignature Language="C++ CLI" Value="public ref class ManagedToNativeComInteropStubAttribute sealed : Attribute" />
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.Runtime.InteropServices</AssemblyName>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Attribute</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.AttributeUsage(System.AttributeTargets.Method, AllowMultiple=false, Inherited=false)</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>Prend en charge la personnalisation par l'utilisateur des stubs d'interopérabilité dans les scénarios COM Interop managés.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Cet attribut permet aux développeurs d’interopérabilité qui ont des connaissances à propos du marshaling et le fonctionnement interne des appels interop pour effectuer les opérations suivantes :  
  
-   Tirer parti des stubs d’interopérabilité personnalisés au moment de la build au lieu de l’exécution.  
  
-   Déboguer les stubs d’interopérabilité personnalisés.  
  
-   Fournir des fonctions de marshaling dans un stub qui ne fournit pas de l’exécution.  
  
-   Fournissent des fonctionnalités de répartition de méthode spécifique à l’utilisateur.  
  
 Vous appliquez l’attribut sur une méthode dans une interface pour spécifier une méthode stub correspondante pour COM interop de managé à natif.  
  
 Si cet attribut est rencontré pendant l’exécution, le common language runtime ne génère pas dynamiquement de stub d’interopérabilité. Au lieu de cela, il appelle le stub personnalisé créé au moment de la génération.  
  
 Le <xref:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute> attribut présente les caractéristiques suivantes :  
  
-   L’attribut peut être utilisé uniquement sur les méthodes des interfaces marquées `[ComImport]`. Si l’attribut est appliqué aux types d’interface non, il est ignoré par le runtime.  
  
-   L’attribut peut être utilisé qu’une seule fois sur la même méthode dans une interface. S’il est utilisé plusieurs fois, le compilateur génère une erreur d’attribut dupliquée.  
  
-   L’attribut n’est pas pouvant être héritée à partir d’une interface de base. Interfaces dérivées doivent affecter explicitement l’attribut.  
  
-   L’assembly qui contient la méthode attribuée doit également contenir le stub personnalisé.  
  
 Les méthodes stub surchargées sont valides. Bien que vous spécifiez uniquement le type et le nom de la méthode stub, l’exécution découvrira le stub correspondant. Il fait ceci en examinant tous les arguments de la méthode d’interface et puis en effectuant la signature complète correspondant à l’aide d’explicite `this` pointeur.  
  
 Il est également possible pour plusieurs méthodes dans une interface de partager la même méthode stub ; Toutefois, vous devez être prudent lorsque vous utilisez des stubs partagés.  
  
> [!NOTE]
>  Les méthodes stub doivent être statiques.  
  
 Vous pouvez informer le runtime pour utiliser un stub d’interopérabilité personnalisé au moment de la build au lieu de l’exécution avec le code c# suivant :  
  
```  
[ComImport]  
interface IMyInterface  
{  
    [ManagedToNativeComInteropStubAttribute(typeof(TestStubClass),  
              "ForwardTestStub")]  
    void GetString (string arg);  
}  
```  
  
 Vous pouvez ensuite utiliser le code suivant pour déclarer la méthode stub correspondante :  
  
```  
class TestStubClass  
{  
    internal static void ForwardTestStub(IMyInterface thisObject,  
             string arg) {…}  
}  
```  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ManagedToNativeComInteropStubAttribute (Type classType, string methodName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Type classType, string methodName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.#ctor(System.Type,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (classType As Type, methodName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ManagedToNativeComInteropStubAttribute(Type ^ classType, System::String ^ methodName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="classType" Type="System.Type" />
        <Parameter Name="methodName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="classType">Classe qui contient la méthode stub requise.</param>
        <param name="methodName">Nom de la méthode stub.</param>
        <summary>Initialise une nouvelle instance de la classe <see cref="T:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute" /> avec le type de classe et le nom de méthode spécifiés.</summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="methodName" /> est introuvable.  
  
 - ou -  
  
 La méthode n'est pas statique ou non générique.  
  
 - ou -  
  
 La liste de paramètres de la méthode ne correspond pas à la liste de paramètres attendue pour le stub.</exception>
        <exception cref="T:System.MethodAccessException">L'interface qui contient la méthode d'interopérabilité managée n'a aucun accès à la méthode stub, parce que la méthode stub a l'accessibilité privée ou protégée, ou à cause d'un problème de sécurité.</exception>
      </Docs>
    </Member>
    <Member MemberName="ClassType">
      <MemberSignature Language="C#" Value="public Type ClassType { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Type ClassType" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.ClassType" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ClassType As Type" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Type ^ ClassType { Type ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Type</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtient la classe qui contient la méthode stub requise.</summary>
        <value>Classe qui contient le stub d'interopérabilité personnalisé.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="MethodName">
      <MemberSignature Language="C#" Value="public string MethodName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MethodName" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.InteropServices.ManagedToNativeComInteropStubAttribute.MethodName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MethodName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MethodName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Obtient le nom de la méthode stub.</summary>
        <value>Nom d'un stub d'interopérabilité personnalisé.</value>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
  </Members>
</Type>