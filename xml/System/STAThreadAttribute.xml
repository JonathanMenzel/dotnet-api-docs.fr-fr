<Type Name="STAThreadAttribute" FullName="System.STAThreadAttribute">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="07786b1c739c286a2b99cb660de2426975ca9130" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="fr-FR" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30727643" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class STAThreadAttribute : Attribute" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit STAThreadAttribute extends System.Attribute" />
  <TypeSignature Language="DocId" Value="T:System.STAThreadAttribute" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class STAThreadAttribute&#xA;Inherits Attribute" />
  <TypeSignature Language="C++ CLI" Value="public ref class STAThreadAttribute sealed : Attribute" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Attribute</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.AttributeUsage(System.AttributeTargets.Method)</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(true)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>Indique que le modèle de thread COM d'une application est un modèle STA (Single-Threaded Apartment).</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 Appliquer cet attribut à la méthode de point d’entrée (le `Main()` méthode en c# et Visual Basic). Il n’a aucun effet sur les autres méthodes. Pour définir l’état de cloisonnement des threads que vous démarrez dans votre code, utilisez la <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> ou <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> méthode avant de démarrer le thread.  
  
> [!NOTE]
>  Pour une vue d’ensemble des modèles de thread COM, consultez [présentation et utilisation des modèles de thread COM](http://msdn.microsoft.com/library/ms809971.aspx).  
  
 Modèles de thread COM s’appliquent uniquement aux applications qui utilisent COM interop. Le modèle de thread COM peut être défini à thread unique cloisonné ou de multithread cloisonné. Le thread d’application est initialisé pour COM interop s’appelle un composant COM uniquement. Si l’interopérabilité COM n’est pas utilisée, alors que le thread n’est pas initialisé et le <xref:System.STAThreadAttribute> attribut, si elle est présente, n’a aucun effet.  
  
 À compter de .NET Framework version 2.0, la valeur par défaut de modèle pour COM interop de thread dépend de la langue dans laquelle vous développez votre application, comme le tableau suivant.  
  
|Langue|Modèle de cloisonnement COM|  
|--------------|-------------------------|  
|C#|Cloisonnement multithread|  
|C++|Cloisonnement multithread|  
|Visual Basic|Thread cloisonné|  
  
 Pour modifier ces valeurs par défaut, vous utilisez la <xref:System.STAThreadAttribute> attribut à définir le modèle de thread pour l’application, ou appelez le <xref:System.Threading.Thread.SetApartmentState%2A?displayProperty=nameWithType> ou <xref:System.Threading.Thread.TrySetApartmentState%2A?displayProperty=nameWithType> méthode avant de démarrer le thread pour définir le modèle de thread pour un thread particulier. En C++, vous pouvez également utiliser le [/CLRTHREADATTRIBUTE](http://msdn.microsoft.com/library/4907e9ef-5031-446c-aecf-0a0b32fae1e8) option de l’éditeur de liens pour spécifier le modèle de cloisonnement.  
  
 Les applications ASP.NET doivent affecter la `ASPCompat` attribut de la [@ Page](http://msdn.microsoft.com/library/f06cf9e5-22bb-461d-8b8f-549e53ff40a4) directive `true` pour forcer la page d’être traitées par le pool de threads STA.  
  
 Voici quelques-uns des cas dans lequel que vous souhaitez utiliser le <xref:System.STAThreadAttribute> attribut pour définir explicitement le modèle de thread cloisonné :  
  
-   Vous développez une application Windows Forms. Les applications Windows Forms doivent être monothread si elles communiquent avec les composants du système Windows tels que le Presse-papiers, ou Windows boîtes de dialogue communes, ou s’ils utilisent des fonctions système telles que les fonctionnalités de glisser-déplacer. Le modèle d’Application Windows Forms c# ajoute automatiquement le <xref:System.STAThreadAttribute> d’attributs pour les projets c#. Étant donné que le modèle de thread cloisonné est la valeur par défaut pour Visual Basic, il n’est pas nécessaire pour l’attribut.  
  
-   Vous développez une application c# qui appelle une bibliothèque Visual Basic, qui, à son tour, s’appuie sur COM interop. Étant donné que le modèle de thread cloisonné est la valeur par défaut pour Visual Basic, vous devez modifier modèle de thread de votre application à thread unique à l’aide de la <xref:System.STAThreadAttribute> attribut.  
  
-   Votre application effectue des appels aux composants COM qui utilisent le modèle de thread cloisonné.  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.MTAThreadAttribute" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public STAThreadAttribute ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.STAThreadAttribute.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; STAThreadAttribute();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>Initialise une nouvelle instance de la classe <see cref="T:System.STAThreadAttribute" />.</summary>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.MTAThreadAttribute" />
      </Docs>
    </Member>
  </Members>
</Type>