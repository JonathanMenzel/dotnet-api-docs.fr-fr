### <a name="new-64-bit-jit-compiler-in-the-net-framework-46"></a>Nouveau compilateur JIT de 64 bits dans le .NET Framework 4.6

|   |   |
|---|---|
|Détails|À compter du .NET Framework 4.6, un nouveau compilateur JIT 64 bits est utilisé pour la compilation juste-à-temps. Dans certains cas, une exception inattendue levée ou un comportement différent est prise en charge que si une application est exécutée à l’aide du compilateur 32 bits ou le compilateur JIT 64 bits plus anciens. Cette modification n’affecte pas le compilateur JIT de 32 bits. La valeur connue différences sont les suivantes :<ul><li>Dans certaines conditions, une opération d’unboxing peut lever une <xref:System.NullReferenceException> dans les versions Release avec l’optimisation activée.</li><li>Dans certains cas, l’exécution du code de production dans un corps de méthode volumineux peut lever une <xref:System.StackOverflowException>.</li><li>Sous certaines conditions, les structures passés à une méthode sont traités comme des types référence plutôt qu’en tant que valeur génère des types dans la version. Ce problème se manifeste notamment lorsque des éléments dans une collection apparaissent dans un ordre inattendu.</li><li>Dans certaines conditions, la comparaison de valeurs <xref:System.UInt16> avec le bit le plus élevé est incorrecte si l’optimisation est activée.</li><li>Sous certaines conditions, en particulier lors de l’initialisation de tableaux de valeurs, l’initialisation de la mémoire par l’instruction <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> du langage intermédiaire peut initialiser la mémoire avec une valeur incorrecte. Cela peut entraîner une exception non gérée ou une sortie incorrecte.</li><li>Dans certains cas rares, un test conditionnel binaire peut retourner une valeur <xref:System.Boolean> incorrecte ou lever une exception si les optimisations du compilateur sont activées.</li><li>Sous certaines conditions, si une instruction <code>if</code> est utilisée pour tester une condition avant d’entrer dans un bloc <code>try</code> et dans la sortie du bloc <code>try</code>, et que la même condition est évaluée dans le bloc <code>catch</code> ou <code>finally</code>, le nouveau compilateur JIT 64 bits supprime la condition <code>if</code> du bloc <code>catch</code> ou <code>finally</code> lorsqu’il optimise le code. Par conséquent, le code à l’intérieur de l’instruction <code>if</code> dans le bloc <code>catch</code> ou <code>finally</code> est exécuté de manière non conditionnelle.</li></ul>|
|Suggestion|<strong>Atténuation des problèmes connus</strong> si vous rencontrez les problèmes répertoriés ci-dessus, vous pouvez les résoudre en effectuant l’une des opérations suivantes :<ul><li>Mettez à niveau vers .NET Framework 4.6.2. Le nouveau compilateur 64 bits inclus avec .NET Framework 4.6.2 résout chacun de ces problèmes connus.</li><li>Assurez-vous que votre version de Windows est à jour en exécutant Windows Update. Les mises à jour de service pour .NET Framework 4.6 et 4.6.1 corrigent chacun de ces problèmes, à l’exception de <xref:System.NullReferenceException> dans une opération d’unboxing.</li><li>Compilez avec l’ancien compilateur JIT 64 bits. Consultez la section <strong>Atténuation des autres problèmes</strong> pour plus d’informations sur cette procédure.</li></ul><strong>Atténuation des autres problèmes</strong> si vous rencontrez n’importe quel autre différence de comportement entre le code compilé avec l’ancien compilateur 64 bits et le nouveau compilateur JIT 64 bits, ou entre les versions debug et release de votre application qui sont à la fois compilé avec le nouveau compilateur JIT de 64 bits, vous pouvez effectuer les opérations suivantes pour compiler votre application avec le compilateur JIT 64 bits plus anciens :<ul><li>Pour chaque application le nécessitant, vous pouvez ajouter l’élément [ \<useLegacyJit>](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) au fichier de configuration de votre application. Ce qui suit désactive la compilation avec le nouveau compilateur JIT 64 bits et utilise l’ancien compilateur à la place.</li></ul><pre><code class="language-xml">&lt;?xml version =&quot;1.0&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;useLegacyJit enabled=&quot;1&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><ul><li>Pour chaque utilisateur concerné, vous pouvez ajouter une valeur <code>REG_DWORD</code> nommée <code>useLegacyJit</code> à la clé de registre <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code>. La valeur 1 active l’ancien compilateur JIT 64 bits ; la valeur 0 le désactive et active le nouveau compilateur JIT 64 bits.</li><li>Pour chaque machine concernée, vous pouvez ajouter une valeur <code>REG_DWORD</code> nommée <code>useLegacyJit</code> à la clé de registre <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code>. La valeur <code>1</code> compilateur JIT d’Active 64 bits hérité ; la valeur <code>0</code> il désactive et le nouveau compilateur JIT 64 bits.</li></ul>Vous pouvez également nous indiquer votre problème en signalant un bogue sur [Microsoft Connect](https://connect.microsoft.com/VisualStudio).|
|Portée|Microsoft Edge|
|Version|4.6|
|Type|Reciblage|

