### <a name="accessibility-improvements-in-windows-forms-controls"></a>Améliorations apportées aux fonctionnalités d’accessibilité dans les contrôles Windows Forms

|   |   |
|---|---|
|Détails|Windows Forms améliore la façon dont il utilise les technologies d’accessibilité pour mieux répondre aux besoins de ses clients. Citons notamment les changements suivants :<ul><li>Changements visant à améliorer l’affichage en mode Contraste élevé.</li><li>Changements visant à améliorer l’expérience dans l’explorateur de propriétés. Améliorations apportées à l’explorateur de propriétés. Parmi celles-ci :</li><li>Une meilleure navigation au clavier via les différentes fenêtres de sélection de liste déroulante.</li><li>Une réduction des taquets de tabulation inutiles.</li><li>Des rapports plus élaborés sur les types de contrôles.</li><li>Un comportement amélioré du Narrateur.</li><li>Changements visant à implémenter les modèles d’accessibilité de l’interface utilisateur manquants dans les contrôles.</li></ul>|
|Suggestion|<strong>Comment accepter ou refuser ces changements</strong>L’application doit s’exécuter sur le .NET Framework 4.7.1 ou ultérieur pour tirer parti de ces changements. Pour que l’application bénéficie de ces changements, procédez de l’une des manières suivantes :<ul><li>Recompilez-la pour qu’elle cible le .NET Framework 4.7.1. Ces changements d’accessibilité sont activés par défaut sur les applications Windows Forms qui ciblent le .NET Framework 4.7.1 ou ultérieur.</li><li>Refusez les comportements d’accessibilité hérités en ajoutant le [commutateur AppContext](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) suivant à la section <code>&lt;runtime&gt;</code> du fichier app.config et en lui affectant la valeur <code>false</code>, comme dans l’exemple suivant.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Si votre application cible le .NET Framework 4.7.1 ou ultérieur et que vous souhaitez conserver le comportement d’accessibilité hérité, choisissez d’utiliser les fonctionnalités d’accessibilité héritées en affectant explicitement à ce commutateur AppContext la valeur <code>true</code>. Pour obtenir une présentation générale d’UI automation, consultez [Vue d’ensemble d’UI Automation](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Prise en charge des modèles et des propriétés d’UI Automation</strong>Les clients d’accessibilité peuvent tirer parti des nouvelles fonctionnalités d’accessibilité WinForms à l’aide de modèles d’appel publics. Ces modèles ne sont pas spécifiques à WinForms. Par exemple, les clients d’accessibilité peuvent appeler la méthode QueryInterface sur l’interface IAccessible (MAAS) pour obtenir une interface IServiceProvider. Si cette interface est disponible, les clients peuvent utiliser sa méthode QueryService pour demander une interface IAccessibleEx. Pour plus d’informations, consultez [Utilisation d’IAccessibleEx à partir d’un client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). À compter du .NET Framework 4.7.1, IServiceProvider et [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (le cas échéant) sont disponibles pour les objets d’accessibilité WinForms. Le .NET Framework 4.7.1 ajoute la prise en charge des modèles et des propriétés UI Automation suivants :<ul><li>Les contrôles <code>T:System.Windows.Forms.ToolStripSplitButton</code> et <code>T:System.Windows.Forms.ComboBox</code> prennent en charge le [modèle Développer/Réduire](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Le contrôle <code>T:System.Windows.Forms.ToolStripMenuItem</code> a une valeur de propriété [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) égale à <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le contrôle <code>T:System.Windows.Forms.ToolStripItem</code> prend en charge la propriété [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) et le [modèle Développer/Réduire](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Le contrôle <code>T:System.Windows.Forms.ToolStripDropDownItem</code> prend en charge <xref:System.Windows.Forms.AccessibleEvents> indiquant StateChange et NameChange quand la liste déroulante est développée ou réduite.</li><li>Le contrôle <code>T:System.Windows.Forms.ToolStripDropDownButton</code> a une valeur de propriété [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) égale à <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le contrôle <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> prend en charge le [modèle Basculer](xref:System.Windows.Automation.TogglePattern).</li><li>Les contrôles <code>T:System.Windows.Forms.NumericUpDown</code> et <code>T:System.Windows.Forms.DomainUpDown</code> prennent en charge [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) et ont un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) égal à <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Améliorations apportées au contrôle PropertyGrid</strong>Le .NET Framework 4.7.1 ajoute les améliorations suivantes au contrôle PropertyBrowser :<ul><li>Le bouton <strong>Détails</strong>, qui se trouve dans la boîte de dialogue d’erreur qui s’affiche quand l’utilisateur entre une valeur incorrecte dans le contrôle <code>T:System.Windows.Forms.PropertyGrid</code>, prend en charge le [modèle Développer/Réduire](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), les notifications de changement de nom et d’état, et une propriété [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) avec la valeur <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le volet de messages, qui s’affiche quand le bouton <strong>Détails</strong> de la boîte de dialogue d’erreur est développé, est désormais accessible au moyen du clavier et permet au Narrateur d’annoncer le contenu du message d’erreur.</li><li>Le <xref:System.Windows.Forms.AccessibleRole> des lignes dans le contrôle <code>T:System.Windows.Forms.PropertyGrid</code> est passé de &quot;Row&quot; à &quot;Cell&quot;. La cellule est mappée au ControlType UIA &quot;DataItem&quot;, ce qui lui permet de prendre en charge les raccourcis clavier appropriés et les annonces du Narrateur.</li><li>Les lignes du contrôle <code>T:System.Windows.Forms.PropertyGrid</code>, qui représentent les éléments d’en-tête quand le contrôle <code>T:System.Windows.Forms.PropertyGrid</code> a une propriété <code>P:System.Windows.Forms.PropertySort</code> dont la valeur est <code>F:System.Windows.Forms.PropertySory.Categorized</code>, ont une valeur de propriété [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) égale à <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType>.</li><li>Les lignes du contrôle <code>T:System.Windows.Forms.PropertyGrid</code>, qui représentent les éléments d’en-tête quand le contrôle <code>T:System.Windows.Forms.PropertyGrid</code> a une propriété <code>P:System.Windows.Forms.PropertySort</code> dont la valeur est <code>F:System.Windows.Forms.PropertySory.Categorized</code>, prennent en charge le [modèle Développer/Réduire](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Navigation au clavier améliorée entre la grille et de la barre d’outils située au-dessus. Le fait d’appuyer sur &quot;Maj+Tab&quot; sélectionne désormais le premier bouton de la barre d’outils, et non la barre d’outils entière.</li><li>Les contrôles <code>T:System.Windows.Forms.PropertyGrid</code> affichés en mode Contraste élevé dessinent désormais un rectangle de focus autour du bouton de barre d’outils qui correspond à la valeur de propriété <code>P:System.Windows.Forms.PropertySort</code> actuelle.</li><li>Les contrôles <code>T:System.Windows.Forms.PropertyGrid</code> affichés en mode Contraste élevé et dont la propriété <code>P:System.Windows.Forms.PropertySort</code> est définie avec la valeur <code>F:System.Windows.Forms.PropertySory.Categorized</code> affichent désormais l’arrière-plan des en-têtes de catégorie dans une couleur très contrastée.</li><li>Les contrôles <code>T:System.Windows.Forms.PropertyGrid</code> permettent de mieux distinguer les éléments de barre d’outils ayant le focus de ceux qui indiquent la valeur actuelle de la propriété <code>P:System.Windows.Forms.PropertySort</code>. Ce correctif se compose de deux changements : l’un visant le mode Contraste élevé et l’autre les scénarios n’utilisant pas ce mode.</li><li>Les éléments de barre d’outils du contrôle <code>T:System.Windows.Forms.PropertyGrid</code>, qui indiquent la valeur actuelle de la propriété <code>P:System.Windows.Forms.PropertySort</code>, prennent en charge le [modèle Basculer](xref:System.Windows.Automation.TogglePattern).</li><li>Prise en charge améliorée du Narrateur pour distinguer l’alignement sélectionné dans le sélecteur d’alignement.</li><li>Quand un contrôle <code>T:System.Windows.Forms.PropertyGrid</code> vide est affiché sur un formulaire, il reçoit désormais le focus. Ce n’était pas le cas avant.</li></ul><strong>Utilisation des couleurs définies par le système d’exploitation dans les thèmes à contraste élevé</strong><ul><li>Les contrôles <code>T:System.Windows.Forms.Button</code> et <code>T:System.Windows.Forms.CheckBox</code> dont le <code>P:System.Windows.Forms.Control.FlatStyle</code> est défini avec la valeur <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, le style par défaut, utilisent désormais les couleurs définies par le système d’exploitation dans le thème à contraste élevé quand celui-ci est sélectionné. Avant, les couleurs du texte et de l’arrière-plan n’étaient pas contrastées et étaient difficiles à lire.</li><li>Les contrôles <code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> et <code>T:System.Windows.Forms.GroupBox</code> dont le <code>P:System.Windows.Forms.Control.Enabled</code> est défini avec la valeur <em>false</em> utilisaient une couleur ombrée pour afficher le texte dans les thèmes à contraste élevé, ce qui aboutissait à un faible contraste par rapport à l’arrière-plan. Ces contrôles utilisent à présent la couleur &quot;Texte désactivé&quot; définie par le système d’exploitation. Ce correctif s’applique aux contrôles dont la propriété <code>P:System.Windows.Forms.Control.FlatStyle</code> est définie avec une valeur autre que <code>F:System.Windows.Forms.FlatStyle.System</code>. Ces derniers contrôles sont affichés par le système d’exploitation.</li><li><code>T:System.Windows.Forms.DataGridView</code> affiche maintenant un rectangle visible autour du contenu de la cellule qui a le focus. Ce rectangle était invisible dans certains thèmes à contraste élevé.</li><li>Les contrôles <code>T:System.Windows.Forms.ToolStripMenuItem</code> dont la propriété <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> a la valeur <em>false</em> utilisent maintenant la couleur &quot;Texte désactivé&quot; définie par le système d’exploitation.</li><li>Les contrôles <code>T:System.Windows.Forms.ToolStripMenuItem</code> dont la propriété <code>P:System.Windows.Forms.ToolStripItem.Checked</code> a la valeur <em>true</em> affichent maintenant la coche associée dans une couleur système contrastée.  Avant, la couleur de la coche n’était pas suffisamment contrastée et était invisible dans les thèmes à contraste élevé.</li></ul>REMARQUE : Les valeurs de certaines couleurs système à contraste élevé ont changé dans Windows 10. Windows Forms Framework est basé sur le framework Win32. Pour une expérience optimale, procédez à une exécution sur la dernière version de Windows et choisissez les derniers changements du système d’exploitation en ajoutant un fichier app.manifest dans une application de test et en décommentant le code suivant :<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navigation au clavier améliorée</strong><ul><li>Quand le <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> d’un contrôle <code>T:System.Windows.Forms.ComboBox</code> a la valeur <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> et qu’il s’agit du premier contrôle dans l’ordre de tabulation sur le formulaire, un rectangle de focus apparaît désormais quand le formulaire parent est ouvert à l’aide du clavier. Avant ce changement, le focus clavier était sur ce contrôle, mais aucun indicateur de focus n’était affiché.</li></ul><strong>Prise en charge améliorée du Narrateur</strong><ul><li>Le contrôle <code>T:System.Windows.Forms.MonthCalendar</code> prend désormais en charge les technologies d’assistance pour accéder au contrôle, notamment la possibilité pour le Narrateur de lire la valeur du contrôle, ce qui n’était pas possible avant.</li><li>Le contrôle <code>T:System.Windows.Forms.CheckedListBox</code> avertit désormais le Narrateur quand la propriété <code>P:System.Windows.Forms.CheckState</code> change. Le Narrateur ne recevait aucune notification, et les utilisateurs n’étaient pas informés de la mise à jour de <code>P:System.Windows.Forms.CheckState</code>.</li><li>Le contrôle <code>T:System.Windows.Forms.LinkLabel</code> notifie le Narrateur du texte présent dans le contrôle de manière différente. Avant, le Narrateur annonçait ce texte à deux reprises et lisait les symboles &quot; &amp; &quot; comme du texte réel, alors qu’ils n’étaient pas visibles. Le texte en double a été supprimé des annonces du Narrateur, ainsi que les symboles &quot;&amp;&quot; inutiles.</li><li>Les types de contrôle <code>T:System.Windows.Forms.DataGridViewCell</code> signalent désormais correctement l’état en lecture seule au Narrateur et à d’autres technologies d’assistance.</li><li>Le Narrateur peut désormais lire le menu système des fenêtres enfants dans les applications à [interface multidocument](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md).</li><li>Le Narrateur peut désormais lire les contrôles <code>T:System.Windows.Forms.ToolStripMenuItem</code> dont la propriété <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> a la valeur <em>false</em>. Avant, le Narrateur ne pouvait pas lire le contenu des éléments de menu désactivés.</li></ul>|
|Portée|Majeur|
|Version|4.7.1|
|Type|Reciblage|
|API affectées|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

