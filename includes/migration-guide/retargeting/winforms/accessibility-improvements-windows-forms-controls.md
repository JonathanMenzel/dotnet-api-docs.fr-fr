### <a name="accessibility-improvements-in-windows-forms-controls"></a>Améliorations d’accessibilité dans les contrôles Windows Forms

|   |   |
|---|---|
|Détails|Windows Forms est améliorer son fonctionnement avec les technologies d’accessibilité pour mieux prendre en charge les clients Windows Forms. Elles incluent notamment les modifications suivantes :<ul><li>Modifications pour améliorer l’affichage en mode de contraste élevé.</li><li>Modifications pour améliorer l’expérience de navigateur de propriété. Propriété navigateur améliorations sont notamment :</li><li>Une meilleure navigation au clavier via les différentes fenêtres de sélection de liste déroulante.</li><li>Réduit les taquets de tabulation inutiles.</li><li>Des rapports plus élaborés sur les types de contrôles.</li><li>Un comportement amélioré du Narrateur.</li><li>Modifications pour implémenter des modèles d’accessibilité de l’interface utilisateur manquants dans les contrôles.</li></ul>|
|Suggestion|<strong>Comment accepter ou de refuser ces modifications</strong>dans l’ordre de l’application pour tirer parti de ces modifications, il doit s’exécuter sur le .NET Framework 4.7.1 ou version ultérieure. L’application peut bénéficier de ces modifications dans une des manières suivantes :<ul><li>Il est recompilé pour cibler le .NET Framework 4.7.1. Ces modifications d’accessibilité sont activées par défaut sur les applications Windows Forms qui ciblent le .NET Framework 4.7.1 ou version ultérieure.</li><li>Il exclut les comportements hérités accessibilité en ajoutant le code suivant [AppContext commutateur](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) à la <code>&lt;runtime&gt;</code> section du fichier app.config et la valeur <code>false</code>, comme le montre l’exemple suivant.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Les applications qui ciblent le .NET Framework 4.7.1 ou version ultérieure et souhaitez conserver l’héritage comportement de l’accessibilité peut participer à l’utilisation des fonctionnalités d’accessibilité hérité en affectant explicitement ce commutateur AppContext <code>true</code>. Pour une vue d’ensemble d’UI automation, consultez la [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Prise en charge pour les modèles et propriétés UI Automation</strong>clients d’accessibilité peuvent tirer parti des nouvelles fonctionnalités d’accessibilité des Windows Forms à l’aide de modèles d’appel courantes, comme décrit au public. Ces modèles ne sont pas spécifiques à WinForms. Par exemple, les clients d’accessibilité peuvent appeler la méthode QueryInterface sur l’interface IAccessible (MAAS) pour obtenir une interface IServiceProvider. Si cette interface est disponible, les clients peuvent utiliser sa méthode QueryService pour demander une interface IAccessibleEx. Pour plus d’informations, consultez [IAccessibleEx d’à l’aide d’un Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). En commençant par le .NET Framework 4.7.1, IServiceProvider et [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (le cas échéant) sont disponibles pour les objets d’accessibilité de Windows Forms. Le .NET Framework 4.7.1 ajoute la prise en charge pour les modèles suivants de UI automation et les propriétés :<ul><li>Le <code>T:System.Windows.Forms.ToolStripSplitButton</code> et <code>T:System.Windows.Forms.ComboBox</code> contrôles prennent en charge la [modèle de développement/réduction](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Le <code>T:System.Windows.Forms.ToolStripMenuItem</code> contrôle a un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valeur de la propriété <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le <code>T:System.Windows.Forms.ToolStripItem</code> contrôle prend en charge la [nom](xref:System.Windows.Automation.AutomationElement.NameProperty) propriété et [modèle de développement/réduction](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Le <code>T:System.Windows.Forms.ToolStripDropDownItem</code> contrôle prend en charge <xref:System.Windows.Forms.AccessibleEvents> indiquant StateChange et NameChange lors de la liste déroulante est développé ou réduit.</li><li>Le <code>T:System.Windows.Forms.ToolStripDropDownButton</code> contrôle a un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valeur de propriété <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> contrôle prend en charge la [modèle Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Le <code>T:System.Windows.Forms.NumericUpDown</code> et <code>T:System.Windows.Forms.DomainUpDown</code> contrôles prennent en charge la [nom](xref:System.Windows.Automation.AutomationElement.NameProperty) et avoir un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) de <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Améliorations apportées au contrôle PropertyGrid</strong>du .NET Framework 4.7.1 ajoute les améliorations suivantes pour le contrôle PropertyBrowser :<ul><li>Le <strong>détails</strong> bouton dans la boîte de dialogue d’erreur qui s’affiche lorsque l’utilisateur entre une valeur incorrecte dans le <code>T:System.Windows.Forms.PropertyGrid</code> contrôle prend en charge la [modèle de développement/réduction](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), l’état et le changement de nom notifications et un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) propriété avec la valeur <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Le volet de message affiché lorsque la <strong>détails</strong> bouton de la boîte de dialogue d’erreur est développé est désormais clavier accessible et permet le Narrateur annoncer le contenu du message d’erreur.</li><li>Le <xref:System.Windows.Forms.AccessibleRole> de lignes dans <code>T:System.Windows.Forms.PropertyGrid</code> contrôle ont changé depuis &quot;ligne&quot; à &quot;cellule&quot;. La cellule est mappé à UIA ControlType &quot;DataItem&quot;, qui lui permet de prendre en charge les raccourcis clavier appropriés et les annonces Narrateur.</li><li>Le <code>T:System.Windows.Forms.PropertyGrid</code> contrôler les lignes d’en-tête représentent les éléments quand la <code>T:System.Windows.Forms.PropertyGrid</code> contrôle a un <code>P:System.Windows.Forms.PropertySort</code> propriété la valeur <code>F:System.Windows.Forms.PropertySory.Categorized</code> ont un [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valeur de propriété <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>Le <code>T:System.Windows.Forms.PropertyGrid</code> contrôler les lignes d’en-tête représentent les éléments quand la <code>T:System.Windows.Forms.PropertyGrid</code> contrôle a un <code>P:System.Windows.Forms.PropertySort</code> propriété la valeur <code>F:System.Windows.Forms.PropertySory.Categorized</code> prennent en charge la [modèle de développement/réduction](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Navigation au clavier améliorée entre la grille et de la barre d’outils au-dessus de lui. En appuyant sur &quot;Maj + Tab&quot; sélectionne maintenant le premier bouton de barre d’outils, au lieu de la barre d’outils entière</li><li><code>T:System.Windows.Forms.PropertyGrid</code> contrôles affichés en mode de contraste élevé Dessine un rectangle de focus autour du bouton de barre d’outils qui correspond à actuel <code>P:System.Windows.Forms.PropertySort</code> valeur de propriété.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> contrôles affichés dans le mode de contraste élevé et avec un <code>P:System.Windows.Forms.PropertySort</code> propriété <code>F:System.Windows.Forms.PropertySory.Categorized</code> s’affichent désormais l’arrière-plan d’en-têtes de catégorie dans une couleur très contrastée.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> contrôles mieux établit la distinction entre les éléments de barre d’outils avec le focus et les éléments de barre d’outils qui indiquent la valeur actuelle de la <code>P:System.Windows.Forms.PropertySort</code> propriété. Ce correctif se compose d’une modification de contraste élevé et une modification pour les scénarios de haute contraste.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> contrôler les éléments de barre d’outils qui indique la valeur actuelle de la <code>P:System.Windows.Forms.PropertySort</code> prise en charge de la propriété du [modèle Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Prise en charge de Narrateur améliorée pour distinguer l’alignement sélectionné dans le sélecteur d’alignement.</li><li>Lorsque vide <code>T:System.Windows.Forms.PropertyGrid</code> contrôle est affiché sur un formulaire, il reçoit désormais où précédemment s’il se n'agissait pas de focus.</li></ul><strong>Utilisation de couleurs du système d’exploitation dans les thèmes de contraste élevé</strong><ul><li><code>T:System.Windows.Forms.Button</code> et <code>T:System.Windows.Forms.CheckBox</code> contrôle avec <code>P:System.Windows.Forms.Control.FlatStyle</code> la valeur <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, qui est le style par défaut, désormais utiliser les couleurs définies par le système d’exploitation dans le thème à contraste élevé lorsque sélectionné. Auparavant, les couleurs de texte et d’arrière-plan n’étaient pas opposant et ont été difficiles à lire.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> et <code>T:System.Windows.Forms.GroupBox</code> avec<code>P:System.Windows.Forms.Control.Enabled</code> la valeur <em>false</em>, une couleur ombrée permet d’afficher le texte dans les thèmes de contraste élevé, aboutissant à un faible contraste par rapport à la en arrière-plan. Ces contrôles utilisent à présent &quot;texte désactivé&quot; couleur définie par le système d’exploitation. Ce correctif s’applique aux contrôles avec <code>P:System.Windows.Forms.Control.FlatStyle</code> propriété définie sur une valeur autre que <code>F:System.Windows.Forms.FlatStyle.System</code>. Les contrôles de ce dernier sont rendus par le système d’exploitation.</li><li><code>T:System.Windows.Forms.DataGridView</code> affiche maintenant un rectangle visible autour du contenu de la cellule qui a le focus actuel. Auparavant, cela n’était pas visible dans certains thèmes à contraste élevé.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> contrôles avec une <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> propriété <em>false</em> maintenant utiliser le &quot;texte désactivé&quot; couleur définie par le système d’exploitation.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> contrôles avec une <code>P:System.Windows.Forms.ToolStripItem.Checked</code> propriété <em>true</em> maintenant afficher la case à cocher associée dans une couleur système distincts.  Précédemment la couleur de la case à cocher a été opposant pas suffisante et non visibles dans les thèmes de contraste élevé.</li></ul>Remarque : Windows 10 Professionnel a modifié les valeurs pour certaines couleurs système à contraste élevé. Windows Forms Framework est basé sur l’infrastructure de Win32. Pour une expérience optimale, s’exécutent sur la dernière version de Windows et accepter les dernières modifications du système d’exploitation en ajoutant un fichier App.manifest dans une application de test et en commentaire le code suivant :<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navigation au clavier améliorée</strong><ul><li>Lorsqu’un <code>T:System.Windows.Forms.ComboBox</code> contrôle a <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> la valeur <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> et est le premier contrôle dans l’onglet ordre sur le formulaire, elle affiche à présent un rectangle de focus lorsque le formulaire parent est ouvert à l’aide du clavier. Avant cette modification, ce contrôle a le focus clavier, mais un indicateur de focus n’a pas été restitué.</li></ul><strong>Prise en charge améliorée du Narrateur</strong><ul><li>Le <code>T:System.Windows.Forms.MonthCalendar</code> contrôle a ajouté la prise en charge pour les technologies d’assistance accéder au contrôle, y compris la possibilité pour le Narrateur de précédemment qu’il n’a pas pu lire la valeur du contrôle.</li><li>Le <code>T:System.Windows.Forms.CheckedListBox</code> contrôle avertit désormais Narrateur lorsque le <code>P:System.Windows.Forms.CheckState</code> propriété a été modifiée. Auparavant, le Narrateur n’a pas reçu la notification et ainsi les utilisateurs ne serait pas informé que le <code>P:System.Windows.Forms.CheckState</code> a été mise à jour.</li><li>Le <code>T:System.Windows.Forms.LinkLabel</code> contrôle a changé la manière il notifie le Narrateur du texte dans le contrôle de. Auparavant, le Narrateur annoncé ce texte à deux reprises et lire &quot; &amp; &quot; symboles sous forme de texte réel, même s’ils ne sont pas visibles par un utilisateur. Le texte en double a été supprimé des annonces Narrateur, ainsi que d’inutiles &quot; &amp; &quot; symboles.</li><li>Le <code>T:System.Windows.Forms.DataGridViewCell</code> types de contrôle désormais correctement l’état en lecture seule Narrateur et d’autres technologies d’assistance de rapport.</li><li>Le Narrateur est désormais en mesure de lire le Menu système des fenêtres enfants dans [Multiple-Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</li><li>Le Narrateur est désormais en mesure de lire <code>T:System.Windows.Forms.ToolStripMenuItem</code> contrôle avec une <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> propriété <em>false</em>. Auparavant, le Narrateur n’a pas pu se concentrer sur les éléments de menu désactivés pour lire le contenu.</li></ul>|
|Portée|Majeur|
|Version|4.7.1|
|Type|Reciblage|
|API affectées|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

